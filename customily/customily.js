!function(t){function e(e){for(var n,r,o=e[0],s=e[1],a=0,l=[];a<o.length;a++)r=o[a],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);for(c&&c(e);l.length;)l.shift()()}var n={},i={0:0};function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise((function(e,r){n=i[t]=[e,r]}));e.push(n[2]=o);var s,a=document.createElement("script");a.charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.src=function(t){return r.p+"customily."+({1:"pdfjsLib",2:"pdfjsWorker"}[t]||t)+".js"}(t);var c=new Error;s=function(e){a.onerror=a.onload=null,clearTimeout(l);var n=i[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",c.name="ChunkLoadError",c.type=r,c.request=o,n[1](c)}i[t]=void 0}};var l=setTimeout((function(){s({type:"timeout",target:a})}),12e4);a.onerror=a.onload=s,document.head.appendChild(a)}return Promise.all(e)},r.m=t,r.c=n,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r.oe=function(t){throw console.error(t),t};var o=window.customily_jsonpFunction_CmqmbZVqRG=window.customily_jsonpFunction_CmqmbZVqRG||[],s=o.push.bind(o);o.push=e,o=o.slice();for(var a=0;a<o.length;a++)e(o[a]);var c=s;r(r.s=73)}([function(t,e,n){t.exports=n(115)},function(t,e){function n(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(l){return void n(l)}a.done?e(c):Promise.resolve(c).then(i,r)}t.exports=function(t){return function(){var e=this,i=arguments;return new Promise((function(r,o){var s=t.apply(e,i);function a(t){n(s,r,o,a,c,"next",t)}function c(t){n(s,r,o,a,c,"throw",t)}a(void 0)}))}}},function(t,e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof global&&global)||Function("return this")()},function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return p}));var i=n(0),r=n.n(i),o=n(1),s=n.n(o),a=n(7),c=n(8).baseUrl+"/api",l={},u={},h={},f=function(){var t=s()(r.a.mark((function t(e,n){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l[e]&&"undefined"!==typeof l[e][n]||(l[e]||(l[e]={}),l[e][n]=a.ajax({type:"GET",url:c+"/Libraries/"+e+"/Elements/Position/"+n,crossDomain:!0,data:{},dataType:"json"})),t.next=3,l[e][n];case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),d=function(){var t=s()(r.a.mark((function t(e){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"undefined"===typeof u[e]&&(u[e]=a.ajax({type:"GET",url:c+"/Libraries/"+e+"/Elements/First",crossDomain:!0,data:{},dataType:"json"})),t.next=3,u[e];case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p=function(){var t=s()(r.a.mark((function t(e){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"undefined"===typeof h[e]&&(h[e]=a.ajax({type:"GET",url:c+"/Libraries/"+e+"/Elements/Positions",crossDomain:!0,data:{},dataType:"json"})),t.next=3,h[e];case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},function(t,e,n){var i=n(2),r=n(21),o=n(44),s=n(78),a=i.Symbol,c=r("wks");t.exports=function(t){return c[t]||(c[t]=s&&a[t]||(s?a:o)("Symbol."+t))}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(12);t.exports=function(t){if(!i(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){var i;!function(e,n){"use strict";"object"===typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!==typeof window?window:this,(function(n,r){"use strict";var o=[],s=n.document,a=Object.getPrototypeOf,c=o.slice,l=o.concat,u=o.push,h=o.indexOf,f={},d=f.toString,p=f.hasOwnProperty,g=p.toString,m=g.call(Object),v={},y=function(t){return"function"===typeof t&&"number"!==typeof t.nodeType},b=function(t){return null!=t&&t===t.window},x={type:!0,src:!0,nonce:!0,noModule:!0};function C(t,e,n){var i,r,o=(n=n||s).createElement("script");if(o.text=t,e)for(i in x)(r=e[i]||e.getAttribute&&e.getAttribute(i))&&o.setAttribute(i,r);n.head.appendChild(o).parentNode.removeChild(o)}function S(t){return null==t?t+"":"object"===typeof t||"function"===typeof t?f[d.call(t)]||"object":typeof t}var w=function(t,e){return new w.fn.init(t,e)},_=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function D(t){var e=!!t&&"length"in t&&t.length,n=S(t);return!y(t)&&!b(t)&&("array"===n||0===e||"number"===typeof e&&e>0&&e-1 in t)}w.fn=w.prototype={jquery:"3.4.1",constructor:w,length:0,toArray:function(){return c.call(this)},get:function(t){return null==t?c.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=w.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return w.each(this,t)},map:function(t){return this.pushStack(w.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(c.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:o.sort,splice:o.splice},w.extend=w.fn.extend=function(){var t,e,n,i,r,o,s=arguments[0]||{},a=1,c=arguments.length,l=!1;for("boolean"===typeof s&&(l=s,s=arguments[a]||{},a++),"object"===typeof s||y(s)||(s={}),a===c&&(s=this,a--);a<c;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&s!==i&&(l&&i&&(w.isPlainObject(i)||(r=Array.isArray(i)))?(n=s[e],o=r&&!Array.isArray(n)?[]:r||w.isPlainObject(n)?n:{},r=!1,s[e]=w.extend(l,o,i)):void 0!==i&&(s[e]=i));return s},w.extend({expando:"jQuery"+("3.4.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==d.call(t))&&(!(e=a(t))||"function"===typeof(n=p.call(e,"constructor")&&e.constructor)&&g.call(n)===m)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e){C(t,{nonce:e&&e.nonce})},each:function(t,e){var n,i=0;if(D(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},trim:function(t){return null==t?"":(t+"").replace(_,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(D(Object(t))?w.merge(n,"string"===typeof t?[t]:t):u.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:h.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,s=!n;r<o;r++)!e(t[r],r)!==s&&i.push(t[r]);return i},map:function(t,e,n){var i,r,o=0,s=[];if(D(t))for(i=t.length;o<i;o++)null!=(r=e(t[o],o,n))&&s.push(r);else for(o in t)null!=(r=e(t[o],o,n))&&s.push(r);return l.apply([],s)},guid:1,support:v}),"function"===typeof Symbol&&(w.fn[Symbol.iterator]=o[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){f["[object "+e+"]"]=e.toLowerCase()}));var T=function(t){var e,n,i,r,o,s,a,c,l,u,h,f,d,p,g,m,v,y,b,x="sizzle"+1*new Date,C=t.document,S=0,w=0,_=ct(),D=ct(),T=ct(),E=ct(),k=function(t,e){return t===e&&(h=!0),0},O={}.hasOwnProperty,A=[],P=A.pop,I=A.push,F=A.push,M=A.slice,L=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",j="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",U="\\["+j+"*("+B+")(?:"+j+"*([*^$|!~]?=)"+j+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+j+"*\\]",z=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+U+")*)|.*)\\)|)",N=new RegExp(j+"+","g"),W=new RegExp("^"+j+"+|((?:^|[^\\\\])(?:\\\\.)*)"+j+"+$","g"),H=new RegExp("^"+j+"*,"+j+"*"),X=new RegExp("^"+j+"*([>+~]|"+j+")"+j+"*"),G=new RegExp(j+"|>"),Y=new RegExp(z),q=new RegExp("^"+B+"$"),V={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+U),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+j+"*(even|odd|(([+-]|)(\\d*)n|)"+j+"*(?:([+-]|)"+j+"*(\\d+)|))"+j+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+j+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+j+"*((?:-\\d)?\\d*)"+j+"*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\([\\da-f]{1,6}"+j+"?|("+j+")|.)","ig"),nt=function(t,e,n){var i="0x"+e-65536;return i!==i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},ot=function(){f()},st=xt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{F.apply(A=M.call(C.childNodes),C.childNodes),A[C.childNodes.length].nodeType}catch(Dt){F={apply:A.length?function(t,e){I.apply(t,M.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function at(t,e,i,r){var o,a,l,u,h,p,v,y=e&&e.ownerDocument,S=e?e.nodeType:9;if(i=i||[],"string"!==typeof t||!t||1!==S&&9!==S&&11!==S)return i;if(!r&&((e?e.ownerDocument||e:C)!==d&&f(e),e=e||d,g)){if(11!==S&&(h=J.exec(t)))if(o=h[1]){if(9===S){if(!(l=e.getElementById(o)))return i;if(l.id===o)return i.push(l),i}else if(y&&(l=y.getElementById(o))&&b(e,l)&&l.id===o)return i.push(l),i}else{if(h[2])return F.apply(i,e.getElementsByTagName(t)),i;if((o=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return F.apply(i,e.getElementsByClassName(o)),i}if(n.qsa&&!E[t+" "]&&(!m||!m.test(t))&&(1!==S||"object"!==e.nodeName.toLowerCase())){if(v=t,y=e,1===S&&G.test(t)){for((u=e.getAttribute("id"))?u=u.replace(it,rt):e.setAttribute("id",u=x),a=(p=s(t)).length;a--;)p[a]="#"+u+" "+bt(p[a]);v=p.join(","),y=tt.test(t)&&vt(e.parentNode)||e}try{return F.apply(i,y.querySelectorAll(v)),i}catch(w){E(t,!0)}finally{u===x&&e.removeAttribute("id")}}}return c(t.replace(W,"$1"),e,i,r)}function ct(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function lt(t){return t[x]=!0,t}function ut(t){var e=d.createElement("fieldset");try{return!!t(e)}catch(Dt){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function ft(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function dt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function pt(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return lt((function(e){return e=+e,lt((function(n,i){for(var r,o=t([],n.length,e),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))}))}))}function vt(t){return t&&"undefined"!==typeof t.getElementsByTagName&&t}for(e in n=at.support={},o=at.isXML=function(t){var e=t.namespaceURI,n=(t.ownerDocument||t).documentElement;return!Z.test(e||n&&n.nodeName||"HTML")},f=at.setDocument=function(t){var e,r,s=t?t.ownerDocument||t:C;return s!==d&&9===s.nodeType&&s.documentElement?(p=(d=s).documentElement,g=!o(d),C!==d&&(r=d.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",ot,!1):r.attachEvent&&r.attachEvent("onunload",ot)),n.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ut((function(t){return t.appendChild(d.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=$.test(d.getElementsByClassName),n.getById=ut((function(t){return p.appendChild(t).id=x,!d.getElementsByName||!d.getElementsByName(x).length})),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if("undefined"!==typeof e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n="undefined"!==typeof t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if("undefined"!==typeof e.getElementById&&g){var n,i,r,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(r=e.getElementsByName(t),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return"undefined"!==typeof e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(t,e){if("undefined"!==typeof e.getElementsByClassName&&g)return e.getElementsByClassName(t)},v=[],m=[],(n.qsa=$.test(d.querySelectorAll))&&(ut((function(t){p.appendChild(t).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+j+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\["+j+"*(?:value|"+R+")"),t.querySelectorAll("[id~="+x+"-]").length||m.push("~="),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+x+"+*").length||m.push(".#.+[+~]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=d.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name"+j+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=$.test(y=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ut((function(t){n.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),v.push("!=",z)})),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),e=$.test(p.compareDocumentPosition),b=e||$.test(p.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},k=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t===d||t.ownerDocument===C&&b(C,t)?-1:e===d||e.ownerDocument===C&&b(C,e)?1:u?L(u,t)-L(u,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!r||!o)return t===d?-1:e===d?1:r?-1:o?1:u?L(u,t)-L(u,e):0;if(r===o)return ft(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?ft(s[i],a[i]):s[i]===C?-1:a[i]===C?1:0},d):d},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if((t.ownerDocument||t)!==d&&f(t),n.matchesSelector&&g&&!E[e+" "]&&(!v||!v.test(e))&&(!m||!m.test(e)))try{var i=y.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(Dt){E(e,!0)}return at(e,d,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!==d&&f(t),b(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!==d&&f(t);var r=i.attrHandle[e.toLowerCase()],o=r&&O.call(i.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==o?o:n.attributes||!g?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},at.escape=function(t){return(t+"").replace(it,rt)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,i=[],r=0,o=0;if(h=!n.detectDuplicates,u=!n.sortStable&&t.slice(0),t.sort(k),h){for(;e=t[o++];)e===t[o]&&(r=i.push(o));for(;r--;)t.splice(i[r],1)}return u=null,t},r=at.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"===typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},(i=at.selectors={cacheLength:50,createPseudo:lt,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return V.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&Y.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=_[t+" "];return e||(e=new RegExp("(^|"+j+")"+t+"("+j+"|$)"))&&_(t,(function(t){return e.test("string"===typeof t.className&&t.className||"undefined"!==typeof t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(i){var r=at.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(N," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,c){var l,u,h,f,d,p,g=o!==s?"nextSibling":"previousSibling",m=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!c&&!a,b=!1;if(m){if(o){for(;g;){for(f=e;f=f[g];)if(a?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;p=g="only"===t&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&y){for(b=(d=(l=(u=(h=(f=m)[x]||(f[x]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]||[])[0]===S&&l[1])&&l[2],f=d&&m.childNodes[d];f=++d&&f&&f[g]||(b=d=0)||p.pop();)if(1===f.nodeType&&++b&&f===e){u[t]=[S,d,b];break}}else if(y&&(b=d=(l=(u=(h=(f=e)[x]||(f[x]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]||[])[0]===S&&l[1]),!1===b)for(;(f=++d&&f&&f[g]||(b=d=0)||p.pop())&&((a?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++b||(y&&((u=(h=f[x]||(f[x]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]=[S,b]),f!==e)););return(b-=r)===i||b%i===0&&b/i>=0}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return r[x]?r(e):r.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?lt((function(t,n){for(var i,o=r(t,e),s=o.length;s--;)t[i=L(t,o[s])]=!(n[i]=o[s])})):function(t){return r(t,0,n)}):r}},pseudos:{not:lt((function(t){var e=[],n=[],i=a(t.replace(W,"$1"));return i[x]?lt((function(t,e,n,r){for(var o,s=i(t,null,r,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))})):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}})),has:lt((function(t){return function(e){return at(t,e).length>0}})),contains:lt((function(t){return t=t.replace(et,nt),function(e){return(e.textContent||r(e)).indexOf(t)>-1}})),lang:lt((function(t){return q.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===p},focus:function(t){return t===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return K.test(t.nodeName)},input:function(t){return Q.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((function(){return[0]})),last:mt((function(t,e){return[e-1]})),eq:mt((function(t,e,n){return[n<0?n+e:n]})),even:mt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:mt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:mt((function(t,e,n){for(var i=n<0?n+e:n>e?e:n;--i>=0;)t.push(i);return t})),gt:mt((function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t}))}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=dt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=pt(e);function yt(){}function bt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function xt(t,e,n){var i=e.dir,r=e.next,o=r||i,s=n&&"parentNode"===o,a=w++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||s)return t(e,n,r);return!1}:function(e,n,c){var l,u,h,f=[S,a];if(c){for(;e=e[i];)if((1===e.nodeType||s)&&t(e,n,c))return!0}else for(;e=e[i];)if(1===e.nodeType||s)if(u=(h=e[x]||(e[x]={}))[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((l=u[o])&&l[0]===S&&l[1]===a)return f[2]=l[2];if(u[o]=f,f[2]=t(e,n,c))return!0}return!1}}function Ct(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function St(t,e,n,i,r){for(var o,s=[],a=0,c=t.length,l=null!=e;a<c;a++)(o=t[a])&&(n&&!n(o,i,r)||(s.push(o),l&&e.push(a)));return s}function wt(t,e,n,i,r,o){return i&&!i[x]&&(i=wt(i)),r&&!r[x]&&(r=wt(r,o)),lt((function(o,s,a,c){var l,u,h,f=[],d=[],p=s.length,g=o||function(t,e,n){for(var i=0,r=e.length;i<r;i++)at(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),m=!t||!o&&e?g:St(g,f,t,a,c),v=n?r||(o?t:p||i)?[]:s:m;if(n&&n(m,v,a,c),i)for(l=St(v,d),i(l,[],a,c),u=l.length;u--;)(h=l[u])&&(v[d[u]]=!(m[d[u]]=h));if(o){if(r||t){if(r){for(l=[],u=v.length;u--;)(h=v[u])&&l.push(m[u]=h);r(null,v=[],l,c)}for(u=v.length;u--;)(h=v[u])&&(l=r?L(o,h):f[u])>-1&&(o[l]=!(s[l]=h))}}else v=St(v===s?v.splice(p,v.length):v),r?r(null,s,v,c):F.apply(s,v)}))}function _t(t){for(var e,n,r,o=t.length,s=i.relative[t[0].type],a=s||i.relative[" "],c=s?1:0,u=xt((function(t){return t===e}),a,!0),h=xt((function(t){return L(e,t)>-1}),a,!0),f=[function(t,n,i){var r=!s&&(i||n!==l)||((e=n).nodeType?u(t,n,i):h(t,n,i));return e=null,r}];c<o;c++)if(n=i.relative[t[c].type])f=[xt(Ct(f),n)];else{if((n=i.filter[t[c].type].apply(null,t[c].matches))[x]){for(r=++c;r<o&&!i.relative[t[r].type];r++);return wt(c>1&&Ct(f),c>1&&bt(t.slice(0,c-1).concat({value:" "===t[c-2].type?"*":""})).replace(W,"$1"),n,c<r&&_t(t.slice(c,r)),r<o&&_t(t=t.slice(r)),r<o&&bt(t))}f.push(n)}return Ct(f)}return yt.prototype=i.filters=i.pseudos,i.setFilters=new yt,s=at.tokenize=function(t,e){var n,r,o,s,a,c,l,u=D[t+" "];if(u)return e?0:u.slice(0);for(a=t,c=[],l=i.preFilter;a;){for(s in n&&!(r=H.exec(a))||(r&&(a=a.slice(r[0].length)||a),c.push(o=[])),n=!1,(r=X.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(W," ")}),a=a.slice(n.length)),i.filter)!(r=V[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?at.error(t):D(t,c).slice(0)},a=at.compile=function(t,e){var n,r=[],o=[],a=T[t+" "];if(!a){for(e||(e=s(t)),n=e.length;n--;)(a=_t(e[n]))[x]?r.push(a):o.push(a);(a=T(t,function(t,e){var n=e.length>0,r=t.length>0,o=function(o,s,a,c,u){var h,p,m,v=0,y="0",b=o&&[],x=[],C=l,w=o||r&&i.find.TAG("*",u),_=S+=null==C?1:Math.random()||.1,D=w.length;for(u&&(l=s===d||s||u);y!==D&&null!=(h=w[y]);y++){if(r&&h){for(p=0,s||h.ownerDocument===d||(f(h),a=!g);m=t[p++];)if(m(h,s||d,a)){c.push(h);break}u&&(S=_)}n&&((h=!m&&h)&&v--,o&&b.push(h))}if(v+=y,n&&y!==v){for(p=0;m=e[p++];)m(b,x,s,a);if(o){if(v>0)for(;y--;)b[y]||x[y]||(x[y]=P.call(c));x=St(x)}F.apply(c,x),u&&!o&&x.length>0&&v+e.length>1&&at.uniqueSort(c)}return u&&(S=_,l=C),b};return n?lt(o):o}(o,r))).selector=t}return a},c=at.select=function(t,e,n,r){var o,c,l,u,h,f="function"===typeof t&&t,d=!r&&s(t=f.selector||t);if(n=n||[],1===d.length){if((c=d[0]=d[0].slice(0)).length>2&&"ID"===(l=c[0]).type&&9===e.nodeType&&g&&i.relative[c[1].type]){if(!(e=(i.find.ID(l.matches[0].replace(et,nt),e)||[])[0]))return n;f&&(e=e.parentNode),t=t.slice(c.shift().value.length)}for(o=V.needsContext.test(t)?0:c.length;o--&&(l=c[o],!i.relative[u=l.type]);)if((h=i.find[u])&&(r=h(l.matches[0].replace(et,nt),tt.test(c[0].type)&&vt(e.parentNode)||e))){if(c.splice(o,1),!(t=r.length&&bt(c)))return F.apply(n,r),n;break}}return(f||a(t,d))(r,e,!g,n,!e||tt.test(t)&&vt(e.parentNode)||e),n},n.sortStable=x.split("").sort(k).join("")===x,n.detectDuplicates=!!h,f(),n.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(d.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||ht(R,(function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),at}(n);w.find=T,w.expr=T.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=T.uniqueSort,w.text=T.getText,w.isXMLDoc=T.isXML,w.contains=T.contains,w.escapeSelector=T.escape;var E=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&w(t).is(n))break;i.push(t)}return i},k=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},O=w.expr.match.needsContext;function A(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var P=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function I(t,e,n){return y(e)?w.grep(t,(function(t,i){return!!e.call(t,i,t)!==n})):e.nodeType?w.grep(t,(function(t){return t===e!==n})):"string"!==typeof e?w.grep(t,(function(t){return h.call(e,t)>-1!==n})):w.filter(e,t,n)}w.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?w.find.matchesSelector(i,t)?[i]:[]:w.find.matches(t,w.grep(e,(function(t){return 1===t.nodeType})))},w.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!==typeof t)return this.pushStack(w(t).filter((function(){for(e=0;e<i;e++)if(w.contains(r[e],this))return!0})));for(n=this.pushStack([]),e=0;e<i;e++)w.find(t,r[e],n);return i>1?w.uniqueSort(n):n},filter:function(t){return this.pushStack(I(this,t||[],!1))},not:function(t){return this.pushStack(I(this,t||[],!0))},is:function(t){return!!I(this,"string"===typeof t&&O.test(t)?w(t):t||[],!1).length}});var F,M=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||F,"string"===typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:M.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof w?e[0]:e,w.merge(this,w.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:s,!0)),P.test(i[1])&&w.isPlainObject(e))for(i in e)y(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=s.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):y(t)?void 0!==n.ready?n.ready(t):t(w):w.makeArray(t,this)}).prototype=w.fn,F=w(s);var L=/^(?:parents|prev(?:Until|All))/,R={children:!0,contents:!0,next:!0,prev:!0};function j(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}w.fn.extend({has:function(t){var e=w(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(w.contains(this,e[t]))return!0}))},closest:function(t,e){var n,i=0,r=this.length,o=[],s="string"!==typeof t&&w(t);if(!O.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?w.uniqueSort(o):o)},index:function(t){return t?"string"===typeof t?h.call(w(t),this[0]):h.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),w.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return E(t,"parentNode")},parentsUntil:function(t,e,n){return E(t,"parentNode",n)},next:function(t){return j(t,"nextSibling")},prev:function(t){return j(t,"previousSibling")},nextAll:function(t){return E(t,"nextSibling")},prevAll:function(t){return E(t,"previousSibling")},nextUntil:function(t,e,n){return E(t,"nextSibling",n)},prevUntil:function(t,e,n){return E(t,"previousSibling",n)},siblings:function(t){return k((t.parentNode||{}).firstChild,t)},children:function(t){return k(t.firstChild)},contents:function(t){return"undefined"!==typeof t.contentDocument?t.contentDocument:(A(t,"template")&&(t=t.content||t),w.merge([],t.childNodes))}},(function(t,e){w.fn[t]=function(n,i){var r=w.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"===typeof i&&(r=w.filter(i,r)),this.length>1&&(R[t]||w.uniqueSort(r),L.test(t)&&r.reverse()),this.pushStack(r)}}));var B=/[^\x20\t\r\n\f]+/g;function U(t){return t}function z(t){throw t}function N(t,e,n,i){var r;try{t&&y(r=t.promise)?r.call(t).done(e).fail(n):t&&y(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}w.Callbacks=function(t){t="string"===typeof t?function(t){var e={};return w.each(t.match(B)||[],(function(t,n){e[n]=!0})),e}(t):w.extend({},t);var e,n,i,r,o=[],s=[],a=-1,c=function(){for(r=r||t.once,i=e=!0;s.length;a=-1)for(n=s.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&t.stopOnFalse&&(a=o.length,n=!1);t.memory||(n=!1),e=!1,r&&(o=n?[]:"")},l={add:function(){return o&&(n&&!e&&(a=o.length-1,s.push(n)),function e(n){w.each(n,(function(n,i){y(i)?t.unique&&l.has(i)||o.push(i):i&&i.length&&"string"!==S(i)&&e(i)}))}(arguments),n&&!e&&c()),this},remove:function(){return w.each(arguments,(function(t,e){for(var n;(n=w.inArray(e,o,n))>-1;)o.splice(n,1),n<=a&&a--})),this},has:function(t){return t?w.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=s=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=s=[],n||e||(o=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],s.push(n),e||c()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!i}};return l},w.extend({Deferred:function(t){var e=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return w.Deferred((function(n){w.each(e,(function(e,i){var r=y(t[i[4]])&&t[i[4]];o[i[1]]((function(){var t=r&&r.apply(this,arguments);t&&y(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[t]:arguments)}))})),t=null})).promise()},then:function(t,i,r){var o=0;function s(t,e,i,r){return function(){var a=this,c=arguments,l=function(){var n,l;if(!(t<o)){if((n=i.apply(a,c))===e.promise())throw new TypeError("Thenable self-resolution");l=n&&("object"===typeof n||"function"===typeof n)&&n.then,y(l)?r?l.call(n,s(o,e,U,r),s(o,e,z,r)):(o++,l.call(n,s(o,e,U,r),s(o,e,z,r),s(o,e,U,e.notifyWith))):(i!==U&&(a=void 0,c=[n]),(r||e.resolveWith)(a,c))}},u=r?l:function(){try{l()}catch(n){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(n,u.stackTrace),t+1>=o&&(i!==z&&(a=void 0,c=[n]),e.rejectWith(a,c))}};t?u():(w.Deferred.getStackHook&&(u.stackTrace=w.Deferred.getStackHook()),n.setTimeout(u))}}return w.Deferred((function(n){e[0][3].add(s(0,n,y(r)?r:U,n.notifyWith)),e[1][3].add(s(0,n,y(t)?t:U)),e[2][3].add(s(0,n,y(i)?i:z))})).promise()},promise:function(t){return null!=t?w.extend(t,r):r}},o={};return w.each(e,(function(t,n){var s=n[2],a=n[5];r[n[1]]=s.add,a&&s.add((function(){i=a}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=s.fireWith})),r.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,n=e,i=Array(n),r=c.call(arguments),o=w.Deferred(),s=function(t){return function(n){i[t]=this,r[t]=arguments.length>1?c.call(arguments):n,--e||o.resolveWith(i,r)}};if(e<=1&&(N(t,o.done(s(n)).resolve,o.reject,!e),"pending"===o.state()||y(r[n]&&r[n].then)))return o.then();for(;n--;)N(r[n],s(n),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,e){n.console&&n.console.warn&&t&&W.test(t.name)&&n.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},w.readyException=function(t){n.setTimeout((function(){throw t}))};var H=w.Deferred();function X(){s.removeEventListener("DOMContentLoaded",X),n.removeEventListener("load",X),w.ready()}w.fn.ready=function(t){return H.then(t).catch((function(t){w.readyException(t)})),this},w.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==t&&--w.readyWait>0||H.resolveWith(s,[w]))}}),w.ready.then=H.then,"complete"===s.readyState||"loading"!==s.readyState&&!s.documentElement.doScroll?n.setTimeout(w.ready):(s.addEventListener("DOMContentLoaded",X),n.addEventListener("load",X));var G=function(t,e,n,i,r,o,s){var a=0,c=t.length,l=null==n;if("object"===S(n))for(a in r=!0,n)G(t,e,a,n[a],!0,o,s);else if(void 0!==i&&(r=!0,y(i)||(s=!0),l&&(s?(e.call(t,i),e=null):(l=e,e=function(t,e,n){return l.call(w(t),n)})),e))for(;a<c;a++)e(t[a],n,s?i:i.call(t[a],a,e(t[a],n)));return r?t:l?e.call(t):c?e(t[0],n):o},Y=/^-ms-/,q=/-([a-z])/g;function V(t,e){return e.toUpperCase()}function Z(t){return t.replace(Y,"ms-").replace(q,V)}var Q=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function K(){this.expando=w.expando+K.uid++}K.uid=1,K.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Q(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"===typeof e)r[Z(e)]=n;else for(i in e)r[Z(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][Z(e)]},access:function(t,e,n){return void 0===e||e&&"string"===typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(Z):(e=Z(e))in i?[e]:e.match(B)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||w.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!w.isEmptyObject(e)}};var $=new K,J=new K,tt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,et=/[A-Z]/g;function nt(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(et,"-$&").toLowerCase(),"string"===typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:tt.test(t)?JSON.parse(t):t)}(n)}catch(r){}J.set(t,e,n)}else n=void 0;return n}w.extend({hasData:function(t){return J.hasData(t)||$.hasData(t)},data:function(t,e,n){return J.access(t,e,n)},removeData:function(t,e){J.remove(t,e)},_data:function(t,e,n){return $.access(t,e,n)},_removeData:function(t,e){$.remove(t,e)}}),w.fn.extend({data:function(t,e){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=J.get(o),1===o.nodeType&&!$.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=Z(i.slice(5)),nt(o,i,r[i]));$.set(o,"hasDataAttrs",!0)}return r}return"object"===typeof t?this.each((function(){J.set(this,t)})):G(this,(function(e){var n;if(o&&void 0===e)return void 0!==(n=J.get(o,t))?n:void 0!==(n=nt(o,t))?n:void 0;this.each((function(){J.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){J.remove(this,t)}))}}),w.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=$.get(t,e),n&&(!i||Array.isArray(n)?i=$.access(t,e,w.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=w.queue(t,e),i=n.length,r=n.shift(),o=w._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,(function(){w.dequeue(t,e)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return $.get(t,n)||$.access(t,n,{empty:w.Callbacks("once memory").add((function(){$.remove(t,[e+"queue",n])}))})}}),w.fn.extend({queue:function(t,e){var n=2;return"string"!==typeof t&&(e=t,t="fx",n--),arguments.length<n?w.queue(this[0],t):void 0===e?this:this.each((function(){var n=w.queue(this,t,e);w._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&w.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){w.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=w.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!==typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=$.get(o[s],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(e)}});var it=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rt=new RegExp("^(?:([+-])=|)("+it+")([a-z%]*)$","i"),ot=["Top","Right","Bottom","Left"],st=s.documentElement,at=function(t){return w.contains(t.ownerDocument,t)},ct={composed:!0};st.getRootNode&&(at=function(t){return w.contains(t.ownerDocument,t)||t.getRootNode(ct)===t.ownerDocument});var lt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&at(t)&&"none"===w.css(t,"display")},ut=function(t,e,n,i){var r,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];for(o in r=n.apply(t,i||[]),e)t.style[o]=s[o];return r};function ht(t,e,n,i){var r,o,s=20,a=i?function(){return i.cur()}:function(){return w.css(t,e,"")},c=a(),l=n&&n[3]||(w.cssNumber[e]?"":"px"),u=t.nodeType&&(w.cssNumber[e]||"px"!==l&&+c)&&rt.exec(w.css(t,e));if(u&&u[3]!==l){for(c/=2,l=l||u[3],u=+c||1;s--;)w.style(t,e,u+l),(1-o)*(1-(o=a()/c||.5))<=0&&(s=0),u/=o;u*=2,w.style(t,e,u+l),n=n||[]}return n&&(u=+u||+c||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=u,i.end=r)),r}var ft={};function dt(t){var e,n=t.ownerDocument,i=t.nodeName,r=ft[i];return r||(e=n.body.appendChild(n.createElement(i)),r=w.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ft[i]=r,r)}function pt(t,e){for(var n,i,r=[],o=0,s=t.length;o<s;o++)(i=t[o]).style&&(n=i.style.display,e?("none"===n&&(r[o]=$.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&lt(i)&&(r[o]=dt(i))):"none"!==n&&(r[o]="none",$.set(i,"display",n)));for(o=0;o<s;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}w.fn.extend({show:function(){return pt(this,!0)},hide:function(){return pt(this)},toggle:function(t){return"boolean"===typeof t?t?this.show():this.hide():this.each((function(){lt(this)?w(this).show():w(this).hide()}))}});var gt=/^(?:checkbox|radio)$/i,mt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,vt=/^$|^module$|\/(?:java|ecma)script/i,yt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function bt(t,e){var n;return n="undefined"!==typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!==typeof t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&A(t,e)?w.merge([t],n):n}function xt(t,e){for(var n=0,i=t.length;n<i;n++)$.set(t[n],"globalEval",!e||$.get(e[n],"globalEval"))}yt.optgroup=yt.option,yt.tbody=yt.tfoot=yt.colgroup=yt.caption=yt.thead,yt.th=yt.td;var Ct=/<|&#?\w+;/;function St(t,e,n,i,r){for(var o,s,a,c,l,u,h=e.createDocumentFragment(),f=[],d=0,p=t.length;d<p;d++)if((o=t[d])||0===o)if("object"===S(o))w.merge(f,o.nodeType?[o]:o);else if(Ct.test(o)){for(s=s||h.appendChild(e.createElement("div")),a=(mt.exec(o)||["",""])[1].toLowerCase(),c=yt[a]||yt._default,s.innerHTML=c[1]+w.htmlPrefilter(o)+c[2],u=c[0];u--;)s=s.lastChild;w.merge(f,s.childNodes),(s=h.firstChild).textContent=""}else f.push(e.createTextNode(o));for(h.textContent="",d=0;o=f[d++];)if(i&&w.inArray(o,i)>-1)r&&r.push(o);else if(l=at(o),s=bt(h.appendChild(o),"script"),l&&xt(s),n)for(u=0;o=s[u++];)vt.test(o.type||"")&&n.push(o);return h}!function(){var t=s.createDocumentFragment().appendChild(s.createElement("div")),e=s.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),v.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var wt=/^key/,_t=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Dt=/^([^.]*)(?:\.(.+)|)/;function Tt(){return!0}function Et(){return!1}function kt(t,e){return t===function(){try{return s.activeElement}catch(t){}}()===("focus"===e)}function Ot(t,e,n,i,r,o){var s,a;if("object"===typeof e){for(a in"string"!==typeof n&&(i=i||n,n=void 0),e)Ot(t,a,n,i,e[a],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"===typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=Et;else if(!r)return t;return 1===o&&(s=r,(r=function(t){return w().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=w.guid++)),t.each((function(){w.event.add(this,e,r,i,n)}))}function At(t,e,n){n?($.set(t,e,!1),w.event.add(t,e,{namespace:!1,handler:function(t){var i,r,o=$.get(this,e);if(1&t.isTrigger&&this[e]){if(o.length)(w.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=c.call(arguments),$.set(this,e,o),i=n(this,e),this[e](),o!==(r=$.get(this,e))||i?$.set(this,e,!1):r={},o!==r)return t.stopImmediatePropagation(),t.preventDefault(),r.value}else o.length&&($.set(this,e,{value:w.event.trigger(w.extend(o[0],w.Event.prototype),o.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===$.get(t,e)&&w.event.add(t,e,Tt)}w.event={global:{},add:function(t,e,n,i,r){var o,s,a,c,l,u,h,f,d,p,g,m=$.get(t);if(m)for(n.handler&&(n=(o=n).handler,r=o.selector),r&&w.find.matchesSelector(st,r),n.guid||(n.guid=w.guid++),(c=m.events)||(c=m.events={}),(s=m.handle)||(s=m.handle=function(e){return"undefined"!==typeof w&&w.event.triggered!==e.type?w.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(B)||[""]).length;l--;)d=g=(a=Dt.exec(e[l])||[])[1],p=(a[2]||"").split(".").sort(),d&&(h=w.event.special[d]||{},d=(r?h.delegateType:h.bindType)||d,h=w.event.special[d]||{},u=w.extend({type:d,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&w.expr.match.needsContext.test(r),namespace:p.join(".")},o),(f=c[d])||((f=c[d]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,p,s)||t.addEventListener&&t.addEventListener(d,s)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),r?f.splice(f.delegateCount++,0,u):f.push(u),w.event.global[d]=!0)},remove:function(t,e,n,i,r){var o,s,a,c,l,u,h,f,d,p,g,m=$.hasData(t)&&$.get(t);if(m&&(c=m.events)){for(l=(e=(e||"").match(B)||[""]).length;l--;)if(d=g=(a=Dt.exec(e[l])||[])[1],p=(a[2]||"").split(".").sort(),d){for(h=w.event.special[d]||{},f=c[d=(i?h.delegateType:h.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;o--;)u=f[o],!r&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(f.splice(o,1),u.selector&&f.delegateCount--,h.remove&&h.remove.call(t,u));s&&!f.length&&(h.teardown&&!1!==h.teardown.call(t,p,m.handle)||w.removeEvent(t,d,m.handle),delete c[d])}else for(d in c)w.event.remove(t,d+e[l],n,i,!0);w.isEmptyObject(c)&&$.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,o,s,a=w.event.fix(t),c=new Array(arguments.length),l=($.get(this,"events")||{})[a.type]||[],u=w.event.special[a.type]||{};for(c[0]=a,e=1;e<arguments.length;e++)c[e]=arguments[e];if(a.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,a)){for(s=w.event.handlers.call(this,a,l),e=0;(r=s[e++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!1!==o.namespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,void 0!==(i=((w.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,c))&&!1===(a.result=i)&&(a.preventDefault(),a.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,a),a.result}},handlers:function(t,e){var n,i,r,o,s,a=[],c=e.delegateCount,l=t.target;if(c&&l.nodeType&&!("click"===t.type&&t.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(o=[],s={},n=0;n<c;n++)void 0===s[r=(i=e[n]).selector+" "]&&(s[r]=i.needsContext?w(r,this).index(l)>-1:w.find(r,this,null,[l]).length),s[r]&&o.push(i);o.length&&a.push({elem:l,handlers:o})}return l=this,c<e.length&&a.push({elem:l,handlers:e.slice(c)}),a},addProp:function(t,e){Object.defineProperty(w.Event.prototype,t,{enumerable:!0,configurable:!0,get:y(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[w.expando]?t:new w.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return gt.test(e.type)&&e.click&&A(e,"input")&&At(e,"click",Tt),!1},trigger:function(t){var e=this||t;return gt.test(e.type)&&e.click&&A(e,"input")&&At(e,"click"),!0},_default:function(t){var e=t.target;return gt.test(e.type)&&e.click&&A(e,"input")&&$.get(e,"click")||A(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},w.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},w.Event=function(t,e){if(!(this instanceof w.Event))return new w.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Tt:Et,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&w.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:Et,isPropagationStopped:Et,isImmediatePropagationStopped:Et,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Tt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Tt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Tt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&wt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&_t.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},(function(t,e){w.event.special[t]={setup:function(){return At(this,t,kt),!1},trigger:function(){return At(this,t),!0},delegateType:e}})),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){w.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===i||w.contains(i,r))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}})),w.fn.extend({on:function(t,e,n,i){return Ot(this,t,e,n,i)},one:function(t,e,n,i){return Ot(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,w(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"===typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!==typeof e||(n=e,e=void 0),!1===n&&(n=Et),this.each((function(){w.event.remove(this,t,n,e)}))}});var Pt=/<script|<style|<link/i,It=/checked\s*(?:[^=]|=\s*.checked.)/i,Ft=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Mt(t,e){return A(t,"table")&&A(11!==e.nodeType?e:e.firstChild,"tr")&&w(t).children("tbody")[0]||t}function Lt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Rt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function jt(t,e){var n,i,r,o,s,a,c,l;if(1===e.nodeType){if($.hasData(t)&&(o=$.access(t),s=$.set(e,o),l=o.events))for(r in delete s.handle,s.events={},l)for(n=0,i=l[r].length;n<i;n++)w.event.add(e,r,l[r][n]);J.hasData(t)&&(a=J.access(t),c=w.extend({},a),J.set(e,c))}}function Bt(t,e){var n=e.nodeName.toLowerCase();"input"===n&&gt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function Ut(t,e,n,i){e=l.apply([],e);var r,o,s,a,c,u,h=0,f=t.length,d=f-1,p=e[0],g=y(p);if(g||f>1&&"string"===typeof p&&!v.checkClone&&It.test(p))return t.each((function(r){var o=t.eq(r);g&&(e[0]=p.call(this,r,o.html())),Ut(o,e,n,i)}));if(f&&(o=(r=St(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(a=(s=w.map(bt(r,"script"),Lt)).length;h<f;h++)c=r,h!==d&&(c=w.clone(c,!0,!0),a&&w.merge(s,bt(c,"script"))),n.call(t[h],c,h);if(a)for(u=s[s.length-1].ownerDocument,w.map(s,Rt),h=0;h<a;h++)c=s[h],vt.test(c.type||"")&&!$.access(c,"globalEval")&&w.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?w._evalUrl&&!c.noModule&&w._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")}):C(c.textContent.replace(Ft,""),c,u))}return t}function zt(t,e,n){for(var i,r=e?w.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||w.cleanData(bt(i)),i.parentNode&&(n&&at(i)&&xt(bt(i,"script")),i.parentNode.removeChild(i));return t}w.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var i,r,o,s,a=t.cloneNode(!0),c=at(t);if(!v.noCloneChecked&&(1===t.nodeType||11===t.nodeType)&&!w.isXMLDoc(t))for(s=bt(a),i=0,r=(o=bt(t)).length;i<r;i++)Bt(o[i],s[i]);if(e)if(n)for(o=o||bt(t),s=s||bt(a),i=0,r=o.length;i<r;i++)jt(o[i],s[i]);else jt(t,a);return(s=bt(a,"script")).length>0&&xt(s,!c&&bt(t,"script")),a},cleanData:function(t){for(var e,n,i,r=w.event.special,o=0;void 0!==(n=t[o]);o++)if(Q(n)){if(e=n[$.expando]){if(e.events)for(i in e.events)r[i]?w.event.remove(n,i):w.removeEvent(n,i,e.handle);n[$.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),w.fn.extend({detach:function(t){return zt(this,t,!0)},remove:function(t){return zt(this,t)},text:function(t){return G(this,(function(t){return void 0===t?w.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Ut(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Mt(this,t).appendChild(t)}))},prepend:function(){return Ut(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Mt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Ut(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Ut(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(w.cleanData(bt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return w.clone(this,t,e)}))},html:function(t){return G(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"===typeof t&&!Pt.test(t)&&!yt[(mt.exec(t)||["",""])[1].toLowerCase()]){t=w.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(w.cleanData(bt(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Ut(this,arguments,(function(e){var n=this.parentNode;w.inArray(this,t)<0&&(w.cleanData(bt(this)),n&&n.replaceChild(e,this))}),t)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){w.fn[t]=function(t){for(var n,i=[],r=w(t),o=r.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),w(r[s])[e](n),u.apply(i,n.get());return this.pushStack(i)}}));var Nt=new RegExp("^("+it+")(?!px)[a-z%]+$","i"),Wt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)},Ht=new RegExp(ot.join("|"),"i");function Xt(t,e,n){var i,r,o,s,a=t.style;return(n=n||Wt(t))&&(""!==(s=n.getPropertyValue(e)||n[e])||at(t)||(s=w.style(t,e)),!v.pixelBoxStyles()&&Nt.test(s)&&Ht.test(e)&&(i=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function Gt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",st.appendChild(l).appendChild(u);var t=n.getComputedStyle(u);i="1%"!==t.top,c=12===e(t.marginLeft),u.style.right="60%",a=36===e(t.right),r=36===e(t.width),u.style.position="absolute",o=12===e(u.offsetWidth/3),st.removeChild(l),u=null}}function e(t){return Math.round(parseFloat(t))}var i,r,o,a,c,l=s.createElement("div"),u=s.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===u.style.backgroundClip,w.extend(v,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),a},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),c},scrollboxSize:function(){return t(),o}}))}();var Yt=["Webkit","Moz","ms"],qt=s.createElement("div").style,Vt={};function Zt(t){var e=w.cssProps[t]||Vt[t];return e||(t in qt?t:Vt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Yt.length;n--;)if((t=Yt[n]+e)in qt)return t}(t)||t)}var Qt=/^(none|table(?!-c[ea]).+)/,Kt=/^--/,$t={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"};function te(t,e,n){var i=rt.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function ee(t,e,n,i,r,o){var s="width"===e?1:0,a=0,c=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(c+=w.css(t,n+ot[s],!0,r)),i?("content"===n&&(c-=w.css(t,"padding"+ot[s],!0,r)),"margin"!==n&&(c-=w.css(t,"border"+ot[s]+"Width",!0,r))):(c+=w.css(t,"padding"+ot[s],!0,r),"padding"!==n?c+=w.css(t,"border"+ot[s]+"Width",!0,r):a+=w.css(t,"border"+ot[s]+"Width",!0,r));return!i&&o>=0&&(c+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-c-a-.5))||0),c}function ne(t,e,n){var i=Wt(t),r=(!v.boxSizingReliable()||n)&&"border-box"===w.css(t,"boxSizing",!1,i),o=r,s=Xt(t,e,i),a="offset"+e[0].toUpperCase()+e.slice(1);if(Nt.test(s)){if(!n)return s;s="auto"}return(!v.boxSizingReliable()&&r||"auto"===s||!parseFloat(s)&&"inline"===w.css(t,"display",!1,i))&&t.getClientRects().length&&(r="border-box"===w.css(t,"boxSizing",!1,i),(o=a in t)&&(s=t[a])),(s=parseFloat(s)||0)+ee(t,e,n||(r?"border":"content"),o,i,s)+"px"}function ie(t,e,n,i,r){return new ie.prototype.init(t,e,n,i,r)}w.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Xt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=Z(e),c=Kt.test(e),l=t.style;if(c||(e=Zt(a)),s=w.cssHooks[e]||w.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(r=s.get(t,!1,i))?r:l[e];"string"===(o=typeof n)&&(r=rt.exec(n))&&r[1]&&(n=ht(t,e,r),o="number"),null!=n&&n===n&&("number"!==o||c||(n+=r&&r[3]||(w.cssNumber[a]?"":"px")),v.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(c?l.setProperty(e,n):l[e]=n))}},css:function(t,e,n,i){var r,o,s,a=Z(e);return Kt.test(e)||(e=Zt(a)),(s=w.cssHooks[e]||w.cssHooks[a])&&"get"in s&&(r=s.get(t,!0,n)),void 0===r&&(r=Xt(t,e,i)),"normal"===r&&e in Jt&&(r=Jt[e]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),w.each(["height","width"],(function(t,e){w.cssHooks[e]={get:function(t,n,i){if(n)return!Qt.test(w.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?ne(t,e,i):ut(t,$t,(function(){return ne(t,e,i)}))},set:function(t,n,i){var r,o=Wt(t),s=!v.scrollboxSize()&&"absolute"===o.position,a=(s||i)&&"border-box"===w.css(t,"boxSizing",!1,o),c=i?ee(t,e,i,a,o):0;return a&&s&&(c-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-ee(t,e,"border",!1,o)-.5)),c&&(r=rt.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=w.css(t,e)),te(0,n,c)}}})),w.cssHooks.marginLeft=Gt(v.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Xt(t,"marginLeft"))||t.getBoundingClientRect().left-ut(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),w.each({margin:"",padding:"",border:"Width"},(function(t,e){w.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"===typeof n?n.split(" "):[n];i<4;i++)r[t+ot[i]+e]=o[i]||o[i-2]||o[0];return r}},"margin"!==t&&(w.cssHooks[t+e].set=te)})),w.fn.extend({css:function(t,e){return G(this,(function(t,e,n){var i,r,o={},s=0;if(Array.isArray(e)){for(i=Wt(t),r=e.length;s<r;s++)o[e[s]]=w.css(t,e[s],!1,i);return o}return void 0!==n?w.style(t,e,n):w.css(t,e)}),t,e,arguments.length>1)}}),w.Tween=ie,ie.prototype={constructor:ie,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||w.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var t=ie.propHooks[this.prop];return t&&t.get?t.get(this):ie.propHooks._default.get(this)},run:function(t){var e,n=ie.propHooks[this.prop];return this.options.duration?this.pos=e=w.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ie.propHooks._default.set(this),this}},ie.prototype.init.prototype=ie.prototype,ie.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=w.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){w.fx.step[t.prop]?w.fx.step[t.prop](t):1!==t.elem.nodeType||!w.cssHooks[t.prop]&&null==t.elem.style[Zt(t.prop)]?t.elem[t.prop]=t.now:w.style(t.elem,t.prop,t.now+t.unit)}}},ie.propHooks.scrollTop=ie.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},w.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},w.fx=ie.prototype.init,w.fx.step={};var re,oe,se=/^(?:toggle|show|hide)$/,ae=/queueHooks$/;function ce(){oe&&(!1===s.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(ce):n.setTimeout(ce,w.fx.interval),w.fx.tick())}function le(){return n.setTimeout((function(){re=void 0})),re=Date.now()}function ue(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=ot[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function he(t,e,n){for(var i,r=(fe.tweeners[e]||[]).concat(fe.tweeners["*"]),o=0,s=r.length;o<s;o++)if(i=r[o].call(n,e,t))return i}function fe(t,e,n){var i,r,o=0,s=fe.prefilters.length,a=w.Deferred().always((function(){delete c.elem})),c=function(){if(r)return!1;for(var e=re||le(),n=Math.max(0,l.startTime+l.duration-e),i=1-(n/l.duration||0),o=0,s=l.tweens.length;o<s;o++)l.tweens[o].run(i);return a.notifyWith(t,[l,i,n]),i<1&&s?n:(s||a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l]),!1)},l=a.promise({elem:t,props:w.extend({},e),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:e,originalOptions:n,startTime:re||le(),duration:n.duration,tweens:[],createTween:function(e,n){var i=w.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(i),i},stop:function(e){var n=0,i=e?l.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)l.tweens[n].run(1);return e?(a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l,e])):a.rejectWith(t,[l,e]),this}}),u=l.props;for(!function(t,e){var n,i,r,o,s;for(n in t)if(r=e[i=Z(n)],o=t[n],Array.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(s=w.cssHooks[i])&&"expand"in s)for(n in o=s.expand(o),delete t[i],o)n in t||(t[n]=o[n],e[n]=r);else e[i]=r}(u,l.opts.specialEasing);o<s;o++)if(i=fe.prefilters[o].call(l,t,u,l.opts))return y(i.stop)&&(w._queueHooks(l.elem,l.opts.queue).stop=i.stop.bind(i)),i;return w.map(u,he,l),y(l.opts.start)&&l.opts.start.call(t,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),w.fx.timer(w.extend(c,{elem:t,anim:l,queue:l.opts.queue})),l}w.Animation=w.extend(fe,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return ht(n.elem,t,rt.exec(e),n),n}]},tweener:function(t,e){y(t)?(e=t,t=["*"]):t=t.match(B);for(var n,i=0,r=t.length;i<r;i++)n=t[i],fe.tweeners[n]=fe.tweeners[n]||[],fe.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,o,s,a,c,l,u,h="width"in e||"height"in e,f=this,d={},p=t.style,g=t.nodeType&&lt(t),m=$.get(t,"fxshow");for(i in n.queue||(null==(s=w._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,f.always((function(){f.always((function(){s.unqueued--,w.queue(t,"fx").length||s.empty.fire()}))}))),e)if(r=e[i],se.test(r)){if(delete e[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}d[i]=m&&m[i]||w.style(t,i)}if((c=!w.isEmptyObject(e))||!w.isEmptyObject(d))for(i in h&&1===t.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(l=m&&m.display)&&(l=$.get(t,"display")),"none"===(u=w.css(t,"display"))&&(l?u=l:(pt([t],!0),l=t.style.display||l,u=w.css(t,"display"),pt([t]))),("inline"===u||"inline-block"===u&&null!=l)&&"none"===w.css(t,"float")&&(c||(f.done((function(){p.display=l})),null==l&&(u=p.display,l="none"===u?"":u)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",f.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),c=!1,d)c||(m?"hidden"in m&&(g=m.hidden):m=$.access(t,"fxshow",{display:l}),o&&(m.hidden=!g),g&&pt([t],!0),f.done((function(){for(i in g||pt([t]),$.remove(t,"fxshow"),d)w.style(t,i,d[i])}))),c=he(g?m[i]:0,i,f),i in m||(m[i]=c.start,g&&(c.end=c.start,c.start=0))}],prefilter:function(t,e){e?fe.prefilters.unshift(t):fe.prefilters.push(t)}}),w.speed=function(t,e,n){var i=t&&"object"===typeof t?w.extend({},t):{complete:n||!n&&e||y(t)&&t,duration:t,easing:n&&e||e&&!y(e)&&e};return w.fx.off?i.duration=0:"number"!==typeof i.duration&&(i.duration in w.fx.speeds?i.duration=w.fx.speeds[i.duration]:i.duration=w.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){y(i.old)&&i.old.call(this),i.queue&&w.dequeue(this,i.queue)},i},w.fn.extend({fadeTo:function(t,e,n,i){return this.filter(lt).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=w.isEmptyObject(t),o=w.speed(e,n,i),s=function(){var e=fe(this,w.extend({},t),o);(r||$.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!==typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",o=w.timers,s=$.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&ae.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||w.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=$.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=w.timers,s=i?i.length:0;for(n.finish=!0,w.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),w.each(["toggle","show","hide"],(function(t,e){var n=w.fn[e];w.fn[e]=function(t,i,r){return null==t||"boolean"===typeof t?n.apply(this,arguments):this.animate(ue(e,!0),t,i,r)}})),w.each({slideDown:ue("show"),slideUp:ue("hide"),slideToggle:ue("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){w.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),w.timers=[],w.fx.tick=function(){var t,e=0,n=w.timers;for(re=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||w.fx.stop(),re=void 0},w.fx.timer=function(t){w.timers.push(t),w.fx.start()},w.fx.interval=13,w.fx.start=function(){oe||(oe=!0,ce())},w.fx.stop=function(){oe=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,e){return t=w.fx&&w.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,i){var r=n.setTimeout(e,t);i.stop=function(){n.clearTimeout(r)}}))},function(){var t=s.createElement("input"),e=s.createElement("select").appendChild(s.createElement("option"));t.type="checkbox",v.checkOn=""!==t.value,v.optSelected=e.selected,(t=s.createElement("input")).value="t",t.type="radio",v.radioValue="t"===t.value}();var de,pe=w.expr.attrHandle;w.fn.extend({attr:function(t,e){return G(this,w.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){w.removeAttr(this,t)}))}}),w.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"===typeof t.getAttribute?w.prop(t,e,n):(1===o&&w.isXMLDoc(t)||(r=w.attrHooks[e.toLowerCase()]||(w.expr.match.bool.test(e)?de:void 0)),void 0!==n?null===n?void w.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=w.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!v.radioValue&&"radio"===e&&A(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(B);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),de={set:function(t,e,n){return!1===e?w.removeAttr(t,n):t.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=pe[e]||w.find.attr;pe[e]=function(t,e,i){var r,o,s=e.toLowerCase();return i||(o=pe[s],pe[s]=r,r=null!=n(t,e,i)?s:null,pe[s]=o),r}}));var ge=/^(?:input|select|textarea|button)$/i,me=/^(?:a|area)$/i;function ve(t){return(t.match(B)||[]).join(" ")}function ye(t){return t.getAttribute&&t.getAttribute("class")||""}function be(t){return Array.isArray(t)?t:"string"===typeof t&&t.match(B)||[]}w.fn.extend({prop:function(t,e){return G(this,w.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[w.propFix[t]||t]}))}}),w.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&w.isXMLDoc(t)||(e=w.propFix[e]||e,r=w.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=w.find.attr(t,"tabindex");return e?parseInt(e,10):ge.test(t.nodeName)||me.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(w.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){w.propFix[this.toLowerCase()]=this})),w.fn.extend({addClass:function(t){var e,n,i,r,o,s,a,c=0;if(y(t))return this.each((function(e){w(this).addClass(t.call(this,e,ye(this)))}));if((e=be(t)).length)for(;n=this[c++];)if(r=ye(n),i=1===n.nodeType&&" "+ve(r)+" "){for(s=0;o=e[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(a=ve(i))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,i,r,o,s,a,c=0;if(y(t))return this.each((function(e){w(this).removeClass(t.call(this,e,ye(this)))}));if(!arguments.length)return this.attr("class","");if((e=be(t)).length)for(;n=this[c++];)if(r=ye(n),i=1===n.nodeType&&" "+ve(r)+" "){for(s=0;o=e[s++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");r!==(a=ve(i))&&n.setAttribute("class",a)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"===typeof e&&i?e?this.addClass(t):this.removeClass(t):y(t)?this.each((function(n){w(this).toggleClass(t.call(this,n,ye(this),e),e)})):this.each((function(){var e,r,o,s;if(i)for(r=0,o=w(this),s=be(t);e=s[r++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==n||((e=ye(this))&&$.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":$.get(this,"__className__")||""))}))},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+ve(ye(n))+" ").indexOf(e)>-1)return!0;return!1}});var xe=/\r/g;w.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=y(t),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,w(this).val()):t)?r="":"number"===typeof r?r+="":Array.isArray(r)&&(r=w.map(r,(function(t){return null==t?"":t+""}))),(e=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=w.valHooks[r.type]||w.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"===typeof(n=r.value)?n.replace(xe,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(t){var e=w.find.attr(t,"value");return null!=e?e:ve(w.text(t))}},select:{get:function(t){var e,n,i,r=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],c=s?o+1:r.length;for(i=o<0?c:s?o:0;i<c;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(e=w(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=w.makeArray(e),s=r.length;s--;)((i=r[s]).selected=w.inArray(w.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),w.each(["radio","checkbox"],(function(){w.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=w.inArray(w(t).val(),e)>-1}},v.checkOn||(w.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),v.focusin="onfocusin"in n;var Ce=/^(?:focusinfocus|focusoutblur)$/,Se=function(t){t.stopPropagation()};w.extend(w.event,{trigger:function(t,e,i,r){var o,a,c,l,u,h,f,d,g=[i||s],m=p.call(t,"type")?t.type:t,v=p.call(t,"namespace")?t.namespace.split("."):[];if(a=d=c=i=i||s,3!==i.nodeType&&8!==i.nodeType&&!Ce.test(m+w.event.triggered)&&(m.indexOf(".")>-1&&(v=m.split("."),m=v.shift(),v.sort()),u=m.indexOf(":")<0&&"on"+m,(t=t[w.expando]?t:new w.Event(m,"object"===typeof t&&t)).isTrigger=r?2:3,t.namespace=v.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:w.makeArray(e,[t]),f=w.event.special[m]||{},r||!f.trigger||!1!==f.trigger.apply(i,e))){if(!r&&!f.noBubble&&!b(i)){for(l=f.delegateType||m,Ce.test(l+m)||(a=a.parentNode);a;a=a.parentNode)g.push(a),c=a;c===(i.ownerDocument||s)&&g.push(c.defaultView||c.parentWindow||n)}for(o=0;(a=g[o++])&&!t.isPropagationStopped();)d=a,t.type=o>1?l:f.bindType||m,(h=($.get(a,"events")||{})[t.type]&&$.get(a,"handle"))&&h.apply(a,e),(h=u&&a[u])&&h.apply&&Q(a)&&(t.result=h.apply(a,e),!1===t.result&&t.preventDefault());return t.type=m,r||t.isDefaultPrevented()||f._default&&!1!==f._default.apply(g.pop(),e)||!Q(i)||u&&y(i[m])&&!b(i)&&((c=i[u])&&(i[u]=null),w.event.triggered=m,t.isPropagationStopped()&&d.addEventListener(m,Se),i[m](),t.isPropagationStopped()&&d.removeEventListener(m,Se),w.event.triggered=void 0,c&&(i[u]=c)),t.result}},simulate:function(t,e,n){var i=w.extend(new w.Event,n,{type:t,isSimulated:!0});w.event.trigger(i,null,e)}}),w.fn.extend({trigger:function(t,e){return this.each((function(){w.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return w.event.trigger(t,e,n,!0)}}),v.focusin||w.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){w.event.simulate(e,t.target,w.event.fix(t))};w.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=$.access(i,e);r||i.addEventListener(t,n,!0),$.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=$.access(i,e)-1;r?$.access(i,e,r):(i.removeEventListener(t,n,!0),$.remove(i,e))}}}));var we=n.location,_e=Date.now(),De=/\?/;w.parseXML=function(t){var e;if(!t||"string"!==typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(i){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+t),e};var Te=/\[\]$/,Ee=/\r?\n/g,ke=/^(?:submit|button|image|reset|file)$/i,Oe=/^(?:input|select|textarea|keygen)/i;function Ae(t,e,n,i){var r;if(Array.isArray(e))w.each(e,(function(e,r){n||Te.test(t)?i(t,r):Ae(t+"["+("object"===typeof r&&null!=r?e:"")+"]",r,n,i)}));else if(n||"object"!==S(e))i(t,e);else for(r in e)Ae(t+"["+r+"]",e[r],n,i)}w.param=function(t,e){var n,i=[],r=function(t,e){var n=y(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!w.isPlainObject(t))w.each(t,(function(){r(this.name,this.value)}));else for(n in t)Ae(n,t[n],e,r);return i.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=w.prop(this,"elements");return t?w.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!w(this).is(":disabled")&&Oe.test(this.nodeName)&&!ke.test(t)&&(this.checked||!gt.test(t))})).map((function(t,e){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,(function(t){return{name:e.name,value:t.replace(Ee,"\r\n")}})):{name:e.name,value:n.replace(Ee,"\r\n")}})).get()}});var Pe=/%20/g,Ie=/#.*$/,Fe=/([?&])_=[^&]*/,Me=/^(.*?):[ \t]*([^\r\n]*)$/gm,Le=/^(?:GET|HEAD)$/,Re=/^\/\//,je={},Be={},Ue="*/".concat("*"),ze=s.createElement("a");function Ne(t){return function(e,n){"string"!==typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(B)||[];if(y(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function We(t,e,n,i){var r={},o=t===Be;function s(a){var c;return r[a]=!0,w.each(t[a]||[],(function(t,a){var l=a(e,n,i);return"string"!==typeof l||o||r[l]?o?!(c=l):void 0:(e.dataTypes.unshift(l),s(l),!1)})),c}return s(e.dataTypes[0])||!r["*"]&&s("*")}function He(t,e){var n,i,r=w.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&w.extend(!0,t,i),t}ze.href=we.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:we.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(we.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ue,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?He(He(t,w.ajaxSettings),e):He(w.ajaxSettings,t)},ajaxPrefilter:Ne(je),ajaxTransport:Ne(Be),ajax:function(t,e){"object"===typeof t&&(e=t,t=void 0),e=e||{};var i,r,o,a,c,l,u,h,f,d,p=w.ajaxSetup({},e),g=p.context||p,m=p.context&&(g.nodeType||g.jquery)?w(g):w.event,v=w.Deferred(),y=w.Callbacks("once memory"),b=p.statusCode||{},x={},C={},S="canceled",_={readyState:0,getResponseHeader:function(t){var e;if(u){if(!a)for(a={};e=Me.exec(o);)a[e[1].toLowerCase()+" "]=(a[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=a[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return u?o:null},setRequestHeader:function(t,e){return null==u&&(t=C[t.toLowerCase()]=C[t.toLowerCase()]||t,x[t]=e),this},overrideMimeType:function(t){return null==u&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(u)_.always(t[_.status]);else for(e in t)b[e]=[b[e],t[e]];return this},abort:function(t){var e=t||S;return i&&i.abort(e),D(0,e),this}};if(v.promise(_),p.url=((t||p.url||we.href)+"").replace(Re,we.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(B)||[""],null==p.crossDomain){l=s.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=ze.protocol+"//"+ze.host!==l.protocol+"//"+l.host}catch(T){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!==typeof p.data&&(p.data=w.param(p.data,p.traditional)),We(je,p,e,_),u)return _;for(f in(h=w.event&&p.global)&&0===w.active++&&w.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Le.test(p.type),r=p.url.replace(Ie,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Pe,"+")):(d=p.url.slice(r.length),p.data&&(p.processData||"string"===typeof p.data)&&(r+=(De.test(r)?"&":"?")+p.data,delete p.data),!1===p.cache&&(r=r.replace(Fe,"$1"),d=(De.test(r)?"&":"?")+"_="+_e+++d),p.url=r+d),p.ifModified&&(w.lastModified[r]&&_.setRequestHeader("If-Modified-Since",w.lastModified[r]),w.etag[r]&&_.setRequestHeader("If-None-Match",w.etag[r])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&_.setRequestHeader("Content-Type",p.contentType),_.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Ue+"; q=0.01":""):p.accepts["*"]),p.headers)_.setRequestHeader(f,p.headers[f]);if(p.beforeSend&&(!1===p.beforeSend.call(g,_,p)||u))return _.abort();if(S="abort",y.add(p.complete),_.done(p.success),_.fail(p.error),i=We(Be,p,e,_)){if(_.readyState=1,h&&m.trigger("ajaxSend",[_,p]),u)return _;p.async&&p.timeout>0&&(c=n.setTimeout((function(){_.abort("timeout")}),p.timeout));try{u=!1,i.send(x,D)}catch(T){if(u)throw T;D(-1,T)}}else D(-1,"No Transport");function D(t,e,s,a){var l,f,d,x,C,S=e;u||(u=!0,c&&n.clearTimeout(c),i=void 0,o=a||"",_.readyState=t>0?4:0,l=t>=200&&t<300||304===t,s&&(x=function(t,e,n){for(var i,r,o,s,a=t.contents,c=t.dataTypes;"*"===c[0];)c.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){c.unshift(r);break}if(c[0]in n)o=c[0];else{for(r in n){if(!c[0]||t.converters[r+" "+c[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==c[0]&&c.unshift(o),n[o]}(p,_,s)),x=function(t,e,n,i){var r,o,s,a,c,l={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)l[s.toLowerCase()]=t.converters[s];for(o=u.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!c&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),c=o,o=u.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(!(s=l[c+" "+o]||l["* "+o]))for(r in l)if((a=r.split(" "))[1]===o&&(s=l[c+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[r]:!0!==l[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(T){return{state:"parsererror",error:s?T:"No conversion from "+c+" to "+o}}}return{state:"success",data:e}}(p,x,_,l),l?(p.ifModified&&((C=_.getResponseHeader("Last-Modified"))&&(w.lastModified[r]=C),(C=_.getResponseHeader("etag"))&&(w.etag[r]=C)),204===t||"HEAD"===p.type?S="nocontent":304===t?S="notmodified":(S=x.state,f=x.data,l=!(d=x.error))):(d=S,!t&&S||(S="error",t<0&&(t=0))),_.status=t,_.statusText=(e||S)+"",l?v.resolveWith(g,[f,S,_]):v.rejectWith(g,[_,S,d]),_.statusCode(b),b=void 0,h&&m.trigger(l?"ajaxSuccess":"ajaxError",[_,p,l?f:d]),y.fireWith(g,[_,S]),h&&(m.trigger("ajaxComplete",[_,p]),--w.active||w.event.trigger("ajaxStop")))}return _},getJSON:function(t,e,n){return w.get(t,e,n,"json")},getScript:function(t,e){return w.get(t,void 0,e,"script")}}),w.each(["get","post"],(function(t,e){w[e]=function(t,n,i,r){return y(n)&&(r=r||i,i=n,n=void 0),w.ajax(w.extend({url:t,type:e,dataType:r,data:n,success:i},w.isPlainObject(t)&&t))}})),w._evalUrl=function(t,e){return w.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){w.globalEval(t,e)}})},w.fn.extend({wrapAll:function(t){var e;return this[0]&&(y(t)&&(t=t.call(this[0])),e=w(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return y(t)?this.each((function(e){w(this).wrapInner(t.call(this,e))})):this.each((function(){var e=w(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=y(t);return this.each((function(n){w(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){w(this).replaceWith(this.childNodes)})),this}}),w.expr.pseudos.hidden=function(t){return!w.expr.pseudos.visible(t)},w.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(t){}};var Xe={0:200,1223:204},Ge=w.ajaxSettings.xhr();v.cors=!!Ge&&"withCredentials"in Ge,v.ajax=Ge=!!Ge,w.ajaxTransport((function(t){var e,i;if(v.cors||Ge&&!t.crossDomain)return{send:function(r,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(s,r[s]);e=function(t){return function(){e&&(e=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!==typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Xe[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!==typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),i=a.onerror=a.ontimeout=e("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&n.setTimeout((function(){e&&i()}))},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(c){if(e)throw c}},abort:function(){e&&e()}}})),w.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return w.globalEval(t),t}}}),w.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),w.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,r){e=w("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),s.head.appendChild(e[0])},abort:function(){n&&n()}}}));var Ye=[],qe=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ye.pop()||w.expando+"_"+_e++;return this[t]=!0,t}}),w.ajaxPrefilter("json jsonp",(function(t,e,i){var r,o,s,a=!1!==t.jsonp&&(qe.test(t.url)?"url":"string"===typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&qe.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=y(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(qe,"$1"+r):!1!==t.jsonp&&(t.url+=(De.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||w.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=n[r],n[r]=function(){s=arguments},i.always((function(){void 0===o?w(n).removeProp(r):n[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,Ye.push(r)),s&&y(o)&&o(s[0]),s=o=void 0})),"script"})),v.createHTMLDocument=function(){var t=s.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),w.parseHTML=function(t,e,n){return"string"!==typeof t?[]:("boolean"===typeof e&&(n=e,e=!1),e||(v.createHTMLDocument?((i=(e=s.implementation.createHTMLDocument("")).createElement("base")).href=s.location.href,e.head.appendChild(i)):e=s),o=!n&&[],(r=P.exec(t))?[e.createElement(r[1])]:(r=St([t],e,o),o&&o.length&&w(o).remove(),w.merge([],r.childNodes)));var i,r,o},w.fn.load=function(t,e,n){var i,r,o,s=this,a=t.indexOf(" ");return a>-1&&(i=ve(t.slice(a)),t=t.slice(0,a)),y(e)?(n=e,e=void 0):e&&"object"===typeof e&&(r="POST"),s.length>0&&w.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){o=arguments,s.html(i?w("<div>").append(w.parseHTML(t)).find(i):t)})).always(n&&function(t,e){s.each((function(){n.apply(this,o||[t.responseText,e,t])}))}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){w.fn[e]=function(t){return this.on(e,t)}})),w.expr.pseudos.animated=function(t){return w.grep(w.timers,(function(e){return t===e.elem})).length},w.offset={setOffset:function(t,e,n){var i,r,o,s,a,c,l=w.css(t,"position"),u=w(t),h={};"static"===l&&(t.style.position="relative"),a=u.offset(),o=w.css(t,"top"),c=w.css(t,"left"),("absolute"===l||"fixed"===l)&&(o+c).indexOf("auto")>-1?(s=(i=u.position()).top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(c)||0),y(e)&&(e=e.call(t,n,w.extend({},a))),null!=e.top&&(h.top=e.top-a.top+s),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):u.css(h)}},w.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){w.offset.setOffset(this,t,e)}));var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===w.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===w.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((r=w(t).offset()).top+=w.css(t,"borderTopWidth",!0),r.left+=w.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-w.css(i,"marginTop",!0),left:e.left-r.left-w.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===w.css(t,"position");)t=t.offsetParent;return t||st}))}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;w.fn[t]=function(i){return G(this,(function(t,i,r){var o;if(b(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r}),t,i,arguments.length)}})),w.each(["top","left"],(function(t,e){w.cssHooks[e]=Gt(v.pixelPosition,(function(t,n){if(n)return n=Xt(t,e),Nt.test(n)?w(t).position()[e]+"px":n}))})),w.each({Height:"height",Width:"width"},(function(t,e){w.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){w.fn[i]=function(r,o){var s=arguments.length&&(n||"boolean"!==typeof r),a=n||(!0===r||!0===o?"margin":"border");return G(this,(function(e,n,r){var o;return b(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?w.css(e,n,a):w.style(e,n,r,a)}),e,s?r:void 0,s)}}))})),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){w.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}})),w.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),w.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),w.proxy=function(t,e){var n,i,r;if("string"===typeof e&&(n=t[e],e=t,t=n),y(t))return i=c.call(arguments,2),(r=function(){return t.apply(e||this,i.concat(c.call(arguments)))}).guid=t.guid=t.guid||w.guid++,r},w.holdReady=function(t){t?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=A,w.isFunction=y,w.isWindow=b,w.camelCase=Z,w.type=S,w.now=Date.now,w.isNumeric=function(t){var e=w.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},void 0===(i=function(){return w}.apply(e,[]))||(t.exports=i);var Ve=n.jQuery,Ze=n.$;return w.noConflict=function(t){return n.$===w&&(n.$=Ze),t&&n.jQuery===w&&(n.jQuery=Ve),w},r||(n.jQuery=n.$=w),w}))},function(t,e,n){t.exports={baseUrl:"https://wps.grexpress.net/proxy?url=https://app.customily.com",s3BaseUrl:"https://customily.s3-us-west-1.amazonaws.com/js-lib-temp-images",cdnUrl:"https://cdn.customily.com",clientVersion:"3.7.13"}},function(t,e,n){var i;!function(r){"use strict";var o=r.URL||r.webkitURL;function s(t){return!!o&&o.createObjectURL(t)}function a(t){return!!o&&o.revokeObjectURL(t)}function c(t,e){!t||"blob:"!==t.slice(0,5)||e&&e.noRevoke||a(t)}function l(t,e,n,i){if(!r.FileReader)return!1;var o=new FileReader;o.onload=function(){e.call(o,this.result)},n&&(o.onabort=o.onerror=function(){n.call(o,this.error)});var s=o[i||"readAsDataURL"];return s?(s.call(o,t),o):void 0}function u(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"}function h(t,e,n){function i(e,i){var o,a=document.createElement("img");function f(t,n){e!==i?t instanceof Error?i(t):((n=n||{}).image=t,e(n)):e&&e(t,n)}function d(e,i){i&&r.console&&console.log(i),e&&u("Blob",e)?o=s(t=e):(o=t,n&&n.crossOrigin&&(a.crossOrigin=n.crossOrigin)),a.src=o}return a.onerror=function(t){c(o,n),i&&i.call(a,t)},a.onload=function(){c(o,n);var e={originalWidth:a.naturalWidth||a.width,originalHeight:a.naturalHeight||a.height};try{h.transform(a,n,f,t,e)}catch(r){i&&i(r)}},"string"===typeof t?(h.requiresMetaData(n)?h.fetchBlob(t,d,n):d(),a):u("Blob",t)||u("File",t)?(o=s(t))?(a.src=o,a):l(t,(function(t){a.src=t}),i):void 0}return r.Promise&&"function"!==typeof e?(n=e,new Promise(i)):i(e,e)}h.requiresMetaData=function(t){return t&&t.meta},h.fetchBlob=function(t,e){e()},h.transform=function(t,e,n,i,r){n(t,r)},h.global=r,h.readFile=l,h.isInstanceOf=u,h.createObjectURL=s,h.revokeObjectURL=a,void 0===(i=function(){return h}.call(e,n,e,t))||(t.exports=i)}("undefined"!==typeof window&&window||this)},function(t,e,n){var i=n(13),r=n(14),o=n(31);t.exports=i?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},function(t,e,n){var i=n(11);t.exports=!i((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){var i=n(13),r=n(42),o=n(6),s=n(43),a=Object.defineProperty;e.f=i?a:function(t,e,n){if(o(t),e=s(e,!0),o(n),r)try{return a(t,e,n)}catch(i){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(41),r=n(2),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(i[t])||o(r[t]):i[t]&&i[t][e]||r[t]&&r[t][e]}},function(t,e){t.exports={}},function(t,e,n){var i,r=r||{version:"3.4.0"};function o(t,e){var n=t.canvas,i=e.targetCanvas,r=i.getContext("2d");r.translate(0,i.height),r.scale(1,-1);var o=n.height-i.height;r.drawImage(n,0,o,i.width,i.height,0,0,i.width,i.height)}function s(t,e){var n=e.targetCanvas.getContext("2d"),i=e.destinationWidth,r=e.destinationHeight,o=i*r*4,s=new Uint8Array(this.imageBuffer,0,o),a=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,i,r,t.RGBA,t.UNSIGNED_BYTE,s);var c=new ImageData(a,i,r);n.putImageData(c,0,0)}e.fabric=r,"undefined"!==typeof document&&"undefined"!==typeof window&&(document instanceof("undefined"!==typeof HTMLDocument?HTMLDocument:Document)?r.document=document:r.document=document.implementation.createHTMLDocument(""),r.window=window),r.isTouchSupported="ontouchstart"in r.window||"ontouchstart"in r.document||r.window&&r.window.navigator&&r.window.navigator.maxTouchPoints>0,r.isLikelyNode="undefined"!==typeof Buffer&&"undefined"===typeof window,r.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],r.DPI=96,r.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",r.fontPaths={},r.iMatrix=[1,0,0,1,0,0],r.perfLimitSizeTotal=2097152,r.maxCacheSideLimit=4096,r.minCacheSideLimit=256,r.charWidthsCache={},r.textureSize=2048,r.disableStyleCopyPaste=!1,r.enableGLFiltering=!0,r.devicePixelRatio=r.window.devicePixelRatio||r.window.webkitDevicePixelRatio||r.window.mozDevicePixelRatio||1,r.browserShadowBlurConstant=1,r.arcToSegmentsCache={},r.boundsOfCurveCache={},r.cachesBoundsOfCurve=!0,r.forceGLPutImageData=!1,r.initFilterBackend=function(){return r.enableGLFiltering&&r.isWebglSupported&&r.isWebglSupported(r.textureSize)?(console.log("max texture size: "+r.maxTextureSize),new r.WebglFilterBackend({tileSize:r.textureSize})):r.Canvas2dFilterBackend?new r.Canvas2dFilterBackend:void 0},"undefined"!==typeof document&&"undefined"!==typeof window&&(window.fabric=r),function(){function t(t,e){if(this.__eventListeners[t]){var n=this.__eventListeners[t];e?n[n.indexOf(e)]=!1:r.util.array.fill(n,!1)}}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var n in t)this.on(n,t[n]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function n(e,n){if(!this.__eventListeners)return this;if(0===arguments.length)for(e in this.__eventListeners)t.call(this,e);else if(1===arguments.length&&"object"===typeof arguments[0])for(var i in e)t.call(this,i,e[i]);else t.call(this,e,n);return this}function i(t,e){if(!this.__eventListeners)return this;var n=this.__eventListeners[t];if(!n)return this;for(var i=0,r=n.length;i<r;i++)n[i]&&n[i].call(this,e||{});return this.__eventListeners[t]=n.filter((function(t){return!1!==t})),this}r.Observable={observe:e,stopObserving:n,fire:i,on:e,off:n,trigger:i}}(),r.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,n){var i=this._objects;return n?i[e]=t:i.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t,e=this._objects,n=!1,i=0,r=arguments.length;i<r;i++)-1!==(t=e.indexOf(arguments[i]))&&(n=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&n&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var n=this.getObjects(),i=0,r=n.length;i<r;i++)t.call(e,n[i],i,n);return this},getObjects:function(t){return"undefined"===typeof t?this._objects.concat():this._objects.filter((function(e){return e.type===t}))},item:function(t){return this._objects[t]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(t){return this._objects.indexOf(t)>-1},complexity:function(){return this._objects.reduce((function(t,e){return t+=e.complexity?e.complexity():0}),0)}},r.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){!t||!t.colorStops||t instanceof r.Gradient||this.set(e,new r.Gradient(t))},_initPattern:function(t,e,n){!t||!t.source||t instanceof r.Pattern?n&&n():this.set(e,new r.Pattern(t,n))},_initClipping:function(t){if(t.clipTo&&"string"===typeof t.clipTo){var e=r.util.getFunctionBody(t.clipTo);"undefined"!==typeof e&&(this.clipTo=new Function("ctx",e))}},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"===typeof t?this._setObject(t):"function"===typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"===typeof e&&this.set(t,!e),this},get:function(t){return this[t]}},function(t){var e=Math.sqrt,n=Math.atan2,i=Math.pow,o=Math.PI/180,s=Math.PI/2;r.util={cos:function(t){if(0===t)return 1;switch(t<0&&(t=-t),t/s){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(0===t)return 0;var e=1;switch(t<0&&(e=-1),t/s){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(t)},removeFromArray:function(t,e){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*o},radiansToDegrees:function(t){return t/o},rotatePoint:function(t,e,n){t.subtractEquals(e);var i=r.util.rotateVector(t,n);return new r.Point(i.x,i.y).addEquals(e)},rotateVector:function(t,e){var n=r.util.sin(e),i=r.util.cos(e);return{x:t.x*i-t.y*n,y:t.x*n+t.y*i}},transformPoint:function(t,e,n){return n?new r.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new r.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t,e){if(e)for(var n=0;n<t.length;n++)t[n]=r.util.transformPoint(t[n],e);var i=[t[0].x,t[1].x,t[2].x,t[3].x],o=r.util.array.min(i),s=r.util.array.max(i)-o,a=[t[0].y,t[1].y,t[2].y,t[3].y],c=r.util.array.min(a);return{left:o,top:c,width:s,height:r.util.array.max(a)-c}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),n=[e*t[3],-e*t[1],-e*t[2],e*t[0]],i=r.util.transformPoint({x:t[4],y:t[5]},n,!0);return n[4]=-i.x,n[5]=-i.y,n},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var n=/\D{0,2}$/.exec(t),i=parseFloat(t);switch(e||(e=r.Text.DEFAULT_SVG_FONT_SIZE),n[0]){case"mm":return i*r.DPI/25.4;case"cm":return i*r.DPI/2.54;case"in":return i*r.DPI;case"pt":return i*r.DPI/72;case"pc":return i*r.DPI/72*12;case"em":return i*e;default:return i}},falseFunction:function(){return!1},getKlass:function(t,e){return t=r.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),r.util.resolveNamespace(e)[t]},getSvgAttributes:function(t){var e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"])}return e},resolveNamespace:function(e){if(!e)return r;var n,i=e.split("."),o=i.length,s=t||r.window;for(n=0;n<o;++n)s=s[i[n]];return s},loadImage:function(t,e,n,i){if(t){var o=r.util.createImage(),s=function(){e&&e.call(n,o),o=o.onload=o.onerror=null};o.onload=s,o.onerror=function(){r.log("Error loading "+o.src),e&&e.call(n,null,!0),o=o.onload=o.onerror=null},0!==t.indexOf("data")&&i&&(o.crossOrigin=i),"data:image/svg"===t.substring(0,14)&&(o.onload=null,r.util.loadImageInDom(o,s)),o.src=t}else e&&e.call(n,t)},loadImageInDom:function(t,e){var n=r.document.createElement("div");n.style.width=n.style.height="1px",n.style.left=n.style.top="-100%",n.style.position="absolute",n.appendChild(t),r.document.querySelector("body").appendChild(n),t.onload=function(){e(),n.parentNode.removeChild(n),n=null}},enlivenObjects:function(t,e,n,i){var o=[],s=0,a=(t=t||[]).length;function c(){++s===a&&e&&e(o.filter((function(t){return t})))}a?t.forEach((function(t,e){t&&t.type?r.util.getKlass(t.type,n).fromObject(t,(function(n,r){r||(o[e]=n),i&&i(t,n,r),c()})):c()})):e&&e(o)},enlivenPatterns:function(t,e){function n(){++o===s&&e&&e(i)}var i=[],o=0,s=(t=t||[]).length;s?t.forEach((function(t,e){t&&t.source?new r.Pattern(t,(function(t){i[e]=t,n()})):(i[e]=t,n())})):e&&e(i)},groupSVGElements:function(t,e,n){var i;return t&&1===t.length?t[0]:(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),i=new r.Group(t,e),"undefined"!==typeof n&&(i.sourcePath=n),i)},populateWithProperties:function(t,e,n){if(n&&"[object Array]"===Object.prototype.toString.call(n))for(var i=0,r=n.length;i<r;i++)n[i]in t&&(e[n[i]]=t[n[i]])},drawDashedLine:function(t,i,r,o,s,a){var c=o-i,l=s-r,u=e(c*c+l*l),h=n(l,c),f=a.length,d=0,p=!0;for(t.save(),t.translate(i,r),t.moveTo(0,0),t.rotate(h),i=0;u>i;)(i+=a[d++%f])>u&&(i=u),t[p?"lineTo":"moveTo"](i,0),p=!p;t.restore()},createCanvasElement:function(){return r.document.createElement("canvas")},copyCanvasElement:function(t){var e=r.util.createCanvasElement();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e},toDataURL:function(t,e,n){return t.toDataURL("image/"+e,n)},createImage:function(){return r.document.createElement("img")},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},multiplyTransformMatrices:function(t,e,n){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],n?0:t[0]*e[4]+t[2]*e[5]+t[4],n?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var r=n(t[1],t[0]),s=i(t[0],2)+i(t[1],2),a=e(s),c=(t[0]*t[3]-t[2]*t[1])/a,l=n(t[0]*t[2]+t[1]*t[3],s);return{angle:r/o,scaleX:a,scaleY:c,skewX:l/o,skewY:0,translateX:t[4],translateY:t[5]}},calcRotateMatrix:function(t){if(!t.angle)return r.iMatrix.concat();var e=r.util.degreesToRadians(t.angle),n=r.util.cos(e),i=r.util.sin(e);return[n,i,-i,n,0,0]},calcDimensionsMatrix:function(t){var e="undefined"===typeof t.scaleX?1:t.scaleX,n="undefined"===typeof t.scaleY?1:t.scaleY,i=[t.flipX?-e:e,0,0,t.flipY?-n:n,0,0],o=r.util.multiplyTransformMatrices,s=r.util.degreesToRadians;return t.skewX&&(i=o(i,[1,0,Math.tan(s(t.skewX)),1],!0)),t.skewY&&(i=o(i,[1,Math.tan(s(t.skewY)),0,1],!0)),i},composeMatrix:function(t){var e=[1,0,0,1,t.translateX||0,t.translateY||0],n=r.util.multiplyTransformMatrices;return t.angle&&(e=n(e,r.util.calcRotateMatrix(t))),(t.scaleX||t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&(e=n(e,r.util.calcDimensionsMatrix(t))),e},customTransformMatrix:function(t,e,n){return r.util.composeMatrix({scaleX:t,scaleY:e,skewX:n})},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},getFunctionBody:function(t){return(String(t).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(t,e,n,i){i>0&&(e>i?e-=i:e=0,n>i?n-=i:n=0);var r,o=!0,s=t.getImageData(e,n,2*i||1,2*i||1),a=s.data.length;for(r=3;r<a&&!1!==(o=s.data[r]<=0);r+=4);return s=null,o},parsePreserveAspectRatioAttribute:function(t){var e,n="meet",i=t.split(" ");return i&&i.length&&("meet"!==(n=i.pop())&&"slice"!==n?(e=n,n="meet"):i.length&&(e=i.pop())),{meetOrSlice:n,alignX:"none"!==e?e.slice(1,4):"none",alignY:"none"!==e?e.slice(5,8):"none"}},clearFabricFontCache:function(t){(t=(t||"").toLowerCase())?r.charWidthsCache[t]&&delete r.charWidthsCache[t]:r.charWidthsCache={}},limitDimsByArea:function(t,e){var n=Math.sqrt(e*t),i=Math.floor(e/n);return{x:Math.floor(n),y:i}},capValue:function(t,e,n){return Math.max(t,Math.min(e,n))},findScaleToFit:function(t,e){return Math.min(e.width/t.width,e.height/t.height)},findScaleToCover:function(t,e){return Math.max(e.width/t.width,e.height/t.height)},matrixToSVG:function(t){return"matrix("+t.map((function(t){return r.util.toFixed(t,r.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"}}}(e),function(){var t=Array.prototype.join;function e(e,o,s,a,c,l,u){var h=t.call(arguments);if(r.arcToSegmentsCache[h])return r.arcToSegmentsCache[h];var f=Math.PI,d=u*f/180,p=r.util.sin(d),g=r.util.cos(d),m=0,v=0,y=-g*e*.5-p*o*.5,b=-g*o*.5+p*e*.5,x=(s=Math.abs(s))*s,C=(a=Math.abs(a))*a,S=b*b,w=y*y,_=x*C-x*S-C*w,D=0;if(_<0){var T=Math.sqrt(1-_/(x*C));s*=T,a*=T}else D=(c===l?-1:1)*Math.sqrt(_/(x*S+C*w));var E=D*s*b/a,k=-D*a*y/s,O=g*E-p*k+.5*e,A=p*E+g*k+.5*o,P=i(1,0,(y-E)/s,(b-k)/a),I=i((y-E)/s,(b-k)/a,(-y-E)/s,(-b-k)/a);0===l&&I>0?I-=2*f:1===l&&I<0&&(I+=2*f);for(var F=Math.ceil(Math.abs(I/f*2)),M=[],L=I/F,R=8/3*Math.sin(L/4)*Math.sin(L/4)/Math.sin(L/2),j=P+L,B=0;B<F;B++)M[B]=n(P,j,g,p,s,a,O,A,R,m,v),m=M[B][4],v=M[B][5],P=j,j+=L;return r.arcToSegmentsCache[h]=M,M}function n(t,e,n,i,o,s,a,c,l,u,h){var f=r.util.cos(t),d=r.util.sin(t),p=r.util.cos(e),g=r.util.sin(e),m=n*o*p-i*s*g+a,v=i*o*p+n*s*g+c;return[u+l*(-n*o*d-i*s*f),h+l*(-i*o*d+n*s*f),m+l*(n*o*g+i*s*p),v+l*(i*o*g-n*s*p),m,v]}function i(t,e,n,i){var r=Math.atan2(e,t),o=Math.atan2(i,n);return o>=r?o-r:2*Math.PI-(r-o)}function o(e,n,i,o,s,a,c,l){var u;if(r.cachesBoundsOfCurve&&(u=t.call(arguments),r.boundsOfCurveCache[u]))return r.boundsOfCurveCache[u];var h,f,d,p,g,m,v,y,b=Math.sqrt,x=Math.min,C=Math.max,S=Math.abs,w=[],_=[[],[]];f=6*e-12*i+6*s,h=-3*e+9*i-9*s+3*c,d=3*i-3*e;for(var D=0;D<2;++D)if(D>0&&(f=6*n-12*o+6*a,h=-3*n+9*o-9*a+3*l,d=3*o-3*n),S(h)<1e-12){if(S(f)<1e-12)continue;0<(p=-d/f)&&p<1&&w.push(p)}else(v=f*f-4*d*h)<0||(0<(g=(-f+(y=b(v)))/(2*h))&&g<1&&w.push(g),0<(m=(-f-y)/(2*h))&&m<1&&w.push(m));for(var T,E,k,O=w.length,A=O;O--;)T=(k=1-(p=w[O]))*k*k*e+3*k*k*p*i+3*k*p*p*s+p*p*p*c,_[0][O]=T,E=k*k*k*n+3*k*k*p*o+3*k*p*p*a+p*p*p*l,_[1][O]=E;_[0][A]=e,_[1][A]=n,_[0][A+1]=c,_[1][A+1]=l;var P=[{x:x.apply(null,_[0]),y:x.apply(null,_[1])},{x:C.apply(null,_[0]),y:C.apply(null,_[1])}];return r.cachesBoundsOfCurve&&(r.boundsOfCurveCache[u]=P),P}r.util.drawArc=function(t,n,i,r){for(var o=r[0],s=r[1],a=r[2],c=r[3],l=r[4],u=[[],[],[],[]],h=e(r[5]-n,r[6]-i,o,s,c,l,a),f=0,d=h.length;f<d;f++)u[f][0]=h[f][0]+n,u[f][1]=h[f][1]+i,u[f][2]=h[f][2]+n,u[f][3]=h[f][3]+i,u[f][4]=h[f][4]+n,u[f][5]=h[f][5]+i,t.bezierCurveTo.apply(t,u[f])},r.util.getBoundsOfArc=function(t,n,i,r,s,a,c,l,u){for(var h,f=0,d=0,p=[],g=e(l-t,u-n,i,r,a,c,s),m=0,v=g.length;m<v;m++)h=o(f,d,g[m][0],g[m][1],g[m][2],g[m][3],g[m][4],g[m][5]),p.push({x:h[0].x+t,y:h[0].y+n}),p.push({x:h[1].x+t,y:h[1].y+n}),f=g[m][4],d=g[m][5];return p},r.util.getBoundsOfCurve=o}(),function(){var t=Array.prototype.slice;function e(t,e,n){if(t&&0!==t.length){var i=t.length-1,r=e?t[i][e]:t[i];if(e)for(;i--;)n(t[i][e],r)&&(r=t[i][e]);else for(;i--;)n(t[i],r)&&(r=t[i]);return r}}r.util.array={fill:function(t,e){for(var n=t.length;n--;)t[n]=e;return t},invoke:function(e,n){for(var i=t.call(arguments,2),r=[],o=0,s=e.length;o<s;o++)r[o]=i.length?e[o][n].apply(e[o],i):e[o][n].call(e[o]);return r},min:function(t,n){return e(t,n,(function(t,e){return t<e}))},max:function(t,n){return e(t,n,(function(t,e){return t>=e}))}}}(),function(){function t(e,n,i){if(i)if(!r.isLikelyNode&&n instanceof Element)e=n;else if(n instanceof Array){e=[];for(var o=0,s=n.length;o<s;o++)e[o]=t({},n[o],i)}else if(n&&"object"===typeof n)for(var a in n)"canvas"===a?e[a]=t({},n[a]):n.hasOwnProperty(a)&&(e[a]=t({},n[a],i));else e=n;else for(var a in n)e[a]=n[a];return e}r.util.object={extend:t,clone:function(e,n){return t({},e,n)}},r.util.object.extend(r.util,r.Observable)}(),function(){function t(t,e){var n=t.charCodeAt(e);if(isNaN(n))return"";if(n<55296||n>57343)return t.charAt(e);if(55296<=n&&n<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";var i=t.charCodeAt(e+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";var r=t.charCodeAt(e-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1}r.util.string={camelize:function(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(e){var n,i=0,r=[];for(i=0;i<e.length;i++)!1!==(n=t(e,i))&&r.push(n);return r}}}(),function(){var t=Array.prototype.slice,e=function(){},n=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),i=function(t,e,i){for(var r in e)r in t.prototype&&"function"===typeof t.prototype[r]&&(e[r]+"").indexOf("callSuper")>-1?t.prototype[r]=function(t){return function(){var n=this.constructor.superclass;this.constructor.superclass=i;var r=e[t].apply(this,arguments);if(this.constructor.superclass=n,"initialize"!==t)return r}}(r):t.prototype[r]=e[r],n&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};function o(){}function s(e){for(var n=null,i=this;i.constructor.superclass;){var r=i.constructor.superclass.prototype[e];if(i[e]!==r){n=r;break}i=i.constructor.superclass.prototype}return n?arguments.length>1?n.apply(this,t.call(arguments,1)):n.call(this):console.log("tried to callSuper "+e+", method not found in prototype chain",this)}r.util.createClass=function(){var n=null,r=t.call(arguments,0);function a(){this.initialize.apply(this,arguments)}"function"===typeof r[0]&&(n=r.shift()),a.superclass=n,a.subclasses=[],n&&(o.prototype=n.prototype,a.prototype=new o,n.subclasses.push(a));for(var c=0,l=r.length;c<l;c++)i(a,r[c],n);return a.prototype.initialize||(a.prototype.initialize=e),a.prototype.constructor=a,a.prototype.callSuper=s,a}}(),function(){var t=!!r.document.createElement("div").attachEvent;r.util.addListener=function(e,n,i,r){e&&e.addEventListener(n,i,!t&&r)},r.util.removeListener=function(e,n,i,r){e&&e.removeEventListener(n,i,!t&&r)},r.util.getPointer=function(t){var e=t.target,n=r.util.getScrollLeftTop(e),i=function(t){var e=t.changedTouches;return e&&e[0]?e[0]:t}(t);return{x:i.clientX+n.left,y:i.clientY+n.top}}}(),function(){var t=r.document.createElement("div"),e="string"===typeof t.style.opacity,n="string"===typeof t.style.filter,i=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,o=function(t){return t};e?o=function(t,e){return t.style.opacity=e,t}:n&&(o=function(t,e){var n=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(n.zoom=1),i.test(n.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",n.filter=n.filter.replace(i,e)):n.filter+=" alpha(opacity="+100*e+")",t}),r.util.setStyle=function(t,e){var n=t.style;if(!n)return t;if("string"===typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?o(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var i in e){if("opacity"===i)o(t,e[i]);else n["float"===i||"cssFloat"===i?"undefined"===typeof n.styleFloat?"cssFloat":"styleFloat":i]=e[i]}return t}}(),function(){var t=Array.prototype.slice;var e,n,i=function(e){return t.call(e,0)};try{e=i(r.document.childNodes)instanceof Array}catch(a){}function o(t,e){var n=r.document.createElement(t);for(var i in e)"class"===i?n.className=e[i]:"for"===i?n.htmlFor=e[i]:n.setAttribute(i,e[i]);return n}function s(t){for(var e=0,n=0,i=r.document.documentElement,o=r.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&((t=t.parentNode||t.host)===r.document?(e=o.scrollLeft||i.scrollLeft||0,n=o.scrollTop||i.scrollTop||0):(e+=t.scrollLeft||0,n+=t.scrollTop||0),1!==t.nodeType||"fixed"!==t.style.position););return{left:e,top:n}}e||(i=function(t){for(var e=new Array(t.length),n=t.length;n--;)e[n]=t[n];return e}),n=r.document.defaultView&&r.document.defaultView.getComputedStyle?function(t,e){var n=r.document.defaultView.getComputedStyle(t,null);return n?n[e]:void 0}:function(t,e){var n=t.style[e];return!n&&t.currentStyle&&(n=t.currentStyle[e]),n},function(){var t=r.document.documentElement.style,e="userSelect"in t?"userSelect":"MozUserSelect"in t?"MozUserSelect":"WebkitUserSelect"in t?"WebkitUserSelect":"KhtmlUserSelect"in t?"KhtmlUserSelect":"";r.util.makeElementUnselectable=function(t){return"undefined"!==typeof t.onselectstart&&(t.onselectstart=r.util.falseFunction),e?t.style[e]="none":"string"===typeof t.unselectable&&(t.unselectable="on"),t},r.util.makeElementSelectable=function(t){return"undefined"!==typeof t.onselectstart&&(t.onselectstart=null),e?t.style[e]="":"string"===typeof t.unselectable&&(t.unselectable=""),t}}(),r.util.getScript=function(t,e){var n=r.document.getElementsByTagName("head")[0],i=r.document.createElement("script"),o=!0;i.onload=i.onreadystatechange=function(t){if(o){if("string"===typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;o=!1,e(t||r.window.event),i=i.onload=i.onreadystatechange=null}},i.src=t,n.appendChild(i)},r.util.getById=function(t){return"string"===typeof t?r.document.getElementById(t):t},r.util.toArray=i,r.util.makeElement=o,r.util.addClass=function(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)},r.util.wrapElement=function(t,e,n){return"string"===typeof e&&(e=o(e,n)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},r.util.getScrollLeftTop=s,r.util.getElementOffset=function(t){var e,i,r=t&&t.ownerDocument,o={left:0,top:0},a={left:0,top:0},c={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return a;for(var l in c)a[c[l]]+=parseInt(n(t,l),10)||0;return e=r.documentElement,"undefined"!==typeof t.getBoundingClientRect&&(o=t.getBoundingClientRect()),i=s(t),{left:o.left+i.left-(e.clientLeft||0)+a.left,top:o.top+i.top-(e.clientTop||0)+a.top}},r.util.getElementStyle=n,r.util.getNodeCanvas=function(t){var e=r.jsdomImplForWrapper(t);return e._canvas||e._image},r.util.cleanUpJsdomNode=function(t){if(r.isLikelyNode){var e=r.jsdomImplForWrapper(t);e&&(e._image=null,e._canvas=null,e._currentSrc=null,e._attributes=null,e._classList=null)}}}(),function(){function t(){}r.util.request=function(e,n){n||(n={});var i=n.method?n.method.toUpperCase():"GET",o=n.onComplete||function(){},s=new r.window.XMLHttpRequest,a=n.body||n.parameters;return s.onreadystatechange=function(){4===s.readyState&&(o(s),s.onreadystatechange=t)},"GET"===i&&(a=null,"string"===typeof n.parameters&&(e=function(t,e){return t+(/\?/.test(t)?"&":"?")+e}(e,n.parameters))),s.open(i,e,!0),"POST"!==i&&"PUT"!==i||s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(a),s}}(),r.log=function(){},r.warn=function(){},"undefined"!==typeof console&&["log","warn"].forEach((function(t){"undefined"!==typeof console[t]&&"function"===typeof console[t].apply&&(r[t]=function(){return console[t].apply(console,arguments)})})),function(){function t(){return!1}function e(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e}var n=r.window.requestAnimationFrame||r.window.webkitRequestAnimationFrame||r.window.mozRequestAnimationFrame||r.window.oRequestAnimationFrame||r.window.msRequestAnimationFrame||function(t){return r.window.setTimeout(t,1e3/60)},i=r.window.cancelAnimationFrame||r.window.clearTimeout;function o(){return n.apply(r.window,arguments)}r.util.animate=function(n){o((function(i){n||(n={});var r,s=i||+new Date,a=n.duration||500,c=s+a,l=n.onChange||t,u=n.abort||t,h=n.onComplete||t,f=n.easing||e,d="startValue"in n?n.startValue:0,p="endValue"in n?n.endValue:100,g=n.byValue||p-d;n.onStart&&n.onStart(),function t(e){var n=(r=e||+new Date)>c?a:r-s,i=n/a,m=f(n,d,g,a),v=Math.abs((m-d)/g);if(!u())return r>c?(l(p,1,1),void h(p,1,1)):(l(m,v,i),void o(t));h(p,1,1)}(s)}))},r.util.requestAnimFrame=o,r.util.cancelAnimFrame=function(){return i.apply(r.window,arguments)}}(),r.util.animateColor=function(t,e,n,i){var o=new r.Color(t).getSource(),s=new r.Color(e).getSource();i=i||{},r.util.animate(r.util.object.extend(i,{duration:n||500,startValue:o,endValue:s,byValue:s,easing:function(t,e,n,r){return function(t,e,n){var i="rgba("+parseInt(t[0]+n*(e[0]-t[0]),10)+","+parseInt(t[1]+n*(e[1]-t[1]),10)+","+parseInt(t[2]+n*(e[2]-t[2]),10);return i+=","+(t&&e?parseFloat(t[3]+n*(e[3]-t[3])):1),i+=")"}(e,n,i.colorEasing?i.colorEasing(t,r):1-Math.cos(t/r*(Math.PI/2)))}}))},function(){function t(t,e,n,i){return t<Math.abs(e)?(t=e,i=n/4):i=0===e&&0===t?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:n,s:i}}function e(t,e,n){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*n-t.s)*(2*Math.PI)/t.p)}function n(t,e,n,r){return n-i(r-t,0,n,r)+e}function i(t,e,n,i){return(t/=i)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e}r.util.ease={easeInQuad:function(t,e,n,i){return n*(t/=i)*t+e},easeOutQuad:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOutQuad:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOutCubic:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOutQuart:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOutQuint:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOutSine:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e},easeInExpo:function(t,e,n,i){return 0===t?e:n*Math.pow(2,10*(t/i-1))+e},easeOutExpo:function(t,e,n,i){return t===i?e+n:n*(1-Math.pow(2,-10*t/i))+e},easeInOutExpo:function(t,e,n,i){return 0===t?e:t===i?e+n:(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOutCirc:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOutCirc:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(n,i,r,o){var s=0;return 0===n?i:1===(n/=o)?i+r:(s||(s=.3*o),-e(t(r,r,s,1.70158),n,o)+i)},easeOutElastic:function(e,n,i,r){var o=0;if(0===e)return n;if(1===(e/=r))return n+i;o||(o=.3*r);var s=t(i,i,o,1.70158);return s.a*Math.pow(2,-10*e)*Math.sin((e*r-s.s)*(2*Math.PI)/s.p)+s.c+n},easeInOutElastic:function(n,i,r,o){var s=0;if(0===n)return i;if(2===(n/=o/2))return i+r;s||(s=o*(.3*1.5));var a=t(r,r,s,1.70158);return n<1?-.5*e(a,n,o)+i:a.a*Math.pow(2,-10*(n-=1))*Math.sin((n*o-a.s)*(2*Math.PI)/a.p)*.5+a.c+i},easeInBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),n*(t/=i)*t*((r+1)*t-r)+e},easeOutBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),n*((t=t/i-1)*t*((r+1)*t+r)+1)+e},easeInOutBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),(t/=i/2)<1?n/2*(t*t*((1+(r*=1.525))*t-r))+e:n/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},easeInBounce:n,easeOutBounce:i,easeInOutBounce:function(t,e,r,o){return t<o/2?.5*n(2*t,0,r,o)+e:.5*i(2*t-o,0,r,o)+.5*r+e}}}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,i=e.util.object.clone,r=e.util.toFixed,o=e.util.parseUnit,s=e.util.multiplyTransformMatrices,a={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform"},c={stroke:"strokeOpacity",fill:"fillOpacity"};function l(t){return t in a?a[t]:t}function u(t,n,i,r){var a,c="[object Array]"===Object.prototype.toString.call(n);if("fill"!==t&&"stroke"!==t||"none"!==n)if("vector-effect"===t)n="non-scaling-stroke"===n;else if("strokeDashArray"===t)n="none"===n?null:n.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===t)n=i&&i.transformMatrix?s(i.transformMatrix,e.parseTransformAttribute(n)):e.parseTransformAttribute(n);else if("visible"===t)n="none"!==n&&"hidden"!==n,i&&!1===i.visible&&(n=!1);else if("opacity"===t)n=parseFloat(n),i&&"undefined"!==typeof i.opacity&&(n*=i.opacity);else if("textAnchor"===t)n="start"===n?"left":"end"===n?"right":"center";else if("charSpacing"===t)a=o(n,r)/r*1e3;else if("paintFirst"===t){var l=n.indexOf("fill"),u=n.indexOf("stroke");n="fill";l>-1&&u>-1&&u<l?n="stroke":-1===l&&u>-1&&(n="stroke")}else{if("href"===t||"xlink:href"===t)return n;a=c?n.map(o):o(n,r)}else n="";return!c&&isNaN(a)?n:a}function h(t){return new RegExp("^("+t.join("|")+")\\b","i")}function f(t,e){var n,i,r,o,s=[];for(r=0,o=e.length;r<o;r++)n=e[r],i=t.getElementsByTagName(n),s=s.concat(Array.prototype.slice.call(i));return s}function d(t,e){var n,i=!0;return(n=p(t,e.pop()))&&e.length&&(i=function(t,e){var n,i=!0;for(;t.parentNode&&1===t.parentNode.nodeType&&e.length;)i&&(n=e.pop()),t=t.parentNode,i=p(t,n);return 0===e.length}(t,e)),n&&i&&0===e.length}function p(t,e){var n,i,r=t.nodeName,o=t.getAttribute("class"),s=t.getAttribute("id");if(n=new RegExp("^"+r,"i"),e=e.replace(n,""),s&&e.length&&(n=new RegExp("#"+s+"(?![a-zA-Z\\-]+)","i"),e=e.replace(n,"")),o&&e.length)for(i=(o=o.split(" ")).length;i--;)n=new RegExp("\\."+o[i]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(n,"");return 0===e.length}function g(t,e){var n;if(t.getElementById&&(n=t.getElementById(e)),n)return n;var i,r,o,s=t.getElementsByTagName("*");for(r=0,o=s.length;r<o;r++)if(e===(i=s[r]).getAttribute("id"))return i}e.svgValidTagNamesRegEx=h(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),e.svgViewBoxElementsRegEx=h(["symbol","image","marker","pattern","view","svg"]),e.svgInvalidAncestorsRegEx=h(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),e.svgValidParentsRegEx=h(["symbol","g","a","svg","clipPath","defs"]),e.cssRules={},e.gradientDefs={},e.clipPaths={},e.parseTransformAttribute=function(){function t(t,n,i){t[i]=Math.tan(e.util.degreesToRadians(n[0]))}var n=e.iMatrix,i=e.reNum,r="(?:\\s+,?\\s*|,\\s*)",o="(?:"+("(?:(matrix)\\s*\\(\\s*("+i+")"+r+"("+i+")"+r+"("+i+")"+r+"("+i+")"+r+"("+i+")"+r+"("+i+")\\s*\\))")+"|"+("(?:(translate)\\s*\\(\\s*("+i+")(?:"+r+"("+i+"))?\\s*\\))")+"|"+("(?:(scale)\\s*\\(\\s*("+i+")(?:"+r+"("+i+"))?\\s*\\))")+"|"+("(?:(rotate)\\s*\\(\\s*("+i+")(?:"+r+"("+i+")"+r+"("+i+"))?\\s*\\))")+"|"+("(?:(skewX)\\s*\\(\\s*("+i+")\\s*\\))")+"|"+("(?:(skewY)\\s*\\(\\s*("+i+")\\s*\\))")+")",s=new RegExp("^\\s*(?:"+("(?:"+o+"(?:"+r+"*"+o+")*)")+"?)\\s*$"),a=new RegExp(o,"g");return function(i){var r=n.concat(),c=[];if(!i||i&&!s.test(i))return r;i.replace(a,(function(i){var s=new RegExp(o).exec(i).filter((function(t){return!!t})),a=s[1],l=s.slice(2).map(parseFloat);switch(a){case"translate":!function(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}(r,l);break;case"rotate":l[0]=e.util.degreesToRadians(l[0]),function(t,n){var i=e.util.cos(n[0]),r=e.util.sin(n[0]),o=0,s=0;3===n.length&&(o=n[1],s=n[2]),t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t[4]=o-(i*o-r*s),t[5]=s-(r*o+i*s)}(r,l);break;case"scale":!function(t,e){var n=e[0],i=2===e.length?e[1]:e[0];t[0]=n,t[3]=i}(r,l);break;case"skewX":t(r,l,2);break;case"skewY":t(r,l,1);break;case"matrix":r=l}c.push(r.concat()),r=n.concat()}));for(var l=c[0];c.length>1;)c.shift(),l=e.util.multiplyTransformMatrices(l,c[0]);return l}}();var m=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function v(t){var n,i,r,s,a,c,l=t.getAttribute("viewBox"),u=1,h=1,f=t.getAttribute("width"),d=t.getAttribute("height"),p=t.getAttribute("x")||0,g=t.getAttribute("y")||0,v=t.getAttribute("preserveAspectRatio")||"",y=!l||!e.svgViewBoxElementsRegEx.test(t.nodeName)||!(l=l.match(m)),b=!f||!d||"100%"===f||"100%"===d,x=y&&b,C={},S="",w=0,_=0;if(C.width=0,C.height=0,C.toBeParsed=x,x)return C;if(y)return C.width=o(f),C.height=o(d),C;if(n=-parseFloat(l[1]),i=-parseFloat(l[2]),r=parseFloat(l[3]),s=parseFloat(l[4]),C.minX=n,C.minY=i,C.viewBoxWidth=r,C.viewBoxHeight=s,b?(C.width=r,C.height=s):(C.width=o(f),C.height=o(d),u=C.width/r,h=C.height/s),"none"!==(v=e.util.parsePreserveAspectRatioAttribute(v)).alignX&&("meet"===v.meetOrSlice&&(h=u=u>h?h:u),"slice"===v.meetOrSlice&&(h=u=u>h?u:h),w=C.width-r*u,_=C.height-s*u,"Mid"===v.alignX&&(w/=2),"Mid"===v.alignY&&(_/=2),"Min"===v.alignX&&(w=0),"Min"===v.alignY&&(_=0)),1===u&&1===h&&0===n&&0===i&&0===p&&0===g)return C;if((p||g)&&(S=" translate("+o(p)+" "+o(g)+") "),a=S+" matrix("+u+" 0 0 "+h+" "+(n*u+w)+" "+(i*h+_)+") ",C.viewboxTransform=e.parseTransformAttribute(a),"svg"===t.nodeName){for(c=t.ownerDocument.createElement("g");t.firstChild;)c.appendChild(t.firstChild);t.appendChild(c)}else a=(c=t).getAttribute("transform")+a;return c.setAttribute("transform",a),C}function y(t,e){var n=g(t,e.getAttribute("xlink:href").substr(1));if(n&&n.getAttribute("xlink:href")&&y(t,n),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach((function(t){n&&!e.hasAttribute(t)&&n.hasAttribute(t)&&e.setAttribute(t,n.getAttribute(t))})),!e.children.length)for(var i=n.cloneNode(!0);i.firstChild;)e.appendChild(i.firstChild);e.removeAttribute("xlink:href")}e.parseSVGDocument=function(t,n,r,o){if(t){!function(t){for(var e=f(t,["use","svg:use"]),n=0;e.length&&n<e.length;){var i,r,o,s,a=e[n],c=(a.getAttribute("xlink:href")||a.getAttribute("href")).substr(1),l=a.getAttribute("x")||0,u=a.getAttribute("y")||0,h=g(t,c).cloneNode(!0),d=(h.getAttribute("transform")||"")+" translate("+l+", "+u+")",p=e.length;if(v(h),/^svg$/i.test(h.nodeName)){var m=h.ownerDocument.createElement("g");for(r=0,s=(o=h.attributes).length;r<s;r++)i=o.item(r),m.setAttribute(i.nodeName,i.nodeValue);for(;h.firstChild;)m.appendChild(h.firstChild);h=m}for(r=0,s=(o=a.attributes).length;r<s;r++)"x"!==(i=o.item(r)).nodeName&&"y"!==i.nodeName&&"xlink:href"!==i.nodeName&&"href"!==i.nodeName&&("transform"===i.nodeName?d=i.nodeValue+" "+d:h.setAttribute(i.nodeName,i.nodeValue));h.setAttribute("transform",d),h.setAttribute("instantiated_by_use","1"),h.removeAttribute("id"),a.parentNode.replaceChild(h,a),e.length===p&&n++}}(t);var s,a,c=e.Object.__uid++,l=v(t),u=e.util.toArray(t.getElementsByTagName("*"));if(l.crossOrigin=o&&o.crossOrigin,l.svgUid=c,0===u.length&&e.isLikelyNode){var h=[];for(s=0,a=(u=t.selectNodes('//*[name(.)!="svg"]')).length;s<a;s++)h[s]=u[s];u=h}var d=u.filter((function(t){return v(t),e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))&&!function(t,e){for(;t&&(t=t.parentNode);)if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return!0;return!1}(t,e.svgInvalidAncestorsRegEx)}));if(!d||d&&!d.length)n&&n([],{});else{var p={};u.filter((function(t){return"clipPath"===t.nodeName.replace("svg:","")})).forEach((function(t){var n=t.getAttribute("id");p[n]=e.util.toArray(t.getElementsByTagName("*")).filter((function(t){return e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))}))})),e.gradientDefs[c]=e.getGradientDefs(t),e.cssRules[c]=e.getCSSRules(t),e.clipPaths[c]=p,e.parseElements(d,(function(t,i){n&&(n(t,l,i,u),delete e.gradientDefs[c],delete e.cssRules[c],delete e.clipPaths[c])}),i(l),r,o)}}};var b=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");n(e,{parseFontDeclaration:function(t,e){var n=t.match(b);if(n){var i=n[1],r=n[3],s=n[4],a=n[5],c=n[6];i&&(e.fontStyle=i),r&&(e.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),s&&(e.fontSize=o(s)),c&&(e.fontFamily=c),a&&(e.lineHeight="normal"===a?1:a)}},getGradientDefs:function(t){var e,n=f(t,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),i=0,r={};for(i=n.length;i--;)(e=n[i]).getAttribute("xlink:href")&&y(t,e),r[e.getAttribute("id")]=e;return r},parseAttributes:function(t,i,s){if(t){var a,h,f,p={};"undefined"===typeof s&&(s=t.getAttribute("svgUid")),t.parentNode&&e.svgValidParentsRegEx.test(t.parentNode.nodeName)&&(p=e.parseAttributes(t.parentNode,i,s));var g=i.reduce((function(e,n){return(a=t.getAttribute(n))&&(e[n]=a),e}),{});g=n(g,n(function(t,n){var i={};for(var r in e.cssRules[n])if(d(t,r.split(" ")))for(var o in e.cssRules[n][r])i[o]=e.cssRules[n][r][o];return i}(t,s),e.parseStyleAttribute(t))),h=f=p.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,g["font-size"]&&(g["font-size"]=h=o(g["font-size"],f));var m,v,y={};for(var b in g)v=u(m=l(b),g[b],p,h),y[m]=v;y&&y.font&&e.parseFontDeclaration(y.font,y);var x=n(p,y);return e.svgValidParentsRegEx.test(t.nodeName)?x:function(t){for(var n in c)if("undefined"!==typeof t[c[n]]&&""!==t[n]){if("undefined"===typeof t[n]){if(!e.Object.prototype[n])continue;t[n]=e.Object.prototype[n]}if(0!==t[n].indexOf("url(")){var i=new e.Color(t[n]);t[n]=i.setAlpha(r(i.getAlpha()*t[c[n]],2)).toRgba()}}return t}(x)}},parseElements:function(t,n,i,r,o){new e.ElementsParser(t,n,i,r,o).parse()},parseStyleAttribute:function(t){var e={},n=t.getAttribute("style");return n?("string"===typeof n?function(t,e){var n,i;t.replace(/;\s*$/,"").split(";").forEach((function(t){var r=t.split(":");n=r[0].trim().toLowerCase(),i=r[1].trim(),e[n]=i}))}(n,e):function(t,e){var n,i;for(var r in t)"undefined"!==typeof t[r]&&(n=r.toLowerCase(),i=t[r],e[n]=i)}(n,e),e):e},parsePointsAttribute:function(t){if(!t)return null;var e,n,i=[];for(e=0,n=(t=(t=t.replace(/,/g," ").trim()).split(/\s+/)).length;e<n;e+=2)i.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return i},getCSSRules:function(t){var n,i,r=t.getElementsByTagName("style"),o={};for(n=0,i=r.length;n<i;n++){var s=r[n].textContent||r[n].text;""!==(s=s.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&s.match(/[^{]*\{[\s\S]*?\}/g).map((function(t){return t.trim()})).forEach((function(t){var r=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),s={},a=r[2].trim().replace(/;$/,"").split(/\s*;\s*/);for(n=0,i=a.length;n<i;n++){var c=a[n].split(/\s*:\s*/),l=c[0],u=c[1];s[l]=u}(t=r[1]).split(",").forEach((function(t){""!==(t=t.replace(/^svg/i,"").trim())&&(o[t]?e.util.object.extend(o[t],s):o[t]=e.util.object.clone(s))}))}))}return o},loadSVGFromURL:function(t,n,i,r){t=t.replace(/^\n\s*/,"").trim(),new e.util.request(t,{method:"get",onComplete:function(t){var o=t.responseXML;o&&!o.documentElement&&e.window.ActiveXObject&&t.responseText&&((o=new ActiveXObject("Microsoft.XMLDOM")).async="false",o.loadXML(t.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));if(!o||!o.documentElement)return n&&n(null),!1;e.parseSVGDocument(o.documentElement,(function(t,e,i,r){n&&n(t,e,i,r)}),i,r)}})},loadSVGFromString:function(t,n,i,r){var o;if(t=t.trim(),"undefined"!==typeof e.window.DOMParser){var s=new e.window.DOMParser;s&&s.parseFromString&&(o=s.parseFromString(t,"text/xml"))}else e.window.ActiveXObject&&((o=new ActiveXObject("Microsoft.XMLDOM")).async="false",o.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));e.parseSVGDocument(o.documentElement,(function(t,e,i,r){n(t,e,i,r)}),i,r)}})}(e),r.ElementsParser=function(t,e,n,i,r){this.elements=t,this.callback=e,this.options=n,this.reviver=i,this.svgUid=n&&n.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g},(i=r.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},i.createObjects=function(){var t=this;this.elements.forEach((function(e,n){e.setAttribute("svgUid",t.svgUid),t.createObject(e,n)}))},i.findTag=function(t){return r[r.util.string.capitalize(t.tagName.replace("svg:",""))]},i.createObject=function(t,e){var n=this.findTag(t);if(n&&n.fromElement)try{n.fromElement(t,this.createCallback(e,t),this.options)}catch(i){r.log(i)}else this.checkIfDone()},i.createCallback=function(t,e){var n=this;return function(i){var o;n.resolveGradient(i,e,"fill"),n.resolveGradient(i,e,"stroke"),i instanceof r.Image&&i._originalElement&&(o=i.parsePreserveAspectRatioAttribute(e)),i._removeTransformMatrix(o),n.resolveClipPath(i),n.reviver&&n.reviver(e,i),n.instances[t]=i,n.checkIfDone()}},i.extractPropertyDefinition=function(t,e,n){var i=t[e];if(/^url\(/.test(i)){var o=this.regexUrl.exec(i)[1];return this.regexUrl.lastIndex=0,r[n][this.svgUid][o]}},i.resolveGradient=function(t,e,n){var i=this.extractPropertyDefinition(t,n,"gradientDefs");if(i){var o=e.getAttribute(n+"-opacity"),s=r.Gradient.fromElement(i,t,o,this.options);t.set(n,s)}},i.createClipPathCallback=function(t,e){return function(t){t._removeTransformMatrix(),t.fillRule=t.clipRule,e.push(t)}},i.resolveClipPath=function(t){var e,n,i,o,s=this.extractPropertyDefinition(t,"clipPath","clipPaths");if(s){i=[],n=r.util.invertTransform(t.calcTransformMatrix());for(var a=0;a<s.length;a++)e=s[a],this.findTag(e).fromElement(e,this.createClipPathCallback(t,i),this.options);s=1===i.length?i[0]:new r.Group(i),o=r.util.multiplyTransformMatrices(n,s.calcTransformMatrix());var c=r.util.qrDecompose(o);s.flipX=!1,s.flipY=!1,s.set("scaleX",c.scaleX),s.set("scaleY",c.scaleY),s.angle=c.angle,s.skewX=c.skewX,s.skewY=0,s.setPositionByOrigin({x:c.translateX,y:c.translateY},"center","center"),t.clipPath=s}},i.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter((function(t){return null!=t})),this.callback(this.instances,this.elements))},function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t,e){this.x=t,this.y=e}e.Point?e.warn("fabric.Point is already defined"):(e.Point=n,n.prototype={type:"point",constructor:n,add:function(t){return new n(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new n(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new n(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new n(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new n(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new n(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return"undefined"===typeof e&&(e=.5),e=Math.max(Math.min(1,e),0),new n(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new n(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new n(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,n=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=n},clone:function(){return new n(this.x,this.y)}})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t){this.status=t,this.points=[]}e.Intersection?e.warn("fabric.Intersection is already defined"):(e.Intersection=n,e.Intersection.prototype={constructor:n,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},e.Intersection.intersectLineLine=function(t,i,r,o){var s,a=(o.x-r.x)*(t.y-r.y)-(o.y-r.y)*(t.x-r.x),c=(i.x-t.x)*(t.y-r.y)-(i.y-t.y)*(t.x-r.x),l=(o.y-r.y)*(i.x-t.x)-(o.x-r.x)*(i.y-t.y);if(0!==l){var u=a/l,h=c/l;0<=u&&u<=1&&0<=h&&h<=1?(s=new n("Intersection")).appendPoint(new e.Point(t.x+u*(i.x-t.x),t.y+u*(i.y-t.y))):s=new n}else s=new n(0===a||0===c?"Coincident":"Parallel");return s},e.Intersection.intersectLinePolygon=function(t,e,i){var r,o,s,a,c=new n,l=i.length;for(a=0;a<l;a++)r=i[a],o=i[(a+1)%l],s=n.intersectLineLine(t,e,r,o),c.appendPoints(s.points);return c.points.length>0&&(c.status="Intersection"),c},e.Intersection.intersectPolygonPolygon=function(t,e){var i,r=new n,o=t.length;for(i=0;i<o;i++){var s=t[i],a=t[(i+1)%o],c=n.intersectLinePolygon(s,a,e);r.appendPoints(c.points)}return r.points.length>0&&(r.status="Intersection"),r},e.Intersection.intersectPolygonRectangle=function(t,i,r){var o=i.min(r),s=i.max(r),a=new e.Point(s.x,o.y),c=new e.Point(o.x,s.y),l=n.intersectLinePolygon(o,a,t),u=n.intersectLinePolygon(a,s,t),h=n.intersectLinePolygon(s,c,t),f=n.intersectLinePolygon(c,o,t),d=new n;return d.appendPoints(l.points),d.appendPoints(u.points),d.appendPoints(h.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function i(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}e.Color?e.warn("fabric.Color is already defined."):(e.Color=n,e.Color.prototype={_tryParsingColor:function(t){var e;t in n.colorNameMap&&(t=n.colorNameMap[t]),"transparent"===t&&(e=[255,255,255,0]),e||(e=n.sourceFromHex(t)),e||(e=n.sourceFromRgb(t)),e||(e=n.sourceFromHsl(t)),e||(e=[0,0,0,1]),e&&this.setSource(e)},_rgbToHsl:function(t,n,i){t/=255,n/=255,i/=255;var r,o,s,a=e.util.array.max([t,n,i]),c=e.util.array.min([t,n,i]);if(s=(a+c)/2,a===c)r=o=0;else{var l=a-c;switch(o=s>.5?l/(2-a-c):l/(a+c),a){case t:r=(n-i)/l+(n<i?6:0);break;case n:r=(i-t)/l+2;break;case i:r=(t-n)/l+4}r/=6}return[Math.round(360*r),Math.round(100*o),Math.round(100*s)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,n,i=this.getSource();return t=1===(t=i[0].toString(16)).length?"0"+t:t,e=1===(e=i[1].toString(16)).length?"0"+e:e,n=1===(n=i[2].toString(16)).length?"0"+n:n,t.toUpperCase()+e.toUpperCase()+n.toUpperCase()},toHexa:function(){var t,e=this.getSource();return t=1===(t=(t=Math.round(255*e[3])).toString(16)).length?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),n=t[3];return this.setSource([e,e,e,n]),this},toBlackWhite:function(t){var e=this.getSource(),n=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),i=e[3];return t=t||127,n=Number(n)<Number(t)?0:255,this.setSource([n,n,n,i]),this},overlayWith:function(t){t instanceof n||(t=new n(t));var e,i=[],r=this.getAlpha(),o=this.getSource(),s=t.getSource();for(e=0;e<3;e++)i.push(Math.round(.5*o[e]+.5*s[e]));return i[3]=r,this.setSource(i),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},e.Color.fromRgb=function(t){return n.fromSource(n.sourceFromRgb(t))},e.Color.sourceFromRgb=function(t){var e=t.match(n.reRGBa);if(e){var i=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),r=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),o=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(i,10),parseInt(r,10),parseInt(o,10),e[4]?parseFloat(e[4]):1]}},e.Color.fromRgba=n.fromRgb,e.Color.fromHsl=function(t){return n.fromSource(n.sourceFromHsl(t))},e.Color.sourceFromHsl=function(t){var e=t.match(n.reHSLa);if(e){var r,o,s,a=(parseFloat(e[1])%360+360)%360/360,c=parseFloat(e[2])/(/%$/.test(e[2])?100:1),l=parseFloat(e[3])/(/%$/.test(e[3])?100:1);if(0===c)r=o=s=l;else{var u=l<=.5?l*(c+1):l+c-l*c,h=2*l-u;r=i(h,u,a+1/3),o=i(h,u,a),s=i(h,u,a-1/3)}return[Math.round(255*r),Math.round(255*o),Math.round(255*s),e[4]?parseFloat(e[4]):1]}},e.Color.fromHsla=n.fromHsl,e.Color.fromHex=function(t){return n.fromSource(n.sourceFromHex(t))},e.Color.sourceFromHex=function(t){if(t.match(n.reHex)){var e=t.slice(t.indexOf("#")+1),i=3===e.length||4===e.length,r=8===e.length||4===e.length,o=i?e.charAt(0)+e.charAt(0):e.substring(0,2),s=i?e.charAt(1)+e.charAt(1):e.substring(2,4),a=i?e.charAt(2)+e.charAt(2):e.substring(4,6),c=r?i?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(o,16),parseInt(s,16),parseInt(a,16),parseFloat((parseInt(c,16)/255).toFixed(2))]}},e.Color.fromSource=function(t){var e=new n;return e.setSource(t),e})}(e),function(){function t(t,e){var n,i,o,s,a=t.getAttribute("style"),c=t.getAttribute("offset")||0;if(c=(c=parseFloat(c)/(/%$/.test(c)?100:1))<0?0:c>1?1:c,a){var l=a.split(/\s*;\s*/);for(""===l[l.length-1]&&l.pop(),s=l.length;s--;){var u=l[s].split(/\s*:\s*/),h=u[0].trim(),f=u[1].trim();"stop-color"===h?n=f:"stop-opacity"===h&&(o=f)}}return n||(n=t.getAttribute("stop-color")||"rgb(0,0,0)"),o||(o=t.getAttribute("stop-opacity")),i=(n=new r.Color(n)).getAlpha(),o=isNaN(parseFloat(o))?1:parseFloat(o),o*=i*e,{offset:c,color:n.toRgb(),opacity:o}}r.util.object.clone;function e(t,e,n,i){var r,o;Object.keys(e).forEach((function(t){"Infinity"===(r=e[t])?o=1:"-Infinity"===r?o=0:(o=parseFloat(e[t],10),"string"===typeof r&&/^(\d+\.\d+)%|(\d+)%$/.test(r)&&(o*=.01,"pixels"===i&&("x1"!==t&&"x2"!==t&&"r2"!==t||(o*=n.viewBoxWidth||n.width),"y1"!==t&&"y2"!==t||(o*=n.viewBoxHeight||n.height)))),e[t]=o}))}r.Gradient=r.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(t){t||(t={}),t.coords||(t.coords={});var e,n=this;Object.keys(t).forEach((function(e){n[e]=t[e]})),this.id?this.id+="_"+r.Object.__uid++:this.id=r.Object.__uid++,e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice()},addColorStop:function(t){for(var e in t){var n=new r.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return r.util.populateWithProperties(this,e,t),e},toLive:function(t){var e,n,i,o=r.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(o.x1,o.y1,o.x2,o.y2):"radial"===this.type&&(e=t.createRadialGradient(o.x1,o.y1,o.r1,o.x2,o.y2,o.r2)),n=0,i=this.colorStops.length;n<i;n++){var s=this.colorStops[n].color,a=this.colorStops[n].opacity,c=this.colorStops[n].offset;"undefined"!==typeof a&&(s=new r.Color(s).setAlpha(a).toRgba()),e.addColorStop(c,s)}return e}}}),r.util.object.extend(r.Gradient,{fromElement:function(n,i,o,s){var a=parseFloat(o)/(/%$/.test(o)?100:1);a=a<0?0:a>1?1:a,isNaN(a)&&(a=1);var c,l,u,h,f=n.getElementsByTagName("stop"),d="userSpaceOnUse"===n.getAttribute("gradientUnits")?"pixels":"percentage",p=n.getAttribute("gradientTransform")||"",g=[],m=0,v=0;for("linearGradient"===n.nodeName||"LINEARGRADIENT"===n.nodeName?(c="linear",l=function(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}(n)):(c="radial",l=function(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}(n)),u=f.length;u--;)g.push(t(f[u],a));return h=r.parseTransformAttribute(p),e(i,l,s,d),"pixels"===d&&(m=-i.left,v=-i.top),new r.Gradient({id:n.getAttribute("id"),type:c,coords:l,colorStops:g,gradientUnits:d,gradientTransform:h,offsetX:m,offsetY:v})},forObject:function(t,n){return n||(n={}),e(t,n.coords,n.gradientUnits,{viewBoxWidth:100,viewBoxHeight:100}),new r.Gradient(n)}})}(),function(){"use strict";var t=r.util.toFixed;r.Pattern=r.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,e){if(t||(t={}),this.id=r.Object.__uid++,this.setOptions(t),!t.source||t.source&&"string"!==typeof t.source)e&&e(this);else if("undefined"!==typeof r.util.getFunctionBody(t.source))this.source=new Function(r.util.getFunctionBody(t.source)),e&&e(this);else{var n=this;this.source=r.util.createImage(),r.util.loadImage(t.source,(function(t){n.source=t,e&&e(n)}),null,this.crossOrigin)}},toObject:function(e){var n,i,o=r.Object.NUM_FRACTION_DIGITS;return"function"===typeof this.source?n=String(this.source):"string"===typeof this.source.src?n=this.source.src:"object"===typeof this.source&&this.source.toDataURL&&(n=this.source.toDataURL()),i={type:"pattern",source:n,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,o),offsetY:t(this.offsetY,o),patternTransform:this.patternTransform?this.patternTransform.concat():null},r.util.populateWithProperties(this,i,e),i},setOptions:function(t){for(var e in t)this[e]=t[e]},toLive:function(t){var e="function"===typeof this.source?this.source():this.source;if(!e)return"";if("undefined"!==typeof e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}(),function(){"use strict";if(r.StaticCanvas)r.warn("fabric.StaticCanvas is already defined.");else{var t=r.util.object.extend,e=r.util.getElementOffset,n=r.util.removeFromArray,i=(r.util.toFixed,r.util.transformPoint),o=r.util.invertTransform,s=r.util.getNodeCanvas,a=r.util.createCanvasElement,c=new Error("Could not initialize `canvas` element");r.StaticCanvas=r.util.createClass(r.CommonMethods,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:r.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,onBeforeScaleRotate:function(){},enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(t,e){var n=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,n),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,n),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,n),e.overlayColor&&this.setOverlayColor(e.overlayColor,n),this.calcOffset()},_isRetinaScaling:function(){return 1!==r.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?r.devicePixelRatio:1},_initRetinaScaling:function(){this._isRetinaScaling()&&(this.lowerCanvasEl.setAttribute("width",this.width*r.devicePixelRatio),this.lowerCanvasEl.setAttribute("height",this.height*r.devicePixelRatio),this.contextContainer.scale(r.devicePixelRatio,r.devicePixelRatio))},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,n){return this.__setBgOverlayImage("overlayImage",t,e,n)},setBackgroundImage:function(t,e,n){return this.__setBgOverlayImage("backgroundImage",t,e,n)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,n,i){return"string"===typeof e?r.util.loadImage(e,(function(e){if(e){var o=new r.Image(e,i);this[t]=o,o.canvas=this}n&&n(e)}),this,i&&i.crossOrigin):(i&&e.setOptions(i),this[t]=e,e&&(e.canvas=this),n&&n(e)),this},__setBgOverlayColor:function(t,e,n){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,n),this},_createCanvasElement:function(){var t=a();if(!t)throw c;if(t.style||(t.style={}),"undefined"===typeof t.getContext)throw c;return t},_initOptions:function(t){var e=this.lowerCanvasEl;this._setOptions(t),this.width=this.width||parseInt(e.width,10)||0,this.height=this.height||parseInt(e.height,10)||0,this.lowerCanvasEl.style&&(e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=r.util.getById(t)||this._createCanvasElement(),r.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var n;for(var i in e=e||{},t)n=t[i],e.cssOnly||(this._setBackstoreDimension(i,t[i]),n+="px",this.hasLostContext=!0),e.backstoreOnly||this._setCssDimension(i,n);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(),this._initRetinaScaling(),this._setImageSmoothing(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,n,i,r=this._activeObject;for(this.viewportTransform=t,n=0,i=this._objects.length;n<i;n++)(e=this._objects[n]).group||e.setCoords(!1,!0);return r&&"activeSelection"===r.type&&r.setCoords(!1,!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var n=t,r=this.viewportTransform.slice(0);t=i(t,o(this.viewportTransform)),r[0]=e,r[3]=e;var s=i(t,r);return r[4]+=n.x-s.x,r[5]+=n.y-s.y,this.setViewportTransform(r)},setZoom:function(t){return this.zoomToPoint(new r.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new r.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=r.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,n=this.height,s=o(this.viewportTransform);return t.tl=i({x:0,y:0},s),t.br=i({x:e,y:n},s),t.tr=new r.Point(t.br.x,t.tl.y),t.bl=new r.Point(t.tl.x,t.br.y),this.vptCoords=t,t},cancelRequestedRender:function(){this.isRendering&&(r.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,e){var n=this.viewportTransform,i=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),this.fire("before:render",{ctx:t}),this.clipTo&&r.util.clipContext(this,t),this._renderBackground(t),t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.clipTo&&t.restore(),i&&(i.canvas=this,i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t)),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render",{ctx:t})},drawClipPathOnCanvas:function(t){var e=this.viewportTransform,n=this.clipPath;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.globalCompositeOperation="destination-in",n.transform(t),t.scale(1/n.zoomX,1/n.zoomY),t.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),t.restore()},_renderObjects:function(t,e){var n,i;for(n=0,i=e.length;n<i;++n)e[n]&&e[n].render(t)},_renderBackgroundOrOverlay:function(t,e){var n=this[e+"Color"],i=this[e+"Image"],r=this.viewportTransform,o=this[e+"Vpt"];if(n||i){if(n){t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=n.toLive?n.toLive(t,this):n,o&&t.transform(r[0],r[1],r[2],r[3],r[4]+(n.offsetX||0),r[5]+(n.offsetY||0));var s=n.gradientTransform||n.patternTransform;s&&t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),t.fill(),t.restore()}i&&(t.save(),o&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i.render(t),t.restore())}},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(t){return this._centerObject(t,new r.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new r.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new r.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new r.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new r.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=o(this.viewportTransform);return i({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,n){var i=this.clipPath,o={version:r.version,objects:this._toObjects(e,n)};return i&&(o.clipPath=this._toObject(this.clipPath,e,n)),t(o,this.__serializeBgOverlay(e,n)),r.util.populateWithProperties(this,o,n),o},_toObjects:function(t,e){return this._objects.filter((function(t){return!t.excludeFromExport})).map((function(n){return this._toObject(n,t,e)}),this)},_toObject:function(t,e,n){var i;this.includeDefaultValues||(i=t.includeDefaultValues,t.includeDefaultValues=!1);var r=t[e](n);return this.includeDefaultValues||(t.includeDefaultValues=i),r},__serializeBgOverlay:function(t,e){var n={},i=this.backgroundImage,r=this.overlayImage;return this.backgroundColor&&(n.background=this.backgroundColor.toObject?this.backgroundColor.toObject(e):this.backgroundColor),this.overlayColor&&(n.overlay=this.overlayColor.toObject?this.overlayColor.toObject(e):this.overlayColor),i&&!i.excludeFromExport&&(n.backgroundImage=this._toObject(i,t,e)),r&&!r.excludeFromExport&&(n.overlayImage=this._toObject(r,t,e)),n},sendToBack:function(t){if(!t)return this;var e,i,r,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(e=(r=o._objects).length;e--;)i=r[e],n(this._objects,i),this._objects.unshift(i);else n(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,i,r,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(r=o._objects,e=0;e<r.length;e++)i=r[e],n(this._objects,i),this._objects.push(i);else n(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var i,r,o,s,a,c=this._activeObject,l=0;if(t===c&&"activeSelection"===t.type)for(a=c._objects,i=0;i<a.length;i++)r=a[i],(o=this._objects.indexOf(r))>0+l&&(s=o-1,n(this._objects,r),this._objects.splice(s,0,r)),l++;else 0!==(o=this._objects.indexOf(t))&&(s=this._findNewLowerIndex(t,o,e),n(this._objects,t),this._objects.splice(s,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,n){var i,r;if(n)for(i=e,r=e-1;r>=0;--r){if(t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t)){i=r;break}}else i=e-1;return i},bringForward:function(t,e){if(!t)return this;var i,r,o,s,a,c=this._activeObject,l=0;if(t===c&&"activeSelection"===t.type)for(i=(a=c._objects).length;i--;)r=a[i],(o=this._objects.indexOf(r))<this._objects.length-1-l&&(s=o+1,n(this._objects,r),this._objects.splice(s,0,r)),l++;else(o=this._objects.indexOf(t))!==this._objects.length-1&&(s=this._findNewUpperIndex(t,o,e),n(this._objects,t),this._objects.splice(s,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,n){var i,r,o;if(n)for(i=e,r=e+1,o=this._objects.length;r<o;++r){if(t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t)){i=r;break}}else i=e+1;return i},moveTo:function(t,e){return n(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(r.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(t){t.dispose&&t.dispose()})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,r.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(r.StaticCanvas.prototype,r.Observable),t(r.StaticCanvas.prototype,r.Collection),t(r.StaticCanvas.prototype,r.DataURLExporter),t(r.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=a();if(!e||!e.getContext)return null;var n=e.getContext("2d");if(!n)return null;switch(t){case"setLineDash":return"undefined"!==typeof n.setLineDash;default:return null}}}),r.StaticCanvas.prototype.toJSON=r.StaticCanvas.prototype.toObject,r.isLikelyNode&&(r.StaticCanvas.prototype.createPNGStream=function(){var t=s(this.lowerCanvasEl);return t&&t.createPNGStream()},r.StaticCanvas.prototype.createJPEGStream=function(t){var e=s(this.lowerCanvasEl);return e&&e.createJPEGStream(t)})}}(),function(){var t=r.util.getPointer,e=r.util.degreesToRadians,n=r.util.radiansToDegrees,i=Math.atan2,o=Math.abs,s=r.StaticCanvas.supports("setLineDash");for(var a in r.Canvas=r.util.createClass(r.StaticCanvas,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniScaleTransform:!1,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=r.PencilBrush&&new r.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e,n,i=this.getActiveObjects();if(i.length>0&&!this.preserveObjectStacking){e=[],n=[];for(var r=0,o=this._objects.length;r<o;r++)t=this._objects[r],-1===i.indexOf(t)?e.push(t):n.push(t);i.length>1&&(this._activeObject._objects=n),e.push.apply(e,n)}else e=this._objects;return e},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&this.renderTopLayer(this.contextTop);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_resetCurrentTransform:function(){var t=this._currentTransform;t.target.set({scaleX:t.original.scaleX,scaleY:t.original.scaleY,skewX:t.original.skewX,skewY:t.original.skewY,left:t.original.left,top:t.original.top}),this._shouldCenterTransform(t.target)?("center"!==t.originX&&("right"===t.originX?t.mouseXSign=-1:t.mouseXSign=1),"center"!==t.originY&&("bottom"===t.originY?t.mouseYSign=-1:t.mouseYSign=1),t.originX="center",t.originY="center"):(t.originX=t.original.originX,t.originY=t.original.originY)},containsPoint:function(t,e,n){var i,r=n||this.getPointer(t,!0);return i=e.group&&e.group===this._activeObject&&"activeSelection"===e.group.type?this._normalizePointer(e.group,r):{x:r.x,y:r.y},e.containsPoint(i)||e._findTargetCorner(r)},_normalizePointer:function(t,e){var n=t.calcTransformMatrix(),i=r.util.invertTransform(n),o=this.restorePointerVpt(e);return r.util.transformPoint(o,i)},isTargetTransparent:function(t,e,n){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var i=this._normalizePointer(t,{x:e,y:n}),o=Math.max(t.cacheTranslationX+i.x*t.zoomX,0),s=Math.max(t.cacheTranslationY+i.y*t.zoomY,0);return r.util.isTransparent(t._cacheContext,Math.round(o),Math.round(s),this.targetFindTolerance)}var a=this.contextCache,c=t.selectionBackgroundColor,l=this.viewportTransform;return t.selectionBackgroundColor="",this.clearContext(a),a.save(),a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),t.render(a),a.restore(),t===this._activeObject&&t._renderControls(a,{hasBorders:!1,transparentCorners:!1},{hasBorders:!1}),t.selectionBackgroundColor=c,r.util.isTransparent(a,e,n,this.targetFindTolerance)},_isSelectionKeyPressed:function(t){return"[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find((function(e){return!0===t[e]})):t[this.selectionKey]},_shouldClearSelection:function(t,e){var n=this.getActiveObjects(),i=this._activeObject;return!e||e&&i&&n.length>1&&-1===n.indexOf(e)&&i!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&i&&i!==e},_shouldCenterTransform:function(t){if(t){var e,n=this._currentTransform;return"scale"===n.action||"scaleX"===n.action||"scaleY"===n.action?e=this.centeredScaling||t.centeredScaling:"rotate"===n.action&&(e=this.centeredRotation||t.centeredRotation),e?!n.altKey:n.altKey}},_getOriginFromCorner:function(t,e){var n={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?n.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(n.x="left"),"tl"===e||"mt"===e||"tr"===e?n.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(n.y="top"),n},_getActionFromCorner:function(t,e,n){if(!e||!t)return"drag";switch(e){case"mtr":return"rotate";case"ml":case"mr":return n[this.altActionKey]?"skewY":"scaleX";case"mt":case"mb":return n[this.altActionKey]?"skewX":"scaleY";default:return"scale"}},_setupCurrentTransform:function(t,n,i){if(n){var o=this.getPointer(t),s=n._findTargetCorner(this.getPointer(t,!0)),a=this._getActionFromCorner(i,s,t,n),c=this._getOriginFromCorner(n,s);this._currentTransform={target:n,action:a,corner:s,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:o.x-n.left,offsetY:o.y-n.top,originX:c.x,originY:c.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:e(n.angle),width:n.width*n.scaleX,mouseXSign:1,mouseYSign:1,shiftKey:t.shiftKey,altKey:t[this.centeredKey],original:r.util.saveObjectTransform(n)},this._currentTransform.original.originX=c.x,this._currentTransform.original.originY=c.y,this._resetCurrentTransform(),this._beforeTransform(t)}},_translateObject:function(t,e){var n=this._currentTransform,i=n.target,r=t-n.offsetX,o=e-n.offsetY,s=!i.get("lockMovementX")&&i.left!==r,a=!i.get("lockMovementY")&&i.top!==o;return s&&i.set("left",r),a&&i.set("top",o),s||a},_changeSkewTransformOrigin:function(t,e,n){var i="originX",r={0:"center"},o=e.target.skewX,s="left",a="right",c="mt"===e.corner||"ml"===e.corner?1:-1,l=1;t=t>0?1:-1,"y"===n&&(o=e.target.skewY,s="top",a="bottom",i="originY"),r[-1]=s,r[1]=a,e.target.flipX&&(l*=-1),e.target.flipY&&(l*=-1),0===o?(e.skewSign=-c*t*l,e[i]=r[-t]):(o=o>0?1:-1,e.skewSign=o,e[i]=r[o*c*l])},_skewObject:function(t,e,n){var i,o=this._currentTransform,s=o.target,a=s.get("lockSkewingX"),c=s.get("lockSkewingY");if(a&&"x"===n||c&&"y"===n)return!1;var l,u,h=s.getCenterPoint(),f=s.toLocalPoint(new r.Point(t,e),"center","center")[n],d=s.toLocalPoint(new r.Point(o.lastX,o.lastY),"center","center")[n],p=s._getTransformedDimensions();return this._changeSkewTransformOrigin(f-d,o,n),l=s.toLocalPoint(new r.Point(t,e),o.originX,o.originY)[n],u=s.translateToOriginPoint(h,o.originX,o.originY),i=this._setObjectSkew(l,o,n,p),o.lastX=t,o.lastY=e,s.setPositionByOrigin(u,o.originX,o.originY),i},_setObjectSkew:function(t,e,n,i){var o,s,a,c,l,u,h,f,d,p,g=e.target,m=e.skewSign;return"x"===n?(l="y",u="Y",h="X",d=0,p=g.skewY):(l="x",u="X",h="Y",d=g.skewX,p=0),c=g._getTransformedDimensions(d,p),(f=2*Math.abs(t)-c[n])<=2?o=0:(o=m*Math.atan(f/g["scale"+h]/(c[l]/g["scale"+u])),o=r.util.radiansToDegrees(o)),s=g["skew"+h]!==o,g.set("skew"+h,o),0!==g["skew"+u]&&(a=g._getTransformedDimensions(),o=i[l]/a[l]*g["scale"+u],g.set("scale"+u,o)),s},_scaleObject:function(t,e,n){var i=this._currentTransform,o=i.target,s=o.lockScalingX,a=o.lockScalingY,c=o.lockScalingFlip;if(s&&a)return!1;var l,u=o.translateToOriginPoint(o.getCenterPoint(),i.originX,i.originY),h=o.toLocalPoint(new r.Point(t,e),i.originX,i.originY),f=o._getTransformedDimensions();return this._setLocalMouse(h,i),l=this._setObjectScale(h,i,s,a,n,c,f),o.setPositionByOrigin(u,i.originX,i.originY),l},_setObjectScale:function(t,e,n,i,o,s,a){var c=e.target,l=!1,u=!1,h=!1,f=t.x*c.scaleX/a.x,d=t.y*c.scaleY/a.y,p=c.scaleX!==f,g=c.scaleY!==d;if(e.newScaleX=f,e.newScaleY=d,"x"===o&&c instanceof r.Textbox){var m=c.width*(t.x/a.x);return m>=c.getMinWidth()&&(h=m!==c.width,c.set("width",m),h)}return s&&f<=0&&f<c.scaleX&&(l=!0,t.x=0),s&&d<=0&&d<c.scaleY&&(u=!0,t.y=0),"equally"!==o||n||i?o?"x"!==o||c.get("lockUniScaling")?"y"!==o||c.get("lockUniScaling")||u||i||c.set("scaleY",d)&&(h=g):l||n||c.set("scaleX",f)&&(h=p):(l||n||c.set("scaleX",f)&&(h=h||p),u||i||c.set("scaleY",d)&&(h=h||g)):h=this._scaleObjectEqually(t,c,e,a),l||u||this._flipObject(e,o),h},_scaleObjectEqually:function(t,e,n,i){var r,o,s,a=t.y+t.x,c=i.y*n.original.scaleY/e.scaleY+i.x*n.original.scaleX/e.scaleX,l=t.x<0?-1:1,u=t.y<0?-1:1;return o=l*Math.abs(n.original.scaleX*a/c),s=u*Math.abs(n.original.scaleY*a/c),r=o!==e.scaleX||s!==e.scaleY,e.set("scaleX",o),e.set("scaleY",s),r},_flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var n=e.target,i=this.getZoom(),r=n.padding/i;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),o(t.x)>r?t.x<0?t.x+=r:t.x-=r:t.x=0,o(t.y)>r?t.y<0?t.y+=r:t.y-=r:t.y=0},_rotateObject:function(t,e){var r=this._currentTransform,o=r.target,s=o.translateToOriginPoint(o.getCenterPoint(),r.originX,r.originY);if(o.lockRotation)return!1;var a=i(r.ey-s.y,r.ex-s.x),c=i(e-s.y,t-s.x),l=n(c-a+r.theta),u=!0;if(o.snapAngle>0){var h=o.snapAngle,f=o.snapThreshold||h,d=Math.ceil(l/h)*h,p=Math.floor(l/h)*h;Math.abs(l-p)<f?l=p:Math.abs(l-d)<f&&(l=d)}return l<0&&(l=360+l),l%=360,o.angle===l?u=!1:(o.angle=l,o.setPositionByOrigin(s,r.originX,r.originY)),u},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var e=this._groupSelector,n=e.left,i=e.top,a=o(n),c=o(i);if(this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(n>0?0:-n),e.ey-(i>0?0:-i),a,c)),this.selectionLineWidth&&this.selectionBorderColor)if(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1&&!s){var l=e.ex+.5-(n>0?0:a),u=e.ey+.5-(i>0?0:c);t.beginPath(),r.util.drawDashedLine(t,l,u,l+a,u,this.selectionDashArray),r.util.drawDashedLine(t,l,u+c-1,l+a,u+c-1,this.selectionDashArray),r.util.drawDashedLine(t,l,u,l,u+c,this.selectionDashArray),r.util.drawDashedLine(t,l+a-1,u,l+a-1,u+c,this.selectionDashArray),t.closePath(),t.stroke()}else r.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(e.ex+.5-(n>0?0:a),e.ey+.5-(i>0?0:c),a,c)},findTarget:function(t,e){if(!this.skipTargetFind){var n,i,r=this.getPointer(t,!0),o=this._activeObject,s=this.getActiveObjects();if(this.targets=[],s.length>1&&!e&&o===this._searchPossibleTargets([o],r))return o;if(1===s.length&&o._findTargetCorner(r))return o;if(1===s.length&&o===this._searchPossibleTargets([o],r)){if(!this.preserveObjectStacking)return o;n=o,i=this.targets,this.targets=[]}var a=this._searchPossibleTargets(this._objects,r);return t[this.altSelectionKey]&&a&&n&&a!==n&&(a=n,this.targets=i),a}},_checkTarget:function(t,e,n){if(e&&e.visible&&e.evented&&this.containsPoint(null,e,t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;if(!this.isTargetTransparent(e,n.x,n.y))return!0}},_searchPossibleTargets:function(t,e){for(var n,i,o=t.length;o--;){var s=t[o],a=s.group&&"activeSelection"!==s.group.type?this._normalizePointer(s.group,e):e;if(this._checkTarget(a,s,e)){(n=t[o]).subTargetCheck&&n instanceof r.Group&&(i=this._searchPossibleTargets(n._objects,e))&&this.targets.push(i);break}}return n},restorePointerVpt:function(t){return r.util.transformPoint(t,r.util.invertTransform(this.viewportTransform))},getPointer:function(e,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var i,r=t(e),o=this.upperCanvasEl,s=o.getBoundingClientRect(),a=s.width||0,c=s.height||0;return a&&c||("top"in s&&"bottom"in s&&(c=Math.abs(s.top-s.bottom)),"right"in s&&"left"in s&&(a=Math.abs(s.right-s.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,n||(r=this.restorePointerVpt(r)),i=0===a||0===c?{width:1,height:1}:{width:o.width/a,height:o.height/c},{x:r.x*i.width,y:r.y*i.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl?this.upperCanvasEl.className="":this.upperCanvasEl=this._createCanvasElement(),r.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=r.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),r.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),r.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,n=this.height||t.height;r.util.setStyle(t,{position:"absolute",width:e+"px",height:n+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=e,t.height=n,r.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),this._hoveredTarget===t&&(this._hoveredTarget=null),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,e){var n=!1,i=this.getActiveObjects(),r=[],o=[],s={e:e};t.forEach((function(t){-1===i.indexOf(t)&&(n=!0,t.fire("deselected",s),o.push(t))})),i.forEach((function(e){-1===t.indexOf(e)&&(n=!0,e.fire("selected",s),r.push(e))})),t.length>0&&i.length>0?(s.selected=r,s.deselected=o,s.updated=r[0]||o[0],s.target=this._activeObject,n&&this.fire("selection:updated",s)):i.length>0?(1===i.length&&(s.target=r[0],this.fire("object:selected",s)),s.selected=r,s.target=this._activeObject,this.fire("selection:created",s)):t.length>0&&(s.deselected=o,this.fire("selection:cleared",s))},setActiveObject:function(t,e){var n=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(n,e),this},_setActiveObject:function(t,e){return this._activeObject!==t&&(!!this._discardActiveObject(e,t)&&(!t.onSelect({e:e})&&(this._activeObject=t,!0)))},_discardActiveObject:function(t,e){var n=this._activeObject;if(n){if(n.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects(),n=this.getActiveObject();return e.length&&this.fire("before:selection:cleared",{target:n,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(t){r.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,r.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,n){var i=this._realizeGroupTransformOnObject(t),r=this.callSuper("_toObject",t,e,n);return this._unwindGroupTransformOnObject(t,i),r},_realizeGroupTransformOnObject:function(t){if(t.group&&"activeSelection"===t.group.type&&this._activeObject===t.group){var e={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach((function(n){e[n]=t[n]})),this._activeObject.realizeTransform(t),e}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,n){var i=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,n),this._unwindGroupTransformOnObject(e,i)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),r.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),r.StaticCanvas)"prototype"!==a&&(r.Canvas[a]=r.StaticCanvas[a])}(),function(){var t={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},e=r.util.addListener,n=r.util.removeListener,i={passive:!1};function o(t,e){return t.button&&t.button===e-1}r.util.object.extend(r.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(e,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(t,e){var n=this.upperCanvasEl,o=this._getEventPrefix();t(r.window,"resize",this._onResize),t(n,o+"down",this._onMouseDown),t(n,o+"move",this._onMouseMove,i),t(n,o+"out",this._onMouseOut),t(n,o+"enter",this._onMouseEnter),t(n,"wheel",this._onMouseWheel),t(n,"contextmenu",this._onContextMenu),t(n,"dblclick",this._onDoubleClick),t(n,"dragover",this._onDragOver),t(n,"dragenter",this._onDragEnter),t(n,"dragleave",this._onDragLeave),t(n,"drop",this._onDrop),this.enablePointerEvents||t(n,"touchstart",this._onTouchStart,i),"undefined"!==typeof eventjs&&e in eventjs&&(eventjs[e](n,"gesture",this._onGesture),eventjs[e](n,"drag",this._onDrag),eventjs[e](n,"orientation",this._onOrientationChange),eventjs[e](n,"shake",this._onShake),eventjs[e](n,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(n,"remove");var t=this._getEventPrefix();n(r.document,t+"up",this._onMouseUp),n(r.document,"touchend",this._onTouchEnd,i),n(r.document,t+"move",this._onMouseMove,i),n(r.document,"touchmove",this._onMouseMove,i)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._simpleEventHandler.bind(this,"drop"),this.eventsBound=!0)},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t}),this._iTextInstances&&this._iTextInstances.forEach((function(t){t.isEditing&&t.hiddenTextarea.focus()}))},_onMouseEnter:function(t){this.currentTransform||this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onDragOver:function(t){t.preventDefault();var e=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(e,t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},getPointerId:function(t){var e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1},_isMainEvent:function(t){return!0===t.isPrimary||!1!==t.isPrimary&&("touchend"===t.type&&0===t.touches.length||(!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId))},_onTouchStart:function(t){t.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t),this._resetTransformEventData();var o=this.upperCanvasEl,s=this._getEventPrefix();e(r.document,"touchend",this._onTouchEnd,i),e(r.document,"touchmove",this._onMouseMove,i),n(o,s+"down",this._onMouseDown)},_onMouseDown:function(t){this.__onMouseDown(t),this._resetTransformEventData();var o=this.upperCanvasEl,s=this._getEventPrefix();n(o,s+"move",this._onMouseMove,i),e(r.document,s+"up",this._onMouseUp),e(r.document,s+"move",this._onMouseMove,i)},_onTouchEnd:function(t){if(!(t.touches.length>0)){this.__onMouseUp(t),this._resetTransformEventData(),this.mainTouchId=null;var o=this._getEventPrefix();n(r.document,"touchend",this._onTouchEnd,i),n(r.document,"touchmove",this._onMouseMove,i);var s=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){e(s.upperCanvasEl,o+"down",s._onMouseDown),s._willAddMouseDown=0}),400)}},_onMouseUp:function(t){this.__onMouseUp(t),this._resetTransformEventData();var o=this.upperCanvasEl,s=this._getEventPrefix();this._isMainEvent(t)&&(n(r.document,s+"up",this._onMouseUp),n(r.document,s+"move",this._onMouseMove,i),e(o,s+"move",this._onMouseMove,i))},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t){var e=this._activeObject;return!!(!!e!==!!t||e&&t&&e!==t)||(e&&e.isEditing,!1)},__onMouseUp:function(t){var e,n=this._currentTransform,i=this._groupSelector,r=!1,s=!i||0===i.left&&0===i.top;if(this._cacheTransformEventData(t),e=this._target,this._handleEvent(t,"up:before"),!o(t,3))return o(t,2)?(this.fireMiddleClick&&this._handleEvent(t,"up",2,s),void this._resetTransformEventData()):void(this.isDrawingMode&&this._isCurrentlyDrawing?this._onMouseUpInDrawingMode(t):this._isMainEvent(t)&&(n&&(this._finalizeCurrentTransform(t),r=n.actionPerformed),s||(this._maybeGroupObjects(t),r||(r=this._shouldRender(e))),e&&(e.isMoving=!1),this._setCursorFromEvent(t,e),this._handleEvent(t,"up",1,s),this._groupSelector=null,this._currentTransform=null,e&&(e.__corner=0),r?this.requestRenderAll():s||this.renderTop()));this.fireRightClick&&this._handleEvent(t,"up",3,s)},_simpleEventHandler:function(t,e){var n=this.findTarget(e),i=this.targets,r={e:e,target:n,subTargets:i};if(this.fire(t,r),n&&n.fire(t,r),!i)return n;for(var o=0;o<i.length;o++)i[o].fire(t,r);return n},_handleEvent:function(t,e,n,i){var r=this._target,o=this.targets||[],s={e:t,target:r,subTargets:o,button:n||1,isClick:i||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};this.fire("mouse:"+e,s),r&&r.fire("mouse"+e,s);for(var a=0;a<o.length;a++)o[a].fire("mouse"+e,s)},_finalizeCurrentTransform:function(t){var e,n=this._currentTransform,i=n.target,r={e:t,target:i,transform:n};i._scaling&&(i._scaling=!1),i.setCoords(),(n.actionPerformed||this.stateful&&i.hasStateChanged())&&(n.actionPerformed&&(e=this._addEventOptions(r,n),this._fire(e,r)),this._fire("modified",r))},_addEventOptions:function(t,e){var n,i;switch(e.action){case"scaleX":n="scaled",i="x";break;case"scaleY":n="scaled",i="y";break;case"skewX":n="skewed",i="x";break;case"skewY":n="skewed",i="y";break;case"scale":n="scaled",i="equally";break;case"rotate":n="rotated";break;case"drag":n="moved"}return t.by=i,n},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll(),this.clipTo&&r.util.clipContext(this,this.contextTop);var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){this.clipTo&&this.contextTop.restore();var e=this.getPointer(t);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:t,pointer:e}),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var e=this._target;if(o(t,3))this.fireRightClick&&this._handleEvent(t,"down",3);else if(o(t,2))this.fireMiddleClick&&this._handleEvent(t,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(t);else if(this._isMainEvent(t)&&!this._currentTransform){var n=this._pointer;this._previousPointer=n;var i=this._shouldRender(e),r=this._shouldGroup(t,e);if(this._shouldClearSelection(t,e)?this.discardActiveObject(t):r&&(this._handleGrouping(t,e),e=this._activeObject),!this.selection||e&&(e.selectable||e.isEditing||e===this._activeObject)||(this._groupSelector={ex:n.x,ey:n.y,top:0,left:0}),e){var s=e===this._activeObject;e.selectable&&this.setActiveObject(e,t),e!==this._activeObject||!e.__corner&&r||this._setupCurrentTransform(t,e,s)}this._handleEvent(t,"down"),(i||r)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var e=this._currentTransform;this.stateful&&e.target.saveState(),this.fire("before:transform",{e:t,transform:e}),e.corner&&this.onBeforeScaleRotate(e.target)},__onMouseMove:function(t){var e,n;if(this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode)this._onMouseMoveInDrawingMode(t);else if(this._isMainEvent(t)){var i=this._groupSelector;i?(n=this._pointer,i.left=n.x-i.ex,i.top=n.y-i.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t)||null,this._setCursorFromEvent(t,e),this._fireOverOutEvents(e,t)),this._handleEvent(t,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(t,e){this.fireSyntheticInOutEvents(t,e,{targetName:"_hoveredTarget",canvasEvtOut:"mouse:out",evtOut:"mouseout",canvasEvtIn:"mouse:over",evtIn:"mouseover"})},_fireEnterLeaveEvents:function(t,e){this.fireSyntheticInOutEvents(t,e,{targetName:"_draggedoverTarget",evtOut:"dragleave",evtIn:"dragenter"})},fireSyntheticInOutEvents:function(t,e,n){var i,r,o,s=this[n.targetName],a=s!==t,c=n.canvasEvtIn,l=n.canvasEvtOut;a&&(i={e:e,target:t,previousTarget:s},r={e:e,target:s,nextTarget:t},this[n.targetName]=t),o=t&&a,s&&a&&(l&&this.fire(l,r),s.fire(n.evtOut,r)),o&&(c&&this.fire(c,i),t.fire(n.evtIn,i))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var e=this.getPointer(t),n=this._currentTransform;n.reset=!1,n.target.isMoving=!0,n.shiftKey=t.shiftKey,n.altKey=t[this.centeredKey],this._beforeScaleTransform(t,n),this._performTransformAction(t,n,e),n.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,n){var i=n.x,r=n.y,o=e.action,s=!1,a={target:e.target,e:t,transform:e,pointer:n};"rotate"===o?(s=this._rotateObject(i,r))&&this._fire("rotating",a):"scale"===o?(s=this._onScale(t,e,i,r))&&this._fire("scaling",a):"scaleX"===o?(s=this._scaleObject(i,r,"x"))&&this._fire("scaling",a):"scaleY"===o?(s=this._scaleObject(i,r,"y"))&&this._fire("scaling",a):"skewX"===o?(s=this._skewObject(i,r,"x"))&&this._fire("skewing",a):"skewY"===o?(s=this._skewObject(i,r,"y"))&&this._fire("skewing",a):(s=this._translateObject(i,r))&&(this._fire("moving",a),this.setCursor(a.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||s},_fire:function(t,e){this.fire("object:"+t,e),e.target.fire(t,e)},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var n=this._shouldCenterTransform(e.target);(n&&("center"!==e.originX||"center"!==e.originY)||!n&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(),e.reset=!0)}},_onScale:function(t,e,n,i){return this._isUniscalePossible(t,e.target)?(e.currentAction="scale",this._scaleObject(n,i)):(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(),e.currentAction="scaleEqually",this._scaleObject(n,i,"equally"))},_isUniscalePossible:function(t,e){return(t[this.uniScaleKey]||this.uniScaleTransform)&&!e.get("lockUniScaling")},_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var n=e.hoverCursor||this.hoverCursor,i=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,r=(!i||!i.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));r?this.setCursor(this.getCornerCursor(r,e,t)):this.setCursor(n)},getCornerCursor:function(e,n,i){return this.actionIsDisabled(e,n,i)?this.notAllowedCursor:e in t?this._getRotatedCornerCursor(e,n,i):"mtr"===e&&n.hasRotatingPoint?this.rotationCursor:this.defaultCursor},actionIsDisabled:function(t,e,n){return"mt"===t||"mb"===t?n[this.altActionKey]?e.lockSkewingX:e.lockScalingY:"ml"===t||"mr"===t?n[this.altActionKey]?e.lockSkewingY:e.lockScalingX:"mtr"===t?e.lockRotation:this._isUniscalePossible(n,e)?e.lockScalingX&&e.lockScalingY:e.lockScalingX||e.lockScalingY},_getRotatedCornerCursor:function(e,n,i){var r=Math.round(n.angle%360/45);return r<0&&(r+=8),r+=t[e],i[this.altActionKey]&&t[e]%2===0&&(r+=2),r%=8,this.cursorMap[r]}})}(),function(){var t=Math.min,e=Math.max;r.util.object.extend(r.Canvas.prototype,{_shouldGroup:function(t,e){var n=this._activeObject;return n&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(n!==e||"activeSelection"===n.type)&&!e.onSelect({e:t})},_handleGrouping:function(t,e){var n=this._activeObject;n.__corner||(e!==n||(e=this.findTarget(t,!0))&&e.selectable)&&(n&&"activeSelection"===n.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var n=this._activeObject,i=n._objects.slice(0);n.contains(t)?(n.removeWithUpdate(t),this._hoveredTarget=t,1===n.size()&&this._setActiveObject(n.item(0),e)):(n.addWithUpdate(t),this._hoveredTarget=n),this._fireSelectionEvents(i,e)},_createActiveSelection:function(t,e){var n=this.getActiveObjects(),i=this._createGroup(t);this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents(n,e)},_createGroup:function(t){var e=this._objects,n=e.indexOf(this._activeObject)<e.indexOf(t)?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new r.ActiveSelection(n,{canvas:this})},_groupSelectedObjects:function(t){var e,n=this._collectObjects(t);1===n.length?this.setActiveObject(n[0],t):n.length>1&&(e=new r.ActiveSelection(n.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(n){for(var i,o=[],s=this._groupSelector.ex,a=this._groupSelector.ey,c=s+this._groupSelector.left,l=a+this._groupSelector.top,u=new r.Point(t(s,c),t(a,l)),h=new r.Point(e(s,c),e(a,l)),f=!this.selectionFullyContained,d=s===c&&a===l,p=this._objects.length;p--&&!((i=this._objects[p])&&i.selectable&&i.visible&&(f&&i.intersectsWithRect(u,h)||i.isContainedWithinRect(u,h)||f&&i.containsPoint(u)||f&&i.containsPoint(h))&&(o.push(i),d)););return o.length>1&&(o=o.filter((function(t){return!t.onSelect({e:n})}))),o},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),r.util.object.extend(r.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",n=t.quality||1,i=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),o=this.toCanvasElement(i,t);return r.util.toDataURL(o,e,n)},toCanvasElement:function(t,e){t=t||1;var n=((e=e||{}).width||this.width)*t,i=(e.height||this.height)*t,o=this.getZoom(),s=this.width,a=this.height,c=o*t,l=this.viewportTransform,u=(l[4]-(e.left||0))*t,h=(l[5]-(e.top||0))*t,f=this.interactive,d=[c,0,0,c,u,h],p=this.enableRetinaScaling,g=r.util.createCanvasElement(),m=this.contextTop;return g.width=n,g.height=i,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=d,this.width=n,this.height=i,this.calcViewportBoundaries(),this.renderCanvas(g.getContext("2d"),this._objects),this.viewportTransform=l,this.width=s,this.height=a,this.calcViewportBoundaries(),this.interactive=f,this.enableRetinaScaling=p,this.contextTop=m,g}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,i=e.util.object.clone,r=e.util.toFixed,o=e.util.string.capitalize,s=e.util.degreesToRadians,a=e.StaticCanvas.supports("setLineDash"),c=!e.isLikelyNode;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",borderDashArray:null,cornerColor:"rgba(102,153,255,0.5)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:c,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow clipTo visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var n=e.perfLimitSizeTotal,i=t.width,r=t.height,o=e.maxCacheSideLimit,s=e.minCacheSideLimit;if(i<=o&&r<=o&&i*r<=n)return i<s&&(t.width=s),r<s&&(t.height=s),t;var a=i/r,c=e.util.limitDimsByArea(a,n),l=e.util.capValue,u=l(s,c.x,o),h=l(s,c.y,o);return i>u&&(t.zoomX/=i/u,t.width=u,t.capped=!0),r>h&&(t.zoomY/=r/h,t.height=h,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),e=this._getTransformedDimensions(0,0),n=e.x*t.scaleX/this.scaleX,i=e.y*t.scaleY/this.scaleY;return{width:n+2,height:i+2,zoomX:t.scaleX,zoomY:t.scaleY,x:n,y:i}},_updateCacheCanvas:function(){var t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){var n=t._currentTransform.target,i=t._currentTransform.action;if(this===n&&i.slice&&"scale"===i.slice(0,5))return!1}var r,o,s=this._cacheCanvas,a=this._limitCacheSize(this._getCacheCanvasDimensions()),c=e.minCacheSideLimit,l=a.width,u=a.height,h=a.zoomX,f=a.zoomY,d=l!==this.cacheWidth||u!==this.cacheHeight,p=this.zoomX!==h||this.zoomY!==f,g=d||p,m=0,v=0,y=!1;if(d){var b=this._cacheCanvas.width,x=this._cacheCanvas.height,C=l>b||u>x;y=C||(l<.9*b||u<.9*x)&&b>c&&x>c,C&&!a.capped&&(l>c||u>c)&&(m=.1*l,v=.1*u)}return!!g&&(y?(s.width=Math.ceil(l+m),s.height=Math.ceil(u+v)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,s.width,s.height)),r=a.x/2,o=a.y/2,this.cacheTranslationX=Math.round(s.width/2-r)+r,this.cacheTranslationY=Math.round(s.height/2-o)+o,this.cacheWidth=l,this.cacheHeight=u,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(h,f),this.zoomX=h,this.zoomY=f,!0)},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initClipping(t),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e;e=this.group&&!this.group._transformDone?this.calcTransformMatrix():this.calcOwnMatrix(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},toObject:function(t){var n=e.Object.NUM_FRACTION_DIGITS,i={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:r(this.left,n),top:r(this.top,n),width:r(this.width,n),height:r(this.height,n),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,n),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:r(this.strokeMiterLimit,n),scaleX:r(this.scaleX,n),scaleY:r(this.scaleY,n),angle:r(this.angle,n),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,n),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,transformMatrix:this.transformMatrix?this.transformMatrix.concat():null,skewX:r(this.skewX,n),skewY:r(this.skewY,n)};return this.clipPath&&(i.clipPath=this.clipPath.toObject(t),i.clipPath.inverted=this.clipPath.inverted,i.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,i,t),this.includeDefaultValues||(i=this._removeDefaultValues(i)),i},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var n=e.util.getKlass(t.type).prototype;return n.stateProperties.forEach((function(e){"left"!==e&&"top"!==e&&(t[e]===n[e]&&delete t[e],"[object Array]"===Object.prototype.toString.call(t[e])&&"[object Array]"===Object.prototype.toString.call(n[e])&&0===t[e].length&&0===n[e].length&&delete t[e])})),t},toString:function(){return"#<fabric."+o(this.type)+">"},getObjectScaling:function(){var t=this.scaleX,e=this.scaleY;if(this.group){var n=this.group.getObjectScaling();t*=n.scaleX,e*=n.scaleY}return{scaleX:t,scaleY:e}},getTotalObjectScaling:function(){var t=this.getObjectScaling(),e=t.scaleX,n=t.scaleY;if(this.canvas){var i=this.canvas.getZoom(),r=this.canvas.getRetinaScaling();e*=i*r,n*=i*r}return{scaleX:e,scaleY:n}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,n){var i="scaleX"===t||"scaleY"===t,r=this[t]!==n,o=!1;return i&&(n=this._constrainScale(n)),"scaleX"===t&&n<0?(this.flipX=!this.flipX,n*=-1):"scaleY"===t&&n<0?(this.flipY=!this.flipY,n*=-1):"shadow"!==t||!n||n instanceof e.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",n):n=new e.Shadow(n),this[t]=n,r&&(o=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(t)>-1?(this.dirty=!0,o&&this.group.set("dirty",!0)):o&&this.stateProperties.indexOf(t)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||0===this.width&&0===this.height&&0===this.strokeWidth||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.clipTo&&e.util.clipContext(this,t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),this.clipTo&&t.restore(),t.restore())},renderCache:function(t){t=t||{},this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,t.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!==typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(t){var n=this.clipPath;if(t.save(),n.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",n.absolutePositioned){var i=e.util.invertTransform(this.calcTransformMatrix());t.transform(i[0],i[1],i[2],i[3],i[4],i[5])}n.transform(t),t.scale(1/n.zoomX,1/n.zoomY),t.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),t.restore()},drawObject:function(t,e){var n=this.fill,i=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):(this._renderBackground(t),this._setStrokeStyles(t,this),this._setFillStyles(t,this)),this._render(t),this._drawClipPath(t),this.fill=n,this.stroke=i},_drawClipPath:function(t){var e=this.clipPath;e&&(e.canvas=this.canvas,e.shouldCache(),e._transformDone=!0,e.renderCache({forClipping:!0}),this.drawClipPathOnCache(t))},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!t){var e=this.cacheWidth/this.zoomX,n=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-n/2,e,n)}return!0}return!1},_renderBackground:function(t){if(this.backgroundColor){var e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){e.stroke&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,t.strokeStyle=e.stroke.toLive?e.stroke.toLive(t,this):e.stroke)},_setFillStyles:function(t,e){e.fill&&(t.fillStyle=e.fill.toLive?e.fill.toLive(t,this):e.fill)},_setClippingProperties:function(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"},_setLineDash:function(t,e,n){e&&(1&e.length&&e.push.apply(e,e),a?t.setLineDash(e):n&&n(t),this.strokeUniform&&t.setLineDash(t.getLineDash().map((function(e){return e*t.lineWidth}))))},_renderControls:function(t,n){var i,r,o,a=this.getViewportTransform(),c=this.calcTransformMatrix();r="undefined"!==typeof(n=n||{}).hasBorders?n.hasBorders:this.hasBorders,o="undefined"!==typeof n.hasControls?n.hasControls:this.hasControls,c=e.util.multiplyTransformMatrices(a,c),i=e.util.qrDecompose(c),t.save(),t.translate(i.translateX,i.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),n.forActiveSelection?(t.rotate(s(i.angle)),r&&this.drawBordersInGroup(t,i,n)):(t.rotate(s(this.angle)),r&&this.drawBorders(t,n)),o&&this.drawControls(t,n),t.restore()},_setShadow:function(t){if(this.shadow){var n,i=this.shadow,r=this.canvas,o=r&&r.viewportTransform[0]||1,s=r&&r.viewportTransform[3]||1;n=i.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),r&&r._isRetinaScaling()&&(o*=e.devicePixelRatio,s*=e.devicePixelRatio),t.shadowColor=i.color,t.shadowBlur=i.blur*e.browserShadowBlurConstant*(o+s)*(n.scaleX+n.scaleY)/4,t.shadowOffsetX=i.offsetX*o*n.scaleX,t.shadowOffsetY=i.offsetY*s*n.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var n=e.gradientTransform||e.patternTransform,i=-this.width/2+e.offsetX||0,r=-this.height/2+e.offsetY||0;return"percentage"===e.gradientUnits?t.transform(this.width,0,0,this.height,i,r):t.transform(1,0,0,1,i,r),n&&t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:i,offsetY:r}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_render:function(){},_renderFill:function(t){this.fill&&(t.save(),this._applyPatternGradientTransform(t,this.fill),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){this.stroke&&0!==this.strokeWidth&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform&&t.scale(1/this.scaleX,1/this.scaleY),this._setLineDash(t,this.strokeDashArray,this._renderDashedStroke),this.stroke.toLive&&"percentage"===this.stroke.gradientUnits?this._applyPatternForTransformedGradient(t,this.stroke):this._applyPatternGradientTransform(t,this.stroke),t.stroke(),t.restore())},_applyPatternForTransformedGradient:function(t,n){var i,r=this._limitCacheSize(this._getCacheCanvasDimensions()),o=e.util.createCanvasElement(),s=this.canvas.getRetinaScaling(),a=r.x/this.scaleX/s,c=r.y/this.scaleY/s;o.width=a,o.height=c,(i=o.getContext("2d")).beginPath(),i.moveTo(0,0),i.lineTo(a,0),i.lineTo(a,c),i.lineTo(0,c),i.closePath(),i.translate(a/2,c/2),i.scale(r.zoomX/this.scaleX/s,r.zoomY/this.scaleY/s),this._applyPatternGradientTransform(i,n),i.fillStyle=n.toLive(t),i.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(s*this.scaleX/r.zoomX,s*this.scaleY/r.zoomY),t.strokeStyle=i.createPattern(o,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var n=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),n=e.util.transformPoint(n,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,n.x+=t.offsetLeft,n.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(n,"center","center")},clone:function(t,n){var i=this.toObject(n);this.constructor.fromObject?this.constructor.fromObject(i,t):e.Object._fromObject("Object",i,t)},cloneAsImage:function(t,n){var i=this.toCanvasElement(n);return t&&t(new e.Image(i)),this},toCanvasElement:function(t){t||(t={});var n=e.util,i=n.saveObjectTransform(this),r=this.shadow,o=Math.abs,s=(t.multiplier||1)*(t.enableRetinaScaling?e.devicePixelRatio:1);t.withoutTransform&&n.resetObjectTransform(this),t.withoutShadow&&(this.shadow=null);var a,c,l=e.util.createCanvasElement(),u=this.getBoundingRect(!0,!0),h=this.shadow,f={x:0,y:0};h&&(c=h.blur,a=h.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),f.x=2*Math.round(o(h.offsetX)+c)*o(a.scaleX),f.y=2*Math.round(o(h.offsetY)+c)*o(a.scaleY)),l.width=u.width+f.x,l.height=u.height+f.y,l.width+=l.width%2?2-l.width%2:0,l.height+=l.height%2?2-l.height%2:0;var d=new e.StaticCanvas(l,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===t.format&&(d.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(d.width/2,d.height/2),"center","center");var p=this.canvas;d.add(this);var g=d.toCanvasElement(s||1,t);return this.shadow=r,this.canvas=p,this.set(i).setCoords(),d._objects=[],d.dispose(),d=null,g},toDataURL:function(t){return t||(t={}),e.util.toDataURL(this.toCanvasElement(t),t.format||"png",t.quality||1)},isType:function(t){return this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},setGradient:function(t,n){n||(n={});var i={colorStops:[]};return i.type=n.type||(n.r1||n.r2?"radial":"linear"),i.coords={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2},i.gradientUnits=n.gradientUnits||"pixels",(n.r1||n.r2)&&(i.coords.r1=n.r1,i.coords.r2=n.r2),i.gradientTransform=n.gradientTransform,e.Gradient.prototype.addColorStop.call(i,n.colorStops),this.set(t,e.Gradient.forObject(this,i))},setPatternFill:function(t,n){return this.set("fill",new e.Pattern(t,n))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,n){n=n||this.canvas.getPointer(t);var i=new e.Point(n.x,n.y),r=this._getLeftTopCoords();return this.angle&&(i=e.util.rotatePoint(i,r,s(-this.angle))),{x:i.x-r.x,y:i.y-r.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),n(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object._fromObject=function(t,n,r,o){var s=e[t];n=i(n,!0),e.util.enlivenPatterns([n.fill,n.stroke],(function(t){"undefined"!==typeof t[0]&&(n.fill=t[0]),"undefined"!==typeof t[1]&&(n.stroke=t[1]),e.util.enlivenObjects([n.clipPath],(function(t){n.clipPath=t[0];var e=o?new s(n[o],n):new s(n);r&&r(e)}))}))},e.Object.__uid=0)}(e),function(){var t=r.util.degreesToRadians,e={left:-.5,center:0,right:.5},n={top:-.5,center:0,bottom:.5};r.util.object.extend(r.Object.prototype,{translateToGivenOrigin:function(t,i,o,s,a){var c,l,u,h=t.x,f=t.y;return"string"===typeof i?i=e[i]:i-=.5,"string"===typeof s?s=e[s]:s-=.5,"string"===typeof o?o=n[o]:o-=.5,"string"===typeof a?a=n[a]:a-=.5,l=a-o,((c=s-i)||l)&&(u=this._getTransformedDimensions(),h=t.x+c*u.x,f=t.y+l*u.y),new r.Point(h,f)},translateToCenterPoint:function(e,n,i){var o=this.translateToGivenOrigin(e,n,i,"center","center");return this.angle?r.util.rotatePoint(o,e,t(this.angle)):o},translateToOriginPoint:function(e,n,i){var o=this.translateToGivenOrigin(e,"center","center",n,i);return this.angle?r.util.rotatePoint(o,e,t(this.angle)):o},getCenterPoint:function(){var t=new r.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var n=this.getCenterPoint();return this.translateToOriginPoint(n,t,e)},toLocalPoint:function(e,n,i){var o,s,a=this.getCenterPoint();return o="undefined"!==typeof n&&"undefined"!==typeof i?this.translateToGivenOrigin(a,"center","center",n,i):new r.Point(this.left,this.top),s=new r.Point(e.x,e.y),this.angle&&(s=r.util.rotatePoint(s,a,-t(this.angle))),s.subtractEquals(o)},setPositionByOrigin:function(t,e,n){var i=this.translateToCenterPoint(t,e,n),r=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",r.x),this.set("top",r.y)},adjustPosition:function(n){var i,o,s=t(this.angle),a=this.getScaledWidth(),c=r.util.cos(s)*a,l=r.util.sin(s)*a;i="string"===typeof this.originX?e[this.originX]:this.originX-.5,o="string"===typeof n?e[n]:n-.5,this.left+=c*(o-i),this.top+=l*(o-i),this.setCoords(),this.originX=n},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){var t=r.util.degreesToRadians,e=r.util.multiplyTransformMatrices,n=r.util.transformPoint;r.util.object.extend(r.Object.prototype,{oCoords:null,aCoords:null,ownMatrixCache:null,matrixCache:null,getCoords:function(t,e){this.oCoords||this.setCoords();var n=t?this.aCoords:this.oCoords;return function(t){return[new r.Point(t.tl.x,t.tl.y),new r.Point(t.tr.x,t.tr.y),new r.Point(t.br.x,t.br.y),new r.Point(t.bl.x,t.bl.y)]}(e?this.calcCoords(t):n)},intersectsWithRect:function(t,e,n,i){var o=this.getCoords(n,i);return"Intersection"===r.Intersection.intersectPolygonRectangle(o,t,e).status},intersectsWithObject:function(t,e,n){return"Intersection"===r.Intersection.intersectPolygonPolygon(this.getCoords(e,n),t.getCoords(e,n)).status||t.isContainedWithinObject(this,e,n)||this.isContainedWithinObject(t,e,n)},isContainedWithinObject:function(t,e,n){for(var i=this.getCoords(e,n),r=0,o=t._getImageLines(n?t.calcCoords(e):e?t.aCoords:t.oCoords);r<4;r++)if(!t.containsPoint(i[r],o))return!1;return!0},isContainedWithinRect:function(t,e,n,i){var r=this.getBoundingRect(n,i);return r.left>=t.x&&r.left+r.width<=e.x&&r.top>=t.y&&r.top+r.height<=e.y},containsPoint:function(t,e,n,i){e=e||this._getImageLines(i?this.calcCoords(n):n?this.aCoords:this.oCoords);var r=this._findCrossPoints(t,e);return 0!==r&&r%2===1},isOnScreen:function(t){if(!this.canvas)return!1;for(var e,n=this.canvas.vptCoords.tl,i=this.canvas.vptCoords.br,r=this.getCoords(!0,t),o=0;o<4;o++)if((e=r[o]).x<=i.x&&e.x>=n.x&&e.y<=i.y&&e.y>=n.y)return!0;return!!this.intersectsWithRect(n,i,!0,t)||this._containsCenterOfCanvas(n,i,t)},_containsCenterOfCanvas:function(t,e,n){var i={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return!!this.containsPoint(i,null,!0,n)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br;return!!this.intersectsWithRect(e,n,!0,t)||this._containsCenterOfCanvas(e,n,t)},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var n,i,r,o=0;for(var s in e)if(!((r=e[s]).o.y<t.y&&r.d.y<t.y)&&!(r.o.y>=t.y&&r.d.y>=t.y)&&(r.o.x===r.d.x&&r.o.x>=t.x?i=r.o.x:(0,n=(r.d.y-r.o.y)/(r.d.x-r.o.x),i=-(t.y-0*t.x-(r.o.y-n*r.o.x))/(0-n)),i>=t.x&&(o+=1),2===o))break;return o},getBoundingRect:function(t,e){var n=this.getCoords(t,e);return r.util.makeBoundingBoxFromPoints(n)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){var n=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/n)},scaleToHeight:function(t,e){var n=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/n)},calcCoords:function(i){var o=this._calcRotateMatrix(),s=this._calcTranslateMatrix(),a=e(s,o),c=this.getViewportTransform(),l=i?a:e(c,a),u=this._getTransformedDimensions(),h=u.x/2,f=u.y/2,d=n({x:-h,y:-f},l),p=n({x:h,y:-f},l),g=n({x:-h,y:f},l),m=n({x:h,y:f},l);if(!i){var v=this.padding,y=t(this.angle),b=r.util.cos(y),x=r.util.sin(y),C=b*v,S=x*v,w=C+S,_=C-S;v&&(d.x-=_,d.y-=w,p.x+=w,p.y-=_,g.x-=w,g.y+=_,m.x+=_,m.y+=w);var D=new r.Point((d.x+g.x)/2,(d.y+g.y)/2),T=new r.Point((p.x+d.x)/2,(p.y+d.y)/2),E=new r.Point((m.x+p.x)/2,(m.y+p.y)/2),k=new r.Point((m.x+g.x)/2,(m.y+g.y)/2),O=new r.Point(T.x+x*this.rotatingPointOffset,T.y-b*this.rotatingPointOffset)}var A={tl:d,tr:p,br:m,bl:g};return i||(A.ml=D,A.mt=T,A.mr=E,A.mb=k,A.mtr=O),A},setCoords:function(t,e){return this.oCoords=this.calcCoords(t),e||(this.aCoords=this.calcCoords(!0)),t||this._setCornerCoords&&this._setCornerCoords(),this},_calcRotateMatrix:function(){return r.util.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var e="";return!t&&this.group&&(e=this.group.transformMatrixKey(t)+"_"),e+this.top+"_"+this.left+"_"+this.scaleX+"_"+this.scaleY+"_"+this.skewX+"_"+this.skewY+"_"+this.angle+"_"+this.originX+"_"+this.originY+"_"+this.width+"_"+this.height+"_"+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){if(t)return this.calcOwnMatrix();var n=this.transformMatrixKey(),i=this.matrixCache||(this.matrixCache={});if(i.key===n)return i.value;var r=this.calcOwnMatrix();return this.group&&(r=e(this.group.calcTransformMatrix(),r)),i.key=n,i.value=r,r},calcOwnMatrix:function(){var t=this.transformMatrixKey(!0),e=this.ownMatrixCache||(this.ownMatrixCache={});if(e.key===t)return e.value;var n=this._calcTranslateMatrix();return this.translateX=n[4],this.translateY=n[5],e.key=t,e.value=r.util.composeMatrix(this),e.value},_calcDimensionsTransformMatrix:function(t,e,n){return r.util.calcDimensionsMatrix({skewX:t,skewY:e,scaleX:this.scaleX*(n&&this.flipX?-1:1),scaleY:this.scaleY*(n&&this.flipY?-1:1)})},_getNonTransformedDimensions:function(){var t=this.strokeWidth;return{x:this.width+t,y:this.height+t}},_getTransformedDimensions:function(t,e){"undefined"===typeof t&&(t=this.skewX),"undefined"===typeof e&&(e=this.skewY);var n,i,o=this._getNonTransformedDimensions(),s=0===t&&0===e;if(this.strokeUniform?(n=this.width,i=this.height):(n=o.x,i=o.y),s)return this._finalizeDimensions(n*this.scaleX,i*this.scaleY);var a=[{x:-(n/=2),y:-(i/=2)},{x:n,y:-i},{x:-n,y:i},{x:n,y:i}],c=r.util.calcDimensionsMatrix({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY}),l=r.util.makeBoundingBoxFromPoints(a,c);return this._finalizeDimensions(l.width,l.height)},_finalizeDimensions:function(t,e){return this.strokeUniform?{x:t+this.strokeWidth,y:e+this.strokeWidth}:{x:t,y:e}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions();return r.util.transformPoint(e,t,!0).scalarAdd(2*this.padding)}})}(),r.util.object.extend(r.Object.prototype,{sendToBack:function(){return this.group?r.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?r.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?r.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?r.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?r.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}}),function(){var t=r.util.object.extend;function e(e,n,i){var r={};i.forEach((function(t){r[t]=e[t]})),t(e[n],r,!0)}r.util.object.extend(r.Object.prototype,{hasStateChanged:function(t){var e="_"+(t=t||"stateProperties");return Object.keys(this[e]).length<this[t].length||!function t(e,n,i){if(e===n)return!0;if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var r=0,o=e.length;r<o;r++)if(!t(e[r],n[r]))return!1;return!0}if(e&&"object"===typeof e){var s,a=Object.keys(e);if(!n||"object"!==typeof n||!i&&a.length!==Object.keys(n).length)return!1;for(r=0,o=a.length;r<o;r++)if("canvas"!==(s=a[r])&&!t(e[s],n[s]))return!1;return!0}}(this[e],this,!0)},saveState:function(t){var n=t&&t.propertySet||"stateProperties",i="_"+n;return this[i]?(e(this,i,this[n]),t&&t.stateProperties&&e(this,i,t.stateProperties),this):this.setupState(t)},setupState:function(t){var e=(t=t||{}).propertySet||"stateProperties";return t.propertySet=e,this["_"+e]={},this.saveState(t),this}})}(),function(){var t=r.util.degreesToRadians;r.util.object.extend(r.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var e,n,i=t.x,r=t.y;for(var o in this.__corner=0,this.oCoords)if(this.isControlVisible(o)&&("mtr"!==o||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==o&&"mr"!==o&&"mb"!==o&&"ml"!==o)&&(n=this._getImageLines(this.oCoords[o].corner),0!==(e=this._findCrossPoints({x:i,y:r},n))&&e%2===1))return this.__corner=o,o;return!1},_setCornerCoords:function(){var e,n,i=this.oCoords,o=t(45-this.angle),s=.707106*this.cornerSize,a=s*r.util.cos(o),c=s*r.util.sin(o);for(var l in i)e=i[l].x,n=i[l].y,i[l].corner={tl:{x:e-c,y:n-a},tr:{x:e+a,y:n-c},bl:{x:e-a,y:n+c},br:{x:e+c,y:n+a}}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var n=this.getCenterPoint(),i=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return e.translate(n.x,n.y),e.scale(1/r[0],1/r[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-i.x/2,-i.y/2,i.x,i.y),e.restore(),this},drawBorders:function(t,e){e=e||{};var n=this._calculateCurrentDimensions(),i=1/this.borderScaleFactor,r=n.x+i,o=n.y+i,s="undefined"!==typeof e.hasRotatingPoint?e.hasRotatingPoint:this.hasRotatingPoint,a="undefined"!==typeof e.hasControls?e.hasControls:this.hasControls,c="undefined"!==typeof e.rotatingPointOffset?e.rotatingPointOffset:this.rotatingPointOffset;if(t.save(),t.strokeStyle=e.borderColor||this.borderColor,this._setLineDash(t,e.borderDashArray||this.borderDashArray,null),t.strokeRect(-r/2,-o/2,r,o),s&&this.isControlVisible("mtr")&&a){var l=-o/2;t.beginPath(),t.moveTo(0,l),t.lineTo(0,l-c),t.stroke()}return t.restore(),this},drawBordersInGroup:function(t,e,n){n=n||{};var i=this._getNonTransformedDimensions(),o=r.util.composeMatrix({scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX}),s=r.util.transformPoint(i,o),a=1/this.borderScaleFactor,c=s.x+a,l=s.y+a;return t.save(),this._setLineDash(t,n.borderDashArray||this.borderDashArray,null),t.strokeStyle=n.borderColor||this.borderColor,t.strokeRect(-c/2,-l/2,c,l),t.restore(),this},drawControls:function(t,e){e=e||{};var n=this._calculateCurrentDimensions(),i=n.x,r=n.y,o=e.cornerSize||this.cornerSize,s=-(i+o)/2,a=-(r+o)/2,c="undefined"!==typeof e.transparentCorners?e.transparentCorners:this.transparentCorners,l="undefined"!==typeof e.hasRotatingPoint?e.hasRotatingPoint:this.hasRotatingPoint,u=c?"stroke":"fill";return t.save(),t.strokeStyle=t.fillStyle=e.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=e.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,e.cornerDashArray||this.cornerDashArray,null),this._drawControl("tl",t,u,s,a,e),this._drawControl("tr",t,u,s+i,a,e),this._drawControl("bl",t,u,s,a+r,e),this._drawControl("br",t,u,s+i,a+r,e),this.get("lockUniScaling")||(this._drawControl("mt",t,u,s+i/2,a,e),this._drawControl("mb",t,u,s+i/2,a+r,e),this._drawControl("mr",t,u,s+i,a+r/2,e),this._drawControl("ml",t,u,s,a+r/2,e)),l&&this._drawControl("mtr",t,u,s+i/2,a-this.rotatingPointOffset,e),t.restore(),this},_drawControl:function(t,e,n,i,r,o){if(o=o||{},this.isControlVisible(t)){var s=this.cornerSize,a=!this.transparentCorners&&this.cornerStrokeColor;switch(o.cornerStyle||this.cornerStyle){case"circle":e.beginPath(),e.arc(i+s/2,r+s/2,s/2,0,2*Math.PI,!1),e[n](),a&&e.stroke();break;default:this.transparentCorners||e.clearRect(i,r,s,s),e[n+"Rect"](i,r,s,s),a&&e.strokeRect(i,r,s,s)}}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){for(var e in t||(t={}),t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility},onDeselect:function(){},onSelect:function(){}})}(),r.util.object.extend(r.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){var n=function(){},i=(e=e||{}).onComplete||n,o=e.onChange||n,s=this;return r.util.animate({startValue:t.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),s.requestRenderAll(),o()},onComplete:function(){t.setCoords(),i()}}),this},fxCenterObjectV:function(t,e){var n=function(){},i=(e=e||{}).onComplete||n,o=e.onChange||n,s=this;return r.util.animate({startValue:t.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),s.requestRenderAll(),o()},onComplete:function(){t.setCoords(),i()}}),this},fxRemove:function(t,e){var n=function(){},i=(e=e||{}).onComplete||n,o=e.onChange||n,s=this;return r.util.animate({startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){t.set("opacity",e),s.requestRenderAll(),o()},onComplete:function(){s.remove(t),i()}}),this}}),r.util.object.extend(r.Object.prototype,{animate:function(){if(arguments[0]&&"object"===typeof arguments[0]){var t,e,n=[];for(t in arguments[0])n.push(t);for(var i=0,r=n.length;i<r;i++)t=n[i],e=i!==r-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,n,i){var o,s=this;e=e.toString(),n=n?r.util.object.clone(n):{},~t.indexOf(".")&&(o=t.split("."));var a=o?this.get(o[0])[o[1]]:this.get(t);"from"in n||(n.from=a),e=~e.indexOf("=")?a+parseFloat(e.replace("=","")):parseFloat(e),r.util.animate({startValue:n.from,endValue:e,byValue:n.by,easing:n.easing,duration:n.duration,abort:n.abort&&function(){return n.abort.call(s)},onChange:function(e,r,a){o?s[o[0]][o[1]]=e:s.set(t,e),i||n.onChange&&n.onChange(e,r,a)},onComplete:function(t,e,r){i||(s.setCoords(),n.onComplete&&n.onComplete(t,e,r))}})}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend;e.Rect?e.warn("fabric.Rect is already defined"):(e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){var e=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,r=this.height,o=-this.width/2,s=-this.height/2,a=0!==e||0!==n,c=.4477152502;t.beginPath(),t.moveTo(o+e,s),t.lineTo(o+i-e,s),a&&t.bezierCurveTo(o+i-c*e,s,o+i,s+c*n,o+i,s+n),t.lineTo(o+i,s+r-n),a&&t.bezierCurveTo(o+i,s+r-c*n,o+i-c*e,s+r,o+i-e,s+r),t.lineTo(o+e,s+r),a&&t.bezierCurveTo(o+c*e,s+r,o,s+r-c*n,o,s+r-n),t.lineTo(o,s+n),a&&t.bezierCurveTo(o,s+c*n,o+c*e,s,o+e,s),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var n=-this.width/2,i=-this.height/2,r=this.width,o=this.height;t.beginPath(),e.util.drawDashedLine(t,n,i,n+r,i,this.strokeDashArray),e.util.drawDashedLine(t,n+r,i,n+r,i+o,this.strokeDashArray),e.util.drawDashedLine(t,n+r,i+o,n,i+o,this.strokeDashArray),e.util.drawDashedLine(t,n,i+o,n,i,this.strokeDashArray),t.closePath()},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,i,r){if(!t)return i(null);r=r||{};var o=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);o.left=o.left||0,o.top=o.top||0,o.height=o.height||0,o.width=o.width||0;var s=new e.Rect(n(r?e.util.object.clone(r):{},o));s.visible=s.visible&&s.width>0&&s.height>0,i(s)},e.Rect.fromObject=function(t,n){return e.Object._fromObject("Rect",t,n)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,i=e.util.array.max,r=e.util.object.extend,o=Object.prototype.toString,s=e.util.drawArc,a=(e.util.toFixed,{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7}),c={m:"l",M:"L"};e.Path?e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(t,n){n=n||{},this.callSuper("initialize",n),t||(t=[]);var i="[object Array]"===o.call(t);this.path=i?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(i||(this.path=this._parsePath()),e.Polyline.prototype._setPositionDimensions.call(this,n))},_renderPathCommands:function(t){var e,n,i,r=null,o=0,a=0,c=0,l=0,u=0,h=0,f=-this.pathOffset.x,d=-this.pathOffset.y;t.beginPath();for(var p=0,g=this.path.length;p<g;++p){switch((e=this.path[p])[0]){case"l":c+=e[1],l+=e[2],t.lineTo(c+f,l+d);break;case"L":c=e[1],l=e[2],t.lineTo(c+f,l+d);break;case"h":c+=e[1],t.lineTo(c+f,l+d);break;case"H":c=e[1],t.lineTo(c+f,l+d);break;case"v":l+=e[1],t.lineTo(c+f,l+d);break;case"V":l=e[1],t.lineTo(c+f,l+d);break;case"m":o=c+=e[1],a=l+=e[2],t.moveTo(c+f,l+d);break;case"M":o=c=e[1],a=l=e[2],t.moveTo(c+f,l+d);break;case"c":n=c+e[5],i=l+e[6],u=c+e[3],h=l+e[4],t.bezierCurveTo(c+e[1]+f,l+e[2]+d,u+f,h+d,n+f,i+d),c=n,l=i;break;case"C":c=e[5],l=e[6],u=e[3],h=e[4],t.bezierCurveTo(e[1]+f,e[2]+d,u+f,h+d,c+f,l+d);break;case"s":n=c+e[3],i=l+e[4],null===r[0].match(/[CcSs]/)?(u=c,h=l):(u=2*c-u,h=2*l-h),t.bezierCurveTo(u+f,h+d,c+e[1]+f,l+e[2]+d,n+f,i+d),u=c+e[1],h=l+e[2],c=n,l=i;break;case"S":n=e[3],i=e[4],null===r[0].match(/[CcSs]/)?(u=c,h=l):(u=2*c-u,h=2*l-h),t.bezierCurveTo(u+f,h+d,e[1]+f,e[2]+d,n+f,i+d),c=n,l=i,u=e[1],h=e[2];break;case"q":n=c+e[3],i=l+e[4],u=c+e[1],h=l+e[2],t.quadraticCurveTo(u+f,h+d,n+f,i+d),c=n,l=i;break;case"Q":n=e[3],i=e[4],t.quadraticCurveTo(e[1]+f,e[2]+d,n+f,i+d),c=n,l=i,u=e[1],h=e[2];break;case"t":n=c+e[1],i=l+e[2],null===r[0].match(/[QqTt]/)?(u=c,h=l):(u=2*c-u,h=2*l-h),t.quadraticCurveTo(u+f,h+d,n+f,i+d),c=n,l=i;break;case"T":n=e[1],i=e[2],null===r[0].match(/[QqTt]/)?(u=c,h=l):(u=2*c-u,h=2*l-h),t.quadraticCurveTo(u+f,h+d,n+f,i+d),c=n,l=i;break;case"a":s(t,c+f,l+d,[e[1],e[2],e[3],e[4],e[5],e[6]+c+f,e[7]+l+d]),c+=e[6],l+=e[7];break;case"A":s(t,c+f,l+d,[e[1],e[2],e[3],e[4],e[5],e[6]+f,e[7]+d]),c=e[6],l=e[7];break;case"z":case"Z":c=o,l=a,t.closePath()}r=e}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){return r(this.callSuper("toObject",t),{path:this.path.map((function(t){return t.slice()}))})},toDatalessObject:function(t){var e=this.toObject(["sourcePath"].concat(t));return e.sourcePath&&delete e.path,e},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,n,i,r,o=[],s=[],l=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,u=0,h=this.path.length;u<h;u++){for(i=(t=this.path[u]).slice(1).trim(),s.length=0;n=l.exec(i);)s.push(n[0]);r=[t.charAt(0)];for(var f=0,d=s.length;f<d;f++)e=parseFloat(s[f]),isNaN(e)||r.push(e);var p=r[0],g=a[p.toLowerCase()],m=c[p]||p;if(r.length-1>g)for(var v=1,y=r.length;v<y;v+=g)o.push([p].concat(r.slice(v,v+g))),p=m;else o.push(r)}return o},_calcDimensions:function(){for(var t,r,o,s,a=[],c=[],l=null,u=0,h=0,f=0,d=0,p=0,g=0,m=0,v=this.path.length;m<v;++m){switch((t=this.path[m])[0]){case"l":f+=t[1],d+=t[2],s=[];break;case"L":f=t[1],d=t[2],s=[];break;case"h":f+=t[1],s=[];break;case"H":f=t[1],s=[];break;case"v":d+=t[1],s=[];break;case"V":d=t[1],s=[];break;case"m":u=f+=t[1],h=d+=t[2],s=[];break;case"M":u=f=t[1],h=d=t[2],s=[];break;case"c":r=f+t[5],o=d+t[6],p=f+t[3],g=d+t[4],s=e.util.getBoundsOfCurve(f,d,f+t[1],d+t[2],p,g,r,o),f=r,d=o;break;case"C":p=t[3],g=t[4],s=e.util.getBoundsOfCurve(f,d,t[1],t[2],p,g,t[5],t[6]),f=t[5],d=t[6];break;case"s":r=f+t[3],o=d+t[4],null===l[0].match(/[CcSs]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,f+t[1],d+t[2],r,o),p=f+t[1],g=d+t[2],f=r,d=o;break;case"S":r=t[3],o=t[4],null===l[0].match(/[CcSs]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,t[1],t[2],r,o),f=r,d=o,p=t[1],g=t[2];break;case"q":r=f+t[3],o=d+t[4],p=f+t[1],g=d+t[2],s=e.util.getBoundsOfCurve(f,d,p,g,p,g,r,o),f=r,d=o;break;case"Q":p=t[1],g=t[2],s=e.util.getBoundsOfCurve(f,d,p,g,p,g,t[3],t[4]),f=t[3],d=t[4];break;case"t":r=f+t[1],o=d+t[2],null===l[0].match(/[QqTt]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,p,g,r,o),f=r,d=o;break;case"T":r=t[1],o=t[2],null===l[0].match(/[QqTt]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,p,g,r,o),f=r,d=o;break;case"a":s=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6]+f,t[7]+d),f+=t[6],d+=t[7];break;case"A":s=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6],t[7]),f=t[6],d=t[7];break;case"z":case"Z":f=u,d=h}l=t,s.forEach((function(t){a.push(t.x),c.push(t.y)})),a.push(f),c.push(d)}var y=n(a)||0,b=n(c)||0;return{left:y,top:b,width:(i(a)||0)-y,height:(i(c)||0)-b}}}),e.Path.fromObject=function(t,n){if("string"===typeof t.sourcePath){var i=t.sourcePath;e.loadSVGFromURL(i,(function(e){var i=e[0];i.setOptions(t),n&&n(i)}))}else e.Object._fromObject("Path",t,n,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,n,i){var o=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);o.fromSVG=!0,n(new e.Path(o.d,r(o,i)))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,i=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,n){e=e||{},this._objects=[],n&&this.callSuper("initialize",e),this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;if(n)this._updateObjectsACoords();else{var r=e&&e.centerPoint;void 0!==e.originX&&(this.originX=e.originX),void 0!==e.originY&&(this.originY=e.originY),r||this._calcBounds(),this._updateObjectsCoords(r),delete e.centerPoint,this.callSuper("initialize",e)}this.setCoords()},_updateObjectsACoords:function(){for(var t=this._objects.length;t--;)this._objects[t].setCoords(!0,!0)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var n=t.left,i=t.top;t.set({left:n-e.x,top:i-e.y}),t.group=this,t.setCoords(!0,!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,n){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(t,n);if("canvas"===t)for(;i--;)this._objects[i]._set(t,n);e.Object.prototype._set.call(this,t,n)},toObject:function(t){var n=this.includeDefaultValues,i=this._objects.map((function(e){var i=e.includeDefaultValues;e.includeDefaultValues=n;var r=e.toObject(t);return e.includeDefaultValues=i,r})),r=e.Object.prototype.toObject.call(this,t);return r.objects=i,r},toDatalessObject:function(t){var n,i=this.sourcePath;if(i)n=i;else{var r=this.includeDefaultValues;n=this._objects.map((function(e){var n=e.includeDefaultValues;e.includeDefaultValues=r;var i=e.toDatalessObject(t);return e.includeDefaultValues=n,i}))}var o=e.Object.prototype.toDatalessObject.call(this,t);return o.objects=n,o},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=e.Object.prototype.shouldCache.call(this);if(t)for(var n=0,i=this._objects.length;n<i;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1;return t},willDrawShadow:function(){if(this.shadow)return e.Object.prototype.willDrawShadow.call(this);for(var t=0,n=this._objects.length;t<n;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,n=this._objects.length;e<n;e++)this._objects[e].render(t);this._drawClipPath(t)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var e=0,n=this._objects.length;e<n;e++)if(this._objects[e].isCacheDirty(!0)){if(this._cacheCanvas){var i=this.cacheWidth/this.zoomX,r=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-i/2,-r/2,i,r)}return!0}return!1},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){var n=t.calcTransformMatrix(),i=e.util.qrDecompose(n),r=new e.Point(i.translateX,i.translateY);return t.flipX=!1,t.flipY=!1,t.set("scaleX",i.scaleX),t.set("scaleY",i.scaleY),t.skewX=i.skewX,t.skewY=i.skewY,t.angle=i.angle,t.setPositionByOrigin(r,"center","center"),t},_restoreObjectState:function(t){return this.realizeTransform(t),t.setCoords(),delete t.group,this},destroy:function(){return this._objects.forEach((function(t){t.set("dirty",!0)})),this._restoreObjectsState()},toActiveSelection:function(){if(this.canvas){var t=this._objects,n=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var r=new e.ActiveSelection([]);return r.set(i),r.type="activeSelection",n.remove(this),t.forEach((function(t){t.group=r,t.dirty=!0,n.add(t)})),r.canvas=n,r._objects=t,n._activeObject=r,r.setCoords(),r}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject((function(t){t.setCoords(!0,!0)})),this},_calcBounds:function(t){for(var e,n,i,r=[],o=[],s=["tr","br","bl","tl"],a=0,c=this._objects.length,l=s.length;a<c;++a)for((e=this._objects[a]).setCoords(!0),i=0;i<l;i++)n=s[i],r.push(e.oCoords[n].x),o.push(e.oCoords[n].y);this._getBounds(r,o,t)},_getBounds:function(t,r,o){var s=new e.Point(n(t),n(r)),a=new e.Point(i(t),i(r)),c=s.y||0,l=s.x||0,u=a.x-s.x||0,h=a.y-s.y||0;this.width=u,this.height=h,o||this.setPositionByOrigin({x:l,y:c},"left","top")}}),e.Group.fromObject=function(t,n){e.util.enlivenObjects(t.objects,(function(i){e.util.enlivenObjects([t.clipPath],(function(r){var o=e.util.object.clone(t,!0);o.clipPath=r[0],delete o.objects,n&&n(new e.Group(i,o,!0))}))}))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(t,n){n=n||{},this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;n.originX&&(this.originX=n.originX),n.originY&&(this.originY=n.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,n),this.setCoords()},toGroup:function(){var t=this._objects.concat();this._objects=[];var n=e.Object.prototype.toObject.call(this),i=new e.Group([]);if(delete n.type,i.set(n),t.forEach((function(t){t.canvas.remove(t),t.group=i})),i._objects=t,!this.canvas)return i;var r=this.canvas;return r.add(i),r._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(t,e,n){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),"undefined"===typeof(n=n||{}).hasControls&&(n.hasControls=!1),"undefined"===typeof n.hasRotatingPoint&&(n.hasRotatingPoint=!1),n.forActiveSelection=!0;for(var i=0,r=this._objects.length;i<r;i++)this._objects[i]._renderControls(t,n);t.restore()}}),e.ActiveSelection.fromObject=function(t,n){e.util.enlivenObjects(t.objects,(function(i){delete t.objects,n&&n(new e.ActiveSelection(i,t,!0))}))})}(e),function(t){"use strict";var e=r.util.object.extend;t.fabric||(t.fabric={}),t.fabric.Image?r.warn("fabric.Image is already defined."):(r.Image=r.util.createClass(r.Object,{type:"image",crossOrigin:"",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:r.Object.prototype.stateProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,initialize:function(t,e){e||(e={}),this.filters=[],this.cacheKey="texture"+r.Object.__uid++,this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element||{}},setElement:function(t,e){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=t,this._originalElement=t,this._initConfig(e),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(t){var e=r.filterBackend;e&&e.evictCachesForKey&&e.evictCachesForKey(t)},dispose:function(){this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(t){r.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this))},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,n=this.height/2;t.beginPath(),t.moveTo(-e,-n),t.lineTo(e,-n),t.lineTo(e,n),t.lineTo(-e,n),t.lineTo(-e,-n),t.closePath()}},_renderDashedStroke:function(t){var e=-this.width/2,n=-this.height/2,i=this.width,o=this.height;t.save(),this._setStrokeStyles(t,this),t.beginPath(),r.util.drawDashedLine(t,e,n,e+i,n,this.strokeDashArray),r.util.drawDashedLine(t,e+i,n,e+i,n+o,this.strokeDashArray),r.util.drawDashedLine(t,e+i,n+o,e,n+o,this.strokeDashArray),r.util.drawDashedLine(t,e,n+o,e,n,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var n=[];this.filters.forEach((function(t){t&&n.push(t.toObject())}));var i=e(this.callSuper("toObject",["crossOrigin","cropX","cropY"].concat(t)),{src:this.getSrc(),filters:n});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},getSrc:function(t){var e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src"):e.src:this.src||""},setSrc:function(t,e,n){return r.util.loadImage(t,(function(t){this.setElement(t,n),this._setWidthHeight(),e&&e(this)}),this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),i=n.scaleX,o=n.scaleY,s=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||i>e&&o>e)return this._element=s,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=o);r.filterBackend||(r.filterBackend=r.initFilterBackend());var a=r.util.createCanvasElement(),c=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,l=s.width,u=s.height;a.width=l,a.height=u,this._element=a,this._lastScaleX=t.scaleX=i,this._lastScaleY=t.scaleY=o,r.filterBackend.applyFilters([t],s,l,u,this._element,c),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height},applyFilters:function(t){if(t=(t=t||this.filters||[]).filter((function(t){return t&&!t.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,n=e.naturalWidth||e.width,i=e.naturalHeight||e.height;if(this._element===this._originalElement){var o=r.util.createCanvasElement();o.width=n,o.height=i,this._element=o,this._filteredEl=o}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,i),this._lastScaleX=1,this._lastScaleY=1;return r.filterBackend||(r.filterBackend=r.initFilterBackend()),r.filterBackend.applyFilters(t,this._originalElement,n,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(t){var e=this._element,n=this.width,i=this.height,r=Math.min(e.naturalWidth||e.width,n*this._filterScalingX),o=Math.min(e.naturalHeight||e.height,i*this._filterScalingY),s=-n/2,a=-i/2,c=Math.max(0,this.cropX*this._filterScalingX),l=Math.max(0,this.cropY*this._filterScalingY);e&&t.drawImage(e,c,l,r,o,s,a,n,i)},_needsResize:function(){var t=this.getTotalObjectScaling();return t.scaleX!==this._lastScaleX||t.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(t,e){this.setElement(r.util.getById(t),e),r.util.addClass(this.getElement(),r.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t&&t.length?r.util.enlivenObjects(t,(function(t){e&&e(t)}),"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){t||(t={});var e=this.getElement();this.width=t.width||e.naturalWidth||e.width||0,this.height=t.height||e.naturalHeight||e.height||0},parsePreserveAspectRatioAttribute:function(){var t,e=r.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),n=this._element.width,i=this._element.height,o=1,s=1,a=0,c=0,l=0,u=0,h=this.width,f=this.height,d={width:h,height:f};return!e||"none"===e.alignX&&"none"===e.alignY?(o=h/n,s=f/i):("meet"===e.meetOrSlice&&(t=(h-n*(o=s=r.util.findScaleToFit(this._element,d)))/2,"Min"===e.alignX&&(a=-t),"Max"===e.alignX&&(a=t),t=(f-i*s)/2,"Min"===e.alignY&&(c=-t),"Max"===e.alignY&&(c=t)),"slice"===e.meetOrSlice&&(t=n-h/(o=s=r.util.findScaleToCover(this._element,d)),"Mid"===e.alignX&&(l=t/2),"Max"===e.alignX&&(l=t),t=i-f/s,"Mid"===e.alignY&&(u=t/2),"Max"===e.alignY&&(u=t),n=h/o,i=f/s)),{width:n,height:i,scaleX:o,scaleY:s,offsetLeft:a,offsetTop:c,cropX:l,cropY:u}}}),r.Image.CSS_CANVAS="canvas-img",r.Image.prototype.getSvgSrc=r.Image.prototype.getSrc,r.Image.fromObject=function(t,e){var n=r.util.object.clone(t);r.util.loadImage(n.src,(function(t,i){i?e&&e(null,i):r.Image.prototype._initFilters.call(n,n.filters,(function(i){n.filters=i||[],r.Image.prototype._initFilters.call(n,[n.resizeFilter],(function(i){n.resizeFilter=i[0],r.util.enlivenObjects([n.clipPath],(function(i){n.clipPath=i[0];var o=new r.Image(t,n);e(o)}))}))}))}),null,n.crossOrigin)},r.Image.fromURL=function(t,e,n){r.util.loadImage(t,(function(t){e&&e(new r.Image(t,n))}),null,n&&n.crossOrigin)},r.Image.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin".split(" ")),r.Image.fromElement=function(t,n,i){var o=r.parseAttributes(t,r.Image.ATTRIBUTE_NAMES);r.Image.fromURL(o["xlink:href"],n,e(i?r.util.object.clone(i):{},o))})}(e),function(){"use strict";function t(t,e){var n="precision "+e+" float;\nvoid main(){}",i=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(i,n),t.compileShader(i),!!t.getShaderParameter(i,t.COMPILE_STATUS)}function e(t){t&&t.tileSize&&(this.tileSize=t.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}r.isWebglSupported=function(e){if(r.isLikelyNode)return!1;e=e||r.WebglFilterBackend.prototype.tileSize;var n=document.createElement("canvas"),i=n.getContext("webgl")||n.getContext("experimental-webgl"),o=!1;if(i){r.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),o=r.maxTextureSize>=e;for(var s=["highp","mediump","lowp"],a=0;a<3;a++)if(t(i,s[a])){r.webGlPrecision=s[a];break}}return this.isSupported=o,o},r.WebglFilterBackend=e,e.prototype={tileSize:2048,resources:{},setupGLContext:function(t,e){this.dispose(),this.createWebGLCanvas(t,e),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(t,e)},chooseFastestCopyGLTo2DMethod:function(t,e){var n,i="undefined"!==typeof window.performance;try{new ImageData(1,1),n=!0}catch(p){n=!1}var a="undefined"!==typeof ArrayBuffer,c="undefined"!==typeof Uint8ClampedArray;if(i&&n&&a&&c){var l=r.util.createCanvasElement(),u=new ArrayBuffer(t*e*4);if(r.forceGLPutImageData)return this.imageBuffer=u,void(this.copyGLTo2D=s);var h,f,d={imageBuffer:u,destinationWidth:t,destinationHeight:e,targetCanvas:l};l.width=t,l.height=e,h=window.performance.now(),o.call(d,this.gl,d),f=window.performance.now()-h,h=window.performance.now(),s.call(d,this.gl,d),f>window.performance.now()-h?(this.imageBuffer=u,this.copyGLTo2D=s):this.copyGLTo2D=o}},createWebGLCanvas:function(t,e){var n=r.util.createCanvasElement();n.width=t,n.height=e;var i={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},o=n.getContext("webgl",i);o||(o=n.getContext("experimental-webgl",i)),o&&(o.clearColor(0,0,0,0),this.canvas=n,this.gl=o)},applyFilters:function(t,e,n,i,r,o){var s,a=this.gl;o&&(s=this.getCachedTexture(o,e));var c={originalWidth:e.width||e.originalWidth,originalHeight:e.height||e.originalHeight,sourceWidth:n,sourceHeight:i,destinationWidth:n,destinationHeight:i,context:a,sourceTexture:this.createTexture(a,n,i,!s&&e),targetTexture:this.createTexture(a,n,i),originalTexture:s||this.createTexture(a,n,i,!s&&e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},l=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,l),t.forEach((function(t){t&&t.applyTo(c)})),function(t){var e=t.targetCanvas,n=e.width,i=e.height,r=t.destinationWidth,o=t.destinationHeight;n===r&&i===o||(e.width=r,e.height=o)}(c),this.copyGLTo2D(a,c),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(c.sourceTexture),a.deleteTexture(c.targetTexture),a.deleteFramebuffer(l),r.getContext("2d").setTransform(1,0,0,1,0,0),c},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(t,e,n,i){var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,null),r},getCachedTexture:function(t,e){if(this.textureCache[t])return this.textureCache[t];var n=this.createTexture(this.gl,e.width,e.height,e);return this.textureCache[t]=n,n},evictCachesForKey:function(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])},copyGLTo2D:o,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var t=this.gl,e={renderer:"",vendor:""};if(!t)return e;var n=t.getExtension("WEBGL_debug_renderer_info");if(n){var i=t.getParameter(n.UNMASKED_RENDERER_WEBGL),r=t.getParameter(n.UNMASKED_VENDOR_WEBGL);i&&(e.renderer=i.toLowerCase()),r&&(e.vendor=r.toLowerCase())}return this.gpuInfo=e,e}}}(),function(){"use strict";var t=function(){};function e(){}r.Canvas2dFilterBackend=e,e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(t,e,n,i,r){var o=r.getContext("2d");o.drawImage(e,0,0,n,i);var s={sourceWidth:n,sourceHeight:i,imageData:o.getImageData(0,0,n,i),originalEl:e,originalImageData:o.getImageData(0,0,n,i),canvasEl:r,ctx:o,filterBackend:this};return t.forEach((function(t){t.applyTo(s)})),s.imageData.width===n&&s.imageData.height===i||(r.width=s.imageData.width,r.height=s.imageData.height),o.putImageData(s.imageData,0,0),s}}}(),r.Image=r.Image||{},r.Image.filters=r.Image.filters||{},r.Image.filters.BaseFilter=r.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,n){e=e||this.fragmentSource,n=n||this.vertexSource,"highp"!==r.webGlPrecision&&(e=e.replace(/precision highp float/g,"precision "+r.webGlPrecision+" float"));var i=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(i));var o=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(o));var s=t.createProgram();if(t.attachShader(s,i),t.attachShader(s,o),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(s));var a=this.getAttributeLocations(t,s),c=this.getUniformLocations(t,s)||{};return c.uStepW=t.getUniformLocation(s,"uStepW"),c.uStepH=t.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:a,uniformLocations:c}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,n){var i=e.aPosition,r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e,n,i=t.context;t.passes>1?(e=t.destinationWidth,n=t.destinationHeight,t.sourceWidth===e&&t.sourceHeight===n||(i.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(i,e,n)),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t.targetTexture,0)):(i.bindFramebuffer(i.FRAMEBUFFER,null),i.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=r.Image.filters[this.type].prototype;if(t){if(Array.isArray(e[t])){for(var n=e[t].length;n--;)if(this[t][n]!==e[t][n])return!1;return!0}return e[t]===this[t]}return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,n=this.retrieveShader(t);0===t.pass&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(n.program),this.sendAttributeData(e,n.attributeLocations,t.aPosition),e.uniform1f(n.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(n.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,n.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,n){t.activeTexture(n),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}}),r.Image.filters.BaseFilter.fromObject=function(t,e){var n=new r.Image.filters[t.type](t);return e&&e(n),n},function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.ColorMatrix=i(n.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){var e,n,i,r,o,s=t.imageData.data,a=s.length,c=this.matrix,l=this.colorsOnly;for(o=0;o<a;o+=4)e=s[o],n=s[o+1],i=s[o+2],l?(s[o]=e*c[0]+n*c[1]+i*c[2]+255*c[4],s[o+1]=e*c[5]+n*c[6]+i*c[7]+255*c[9],s[o+2]=e*c[10]+n*c[11]+i*c[12]+255*c[14]):(r=s[o+3],s[o]=e*c[0]+n*c[1]+i*c[2]+r*c[3]+255*c[4],s[o+1]=e*c[5]+n*c[6]+i*c[7]+r*c[8]+255*c[9],s[o+2]=e*c[10]+n*c[11]+i*c[12]+r*c[13]+255*c[14],s[o+3]=e*c[15]+n*c[16]+i*c[17]+r*c[18]+255*c[19])},getUniformLocations:function(t,e){return{uColorMatrix:t.getUniformLocation(e,"uColorMatrix"),uConstants:t.getUniformLocation(e,"uConstants")}},sendUniformData:function(t,e){var n=this.matrix,i=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],r=[n[4],n[9],n[14],n[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,i),t.uniform4fv(e.uConstants,r)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.Brightness=i(n.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(0!==this.brightness){var e,n=t.imageData.data,i=n.length,r=Math.round(255*this.brightness);for(e=0;e<i;e+=4)n[e]=n[e]+r,n[e+1]=n[e+1]+r,n[e+2]=n[e+2]+r}},getUniformLocations:function(t,e){return{uBrightness:t.getUniformLocation(e,"uBrightness")}},sendUniformData:function(t,e){t.uniform1f(e.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,i=e.Image.filters,r=e.util.createClass;i.Convolute=r(i.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(t){var e=Math.sqrt(this.matrix.length),n=this.type+"_"+e+"_"+(this.opaque?1:0),i=this.fragmentSource[n];return t.programCache.hasOwnProperty(n)||(t.programCache[n]=this.createProgram(t.context,i)),t.programCache[n]},applyTo2d:function(t){var e,n,i,r,o,s,a,c,l,u,h,f,d,p=t.imageData,g=p.data,m=this.matrix,v=Math.round(Math.sqrt(m.length)),y=Math.floor(v/2),b=p.width,x=p.height,C=t.ctx.createImageData(b,x),S=C.data,w=this.opaque?1:0;for(h=0;h<x;h++)for(u=0;u<b;u++){for(o=4*(h*b+u),e=0,n=0,i=0,r=0,d=0;d<v;d++)for(f=0;f<v;f++)s=u+f-y,(a=h+d-y)<0||a>x||s<0||s>b||(c=4*(a*b+s),l=m[d*v+f],e+=g[c]*l,n+=g[c+1]*l,i+=g[c+2]*l,w||(r+=g[c+3]*l));S[o]=e,S[o+1]=n,S[o+2]=i,S[o+3]=w?g[o+3]:r}t.imageData=C},getUniformLocations:function(t,e){return{uMatrix:t.getUniformLocation(e,"uMatrix"),uOpaque:t.getUniformLocation(e,"uOpaque"),uHalfSize:t.getUniformLocation(e,"uHalfSize"),uSize:t.getUniformLocation(e,"uSize")}},sendUniformData:function(t,e){t.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return n(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.Grayscale=i(n.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){var e,n,i=t.imageData.data,r=i.length,o=this.mode;for(e=0;e<r;e+=4)"average"===o?n=(i[e]+i[e+1]+i[e+2])/3:"lightness"===o?n=(Math.min(i[e],i[e+1],i[e+2])+Math.max(i[e],i[e+1],i[e+2]))/2:"luminosity"===o&&(n=.21*i[e]+.72*i[e+1]+.07*i[e+2]),i[e]=n,i[e+1]=n,i[e+2]=n},retrieveShader:function(t){var e=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(e)){var n=this.fragmentSource[this.mode];t.programCache[e]=this.createProgram(t.context,n)}return t.programCache[e]},getUniformLocations:function(t,e){return{uMode:t.getUniformLocation(e,"uMode")}},sendUniformData:function(t,e){t.uniform1i(e.uMode,1)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.Invert=i(n.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){var e,n=t.imageData.data,i=n.length;for(e=0;e<i;e+=4)n[e]=255-n[e],n[e+1]=255-n[e+1],n[e+2]=255-n[e+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,e){return{uInvert:t.getUniformLocation(e,"uInvert")}},sendUniformData:function(t,e){t.uniform1i(e.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,i=e.Image.filters,r=e.util.createClass;i.Noise=r(i.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(t){if(0!==this.noise){var e,n,i=t.imageData.data,r=i.length,o=this.noise;for(e=0,r=i.length;e<r;e+=4)n=(.5-Math.random())*o,i[e]+=n,i[e+1]+=n,i[e+2]+=n}},getUniformLocations:function(t,e){return{uNoise:t.getUniformLocation(e,"uNoise"),uSeed:t.getUniformLocation(e,"uSeed")}},sendUniformData:function(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())},toObject:function(){return n(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.Pixelate=i(n.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){var e,n,i,r,o,s,a,c,l,u,h,f=t.imageData,d=f.data,p=f.height,g=f.width;for(n=0;n<p;n+=this.blocksize)for(i=0;i<g;i+=this.blocksize)for(r=d[e=4*n*g+4*i],o=d[e+1],s=d[e+2],a=d[e+3],u=Math.min(n+this.blocksize,p),h=Math.min(i+this.blocksize,g),c=n;c<u;c++)for(l=i;l<h;l++)d[e=4*c*g+4*l]=r,d[e+1]=o,d[e+2]=s,d[e+3]=a},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(t,e){return{uBlocksize:t.getUniformLocation(e,"uBlocksize"),uStepW:t.getUniformLocation(e,"uStepW"),uStepH:t.getUniformLocation(e,"uStepH")}},sendUniformData:function(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,i=e.Image.filters,r=e.util.createClass;i.RemoveColor=r(i.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(t){var n,i,r,o,s=t.imageData.data,a=255*this.distance,c=new e.Color(this.color).getSource(),l=[c[0]-a,c[1]-a,c[2]-a],u=[c[0]+a,c[1]+a,c[2]+a];for(n=0;n<s.length;n+=4)i=s[n],r=s[n+1],o=s[n+2],i>l[0]&&r>l[1]&&o>l[2]&&i<u[0]&&r<u[1]&&o<u[2]&&(s[n+3]=0)},getUniformLocations:function(t,e){return{uLow:t.getUniformLocation(e,"uLow"),uHigh:t.getUniformLocation(e,"uHigh")}},sendUniformData:function(t,n){var i=new e.Color(this.color).getSource(),r=parseFloat(this.distance),o=[0+i[0]/255-r,0+i[1]/255-r,0+i[2]/255-r,1],s=[i[0]/255+r,i[1]/255+r,i[2]/255+r,1];t.uniform4fv(n.uLow,o),t.uniform4fv(n.uHigh,s)},toObject:function(){return n(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass,r={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var o in r)n[o]=i(n.ColorMatrix,{type:o,matrix:r[o],mainParameter:!1,colorsOnly:!0}),e.Image.filters[o].fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,n=e.Image.filters,i=e.util.createClass;n.BlendColor=i(n.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(t){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[t]+"}\n}"},retrieveShader:function(t){var e,n=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(n)||(e=this.buildSource(this.mode),t.programCache[n]=this.createProgram(t.context,e)),t.programCache[n]},applyTo2d:function(t){var n,i,r,o,s,a,c,l=t.imageData.data,u=l.length,h=1-this.alpha;n=(c=new e.Color(this.color).getSource())[0]*this.alpha,i=c[1]*this.alpha,r=c[2]*this.alpha;for(var f=0;f<u;f+=4)switch(o=l[f],s=l[f+1],a=l[f+2],this.mode){case"multiply":l[f]=o*n/255,l[f+1]=s*i/255,l[f+2]=a*r/255;break;case"screen":l[f]=255-(255-o)*(255-n)/255,l[f+1]=255-(255-s)*(255-i)/255,l[f+2]=255-(255-a)*(255-r)/255;break;case"add":l[f]=o+n,l[f+1]=s+i,l[f+2]=a+r;break;case"diff":case"difference":l[f]=Math.abs(o-n),l[f+1]=Math.abs(s-i),l[f+2]=Math.abs(a-r);break;case"subtract":l[f]=o-n,l[f+1]=s-i,l[f+2]=a-r;break;case"darken":l[f]=Math.min(o,n),l[f+1]=Math.min(s,i),l[f+2]=Math.min(a,r);break;case"lighten":l[f]=Math.max(o,n),l[f+1]=Math.max(s,i),l[f+2]=Math.max(a,r);break;case"overlay":l[f]=n<128?2*o*n/255:255-2*(255-o)*(255-n)/255,l[f+1]=i<128?2*s*i/255:255-2*(255-s)*(255-i)/255,l[f+2]=r<128?2*a*r/255:255-2*(255-a)*(255-r)/255;break;case"exclusion":l[f]=n+o-2*n*o/255,l[f+1]=i+s-2*i*s/255,l[f+2]=r+a-2*r*a/255;break;case"tint":l[f]=n+o*h,l[f+1]=i+s*h,l[f+2]=r+a*h}},getUniformLocations:function(t,e){return{uColor:t.getUniformLocation(e,"uColor")}},sendUniformData:function(t,n){var i=new e.Color(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,t.uniform4fv(n.uColor,i)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,n=e.Image.filters,i=e.util.createClass;n.BlendImage=i(n.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(t){var e=this.type+"_"+this.mode,n=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(e)||(t.programCache[e]=this.createProgram(t.context,n)),t.programCache[e]},applyToWebGL:function(t){var e=t.context,n=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,n,e.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(e,e.TEXTURE1)},createTexture:function(t,e){return t.getCachedTexture(e.cacheKey,e._element)},calculateMatrix:function(){var t=this.image,e=t._element.width,n=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/n,1]},applyTo2d:function(t){var n,i,r,o,s,a,c,l,u,h,f,d=t.imageData,p=t.filterBackend.resources,g=d.data,m=g.length,v=d.width,y=d.height,b=this.image;p.blendImage||(p.blendImage=e.util.createCanvasElement()),h=(u=p.blendImage).getContext("2d"),u.width!==v||u.height!==y?(u.width=v,u.height=y):h.clearRect(0,0,v,y),h.setTransform(b.scaleX,0,0,b.scaleY,b.left,b.top),h.drawImage(b._element,0,0,v,y),f=h.getImageData(0,0,v,y).data;for(var x=0;x<m;x+=4)switch(s=g[x],a=g[x+1],c=g[x+2],l=g[x+3],n=f[x],i=f[x+1],r=f[x+2],o=f[x+3],this.mode){case"multiply":g[x]=s*n/255,g[x+1]=a*i/255,g[x+2]=c*r/255,g[x+3]=l*o/255;break;case"mask":g[x+3]=o}},getUniformLocations:function(t,e){return{uTransformMatrix:t.getUniformLocation(e,"uTransformMatrix"),uImage:t.getUniformLocation(e,"uImage")}},sendUniformData:function(t,e){var n=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,n)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(t,n){e.Image.fromObject(t.image,(function(i){var r=e.util.object.clone(t);r.image=i,n(new e.Image.filters.BlendImage(r))}))}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=Math.pow,i=Math.floor,r=Math.sqrt,o=Math.abs,s=Math.round,a=Math.sin,c=Math.ceil,l=e.Image.filters,u=e.util.createClass;l.Resize=u(l.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(t,e){return{uDelta:t.getUniformLocation(e,"uDelta"),uTaps:t.getUniformLocation(e,"uTaps")}},sendUniformData:function(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)},retrieveShader:function(t){var e=this.getFilterWindow(),n=this.type+"_"+e;if(!t.programCache.hasOwnProperty(n)){var i=this.generateShader(e);t.programCache[n]=this.createProgram(t.context,i)}return t.programCache[n]},getFilterWindow:function(){var t=this.tempScale;return Math.ceil(this.lanczosLobes/t)},getTaps:function(){for(var t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,n=this.getFilterWindow(),i=new Array(n),r=1;r<=n;r++)i[r-1]=t(r*e);return i},generateShader:function(t){for(var e=new Array(t),n=this.fragmentSourceTOP,i=1;i<=t;i++)e[i-1]=i+".0 * uDelta";return n+="uniform float uTaps["+t+"];\n",n+="void main() {\n",n+="  vec4 color = texture2D(uTexture, vTexCoord);\n",n+="  float sum = 1.0;\n",e.forEach((function(t,e){n+="  color += texture2D(uTexture, vTexCoord + "+t+") * uTaps["+e+"];\n",n+="  color += texture2D(uTexture, vTexCoord - "+t+") * uTaps["+e+"];\n",n+="  sum += 2.0 * uTaps["+e+"];\n"})),n+="  gl_FragColor = color / sum;\n",n+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(t){t.webgl?(t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceHeight=t.destinationHeight):this.applyTo2d(t)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(t){return function(e){if(e>=t||e<=-t)return 0;if(e<1.1920929e-7&&e>-1.1920929e-7)return 1;var n=(e*=Math.PI)/t;return a(e)/e*a(n)/n}},applyTo2d:function(t){var e=t.imageData,n=this.scaleX,i=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/i;var r,o=e.width,a=e.height,c=s(o*n),l=s(a*i);"sliceHack"===this.resizeType?r=this.sliceByTwo(t,o,a,c,l):"hermite"===this.resizeType?r=this.hermiteFastResize(t,o,a,c,l):"bilinear"===this.resizeType?r=this.bilinearFiltering(t,o,a,c,l):"lanczos"===this.resizeType&&(r=this.lanczosResize(t,o,a,c,l)),t.imageData=r},sliceByTwo:function(t,n,r,o,s){var a,c,l=t.imageData,u=!1,h=!1,f=.5*n,d=.5*r,p=e.filterBackend.resources,g=0,m=0,v=n,y=0;for(p.sliceByTwo||(p.sliceByTwo=document.createElement("canvas")),((a=p.sliceByTwo).width<1.5*n||a.height<r)&&(a.width=1.5*n,a.height=r),(c=a.getContext("2d")).clearRect(0,0,1.5*n,r),c.putImageData(l,0,0),o=i(o),s=i(s);!u||!h;)n=f,r=d,o<i(.5*f)?f=i(.5*f):(f=o,u=!0),s<i(.5*d)?d=i(.5*d):(d=s,h=!0),c.drawImage(a,g,m,n,r,v,y,f,d),g=v,m=y,y+=d;return c.getImageData(g,m,o,s)},lanczosResize:function(t,e,s,a,l){var u=t.imageData.data,h=t.ctx.createImageData(a,l),f=h.data,d=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,g=this.rcpScaleY,m=2/this.rcpScaleX,v=2/this.rcpScaleY,y=c(p*this.lanczosLobes/2),b=c(g*this.lanczosLobes/2),x={},C={},S={};return function t(c){var w,_,D,T,E,k,O,A,P,I,F;for(C.x=(c+.5)*p,S.x=i(C.x),w=0;w<l;w++){for(C.y=(w+.5)*g,S.y=i(C.y),E=0,k=0,O=0,A=0,P=0,_=S.x-y;_<=S.x+y;_++)if(!(_<0||_>=e)){I=i(1e3*o(_-C.x)),x[I]||(x[I]={});for(var M=S.y-b;M<=S.y+b;M++)M<0||M>=s||(F=i(1e3*o(M-C.y)),x[I][F]||(x[I][F]=d(r(n(I*m,2)+n(F*v,2))/1e3)),(D=x[I][F])>0&&(E+=D,k+=D*u[T=4*(M*e+_)],O+=D*u[T+1],A+=D*u[T+2],P+=D*u[T+3]))}f[T=4*(w*a+c)]=k/E,f[T+1]=O/E,f[T+2]=A/E,f[T+3]=P/E}return++c<a?t(c):h}(0)},bilinearFiltering:function(t,e,n,r,o){var s,a,c,l,u,h,f,d,p,g=0,m=this.rcpScaleX,v=this.rcpScaleY,y=4*(e-1),b=t.imageData.data,x=t.ctx.createImageData(r,o),C=x.data;for(c=0;c<o;c++)for(l=0;l<r;l++)for(u=m*l-(s=i(m*l)),h=v*c-(a=i(v*c)),p=4*(a*e+s),f=0;f<4;f++)d=b[p+f]*(1-u)*(1-h)+b[p+4+f]*u*(1-h)+b[p+y+f]*h*(1-u)+b[p+y+4+f]*u*h,C[g++]=d;return x},hermiteFastResize:function(t,e,n,s,a){for(var l=this.rcpScaleX,u=this.rcpScaleY,h=c(l/2),f=c(u/2),d=t.imageData.data,p=t.ctx.createImageData(s,a),g=p.data,m=0;m<a;m++)for(var v=0;v<s;v++){for(var y=4*(v+m*s),b=0,x=0,C=0,S=0,w=0,_=0,D=0,T=(m+.5)*u,E=i(m*u);E<(m+1)*u;E++)for(var k=o(T-(E+.5))/f,O=(v+.5)*l,A=k*k,P=i(v*l);P<(v+1)*l;P++){var I=o(O-(P+.5))/h,F=r(A+I*I);F>1&&F<-1||(b=2*F*F*F-3*F*F+1)>0&&(D+=b*d[(I=4*(P+E*e))+3],C+=b,d[I+3]<255&&(b=b*d[I+3]/250),S+=b*d[I],w+=b*d[I+1],_+=b*d[I+2],x+=b)}g[y]=S/x,g[y+1]=w/x,g[y+2]=_/x,g[y+3]=D/C}return p},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.Contrast=i(n.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(0!==this.contrast){var e,n=t.imageData.data,i=n.length,r=Math.floor(255*this.contrast),o=259*(r+255)/(255*(259-r));for(e=0;e<i;e+=4)n[e]=o*(n[e]-128)+128,n[e+1]=o*(n[e+1]-128)+128,n[e+2]=o*(n[e+2]-128)+128}},getUniformLocations:function(t,e){return{uContrast:t.getUniformLocation(e,"uContrast")}},sendUniformData:function(t,e){t.uniform1f(e.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.Saturation=i(n.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(0!==this.saturation){var e,n,i=t.imageData.data,r=i.length,o=-this.saturation;for(e=0;e<r;e+=4)n=Math.max(i[e],i[e+1],i[e+2]),i[e]+=n!==i[e]?(n-i[e])*o:0,i[e+1]+=n!==i[e+1]?(n-i[e+1])*o:0,i[e+2]+=n!==i[e+2]?(n-i[e+2])*o:0}},getUniformLocations:function(t,e){return{uSaturation:t.getUniformLocation(e,"uSaturation")}},sendUniformData:function(t,e){t.uniform1f(e.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.Blur=i(n.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var n,i,r=t.filterBackend.resources,o=t.imageData.width,s=t.imageData.height;r.blurLayer1||(r.blurLayer1=e.util.createCanvasElement(),r.blurLayer2=e.util.createCanvasElement()),n=r.blurLayer1,i=r.blurLayer2,n.width===o&&n.height===s||(i.width=n.width=o,i.height=n.height=s);var a,c,l,u,h=n.getContext("2d"),f=i.getContext("2d"),d=.06*this.blur*.5;for(h.putImageData(t.imageData,0,0),f.clearRect(0,0,o,s),u=-15;u<=15;u++)l=d*(c=u/15)*o+(a=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(c),f.drawImage(n,l,a),h.drawImage(i,0,0),f.globalAlpha=1,f.clearRect(0,0,i.width,i.height);for(u=-15;u<=15;u++)l=d*(c=u/15)*s+(a=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(c),f.drawImage(n,a,l),h.drawImage(i,0,0),f.globalAlpha=1,f.clearRect(0,0,i.width,i.height);t.ctx.drawImage(n,0,0);var p=t.ctx.getImageData(0,0,n.width,n.height);return h.globalAlpha=1,h.clearRect(0,0,n.width,n.height),p},getUniformLocations:function(t,e){return{delta:t.getUniformLocation(e,"uDelta")}},sendUniformData:function(t,e){var n=this.chooseRightDelta();t.uniform2fv(e.delta,n)},chooseRightDelta:function(){var t,e=1,n=[0,0];return this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio),t=e*this.blur*.12,this.horizontal?n[0]=t:n[1]=t,n}}),n.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.Gamma=i(n.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],n.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var e,n=t.imageData.data,i=this.gamma,r=n.length,o=1/i[0],s=1/i[1],a=1/i[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),e=0,r=256;e<r;e++)this.rVals[e]=255*Math.pow(e/255,o),this.gVals[e]=255*Math.pow(e/255,s),this.bVals[e]=255*Math.pow(e/255,a);for(e=0,r=n.length;e<r;e+=4)n[e]=this.rVals[n[e]],n[e+1]=this.gVals[n[e+1]],n[e+2]=this.bVals[n[e+2]]},getUniformLocations:function(t,e){return{uGamma:t.getUniformLocation(e,"uGamma")}},sendUniformData:function(t,e){t.uniform3fv(e.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.Composed=i(n.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach((function(e){e.applyTo(t)}))},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map((function(t){return t.toObject()}))})},isNeutralState:function(){return!this.subFilters.some((function(t){return!t.isNeutralState()}))}}),e.Image.filters.Composed.fromObject=function(t,n){var i=(t.subFilters||[]).map((function(t){return new e.Image.filters[t.type](t)})),r=new e.Image.filters.Composed({subFilters:i});return n&&n(r),r}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,i=e.util.createClass;n.HueRotation=i(n.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,n=e.util.cos(t),i=e.util.sin(t),r=Math.sqrt(1/3)*i,o=1-n;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=n+o/3,this.matrix[1]=1/3*o-r,this.matrix[2]=1/3*o+r,this.matrix[5]=1/3*o+r,this.matrix[6]=n+1/3*o,this.matrix[7]=1/3*o-r,this.matrix[10]=1/3*o-r,this.matrix[11]=1/3*o+r,this.matrix[12]=n+1/3*o},isNeutralState:function(t){return this.calculateMatrix(),n.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),n.BaseFilter.prototype.applyTo.call(this,t)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.clone;e.Text?e.warn("fabric.Text is already defined"):(e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),cacheProperties:e.Object.prototype.cacheProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),stroke:null,shadow:null,_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,e){this.styles=e&&e.styles||{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",e),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,e,n,i,r,o,s,a=0,c=this._textLines.length;a<c;a++)if(("justify"===this.textAlign||a!==c-1&&!this.isEndOfWrapping(a))&&(i=0,r=this._textLines[a],(e=this.getLineWidth(a))<this.width&&(s=this.textLines[a].match(this._reSpacesAndTabs)))){n=s.length,t=(this.width-e)/n;for(var l=0,u=r.length;l<=u;l++)o=this.__charBounds[a][l],this._reSpaceAndTab.test(r[l])?(o.width+=t,o.kernedWidth+=t,o.left+=i,i+=t):o.left+=i}},isEndOfWrapping:function(t){return t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t},_render:function(t){this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){"stroke"===this.paintFirst?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,e,n){t.textBaseline="alphabetic",t.font=this._getFontDeclaration(e,n)},calcTextWidth:function(){for(var t=this.getLineWidth(0),e=1,n=this._textLines.length;e<n;e++){var i=this.getLineWidth(e);i>t&&(t=i)}return t},_renderTextLine:function(t,e,n,i,r,o){this._renderChars(t,e,n,i,r,o)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var e,n,i,r,o,s,a=0,c=t.fillStyle,l=this._getLeftOffset(),u=this._getTopOffset(),h=0,f=0,d=0,p=this._textLines.length;d<p;d++)if(e=this.getHeightOfLine(d),this.textBackgroundColor||this.styleHas("textBackgroundColor",d)){i=this._textLines[d],n=this._getLineLeftOffset(d),f=0,h=0,r=this.getValueOfPropertyAt(d,0,"textBackgroundColor");for(var g=0,m=i.length;g<m;g++)o=this.__charBounds[d][g],(s=this.getValueOfPropertyAt(d,g,"textBackgroundColor"))!==r?(t.fillStyle=r,r&&t.fillRect(l+n+h,u+a,f,e/this.lineHeight),h=o.left,f=o.width,r=s):f+=o.kernedWidth;s&&(t.fillStyle=s,t.fillRect(l+n+h,u+a,f,e/this.lineHeight)),a+=e}else a+=e;t.fillStyle=c,this._removeShadow(t)}},getFontCache:function(t){var n=t.fontFamily.toLowerCase();e.charWidthsCache[n]||(e.charWidthsCache[n]={});var i=e.charWidthsCache[n],r=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return i[r]||(i[r]={}),i[r]},_applyCharStyles:function(t,e,n,i,r){this._setFillStyles(e,r),this._setStrokeStyles(e,r),e.font=this._getFontDeclaration(r)},_measureChar:function(t,e,n,i){var r,o,s,a,c=this.getFontCache(e),l=n+t,u=this._getFontDeclaration(e)===this._getFontDeclaration(i),h=e.fontSize/this.CACHE_FONT_SIZE;if(n&&void 0!==c[n]&&(s=c[n]),void 0!==c[t]&&(a=r=c[t]),u&&void 0!==c[l]&&(a=(o=c[l])-s),void 0===r||void 0===s||void 0===o){var f=this.getMeasuringContext();this._setTextStyles(f,e,!0)}return void 0===r&&(a=r=f.measureText(t).width,c[t]=r),void 0===s&&u&&n&&(s=f.measureText(n).width,c[n]=s),u&&void 0===o&&(o=f.measureText(l).width,c[l]=o,a=o-s),{width:r*h,kernedWidth:a*h}},getHeightOfChar:function(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")},measureLine:function(t){var e=this._measureLine(t);return 0!==this.charSpacing&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e},_measureLine:function(t){var e,n,i,r,o=0,s=this._textLines[t],a=new Array(s.length);for(this.__charBounds[t]=a,e=0;e<s.length;e++)n=s[e],r=this._getGraphemeBox(n,t,e,i),a[e]=r,o+=r.kernedWidth,i=n;return a[e]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize},{width:o,numOfSpaces:0}},_getGraphemeBox:function(t,e,n,i,r){var o,s=this.getCompleteStyleDeclaration(e,n),a=i?this.getCompleteStyleDeclaration(e,n-1):{},c=this._measureChar(t,s,i,a),l=c.kernedWidth,u=c.width;0!==this.charSpacing&&(u+=o=this._getWidthOfCharSpacing(),l+=o);var h={width:u,left:0,height:s.fontSize,kernedWidth:l,deltaY:s.deltaY};if(n>0&&!r){var f=this.__charBounds[e][n-1];h.left=f.left+f.width+c.kernedWidth-c.width}return h},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var e=this._textLines[t],n=this.getHeightOfChar(t,0),i=1,r=e.length;i<r;i++)n=Math.max(this.getHeightOfChar(t,i),n);return this.__lineHeights[t]=n*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,e=0,n=0,i=this._textLines.length;n<i;n++)t=this.getHeightOfLine(n),e+=n===i-1?t/this.lineHeight:t;return e},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,e){t.save();for(var n=0,i=this._getLeftOffset(),r=this._getTopOffset(),o=this._applyPatternGradientTransform(t,"fillText"===e?this.fill:this.stroke),s=0,a=this._textLines.length;s<a;s++){var c=this.getHeightOfLine(s),l=c/this.lineHeight,u=this._getLineLeftOffset(s);this._renderTextLine(e,t,this._textLines[s],i+u-o.offsetX,r+n+l-o.offsetY,s),n+=c}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,e,n,i,r,o){var s,a,c,l,u=this.getHeightOfLine(o),h=-1!==this.textAlign.indexOf("justify"),f="",d=0,p=!h&&0===this.charSpacing&&this.isEmptyStyles(o);if(e.save(),r-=u*this._fontSizeFraction/this.lineHeight,p)return this._renderChar(t,e,o,0,this.textLines[o],i,r,u),void e.restore();for(var g=0,m=n.length-1;g<=m;g++)l=g===m||this.charSpacing,f+=n[g],c=this.__charBounds[o][g],0===d?(i+=c.kernedWidth-c.width,d+=c.width):d+=c.kernedWidth,h&&!l&&this._reSpaceAndTab.test(n[g])&&(l=!0),l||(s=s||this.getCompleteStyleDeclaration(o,g),a=this.getCompleteStyleDeclaration(o,g+1),l=this._hasStyleChanged(s,a)),l&&(this._renderChar(t,e,o,g,f,i,r,u),f="",s=a,i+=d,d=0);e.restore()},_renderChar:function(t,e,n,i,r,o,s){var a=this._getStyleDeclaration(n,i),c=this.getCompleteStyleDeclaration(n,i),l="fillText"===t&&c.fill,u="strokeText"===t&&c.stroke&&c.strokeWidth;(u||l)&&(a&&e.save(),this._applyCharStyles(t,e,n,i,c),a&&a.textBackgroundColor&&this._removeShadow(e),a&&a.deltaY&&(s+=a.deltaY),l&&e.fillText(r,o,s),u&&e.strokeText(r,o,s),a&&e.restore())},setSuperscript:function(t,e){return this._setScript(t,e,this.superscript)},setSubscript:function(t,e){return this._setScript(t,e,this.subscript)},_setScript:function(t,e,n){var i=this.get2DCursorLocation(t,!0),r=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),o=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),s={fontSize:r*n.size,deltaY:o+r*n.baseline};return this.setSelectionStyles(s,t,e),this},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.deltaY!==e.deltaY},_hasStyleChangedForSvg:function(t,e){return this._hasStyleChanged(t,e)||t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough},_getLineLeftOffset:function(t){var e=this.getLineWidth(t);return"center"===this.textAlign?(this.width-e)/2:"right"===this.textAlign?this.width-e:"justify-center"===this.textAlign&&this.isEndOfWrapping(t)?(this.width-e)/2:"justify-right"===this.textAlign&&this.isEndOfWrapping(t)?this.width-e:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){return this.__lineWidths[t]?this.__lineWidths[t]:(e=""===this._textLines[t]?0:this.measureLine(t).width,this.__lineWidths[t]=e,e);var e},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,e,n){var i=this._getStyleDeclaration(t,e);return i&&"undefined"!==typeof i[n]?i[n]:this[n]},_renderTextDecoration:function(t,e){if(this[e]||this.styleHas(e)){for(var n,i,r,o,s,a,c,l,u,h,f,d,p,g,m,v,y=this._getLeftOffset(),b=this._getTopOffset(),x=this._getWidthOfCharSpacing(),C=0,S=this._textLines.length;C<S;C++)if(n=this.getHeightOfLine(C),this[e]||this.styleHas(e,C)){c=this._textLines[C],g=n/this.lineHeight,o=this._getLineLeftOffset(C),h=0,f=0,l=this.getValueOfPropertyAt(C,0,e),v=this.getValueOfPropertyAt(C,0,"fill"),u=b+g*(1-this._fontSizeFraction),i=this.getHeightOfChar(C,0),s=this.getValueOfPropertyAt(C,0,"deltaY");for(var w=0,_=c.length;w<_;w++)d=this.__charBounds[C][w],p=this.getValueOfPropertyAt(C,w,e),m=this.getValueOfPropertyAt(C,w,"fill"),r=this.getHeightOfChar(C,w),a=this.getValueOfPropertyAt(C,w,"deltaY"),(p!==l||m!==v||r!==i||a!==s)&&f>0?(t.fillStyle=v,l&&v&&t.fillRect(y+o+h,u+this.offsets[e]*i+s,f,this.fontSize/15),h=d.left,f=d.width,l=p,v=m,i=r,s=a):f+=d.kernedWidth;t.fillStyle=m,p&&m&&t.fillRect(y+o+h,u+this.offsets[e]*i+s,f-x,this.fontSize/15),b+=n}else b+=n;this._removeShadow(t)}},_getFontDeclaration:function(t,n){var i=t||this,r=this.fontFamily,o=e.Text.genericFonts.indexOf(r.toLowerCase())>-1,s=void 0===r||r.indexOf("'")>-1||r.indexOf(",")>-1||r.indexOf('"')>-1||o?i.fontFamily:'"'+i.fontFamily+'"';return[e.isLikelyNode?i.fontWeight:i.fontStyle,e.isLikelyNode?i.fontStyle:i.fontWeight,n?this.CACHE_FONT_SIZE+"px":i.fontSize+"px",s].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var n=t.split(this._reNewline),i=new Array(n.length),r=["\n"],o=[],s=0;s<n.length;s++)i[s]=e.util.string.graphemeSplit(n[s]),o=o.concat(i[s],r);return o.pop(),{_unwrappedLines:i,lines:n,graphemeText:o,graphemeLines:i}},toObject:function(t){var e=["text","fontSize","fontWeight","fontFamily","fontStyle","lineHeight","underline","overline","linethrough","textAlign","textBackgroundColor","charSpacing"].concat(t),i=this.callSuper("toObject",e);return i.styles=n(this.styles,!0),i},set:function(t,e){this.callSuper("set",t,e);var n=!1;if("object"===typeof t)for(var i in t)n=n||-1!==this._dimensionAffectingProps.indexOf(i);else n=-1!==this._dimensionAffectingProps.indexOf(t);return n&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,i,r){if(!t)return i(null);var o=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES),s=o.textAnchor||"left";if((r=e.util.object.extend(r?n(r):{},o)).top=r.top||0,r.left=r.left||0,o.textDecoration){var a=o.textDecoration;-1!==a.indexOf("underline")&&(r.underline=!0),-1!==a.indexOf("overline")&&(r.overline=!0),-1!==a.indexOf("line-through")&&(r.linethrough=!0),delete r.textDecoration}"dx"in o&&(r.left+=o.dx),"dy"in o&&(r.top+=o.dy),"fontSize"in r||(r.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var c="";"textContent"in t?c=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(c=t.firstChild.data),c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var l=r.strokeWidth;r.strokeWidth=0;var u=new e.Text(c,r),h=u.getScaledHeight()/u.height,f=((u.height+u.strokeWidth)*u.lineHeight-u.height)*h,d=u.getScaledHeight()+f,p=0;"center"===s&&(p=u.getScaledWidth()/2),"right"===s&&(p=u.getScaledWidth()),u.set({left:u.left-p,top:u.top-(d-u.fontSize*(.07+u._fontSizeFraction))/u.lineHeight,strokeWidth:"undefined"!==typeof l?l:1}),i(u)},e.Text.fromObject=function(t,n){return e.Object._fromObject("Text",t,n,"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text))}(e),r.util.object.extend(r.Text.prototype,{isEmptyStyles:function(t){if(!this.styles)return!0;if("undefined"!==typeof t&&!this.styles[t])return!0;var e="undefined"===typeof t?this.styles:{line:this.styles[t]};for(var n in e)for(var i in e[n])for(var r in e[n][i])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||""===t)return!1;if("undefined"!==typeof e&&!this.styles[e])return!1;var n="undefined"===typeof e?this.styles:{0:this.styles[e]};for(var i in n)for(var r in n[i])if("undefined"!==typeof n[i][r][t])return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||""===t)return!1;var e,n,i=this.styles,r=0,o=!0,s=0;for(var a in i){for(var c in e=0,i[a]){var l;r++,(l=i[a][c]).hasOwnProperty(t)?(n?l[t]!==n&&(o=!1):n=l[t],l[t]===this[t]&&delete l[t]):o=!1,0!==Object.keys(l).length?e++:delete i[a][c]}0===e&&delete i[a]}for(var u=0;u<this._textLines.length;u++)s+=this._textLines[u].length;o&&r===s&&(this[t]=n,this.removeStyle(t))},removeStyle:function(t){if(this.styles&&t&&""!==t){var e,n,i,r=this.styles;for(n in r){for(i in e=r[n])delete e[i][t],0===Object.keys(e[i]).length&&delete e[i];0===Object.keys(e).length&&delete r[n]}}},_extendStyles:function(t,e){var n=this.get2DCursorLocation(t);this._getLineStyle(n.lineIndex)||this._setLineStyle(n.lineIndex),this._getStyleDeclaration(n.lineIndex,n.charIndex)||this._setStyleDeclaration(n.lineIndex,n.charIndex,{}),r.util.object.extend(this._getStyleDeclaration(n.lineIndex,n.charIndex),e)},get2DCursorLocation:function(t,e){"undefined"===typeof t&&(t=this.selectionStart);for(var n=e?this._unwrappedTextLines:this._textLines,i=n.length,r=0;r<i;r++){if(t<=n[r].length)return{lineIndex:r,charIndex:t};t-=n[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:n[r-1].length<t?n[r-1].length:t}},getSelectionStyles:function(t,e,n){"undefined"===typeof t&&(t=this.selectionStart||0),"undefined"===typeof e&&(e=this.selectionEnd||t);for(var i=[],r=t;r<e;r++)i.push(this.getStyleAtPosition(r,n));return i},getStyleAtPosition:function(t,e){var n=this.get2DCursorLocation(t);return(e?this.getCompleteStyleDeclaration(n.lineIndex,n.charIndex):this._getStyleDeclaration(n.lineIndex,n.charIndex))||{}},setSelectionStyles:function(t,e,n){"undefined"===typeof e&&(e=this.selectionStart||0),"undefined"===typeof n&&(n=this.selectionEnd||e);for(var i=e;i<n;i++)this._extendStyles(i,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var n=this.styles&&this.styles[t];return n?n[e]:null},getCompleteStyleDeclaration:function(t,e){for(var n,i=this._getStyleDeclaration(t,e)||{},r={},o=0;o<this._styleProperties.length;o++)r[n=this._styleProperties[o]]="undefined"===typeof i[n]?this[n]:i[n];return r},_setStyleDeclaration:function(t,e,n){this.styles[t][e]=n},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}}),function(){function t(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}r.IText=r.util.createClass(r.Text,r.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,caching:!0,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,e){this.callSuper("initialize",t,e),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this.canvas.contextTop,n=this.canvas.viewportTransform;e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(e),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),this._clearTextArea(e),t||e.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this._getCursorBoundaries(),e=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,e):this.renderSelection(t,e),e.restore()}},_clearTextArea:function(t){var e=this.width+4,n=this.height+4;t.clearRect(-e/2,-n/2,e,n)},_getCursorBoundaries:function(t){"undefined"===typeof t&&(t=this.selectionStart);var e=this._getLeftOffset(),n=this._getTopOffset(),i=this._getCursorBoundariesOffsets(t);return{left:e,top:n,leftOffset:i.left,topOffset:i.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var e,n,i,r,o=0,s=0,a=this.get2DCursorLocation(t);i=a.charIndex,n=a.lineIndex;for(var c=0;c<n;c++)o+=this.getHeightOfLine(c);e=this._getLineLeftOffset(n);var l=this.__charBounds[n][i];return l&&(s=l.left),0!==this.charSpacing&&i===this._textLines[n].length&&(s-=this._getWidthOfCharSpacing()),r={top:o,left:e+(s>0?s:0)},this.cursorOffsetCache=r,this.cursorOffsetCache},renderCursor:function(t,e){var n=this.get2DCursorLocation(),i=n.lineIndex,r=n.charIndex>0?n.charIndex-1:0,o=this.getValueOfPropertyAt(i,r,"fontSize"),s=this.scaleX*this.canvas.getZoom(),a=this.cursorWidth/s,c=t.topOffset,l=this.getValueOfPropertyAt(i,r,"deltaY");c+=(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-o*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,e),e.fillStyle=this.getValueOfPropertyAt(i,r,"fill"),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-a/2,c+t.top+l,a,o)},renderSelection:function(t,e){for(var n=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,i=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,r=-1!==this.textAlign.indexOf("justify"),o=this.get2DCursorLocation(n),s=this.get2DCursorLocation(i),a=o.lineIndex,c=s.lineIndex,l=o.charIndex<0?0:o.charIndex,u=s.charIndex<0?0:s.charIndex,h=a;h<=c;h++){var f,d=this._getLineLeftOffset(h)||0,p=this.getHeightOfLine(h),g=0,m=0;if(h===a&&(g=this.__charBounds[a][l].left),h>=a&&h<c)m=r&&!this.isEndOfWrapping(h)?this.width:this.getLineWidth(h)||5;else if(h===c)if(0===u)m=this.__charBounds[c][u].left;else{var v=this._getWidthOfCharSpacing();m=this.__charBounds[c][u-1].left+this.__charBounds[c][u-1].width-v}f=p,(this.lineHeight<1||h===c&&this.lineHeight>1)&&(p/=this.lineHeight),this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",e.fillRect(t.left+d+g,t.top+t.topOffset+p,m-g,1)):(e.fillStyle=this.selectionColor,e.fillRect(t.left+d+g,t.top+t.topOffset,m-g,p)),t.topOffset+=f}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}}),r.IText.fromObject=function(e,n){if(t(e),e.styles)for(var i in e.styles)for(var o in e.styles[i])t(e.styles[i][o]);r.Object._fromObject("IText",e,n,"text")}}(),function(){var t=r.util.object.clone;r.util.object.extend(r.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",(function(){var e=t.canvas;e&&(e._hasITextHandlers||(e._hasITextHandlers=!0,t._initCanvasHandlers(e)),e._iTextInstances=e._iTextInstances||[],e._iTextInstances.push(t))}))},initRemovedHandler:function(){var t=this;this.on("removed",(function(){var e=t.canvas;e&&(e._iTextInstances=e._iTextInstances||[],r.util.removeFromArray(e._iTextInstances,t),0===e._iTextInstances.length&&(e._hasITextHandlers=!1,t._removeCanvasHandlers(e)))}))},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.__isMousedown=!1}))},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,n,i){var r;return r={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:n,onComplete:function(){r.isAborted||t[i]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return r.isAborted}}),r},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout((function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")}),100)},initDelayedCursor:function(t){var e=this,n=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout((function(){e._tick()}),n)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,e=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&e&&e.clearContext(e.contextTop||e.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var e=0,n=t-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)e++,n--;for(;/\S/.test(this._text[n])&&n>-1;)e++,n--;return t-e},findWordBoundaryRight:function(t){var e=0,n=t;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)e++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)e++,n++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,n=t-1;!/\n/.test(this._text[n])&&n>-1;)e++,n--;return t-e},findLineBoundaryRight:function(t){for(var e=0,n=t;!/\n/.test(this._text[n])&&n<this._text.length;)e++,n++;return t+e},searchWordBoundary:function(t,e){for(var n=this._reSpace.test(this._text[t])?t-1:t,i=this._text[n],r=/[ \n\.,;!\?\-]/;!r.test(i)&&n>0&&n<this._text.length;)n+=e,i=this._text[n];return r.test(i)&&"\n"!==i&&(n+=1===e?0:1),n},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),n=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),n=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.selected=!1,t.isEditing&&t.exitEditing()}))},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(this.__isMousedown&&this.isEditing){var e=this.getSelectionStartFromPointer(t.e),n=this.selectionStart,i=this.selectionEnd;(e===this.__selectionStartOnMouseDown&&n!==i||n!==e&&i!==e)&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===n&&this.selectionEnd===i||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,e,n){var i=n.slice(0,t),o=r.util.string.graphemeSplit(i).length;if(t===e)return{selectionStart:o,selectionEnd:o};var s=n.slice(t,e);return{selectionStart:o,selectionEnd:o+r.util.string.graphemeSplit(s).length}},fromGraphemeToStringSelection:function(t,e,n){var i=n.slice(0,t).join("").length;return t===e?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+n.slice(t,e).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),n=this.get2DCursorLocation(t),i=n.lineIndex,o=n.charIndex,s=this.getValueOfPropertyAt(i,o,"fontSize")*this.lineHeight,a=e.leftOffset,c=this.calcTransformMatrix(),l={x:e.left+a,y:e.top+e.topOffset+s},u=this.canvas.upperCanvasEl,h=u.width,f=u.height,d=h-s,p=f-s,g=u.clientWidth/h,m=u.clientHeight/f;return l=r.util.transformPoint(l,c),(l=r.util.transformPoint(l,this.canvas.viewportTransform)).x*=g,l.y*=m,l.x<0&&(l.x=0),l.x>d&&(l.x=d),l.y<0&&(l.y=0),l.y>p&&(l.y=p),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:s+"px",charHeight:s}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&(this.hiddenTextarea.blur&&this.hiddenTextarea.blur(),this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null),this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,e){var n,i,r=this.get2DCursorLocation(t,!0),o=this.get2DCursorLocation(e,!0),s=r.lineIndex,a=r.charIndex,c=o.lineIndex,l=o.charIndex;if(s!==c){if(this.styles[s])for(n=a;n<this._unwrappedTextLines[s].length;n++)delete this.styles[s][n];if(this.styles[c])for(n=l;n<this._unwrappedTextLines[c].length;n++)(i=this.styles[c][n])&&(this.styles[s]||(this.styles[s]={}),this.styles[s][a+n-l]=i);for(n=s+1;n<=c;n++)delete this.styles[n];this.shiftLineStyles(c,s-c)}else if(this.styles[s]){i=this.styles[s];var u,h,f=l-a;for(n=a;n<l;n++)delete i[n];for(h in this.styles[s])(u=parseInt(h,10))>=l&&(i[u-f]=i[h],delete i[h])}},shiftLineStyles:function(e,n){var i=t(this.styles);for(var r in this.styles){var o=parseInt(r,10);o>e&&(this.styles[o+n]=i[o],i[o-n]||delete this.styles[o])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(e,n,i,r){var o,s={},a=!1;for(var c in i||(i=1),this.shiftLineStyles(e,i),this.styles[e]&&(o=this.styles[e][0===n?n:n-1]),this.styles[e]){var l=parseInt(c,10);l>=n&&(a=!0,s[l-n]=this.styles[e][c],delete this.styles[e][c])}for(a?this.styles[e+i]=s:delete this.styles[e+i];i>1;)i--,r&&r[i]?this.styles[e+i]={0:t(r[i])}:o?this.styles[e+i]={0:t(o)}:delete this.styles[e+i];this._forceClearCache=!0},insertCharStyleObject:function(e,n,i,r){this.styles||(this.styles={});var o=this.styles[e],s=o?t(o):{};for(var a in i||(i=1),s){var c=parseInt(a,10);c>=n&&(o[c+i]=s[c],s[c-i]||delete o[c])}if(this._forceClearCache=!0,r)for(;i--;)Object.keys(r[i]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][n+i]=t(r[i]));else if(o)for(var l=o[n?n-1:1];l&&i--;)this.styles[e][n+i]=t(l)},insertNewStyleBlock:function(t,e,n){for(var i=this.get2DCursorLocation(e,!0),r=[0],o=0,s=0;s<t.length;s++)"\n"===t[s]?r[++o]=0:r[o]++;r[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,r[0],n),n=n&&n.slice(r[0]+1)),o&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+r[0],o);for(s=1;s<o;s++)r[s]>0?this.insertCharStyleObject(i.lineIndex+s,0,r[s],n):n&&(this.styles[i.lineIndex+s][0]=n[0]),n=n&&n.slice(r[s]+1);r[s]>0&&this.insertCharStyleObject(i.lineIndex+s,0,r[s],n)},setSelectionStartEndWithShift:function(t,e,n){n<=t?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=n):n>t&&n<e?"right"===this._selectionDirection?this.selectionEnd=n:this.selectionStart=n:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=n)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),r.util.object.extend(r.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("mousedblclick",(function(t){this.selectWord(this.getSelectionStartFromPointer(t.e))})),this.on("tripleclick",(function(t){this.selectLine(this.getSelectionStartFromPointer(t.e))}))},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.__isMousedown=!0,this.selected&&this.setCursorByClick(t.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||this===this.canvas._activeObject&&(this.selected=!0)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&1!==t.e.button)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),n=this.selectionStart,i=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(n,i,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e=this.getLocalPointer(t),n=0,i=0,r=0,o=0,s=0,a=0,c=this._textLines.length;a<c&&r<=e.y;a++)r+=this.getHeightOfLine(a)*this.scaleY,s=a,a>0&&(o+=this._textLines[a-1].length+this.missingNewlineOffset(a-1));i=this._getLineLeftOffset(s)*this.scaleX;for(var l=0,u=this._textLines[s].length;l<u&&(n=i,(i+=this.__charBounds[s][l].kernedWidth*this.scaleX)<=e.x);l++)o++;return this._getNewSelectionStartFromOffset(e,n,i,o,u)},_getNewSelectionStartFromOffset:function(t,e,n,i,r){var o=t.x-e,s=n-t.x,a=i+(s>o||s<0?0:1);return this.flipX&&(a=r-a),a>this._text.length&&(a=this._text.length),a}}),r.util.object.extend(r.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=r.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; paddingｰtop: "+t.fontSize+";",r.document.body.appendChild(this.hiddenTextarea),r.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),r.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),r.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),r.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),r.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),r.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),r.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),r.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),r.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(r.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing&&!this.inCompositionMode){if(t.keyCode in this.keysMap)this[this.keysMap[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown&&(t.ctrlKey||t.metaKey)))return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),this.isEditing){var n,i,o=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,s=this._text.length,a=o.length,c=a-s;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var l=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),u=this.selectionStart>l.selectionStart;this.selectionStart!==this.selectionEnd?(n=this._text.slice(this.selectionStart,this.selectionEnd),c+=this.selectionEnd-this.selectionStart):a<s&&(n=u?this._text.slice(this.selectionEnd+c,this.selectionEnd):this._text.slice(this.selectionStart,this.selectionStart-c)),i=o.slice(l.selectionEnd-c,l.selectionEnd),n&&n.length&&(this.selectionStart!==this.selectionEnd?this.removeStyleFromTo(this.selectionStart,this.selectionEnd):u?this.removeStyleFromTo(this.selectionEnd-n.length,this.selectionEnd):this.removeStyleFromTo(this.selectionEnd,this.selectionEnd+n.length)),i.length&&(e&&i.join("")===r.copiedText&&!r.disableStyleCopyPaste?this.insertNewStyleBlock(i,this.selectionStart,r.copiedTextStyle):this.insertNewStyleBlock(i,this.selectionStart)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(r.copiedText=this.getSelectedText(),r.disableStyleCopyPaste?r.copiedTextStyle=null:r.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||r.window.clipboardData},_getWidthBeforeCursor:function(t,e){var n,i=this._getLineLeftOffset(t);return e>0&&(i+=(n=this.__charBounds[t][e-1]).left+n.width),i},getDownCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),i=this.get2DCursorLocation(n),r=i.lineIndex;if(r===this._textLines.length-1||t.metaKey||34===t.keyCode)return this._text.length-n;var o=i.charIndex,s=this._getWidthBeforeCursor(r,o),a=this._getIndexOnLine(r+1,s);return this._textLines[r].slice(o).length+a+1+this.missingNewlineOffset(r)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),i=this.get2DCursorLocation(n),r=i.lineIndex;if(0===r||t.metaKey||33===t.keyCode)return-n;var o=i.charIndex,s=this._getWidthBeforeCursor(r,o),a=this._getIndexOnLine(r-1,s),c=this._textLines[r].slice(0,o),l=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+a-c.length+(1-l)},_getIndexOnLine:function(t,e){for(var n,i,r=this._textLines[t],o=this._getLineLeftOffset(t),s=0,a=0,c=r.length;a<c;a++)if((o+=n=this.__charBounds[t][a].width)>e){i=!0;var l=o-n,u=o,h=Math.abs(l-e);s=Math.abs(u-e)<h?a:a-1;break}return i||(s=r.length-1),s},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var n=this["get"+t+"CursorOffset"](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),0!==n&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,n){var i;if(t.altKey)i=this["findWordBoundary"+n](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===n?-1:1,!0;i=this["findLineBoundary"+n](this[e])}if(void 0!==typeof i&&this[e]!==i)return this[e]=i,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var n="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?n+="Shift":n+="outShift",this[n](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){"undefined"===typeof e&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,n,i){"undefined"===typeof i&&(i=n),i>n&&this.removeStyleFromTo(n,i);var o=r.util.string.graphemeSplit(t);this.insertNewStyleBlock(o,n,e),this._text=[].concat(this._text.slice(0,n),o,this._text.slice(i)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(t){for(var e=0,n=0,i=0,r={},o=0;o<t.graphemeLines.length;o++)"\n"===t.graphemeText[i]&&o>0?(n=0,i++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[i])&&o>0&&(n++,i++),r[o]={line:e,offset:n},i+=t.graphemeLines[o].length,n+=t.graphemeLines[o].length;return r},styleHas:function(t,n){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[n];i&&(n=i.line)}return e.Text.prototype.styleHas.call(this,t,n)},isEmptyStyles:function(t){var e,n,i=0,r=!1,o=this._styleMap[t],s=this._styleMap[t+1];for(var a in o&&(t=o.line,i=o.offset),s&&(r=s.line===t,e=s.offset),n="undefined"===typeof t?this.styles:{line:this.styles[t]})for(var c in n[a])if(c>=i&&(!r||c<e))for(var l in n[a][c])return!1;return!0},_getStyleDeclaration:function(t,e){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[t];if(!n)return null;t=n.line,e=n.offset+e}return this.callSuper("_getStyleDeclaration",t,e)},_setStyleDeclaration:function(t,e,n){var i=this._styleMap[t];t=i.line,e=i.offset+e,this.styles[t][e]=n},_deleteStyleDeclaration:function(t,e){var n=this._styleMap[t];t=n.line,e=n.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){var e=this._styleMap[t];return!!this.styles[e.line]},_setLineStyle:function(t){var e=this._styleMap[t];this.styles[e.line]={}},_wrapText:function(t,e){var n,i=[];for(this.isWrapping=!0,n=0;n<t.length;n++)i=i.concat(this._wrapLine(t[n],n,e));return this.isWrapping=!1,i},_measureWord:function(t,e,n){var i,r=0;n=n||0;for(var o=0,s=t.length;o<s;o++){r+=this._getGraphemeBox(t[o],e,o+n,i,!0).kernedWidth,i=t[o]}return r},_wrapLine:function(t,n,i,r){var o=0,s=this.splitByGrapheme,a=[],c=[],l=s?e.util.string.graphemeSplit(t):t.split(this._wordJoiners),u="",h=0,f=s?"":" ",d=0,p=0,g=0,m=!0,v=s?0:this._getWidthOfCharSpacing();r=r||0;0===l.length&&l.push([]),i-=r;for(var y=0;y<l.length;y++)u=s?l[y]:e.util.string.graphemeSplit(l[y]),d=this._measureWord(u,n,h),h+=u.length,(o+=p+d-v)>=i&&!m?(a.push(c),c=[],o=d,m=!0):o+=v,m||s||c.push(f),c=c.concat(u),p=this._measureWord([f],n,h),h++,m=!1,d>g&&(g=d);return y&&a.push(c),g+r>this.dynamicMinWidth&&(this.dynamicMinWidth=g-v+r),a},isEndOfWrapping:function(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line},missingNewlineOffset:function(t){return this.splitByGrapheme?this.isEndOfWrapping(t)?1:0:1},_splitTextIntoLines:function(t){for(var n=e.Text.prototype._splitTextIntoLines.call(this,t),i=this._wrapText(n.lines,this.width),r=new Array(i.length),o=0;o<i.length;o++)r[o]=i[o].join("");return n.lines=r,n.graphemeLines=i,n},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var t={};for(var e in this._styleMap)this._textLines[e]&&(t[this._styleMap[e].line]=1);for(var e in this.styles)t[e]||delete this.styles[e]},toObject:function(t){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(t))}}),e.Textbox.fromObject=function(t,n){return e.Object._fromObject("Textbox",t,n,"text")}}(e),function(){var t=r.Canvas.prototype._setObjectScale;r.Canvas.prototype._setObjectScale=function(e,n,i,o,s,a,c){var l,u=n.target,h=e.x*u.scaleX/c.x,f=e.y*u.scaleY/c.y;if(!("x"===s&&u instanceof r.Textbox))return t.call(r.Canvas.prototype,e,n,i,o,s,a,c);var d=u._getTransformedDimensions().x,p=u.width*(e.x/d);return n.newScaleX=h,n.newScaleY=f,p>=u.getMinWidth()?(l=p!==u.width,u.set("width",p),l):void 0},r.util.object.extend(r.Textbox.prototype,{_removeExtraneousStyles:function(){for(var t in this._styleMap)this._textLines[t]||delete this.styles[this._styleMap[t].line]}})}()},function(t,e,n){(function(t){var n;!function(){var i="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},r=i._,o=Array.prototype,s=Object.prototype,a="undefined"!==typeof Symbol?Symbol.prototype:null,c=o.push,l=o.slice,u=s.toString,h=s.hasOwnProperty,f=Array.isArray,d=Object.keys,p=Object.create,g=function(){},m=function(t){return t instanceof m?t:this instanceof m?void(this._wrapped=t):new m(t)};e.nodeType?i._=m:(!t.nodeType&&t.exports&&(e=t.exports=m),e._=m),m.VERSION="1.9.1";var v,y=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}},b=function(t,e,n){return m.iteratee!==v?m.iteratee(t,e):null==t?m.identity:m.isFunction(t)?y(t,e,n):m.isObject(t)&&!m.isArray(t)?m.matcher(t):m.property(t)};m.iteratee=v=function(t,e){return b(t,e,1/0)};var x=function(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),i=Array(n),r=0;r<n;r++)i[r]=arguments[r+e];switch(e){case 0:return t.call(this,i);case 1:return t.call(this,arguments[0],i);case 2:return t.call(this,arguments[0],arguments[1],i)}var o=Array(e+1);for(r=0;r<e;r++)o[r]=arguments[r];return o[e]=i,t.apply(this,o)}},C=function(t){if(!m.isObject(t))return{};if(p)return p(t);g.prototype=t;var e=new g;return g.prototype=null,e},S=function(t){return function(e){return null==e?void 0:e[t]}},w=function(t,e){return null!=t&&h.call(t,e)},_=function(t,e){for(var n=e.length,i=0;i<n;i++){if(null==t)return;t=t[e[i]]}return n?t:void 0},D=Math.pow(2,53)-1,T=S("length"),E=function(t){var e=T(t);return"number"==typeof e&&e>=0&&e<=D};m.each=m.forEach=function(t,e,n){var i,r;if(e=y(e,n),E(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var o=m.keys(t);for(i=0,r=o.length;i<r;i++)e(t[o[i]],o[i],t)}return t},m.map=m.collect=function(t,e,n){e=b(e,n);for(var i=!E(t)&&m.keys(t),r=(i||t).length,o=Array(r),s=0;s<r;s++){var a=i?i[s]:s;o[s]=e(t[a],a,t)}return o};var k=function(t){var e=function(e,n,i,r){var o=!E(e)&&m.keys(e),s=(o||e).length,a=t>0?0:s-1;for(r||(i=e[o?o[a]:a],a+=t);a>=0&&a<s;a+=t){var c=o?o[a]:a;i=n(i,e[c],c,e)}return i};return function(t,n,i,r){var o=arguments.length>=3;return e(t,y(n,r,4),i,o)}};m.reduce=m.foldl=m.inject=k(1),m.reduceRight=m.foldr=k(-1),m.find=m.detect=function(t,e,n){var i=(E(t)?m.findIndex:m.findKey)(t,e,n);if(void 0!==i&&-1!==i)return t[i]},m.filter=m.select=function(t,e,n){var i=[];return e=b(e,n),m.each(t,(function(t,n,r){e(t,n,r)&&i.push(t)})),i},m.reject=function(t,e,n){return m.filter(t,m.negate(b(e)),n)},m.every=m.all=function(t,e,n){e=b(e,n);for(var i=!E(t)&&m.keys(t),r=(i||t).length,o=0;o<r;o++){var s=i?i[o]:o;if(!e(t[s],s,t))return!1}return!0},m.some=m.any=function(t,e,n){e=b(e,n);for(var i=!E(t)&&m.keys(t),r=(i||t).length,o=0;o<r;o++){var s=i?i[o]:o;if(e(t[s],s,t))return!0}return!1},m.contains=m.includes=m.include=function(t,e,n,i){return E(t)||(t=m.values(t)),("number"!=typeof n||i)&&(n=0),m.indexOf(t,e,n)>=0},m.invoke=x((function(t,e,n){var i,r;return m.isFunction(e)?r=e:m.isArray(e)&&(i=e.slice(0,-1),e=e[e.length-1]),m.map(t,(function(t){var o=r;if(!o){if(i&&i.length&&(t=_(t,i)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)}))})),m.pluck=function(t,e){return m.map(t,m.property(e))},m.where=function(t,e){return m.filter(t,m.matcher(e))},m.findWhere=function(t,e){return m.find(t,m.matcher(e))},m.max=function(t,e,n){var i,r,o=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,c=(t=E(t)?t:m.values(t)).length;a<c;a++)null!=(i=t[a])&&i>o&&(o=i);else e=b(e,n),m.each(t,(function(t,n,i){((r=e(t,n,i))>s||r===-1/0&&o===-1/0)&&(o=t,s=r)}));return o},m.min=function(t,e,n){var i,r,o=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,c=(t=E(t)?t:m.values(t)).length;a<c;a++)null!=(i=t[a])&&i<o&&(o=i);else e=b(e,n),m.each(t,(function(t,n,i){((r=e(t,n,i))<s||r===1/0&&o===1/0)&&(o=t,s=r)}));return o},m.shuffle=function(t){return m.sample(t,1/0)},m.sample=function(t,e,n){if(null==e||n)return E(t)||(t=m.values(t)),t[m.random(t.length-1)];var i=E(t)?m.clone(t):m.values(t),r=T(i);e=Math.max(Math.min(e,r),0);for(var o=r-1,s=0;s<e;s++){var a=m.random(s,o),c=i[s];i[s]=i[a],i[a]=c}return i.slice(0,e)},m.sortBy=function(t,e,n){var i=0;return e=b(e,n),m.pluck(m.map(t,(function(t,n,r){return{value:t,index:i++,criteria:e(t,n,r)}})).sort((function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index})),"value")};var O=function(t,e){return function(n,i,r){var o=e?[[],[]]:{};return i=b(i,r),m.each(n,(function(e,r){var s=i(e,r,n);t(o,e,s)})),o}};m.groupBy=O((function(t,e,n){w(t,n)?t[n].push(e):t[n]=[e]})),m.indexBy=O((function(t,e,n){t[n]=e})),m.countBy=O((function(t,e,n){w(t,n)?t[n]++:t[n]=1}));var A=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;m.toArray=function(t){return t?m.isArray(t)?l.call(t):m.isString(t)?t.match(A):E(t)?m.map(t,m.identity):m.values(t):[]},m.size=function(t){return null==t?0:E(t)?t.length:m.keys(t).length},m.partition=O((function(t,e,n){t[n?0:1].push(e)}),!0),m.first=m.head=m.take=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[0]:m.initial(t,t.length-e)},m.initial=function(t,e,n){return l.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},m.last=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[t.length-1]:m.rest(t,Math.max(0,t.length-e))},m.rest=m.tail=m.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},m.compact=function(t){return m.filter(t,Boolean)};var P=function(t,e,n,i){for(var r=(i=i||[]).length,o=0,s=T(t);o<s;o++){var a=t[o];if(E(a)&&(m.isArray(a)||m.isArguments(a)))if(e)for(var c=0,l=a.length;c<l;)i[r++]=a[c++];else P(a,e,n,i),r=i.length;else n||(i[r++]=a)}return i};m.flatten=function(t,e){return P(t,e,!1)},m.without=x((function(t,e){return m.difference(t,e)})),m.uniq=m.unique=function(t,e,n,i){m.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=b(n,i));for(var r=[],o=[],s=0,a=T(t);s<a;s++){var c=t[s],l=n?n(c,s,t):c;e&&!n?(s&&o===l||r.push(c),o=l):n?m.contains(o,l)||(o.push(l),r.push(c)):m.contains(r,c)||r.push(c)}return r},m.union=x((function(t){return m.uniq(P(t,!0,!0))})),m.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=T(t);i<r;i++){var o=t[i];if(!m.contains(e,o)){var s;for(s=1;s<n&&m.contains(arguments[s],o);s++);s===n&&e.push(o)}}return e},m.difference=x((function(t,e){return e=P(e,!0,!0),m.filter(t,(function(t){return!m.contains(e,t)}))})),m.unzip=function(t){for(var e=t&&m.max(t,T).length||0,n=Array(e),i=0;i<e;i++)n[i]=m.pluck(t,i);return n},m.zip=x(m.unzip),m.object=function(t,e){for(var n={},i=0,r=T(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n};var I=function(t){return function(e,n,i){n=b(n,i);for(var r=T(e),o=t>0?0:r-1;o>=0&&o<r;o+=t)if(n(e[o],o,e))return o;return-1}};m.findIndex=I(1),m.findLastIndex=I(-1),m.sortedIndex=function(t,e,n,i){for(var r=(n=b(n,i,1))(e),o=0,s=T(t);o<s;){var a=Math.floor((o+s)/2);n(t[a])<r?o=a+1:s=a}return o};var F=function(t,e,n){return function(i,r,o){var s=0,a=T(i);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(n&&o&&a)return i[o=n(i,r)]===r?o:-1;if(r!==r)return(o=e(l.call(i,s,a),m.isNaN))>=0?o+s:-1;for(o=t>0?s:a-1;o>=0&&o<a;o+=t)if(i[o]===r)return o;return-1}};m.indexOf=F(1,m.findIndex,m.sortedIndex),m.lastIndexOf=F(-1,m.findLastIndex),m.range=function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;o<i;o++,t+=n)r[o]=t;return r},m.chunk=function(t,e){if(null==e||e<1)return[];for(var n=[],i=0,r=t.length;i<r;)n.push(l.call(t,i,i+=e));return n};var M=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var o=C(t.prototype),s=t.apply(o,r);return m.isObject(s)?s:o};m.bind=x((function(t,e,n){if(!m.isFunction(t))throw new TypeError("Bind must be called on a function");var i=x((function(r){return M(t,i,e,this,n.concat(r))}));return i})),m.partial=x((function(t,e){var n=m.partial.placeholder,i=function(){for(var r=0,o=e.length,s=Array(o),a=0;a<o;a++)s[a]=e[a]===n?arguments[r++]:e[a];for(;r<arguments.length;)s.push(arguments[r++]);return M(t,i,this,this,s)};return i})),m.partial.placeholder=m,m.bindAll=x((function(t,e){var n=(e=P(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var i=e[n];t[i]=m.bind(t[i],t)}})),m.memoize=function(t,e){var n=function(i){var r=n.cache,o=""+(e?e.apply(this,arguments):i);return w(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n},m.delay=x((function(t,e,n){return setTimeout((function(){return t.apply(null,n)}),e)})),m.defer=m.partial(m.delay,m,1),m.throttle=function(t,e,n){var i,r,o,s,a=0;n||(n={});var c=function(){a=!1===n.leading?0:m.now(),i=null,s=t.apply(r,o),i||(r=o=null)},l=function(){var l=m.now();a||!1!==n.leading||(a=l);var u=e-(l-a);return r=this,o=arguments,u<=0||u>e?(i&&(clearTimeout(i),i=null),a=l,s=t.apply(r,o),i||(r=o=null)):i||!1===n.trailing||(i=setTimeout(c,u)),s};return l.cancel=function(){clearTimeout(i),a=0,i=r=o=null},l},m.debounce=function(t,e,n){var i,r,o=function(e,n){i=null,n&&(r=t.apply(e,n))},s=x((function(s){if(i&&clearTimeout(i),n){var a=!i;i=setTimeout(o,e),a&&(r=t.apply(this,s))}else i=m.delay(o,e,this,s);return r}));return s.cancel=function(){clearTimeout(i),i=null},s},m.wrap=function(t,e){return m.partial(e,t)},m.negate=function(t){return function(){return!t.apply(this,arguments)}},m.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},m.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},m.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},m.once=m.partial(m.before,2),m.restArguments=x;var L=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],j=function(t,e){var n=R.length,i=t.constructor,r=m.isFunction(i)&&i.prototype||s,o="constructor";for(w(t,o)&&!m.contains(e,o)&&e.push(o);n--;)(o=R[n])in t&&t[o]!==r[o]&&!m.contains(e,o)&&e.push(o)};m.keys=function(t){if(!m.isObject(t))return[];if(d)return d(t);var e=[];for(var n in t)w(t,n)&&e.push(n);return L&&j(t,e),e},m.allKeys=function(t){if(!m.isObject(t))return[];var e=[];for(var n in t)e.push(n);return L&&j(t,e),e},m.values=function(t){for(var e=m.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},m.mapObject=function(t,e,n){e=b(e,n);for(var i=m.keys(t),r=i.length,o={},s=0;s<r;s++){var a=i[s];o[a]=e(t[a],a,t)}return o},m.pairs=function(t){for(var e=m.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},m.invert=function(t){for(var e={},n=m.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},m.functions=m.methods=function(t){var e=[];for(var n in t)m.isFunction(t[n])&&e.push(n);return e.sort()};var B=function(t,e){return function(n){var i=arguments.length;if(e&&(n=Object(n)),i<2||null==n)return n;for(var r=1;r<i;r++)for(var o=arguments[r],s=t(o),a=s.length,c=0;c<a;c++){var l=s[c];e&&void 0!==n[l]||(n[l]=o[l])}return n}};m.extend=B(m.allKeys),m.extendOwn=m.assign=B(m.keys),m.findKey=function(t,e,n){e=b(e,n);for(var i,r=m.keys(t),o=0,s=r.length;o<s;o++)if(e(t[i=r[o]],i,t))return i};var U,z,N=function(t,e,n){return e in n};m.pick=x((function(t,e){var n={},i=e[0];if(null==t)return n;m.isFunction(i)?(e.length>1&&(i=y(i,e[1])),e=m.allKeys(t)):(i=N,e=P(e,!1,!1),t=Object(t));for(var r=0,o=e.length;r<o;r++){var s=e[r],a=t[s];i(a,s,t)&&(n[s]=a)}return n})),m.omit=x((function(t,e){var n,i=e[0];return m.isFunction(i)?(i=m.negate(i),e.length>1&&(n=e[1])):(e=m.map(P(e,!1,!1),String),i=function(t,n){return!m.contains(e,n)}),m.pick(t,i,n)})),m.defaults=B(m.allKeys,!0),m.create=function(t,e){var n=C(t);return e&&m.extendOwn(n,e),n},m.clone=function(t){return m.isObject(t)?m.isArray(t)?t.slice():m.extend({},t):t},m.tap=function(t,e){return e(t),t},m.isMatch=function(t,e){var n=m.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),o=0;o<i;o++){var s=n[o];if(e[s]!==r[s]||!(s in r))return!1}return!0},U=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return!1;if(t!==t)return e!==e;var r=typeof t;return("function"===r||"object"===r||"object"==typeof e)&&z(t,e,n,i)},z=function(t,e,n,i){t instanceof m&&(t=t._wrapped),e instanceof m&&(e=e._wrapped);var r=u.call(t);if(r!==u.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t===""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e;case"[object Symbol]":return a.valueOf.call(t)===a.valueOf.call(e)}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,c=e.constructor;if(s!==c&&!(m.isFunction(s)&&s instanceof s&&m.isFunction(c)&&c instanceof c)&&"constructor"in t&&"constructor"in e)return!1}i=i||[];for(var l=(n=n||[]).length;l--;)if(n[l]===t)return i[l]===e;if(n.push(t),i.push(e),o){if((l=t.length)!==e.length)return!1;for(;l--;)if(!U(t[l],e[l],n,i))return!1}else{var h,f=m.keys(t);if(l=f.length,m.keys(e).length!==l)return!1;for(;l--;)if(h=f[l],!w(e,h)||!U(t[h],e[h],n,i))return!1}return n.pop(),i.pop(),!0},m.isEqual=function(t,e){return U(t,e)},m.isEmpty=function(t){return null==t||(E(t)&&(m.isArray(t)||m.isString(t)||m.isArguments(t))?0===t.length:0===m.keys(t).length)},m.isElement=function(t){return!(!t||1!==t.nodeType)},m.isArray=f||function(t){return"[object Array]"===u.call(t)},m.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},m.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],(function(t){m["is"+t]=function(e){return u.call(e)==="[object "+t+"]"}})),m.isArguments(arguments)||(m.isArguments=function(t){return w(t,"callee")});var W=i.document&&i.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof W&&(m.isFunction=function(t){return"function"==typeof t||!1}),m.isFinite=function(t){return!m.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},m.isNaN=function(t){return m.isNumber(t)&&isNaN(t)},m.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===u.call(t)},m.isNull=function(t){return null===t},m.isUndefined=function(t){return void 0===t},m.has=function(t,e){if(!m.isArray(e))return w(t,e);for(var n=e.length,i=0;i<n;i++){var r=e[i];if(null==t||!h.call(t,r))return!1;t=t[r]}return!!n},m.noConflict=function(){return i._=r,this},m.identity=function(t){return t},m.constant=function(t){return function(){return t}},m.noop=function(){},m.property=function(t){return m.isArray(t)?function(e){return _(e,t)}:S(t)},m.propertyOf=function(t){return null==t?function(){}:function(e){return m.isArray(e)?_(t,e):t[e]}},m.matcher=m.matches=function(t){return t=m.extendOwn({},t),function(e){return m.isMatch(e,t)}},m.times=function(t,e,n){var i=Array(Math.max(0,t));e=y(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i},m.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},m.now=Date.now||function(){return(new Date).getTime()};var H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},X=m.invert(H),G=function(t){var e=function(e){return t[e]},n="(?:"+m.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}};m.escape=G(H),m.unescape=G(X),m.result=function(t,e,n){m.isArray(e)||(e=[e]);var i=e.length;if(!i)return m.isFunction(n)?n.call(t):n;for(var r=0;r<i;r++){var o=null==t?void 0:t[e[r]];void 0===o&&(o=n,r=i),t=m.isFunction(o)?o.call(t):o}return t};var Y=0;m.uniqueId=function(t){var e=++Y+"";return t?t+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,V={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Z=/\\|'|\r|\n|\u2028|\u2029/g,Q=function(t){return"\\"+V[t]};m.template=function(t,e,n){!e&&n&&(e=n),e=m.defaults({},e,m.templateSettings);var i,r=RegExp([(e.escape||q).source,(e.interpolate||q).source,(e.evaluate||q).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(r,(function(e,n,i,r,a){return s+=t.slice(o,a).replace(Z,Q),o=a+e.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?s+="'+\n((__t=("+i+"))==null?'':__t)+\n'":r&&(s+="';\n"+r+"\n__p+='"),e})),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(e.variable||"obj","_",s)}catch(l){throw l.source=s,l}var a=function(t){return i.call(this,t,m)},c=e.variable||"obj";return a.source="function("+c+"){\n"+s+"}",a},m.chain=function(t){var e=m(t);return e._chain=!0,e};var K=function(t,e){return t._chain?m(e).chain():e};m.mixin=function(t){return m.each(m.functions(t),(function(e){var n=m[e]=t[e];m.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),K(this,n.apply(m,t))}})),m},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=o[t];m.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],K(this,n)}})),m.each(["concat","join","slice"],(function(t){var e=o[t];m.prototype[t]=function(){return K(this,e.apply(this._wrapped,arguments))}})),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return String(this._wrapped)},void 0===(n=function(){return m}.apply(e,[]))||(t.exports=n)}()}).call(this,n(40)(t))},function(t,e,n){var i=n(143),r=n(144),o=n(145);t.exports=function(t,e){return i(t)||r(t,e)||o()}},function(t,e,n){var i=n(22),r=n(77);(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.3.6",mode:i?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports=!1},function(t,e,n){var i=n(81),r=n(46);t.exports=function(t){return i(r(t))}},function(t,e,n){var i=n(2),r=n(21),o=n(10),s=n(5),a=n(29),c=n(47),l=n(33),u=l.get,h=l.enforce,f=String(c).split("toString");r("inspectSource",(function(t){return c.call(t)})),(t.exports=function(t,e,n,r){var c=!!r&&!!r.unsafe,l=!!r&&!!r.enumerable,u=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof e||s(n,"name")||o(n,"name",e),h(n).source=f.join("string"==typeof e?e:"")),t!==i?(c?!u&&t[e]&&(l=!0):delete t[e],l?t[e]=n:o(t,e,n)):l?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||c.call(this)}))},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){var i,r,o;!function(s){"use strict";r=[n(9)],void 0===(o="function"===typeof(i=function(t){var e=t.global,n=t.transform,i=e.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),r=e.ArrayBuffer&&ArrayBuffer.prototype.slice||function(t,e){e=e||this.byteLength-t;var n=new Uint8Array(this,t,e),i=new Uint8Array(e);return i.set(n),i.buffer},o={jpeg:{65505:[],65517:[]}};function s(n,s,a,c){var l=this;function u(s,u){if(!(e.DataView&&i&&n&&n.size>=12&&"image/jpeg"===n.type))return s(c);var h=a.maxMetaDataSize||262144;t.readFile(i.call(n,0,h),(function(t){var e=new DataView(t);if(65496!==e.getUint16(0))return u(new Error("Invalid JPEG file: Missing JPEG marker."));for(var n,i,h,f,d=2,p=e.byteLength-4,g=d;d<p&&((n=e.getUint16(d))>=65504&&n<=65519||65534===n);){if(d+(i=e.getUint16(d+2)+2)>e.byteLength){console.log("Invalid JPEG metadata: Invalid segment size.");break}if((h=o.jpeg[n])&&!a.disableMetaDataParsers)for(f=0;f<h.length;f+=1)h[f].call(l,e,d,i,c,a);g=d+=i}!a.disableImageHead&&g>6&&(c.imageHead=r.call(t,0,g)),s(c)}),u,"readAsArrayBuffer")||s(c)}return a=a||{},e.Promise&&"function"!==typeof s?(c=a=s||{},new Promise(u)):(c=c||{},u(s,s))}function a(t,e,n){return t&&e&&n?new Blob([n,i.call(t,e.byteLength)],{type:"image/jpeg"}):null}t.transform=function(i,r,o,a,c){t.requiresMetaData(r)?s(a,(function(s){s!==c&&(e.console&&console.log(s),s=c),n.call(t,i,r,o,a,s)}),r,c=c||{}):n.apply(t,arguments)},t.blobSlice=i,t.bufferSlice=r,t.replaceHead=function(t,n,i){var r={maxMetaDataSize:256,disableMetaDataParsers:!0};if(!i&&e.Promise)return s(t,r).then((function(e){return a(t,e.imageHead,n)}));s(t,(function(e){i(a(t,e.imageHead,n))}),r)},t.parseMetaData=s,t.metaDataParsers=o})?i.apply(e,r):i)||(t.exports=o)}()},function(t,e){function n(t){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(e){return"function"===typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=i=function(t){return n(t)}:t.exports=i=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},i(e)}t.exports=i},function(t,e){t.exports={waitConditionAsync:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return new Promise((function(n){t()?n():setTimeout((function i(){t()?n():setTimeout(i,e)}),e)}))},delay:function(t){return new Promise((function(e){setTimeout(e,t)}))},acceleratedBtnPress:function(t,e,n,i,r){var o,s=n;t.onmousedown=t.ontouchstart=function(t){!function t(n){e(n),o=setTimeout(t,s),s=Math.max(s/i,r)}(t)},t.onmouseout=t.onmouseup=t.ontouchend=t.ontouchcancel=function(){clearTimeout(o),s=n}}}},function(t,e,n){var i=n(2),r=n(10);t.exports=function(t,e){try{r(i,t,e)}catch(n){i[t]=e}return e}},function(t,e,n){var i=n(2),r=n(12),o=i.document,s=r(o)&&r(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(13),r=n(80),o=n(31),s=n(23),a=n(43),c=n(5),l=n(42),u=Object.getOwnPropertyDescriptor;e.f=i?u:function(t,e){if(t=s(t),e=a(e,!0),l)try{return u(t,e)}catch(n){}if(c(t,e))return o(!r.f.call(t,e),t[e])}},function(t,e,n){var i,r,o,s=n(82),a=n(2),c=n(12),l=n(10),u=n(5),h=n(34),f=n(35),d=a.WeakMap;if(s){var p=new d,g=p.get,m=p.has,v=p.set;i=function(t,e){return v.call(p,t,e),e},r=function(t){return g.call(p,t)||{}},o=function(t){return m.call(p,t)}}else{var y=h("state");f[y]=!0,i=function(t,e){return l(t,y,e),e},r=function(t){return u(t,y)?t[y]:{}},o=function(t){return u(t,y)}}t.exports={set:i,get:r,has:o,enforce:function(t){return o(t)?r(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=r(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var i=n(21),r=n(44),o=i("keys");t.exports=function(t){return o[t]||(o[t]=r(t))}},function(t,e){t.exports={}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,n){var i=n(14).f,r=n(5),o=n(4)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){var i=n(16);t.exports=i("navigator","userAgent")||""},function(t,e){},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){t.exports=n(2)},function(t,e,n){var i=n(13),r=n(11),o=n(30);t.exports=!i&&!r((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var i=n(12);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+i).toString(36)}},function(t,e,n){var i=n(2),r=n(32).f,o=n(10),s=n(24),a=n(29),c=n(83),l=n(51);t.exports=function(t,e){var n,u,h,f,d,p=t.target,g=t.global,m=t.stat;if(n=g?i:m?i[p]||a(p,{}):(i[p]||{}).prototype)for(u in e){if(f=e[u],h=t.noTargetGet?(d=r(n,u))&&d.value:n[u],!l(g?u:p+(m?".":"#")+u,t.forced)&&void 0!==h){if(typeof f===typeof h)continue;c(f,h)}(t.sham||h&&h.sham)&&o(f,"sham",!0),s(n,u,f,t)}}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){var i=n(21);t.exports=i("native-function-to-string",Function.toString)},function(t,e,n){var i=n(5),r=n(23),o=n(86).indexOf,s=n(35);t.exports=function(t,e){var n,a=r(t),c=0,l=[];for(n in a)!i(s,n)&&i(a,n)&&l.push(n);for(;e.length>c;)i(a,n=e[c++])&&(~o(l,n)||l.push(n));return l}},function(t,e,n){var i=n(50),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(11),r=/#|\.prototype\./,o=function(t,e){var n=a[s(t)];return n==l||n!=c&&("function"==typeof e?i(e):!!e)},s=o.normalize=function(t){return String(t).replace(r,".").toLowerCase()},a=o.data={},c=o.NATIVE="N",l=o.POLYFILL="P";t.exports=o},function(t,e,n){var i=n(25);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var i,r,o,s=n(2),a=n(11),c=n(15),l=n(52),u=n(54),h=n(30),f=n(38),d=s.location,p=s.setImmediate,g=s.clearImmediate,m=s.process,v=s.MessageChannel,y=s.Dispatch,b=0,x={},C=function(t){if(x.hasOwnProperty(t)){var e=x[t];delete x[t],e()}},S=function(t){return function(){C(t)}},w=function(t){C(t.data)},_=function(t){s.postMessage(t+"",d.protocol+"//"+d.host)};p&&g||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return x[++b]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},i(b),b},g=function(t){delete x[t]},"process"==c(m)?i=function(t){m.nextTick(S(t))}:y&&y.now?i=function(t){y.now(S(t))}:v&&!/(iphone|ipod|ipad).*applewebkit/i.test(f)?(o=(r=new v).port2,r.port1.onmessage=w,i=l(o.postMessage,o,1)):!s.addEventListener||"function"!=typeof postMessage||s.importScripts||a(_)?i="onreadystatechange"in h("script")?function(t){u.appendChild(h("script")).onreadystatechange=function(){u.removeChild(this),C(t)}}:function(t){setTimeout(S(t),0)}:(i=_,s.addEventListener("message",w,!1))),t.exports={set:p,clear:g}},function(t,e,n){var i=n(16);t.exports=i("document","documentElement")},function(t,e,n){"use strict";var i=n(25),r=function(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)};t.exports.f=function(t){return new r(t)}},function(t,e,n){var i=n(6),r=n(107),o=n(36),s=n(35),a=n(54),c=n(30),l=n(34)("IE_PROTO"),u=function(){},h=function(){var t,e=c("iframe"),n=o.length;for(e.style.display="none",a.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),h=t.F;n--;)delete h.prototype[o[n]];return h()};t.exports=Object.create||function(t,e){var n;return null!==t?(u.prototype=i(t),n=new u,u.prototype=null,n[l]=t):n=h(),void 0===e?n:r(n,e)},s[l]=!0},function(t,e,n){"use strict";var i,r,o,s=n(58),a=n(10),c=n(5),l=n(4),u=n(22),h=l("iterator"),f=!1;[].keys&&("next"in(o=[].keys())?(r=s(s(o)))!==Object.prototype&&(i=r):f=!0),void 0==i&&(i={}),u||c(i,h)||a(i,h,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:f}},function(t,e,n){var i=n(5),r=n(111),o=n(34),s=n(112),a=o("IE_PROTO"),c=Object.prototype;t.exports=s?Object.getPrototypeOf:function(t){return t=r(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?c:null}},function(t,e,n){var i=n(7),r=n(8);t.exports=function(){var t=r.baseUrl+"/api";return{generateFile:function(e,n,o,s,a,c,l,u,h){var f={texts:n,circularTexts:o,vectorPlaceholders:c,id:l,fileName:u,clientVersion:r.clientVersion,sessionId:h,imagesParameters:s,vectorsParameters:a},d=null;switch(e.toLowerCase()){case"dxf":d=t+"/EPSEngrave/GenerateDXF";break;case"eps":d=t+"/EPSEngrave/GenerateEPS";break;case"pdf":d=t+"/EPSEngrave/GeneratePDF";break;case"png":d=t+"/EPSEngrave/GeneratePNG";break;case"jpg":d=t+"/EPSEngrave/GenerateJPG";break;case"ai":d=t+"/EPSEngrave/GenerateAI";break;case"ofm":d=t+"/EPSEngrave/GenerateOFM";break;default:d=t+"/EPSEngrave/GenerateEPS"}return i.ajax({type:"POST",url:d,crossDomain:!0,data:f,dataType:"json"})},generateFileAuth:function(e,n,o,s,a,c,l,u,h,f){var d={texts:n,circularTexts:o,vectorPlaceholders:c,id:l,fileName:u,clientVersion:r.clientVersion,sessionId:h,imagesParameters:s,vectorsParameters:a},p={format:e,"x-api-key":f};return i.ajax({type:"POST",url:t+"/EPSEngrave/GenerateProductionFileAuth?"+i.param(p),crossDomain:!0,data:d,dataType:"json"})},generateProductionFile:function(e,n,o,s,a,c,l,u,h){var f={texts:e,circularTexts:n,vectorPlaceholders:a,id:c,fileName:l,clientVersion:r.clientVersion,sessionId:u,imagesParameters:o,vectorsParameters:s,uploadToFTP:h};return i.ajax({type:"POST",url:t+"/EPSEngrave/GenerateProductionFile",crossDomain:!0,data:f,dataType:"json"})},renameExportedFile:function(e,n,r){var o={oldFileName:n,newFileName:r,productId:e};return i.ajax({type:"POST",url:t+"/EPSEngrave/RenameExportedFile",crossDomain:!0,data:o,dataType:"json"})},requestFutureProductionFile:function(e,n,o,s,a,c,l,u){var h={texts:e,circularTexts:n,vectorPlaceholders:a,id:c,fileName:l,clientVersion:r.clientVersion,sessionId:u,imagesParameters:o,vectorsParameters:s};return i.ajax({type:"POST",url:t+"/EPSEngrave/RequestFutureProductionFile",crossDomain:!0,data:h,dataType:"json"})}}}()},function(t,e,n){t.exports=n(9),n(61),n(26),n(121),n(62),n(122),n(63),n(123),n(124)},function(t,e,n){var i,r,o;!function(s){"use strict";r=[n(9)],void 0===(o="function"===typeof(i=function(t){var e=t.transform;t.createCanvas=function(e,n,i){if(i&&t.global.OffscreenCanvas)return new OffscreenCanvas(e,n);var r=document.createElement("canvas");return r.width=e,r.height=n,r},t.transform=function(n,i,r,o,s){e.call(t,t.scale(n,i,s),i,r,o,s)},t.transformCoordinates=function(){},t.getTransformedOptions=function(t,e){var n,i,r,o,s=e.aspectRatio;if(!s)return e;for(i in n={},e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n.crop=!0,(r=t.naturalWidth||t.width)/(o=t.naturalHeight||t.height)>s?(n.maxWidth=o*s,n.maxHeight=o):(n.maxWidth=r,n.maxHeight=r/s),n},t.drawImage=function(t,e,n,i,r,o,s,a,c){var l=e.getContext("2d");return!1===c.imageSmoothingEnabled?(l.msImageSmoothingEnabled=!1,l.imageSmoothingEnabled=!1):c.imageSmoothingQuality&&(l.imageSmoothingQuality=c.imageSmoothingQuality),l.drawImage(t,n,i,r,o,0,0,s,a),l},t.requiresCanvas=function(t){return t.canvas||t.crop||!!t.aspectRatio},t.scale=function(e,n,i){n=n||{},i=i||{};var r,o,s,a,c,l,u,h,f,d,p,g,m=e.getContext||t.requiresCanvas(n)&&!!t.global.HTMLCanvasElement,v=e.naturalWidth||e.width,y=e.naturalHeight||e.height,b=v,x=y;function C(){var t=Math.max((s||b)/b,(a||x)/x);t>1&&(b*=t,x*=t)}function S(){var t=Math.min((r||b)/b,(o||x)/x);t<1&&(b*=t,x*=t)}if(m&&(u=(n=t.getTransformedOptions(e,n,i)).left||0,h=n.top||0,n.sourceWidth?(c=n.sourceWidth,void 0!==n.right&&void 0===n.left&&(u=v-c-n.right)):c=v-u-(n.right||0),n.sourceHeight?(l=n.sourceHeight,void 0!==n.bottom&&void 0===n.top&&(h=y-l-n.bottom)):l=y-h-(n.bottom||0),b=c,x=l),r=n.maxWidth,o=n.maxHeight,s=n.minWidth,a=n.minHeight,m&&r&&o&&n.crop?(b=r,x=o,(p=c/l-r/o)<0?(l=o*c/r,void 0===n.top&&void 0===n.bottom&&(h=(y-l)/2)):p>0&&(c=r*l/o,void 0===n.left&&void 0===n.right&&(u=(v-c)/2))):((n.contain||n.cover)&&(s=r=r||s,a=o=o||a),n.cover?(S(),C()):(C(),S())),m){if((f=n.pixelRatio)>1&&(!e.style.width||Math.floor(parseFloat(e.style.width,10))!==Math.floor(v/f))&&(b*=f,x*=f),t.orientationCropBug&&!e.getContext&&(u||h||c!==v||l!==y)&&(p=e,e=t.createCanvas(v,y,!0),t.drawImage(p,e,0,0,v,y,v,y,n)),(d=n.downsamplingRatio)>0&&d<1&&b<c&&x<l)for(;c*d>b;)g=t.createCanvas(c*d,l*d,!0),t.drawImage(e,g,u,h,c,l,g.width,g.height,n),u=0,h=0,c=g.width,l=g.height,e=g;return g=t.createCanvas(b,x),t.transformCoordinates(g,n,i),f>1&&(g.style.width=g.width/f+"px"),t.drawImage(e,g,u,h,c,l,b,x,n).setTransform(1,0,0,1,0,0),g}return e.width=b,e.height=x,e}})?i.apply(e,r):i)||(t.exports=o)}()},function(t,e,n){var i,r,o;!function(s){"use strict";r=[n(9),n(26)],void 0===(o="function"===typeof(i=function(t){function e(t){t&&(Object.defineProperty(this,"map",{value:this.ifds[t].map}),Object.defineProperty(this,"tags",{value:this.tags&&this.tags[t]||{}}))}e.prototype.map={Orientation:274,Thumbnail:"ifd1",Blob:513,Exif:34665,GPSInfo:34853,Interoperability:40965},e.prototype.ifds={ifd1:{name:"Thumbnail",map:e.prototype.map},34665:{name:"Exif",map:{}},34853:{name:"GPSInfo",map:{}},40965:{name:"Interoperability",map:{}}},e.prototype.get=function(t){return this[t]||this[this.map[t]]};var n={1:{getValue:function(t,e){return t.getUint8(e)},size:1},2:{getValue:function(t,e){return String.fromCharCode(t.getUint8(e))},size:1,ascii:!0},3:{getValue:function(t,e,n){return t.getUint16(e,n)},size:2},4:{getValue:function(t,e,n){return t.getUint32(e,n)},size:4},5:{getValue:function(t,e,n){return t.getUint32(e,n)/t.getUint32(e+4,n)},size:8},9:{getValue:function(t,e,n){return t.getInt32(e,n)},size:4},10:{getValue:function(t,e,n){return t.getInt32(e,n)/t.getInt32(e+4,n)},size:8}};function i(t,e,i,r,o,s){var a,c,l,u,h,f,d=n[r];if(d){if(!((c=(a=d.size*o)>4?e+t.getUint32(i+8,s):i+8)+a>t.byteLength)){if(1===o)return d.getValue(t,c,s);for(l=[],u=0;u<o;u+=1)l[u]=d.getValue(t,c+u*d.size,s);if(d.ascii){for(h="",u=0;u<l.length&&"\0"!==(f=l[u]);u+=1)h+=f;return h}return l}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")}function r(t,e,n){return(!t||t[n])&&(!e||!0!==e[n])}function o(t,e,n,o,s,a,c,l){var u,h,f,d,p,g;if(n+6>t.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((h=n+2+12*(u=t.getUint16(n,o)))+4>t.byteLength)){for(f=0;f<u;f+=1)d=n+2+12*f,r(c,l,p=t.getUint16(d,o))&&(g=i(t,e,d,t.getUint16(d+2,o),t.getUint32(d+4,o),o),s[p]=g,a&&(a[p]=d));return t.getUint32(h,o)}console.log("Invalid Exif data: Invalid directory size.")}}n[7]=n[1],t.parseExifData=function(n,i,s,a,c){if(!c.disableExif){var l,u,h,f=c.includeExifTags,d=c.excludeExifTags||{34665:{37500:!0}},p=i+10;if(1165519206===n.getUint32(i+4))if(p+8>n.byteLength)console.log("Invalid Exif data: Invalid segment size.");else if(0===n.getUint16(i+8)){switch(n.getUint16(p)){case 18761:l=!0;break;case 19789:l=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}42===n.getUint16(p+2,l)?(u=n.getUint32(p+4,l),a.exif=new e,c.disableExifOffsets||(a.exifOffsets=new e,a.exifTiffOffset=p,a.exifLittleEndian=l),(u=o(n,p,p+u,l,a.exif,a.exifOffsets,f,d))&&r(f,d,"ifd1")&&(a.exif.ifd1=u,a.exifOffsets&&(a.exifOffsets.ifd1=p+u)),Object.keys(a.exif.ifds).forEach((function(t){!function(t,n,i,r,s,a,c){var l=t.exif[n];l&&(t.exif[n]=new e(n),t.exifOffsets&&(t.exifOffsets[n]=new e(n)),o(i,r,r+l,s,t.exif[n],t.exifOffsets&&t.exifOffsets[n],a&&a[n],c&&c[n]))}(a,t,n,p,l,f,d)})),(h=a.exif.ifd1)&&h[513]&&(h[513]=function(e,n,i){if(i){if(!(n+i>e.byteLength))return new Blob([t.bufferSlice.call(e.buffer,n,n+i)],{type:"image/jpeg"});console.log("Invalid Exif data: Invalid thumbnail data.")}}(n,p+h[513],h[514]))):console.log("Invalid Exif data: Missing TIFF marker.")}else console.log("Invalid Exif data: Missing byte alignment offset.")}},t.metaDataParsers.jpeg[65505].push(t.parseExifData),t.exifWriters={274:function(t,e,n){var i=e.exifOffsets[274];return i?(new DataView(t,i+8,2).setUint16(0,n,e.exifLittleEndian),t):t}},t.writeExifData=function(e,n,i,r){return t.exifWriters[n.exif.map[i]](e,n,r)},t.ExifMap=e})?i.apply(e,r):i)||(t.exports=o)}()},function(t,e,n){var i,r,o;!function(s){"use strict";r=[n(9),n(26)],void 0===(o="function"===typeof(i=function(t){function e(){}function n(t,e,n,i,r){return"binary"===e.types[t]?new Blob([n.buffer.slice(i,i+r)]):"Uint16"===e.types[t]?n.getUint16(i):function(t,e,n){for(var i="",r=e+n,o=e;o<r;o+=1)i+=String.fromCharCode(t.getUint8(o));return i}(n,i,r)}function i(t,e){return void 0===t?e:t instanceof Array?(t.push(e),t):[t,e]}function r(t,e,r,o,s,a){for(var c,l,u,h=e+r,f=e;f<h;)28===t.getUint8(f)&&2===t.getUint8(f+1)&&(u=t.getUint8(f+2),s&&!s[u]||a&&a[u]||(l=t.getInt16(f+3),c=n(u,o.iptc,t,f+5,l),o.iptc[u]=i(o.iptc[u],c),o.iptcOffsets&&(o.iptcOffsets[u]=f))),f+=1}function o(t,e){return 943868237===t.getUint32(e)&&1028===t.getUint16(e+4)}function s(t,e){var n=t.getUint8(e+7);return n%2!==0&&(n+=1),0===n&&(n=4),n}e.prototype.map={ObjectName:5},e.prototype.types={0:"Uint16",200:"Uint16",201:"Uint16",202:"binary"},e.prototype.get=function(t){return this[t]||this[this.map[t]]},t.parseIptcData=function(t,n,i,a,c){if(!c.disableIptc)for(var l=n+i;n+8<l;){if(o(t,n)){var u=s(t,n),h=n+8+u;if(h>l){console.log("Invalid IPTC data: Invalid segment offset.");break}var f=t.getUint16(n+6+u);if(n+f>l){console.log("Invalid IPTC data: Invalid segment size.");break}return a.iptc=new e,c.disableIptcOffsets||(a.iptcOffsets=new e),void r(t,h,f,a,c.includeIptcTags,c.excludeIptcTags||{202:!0})}n+=1}},t.metaDataParsers.jpeg[65517].push(t.parseIptcData),t.IptcMap=e})?i.apply(e,r):i)||(t.exports=o)}()},function(t,e){t.exports="data:image/svg+xml,%3C?xml version='1.0' encoding='iso-8859-1'?%3E %3C!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0) --%3E %3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E %3Csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='438.529px' height='438.528px' viewBox='0 0 438.529 438.528' style='enable-background:new 0 0 438.529 438.528;' xml:space='preserve'%3E %3Cg%3E %3Cg%3E %3Cpath d='M433.109,23.694c-3.614-3.612-7.898-5.424-12.848-5.424c-4.948,0-9.226,1.812-12.847,5.424l-37.113,36.835 c-20.365-19.226-43.684-34.123-69.948-44.684C274.091,5.283,247.056,0.003,219.266,0.003c-52.344,0-98.022,15.843-137.042,47.536 C43.203,79.228,17.509,120.574,5.137,171.587v1.997c0,2.474,0.903,4.617,2.712,6.423c1.809,1.809,3.949,2.712,6.423,2.712h56.814 c4.189,0,7.042-2.19,8.566-6.565c7.993-19.032,13.035-30.166,15.131-33.403c13.322-21.698,31.023-38.734,53.103-51.106 c22.082-12.371,45.873-18.559,71.376-18.559c38.261,0,71.473,13.039,99.645,39.115l-39.406,39.397 c-3.607,3.617-5.421,7.902-5.421,12.851c0,4.948,1.813,9.231,5.421,12.847c3.621,3.617,7.905,5.424,12.854,5.424h127.906 c4.949,0,9.233-1.807,12.848-5.424c3.613-3.616,5.42-7.898,5.42-12.847V36.542C438.529,31.593,436.733,27.312,433.109,23.694z'/%3E %3Cpath d='M422.253,255.813h-54.816c-4.188,0-7.043,2.187-8.562,6.566c-7.99,19.034-13.038,30.163-15.129,33.4 c-13.326,21.693-31.028,38.735-53.102,51.106c-22.083,12.375-45.874,18.556-71.378,18.556c-18.461,0-36.259-3.423-53.387-10.273 c-17.13-6.858-32.454-16.567-45.966-29.13l39.115-39.112c3.615-3.613,5.424-7.901,5.424-12.847c0-4.948-1.809-9.236-5.424-12.847 c-3.617-3.62-7.898-5.431-12.847-5.431H18.274c-4.952,0-9.235,1.811-12.851,5.431C1.807,264.844,0,269.132,0,274.08v127.907 c0,4.945,1.807,9.232,5.424,12.847c3.619,3.61,7.902,5.428,12.851,5.428c4.948,0,9.229-1.817,12.847-5.428l36.829-36.833 c20.367,19.41,43.542,34.355,69.523,44.823c25.981,10.472,52.866,15.701,80.653,15.701c52.155,0,97.643-15.845,136.471-47.534 c38.828-31.688,64.333-73.042,76.52-124.05c0.191-0.38,0.281-1.047,0.281-1.995c0-2.478-0.907-4.612-2.715-6.427 C426.874,256.72,424.731,255.813,422.253,255.813z'/%3E %3C/g%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3Cg%3E %3C/g%3E %3C/svg%3E"},function(t,e,n){var i=n(18).fabric;n(128);var r=n(131);i.BoundedText=i.util.createClass(i.Group,{cacheProperties:i.Group.prototype.cacheProperties.concat("textAlign","caps","outlineWidth","fontFamily","fillPattern","version","lineSpacing","ligatures","tracking","fontSize","multiline","minSizePx","maxSizePx","prefix","suffix","_textWithoutPrefixSuffix"),async:!0,type:"bounded-text",lockUniScalingWithSkew:!1,caps:!1,debug:!1,version:"2.0.0",Itext:!1,lineSpacing:1,_textWithoutPrefixSuffix:"",initialize:function(t){t.fontFamily&&(t.fontFamily=this._sanitizeFontFamily(t.fontFamily)),t.version=t.version||i.BoundedText.prototype.version,t.width=t.width||300,t.height=t.height||300;var e={width:t.width,height:t.height,fontSize:t.fontSize||200,originX:"center",originY:"center",textAlign:t.textAlign||"center",centeredRotation:!0,color:t.color||"black",fontFamily:t.fontFamily||"Arial",backgroundColor:this.debug?"#f7dacf":"rgba(0,0,0,0)",tracking:t.tracking||0,version:t.version},n=new i.OpentypeIText("",e);n.set("maxWidth",t.width),n.set("maxHeight",t.height);var r=new i.Rect({strokeDashArray:t.strokeDashArray,originX:"center",originY:"center",stroke:"#000000",strokeWidth:3,width:t.width,height:t.height,fill:"rgba(0, 0, 0, 0)"});this.callSuper("initialize",[n,r],t),this.setTextAlign(t.textAlign||"center"),this.setText(t.Itext?"ם":"A"),this.on({scaling:function(t){if(this.lockUniScalingWithSkew){var e=1;e="scaleX"===t.transform.action?this.scaleX:this.scaleY,this.scaleX=e,this.scaleY=e}},scaled:function(){var t=this.width*this.scaleX,e=this.height*this.scaleY;this.scaleX=1,this.scaleY=1,this.setWidth(t),this.setHeight(e)},added:function(){this.cornerSize=.025*this.canvas.width,this.transparentCorners=!1}})},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions");return t.height=2*this.height*t.zoomY,t},updateFromGroupScaling:function(){var t=this.width*this.scaleX,e=this.height*this.scaleY;this.scaleX=1,this.scaleY=1,this.setWidth(t),this.setHeight(e),this.setTextAlign(this.getTextAlign())},_set:function(t,e){"minSizePx"===t?this.setMinSizePx(e):"maxSizePx"===t?this.setMaxSizePx(e):"textAlign"===t?this.setTextAlign(e):"caps"===t?this.setCaps(e):"text"===t?this.setText(e):"outlineWidth"===t?this.setOutlineWidth(e):"fontFamily"===t?this.setFontFamily(e):"fill"===t&&e.constructor===i.Pattern?this.item(0).set("fillPattern",e):"version"===t?this.item(0).set("version",e):"lineSpacing"===t?this.item(0).set("lineSpacing",e):"ligatures"===t?this.item(0).set("ligatures",e):"multiline"===t&&this.setMultiline(e),this.callSuper("_set",t,e),"prefix"!==t&&"suffix"!==t||this.setText(this.getText())},getTextPaths:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.item(0).getTextPaths(t)},setTextAlign:function(t){"opentype-itext"==this.item(0).type&&this.item(0).set("textAlign",t)},setTrackingAmount:function(t){this.item(0).set("tracking",t||0)},getTrackingAmount:function(){return this.item(0).tracking||0},getOutlineWidth:function(){return this.item(0).opentypeStrokeWidth||0},setOutlineWidth:function(t){this.item(0).set("opentypeStrokeWidth",t||0)},getOutlineColor:function(){return this.item(0).opentypeStroke||"#000000"},setOutlineColor:function(t){this.item(0).set("opentypeStroke",t||"#000000")},getTextAlign:function(){return this.item(0).textAlign},setCursorColor:function(t){this.item(0).cursorColor=t},setStroke:function(t){this.item(1).set("stroke",t)},setStrokeWidth:function(t){this.item(1).set("strokeWidth",t)},getStroke:function(){return this.item(1).stroke},setColor:function(t){this.item(0).setColor(t)},getColor:function(){return this.item(0).fill},getText:function(){return this._textWithoutPrefixSuffix},getTextWithLines:function(){return this.item(0).getText()},setText:function(t){return t||(t=""),this.set("_textWithoutPrefixSuffix",t),this.caps&&(t=t.toUpperCase()),t=(this.prefix||"")+t+(this.suffix||""),this.item(0).set("text",this.Itext?r.reverse(t):t),t},forceFontSize:function(t){t?(this.item(0).set("maxFontSize",t),this.item(0).set("minFontSize",t)):(this.item(0).set("maxFontSize",this.maxSizePx),this.item(0).set("minFontSize",this.minSizePx))},setFontSize:function(t){this.item(0).fontSize=t},getFontSize:function(){return this.item(0).fontSize},_sanitizeFontFamily:function(t){return t.indexOf("'")<0&&(t="'"+t+"'"),t},setFontFamily:function(t){t=this._sanitizeFontFamily(t),this.item(0).set("fontFamily",t)},getFontFamily:function(){return this.item(0).fontFamily},setWidth:function(t){t||(t=0),this.set("width",t),this.item(1).set("width",t),this.item(0).set("maxWidth",t)},getWidth:function(){return this.width*this.scaleX},setHeight:function(t){t||(t=0),this.set("height",t),this.item(1).set("height",t),this.item(0).set("maxHeight",t)},getHeight:function(){return this.height*this.scaleY},setMinSizePx:function(t){this.minSizePx=t,this.item(0).set("minFontSize",t)},setMaxSizePx:function(t){this.maxSizePx=t,this.item(0).set("maxFontSize",t)},setMultiline:function(t){this.multiline=t,this.item(0).set("multiline",t)},setCaps:function(t){this.caps=t,t&&this.setText(this.getText().toUpperCase())},drawObject:function(t){var e;switch(this.textAlign){case"justify":case"center":this.item(0).set({left:0,top:0});break;case"left":e=(this.getWidth()-this.item(0).width)/2,this.item(0).set({left:-e,top:0});break;case"right":e=(this.getWidth()-this.item(0).width)/2,this.item(0).set({left:e,top:0})}this.callSuper("drawObject",t)},clone:function(t){var e=new i.BoundedText({width:this.getWidth(),height:this.getHeight(),originX:"center",originY:"center",left:this.left,top:this.top,skewX:this.skewX,skewY:this.skewY,strokeDashArray:this.item(1).strokeDashArray,angle:this.angle,centeredRotation:(!0).centeredRotation,Itext:this.Itext,lockSkewingX:this.lockSkewingX,lockSkewingY:this.lockSkewingY,lockScalingFlip:!0,fontPath:this.fontPath,fontName:this.firstFontName||this.fontName,fontColorsMap:new Map(this.fontColorsMap),fontsMap:new Map(this.fontsMap),outlineColor:this.outlineColor,id:this.id,uuid:this.uuid,evented:this.evented,selectable:this.selectable,locked:this.locked,visible:this.visible,name:this.name,fontColorOption:this.fontColorOption,fontOption:this.fontOption,prefix:this.prefix,suffix:this.suffix,ligatures:this.ligatures});e.setMultiline(this.multiline),e.setMinSizePx(this.minSizePx),e.setMaxSizePx(this.maxSizePx),e.setFontFamily(this.getFontFamily()),e.setFontSize(this.item(0).fontSize),e.setColor(this.getColor()),e.setStroke(this.item(1).stroke),e.setStrokeWidth(this.item(1).strokeWidth),e.setCursorColor(this.item(0).cursorColor),e.setTextAlign(this.item(0).textAlign),e.setOutlineColor(this.getOutlineColor()),e.setOutlineWidth(this.getOutlineWidth()),e.setTrackingAmount(this.getTrackingAmount()),e.set("caps",this.caps),e.set("fontLibraryId",this.fontLibraryId),e.set("colorLibraryId",this.colorLibraryId),e.set("zIndex",this.zIndex),e.set("version",this.version),e.item(0).set("version",this.version),e.set("prefix",this.prefix),e.set("suffix",this.suffix),e.setText(this.getText()),t&&t(e)}})},function(t,e,n){"use strict";var i,r;"undefined"!==typeof window&&window,void 0===(r="function"===typeof(i=function(){if("undefined"===typeof window)return null;var t="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)};function n(t,e){var n=Object.prototype.toString.call(t),i="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!==typeof jQuery&&t instanceof jQuery||"undefined"!==typeof Elements&&t instanceof Elements,r=0,o=t.length;if(i)for(;r<o;r++)e(t[r]);else e(t)}function i(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}function r(t,e){Object.keys(e).forEach((function(n){t.style[n]=e[n]}))}var o=function(t,s){function a(){var t,e,n=[];this.add=function(t){n.push(t)},this.call=function(i){for(t=0,e=n.length;t<e;t++)n[t].call(this,i)},this.remove=function(i){var r=[];for(t=0,e=n.length;t<e;t++)n[t]!==i&&r.push(n[t]);n=r},this.length=function(){return n.length}}function c(t,n){if(t)if(t.resizedAttached)t.resizedAttached.add(n);else{t.resizedAttached=new a,t.resizedAttached.add(n),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var o={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},s={position:"absolute",left:"0px",top:"0px",transition:"0s"};r(t.resizeSensor,o);var c=document.createElement("div");c.className="resize-sensor-expand",r(c,o);var l=document.createElement("div");r(l,s),c.appendChild(l);var u=document.createElement("div");u.className="resize-sensor-shrink",r(u,o);var h=document.createElement("div");r(h,s),r(h,{width:"200%",height:"200%"}),u.appendChild(h),t.resizeSensor.appendChild(c),t.resizeSensor.appendChild(u),t.appendChild(t.resizeSensor);var f,d,p=window.getComputedStyle(t),g=p?p.getPropertyValue("position"):null;"absolute"!==g&&"relative"!==g&&"fixed"!==g&&(t.style.position="relative");var m=i(t),v=0,y=0,b=!0,x=0,C=function(){if(b){if(0===t.offsetWidth&&0===t.offsetHeight)return void(x||(x=e((function(){x=0,C()}))));b=!1}!function(){var e=t.offsetWidth,n=t.offsetHeight;l.style.width=e+10+"px",l.style.height=n+10+"px",c.scrollLeft=e+10,c.scrollTop=n+10,u.scrollLeft=e+10,u.scrollTop=n+10}()};t.resizeSensor.resetSensor=C;var S=function(){d=0,f&&(v=m.width,y=m.height,t.resizedAttached&&t.resizedAttached.call(m))},w=function(){m=i(t),(f=m.width!==v||m.height!==y)&&!d&&(d=e(S)),C()},_=function(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n)};_(c,"scroll",w),_(u,"scroll",w),e(C)}}n(t,(function(t){c(t,s)})),this.detach=function(e){o.detach(t,e)},this.reset=function(){t.resizeSensor.resetSensor()}};if(o.reset=function(t){n(t,(function(t){t.resizeSensor.resetSensor()}))},o.detach=function(t,e){n(t,(function(t){t&&(t.resizedAttached&&"function"===typeof e&&(t.resizedAttached.remove(e),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))}))},"undefined"!==typeof MutationObserver){var s=new MutationObserver((function(t){for(var e in t)if(t.hasOwnProperty(e))for(var n=t[e].addedNodes,i=0;i<n.length;i++)n[i].resizeSensor&&o.reset(n[i])}));document.addEventListener("DOMContentLoaded",(function(t){s.observe(document.body,{childList:!0,subtree:!0})}))}return o})?i.call(e,n,e,t):i)||(t.exports=r)},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){function i(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(l){return void n(l)}a.done?e(c):Promise.resolve(c).then(i,r)}var r,o,s=!1;if(s){var a=n(168);r=a.assert,o=a.assertType}function c(){var t;return t=regeneratorRuntime.mark((function t(e,n,i){var a,c,l,u,h,f,d,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s&&(o(e,"poolLimit",["number"]),o(n,"array",["array"]),o(i,"iteratorFn",["function"]),r(n.length,"Parameter `array` must have at least one item")),a=[],c=[],l=!0,u=!1,h=void 0,t.prev=6,f=regeneratorRuntime.mark((function t(){var r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=p.value,o=Promise.resolve().then((function(){return i(r,n)})),a.push(o),s=o.then((function(){return c.splice(c.indexOf(s),1)})),c.push(s),!(c.length>=e)){t.next=8;break}return t.next=8,Promise.race(c);case 8:case"end":return t.stop()}}),t)})),d=n[Symbol.iterator]();case 9:if(l=(p=d.next()).done){t.next=14;break}return t.delegateYield(f(),"t0",11);case 11:l=!0,t.next=9;break;case 14:t.next=20;break;case 16:t.prev=16,t.t1=t.catch(6),u=!0,h=t.t1;case 20:t.prev=20,t.prev=21,l||null==d.return||d.return();case 23:if(t.prev=23,!u){t.next=26;break}throw h;case 26:return t.finish(23);case 27:return t.finish(20);case 28:return t.abrupt("return",Promise.all(a));case 29:case"end":return t.stop()}}),t,null,[[6,16,20,28],[21,,23,27]])})),(c=function(){var e=this,n=arguments;return new Promise((function(r,o){var s=t.apply(e,n);function a(t){i(s,r,o,a,c,"next",t)}function c(t){i(s,r,o,a,c,"throw",t)}a(void 0)}))}).apply(this,arguments)}t.exports=function(t,e,n){return c.apply(this,arguments)}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}},function(t,e,n){var i,r;i=this,r=function(){return function(t,e){"use strict";var n=e;if(t){var i,r,o,s={sourceImg:{element:null,width:0,height:0,naturalWidth:0,naturalHeight:0},zoomedImgOffset:{vertical:0,horizontal:0},zoomedImg:{element:null,width:0,height:0},zoomLens:{element:null,width:0,height:0}},a=document.createElement("div"),c=document.createElement("div");s.zoomedImgOffset={vertical:n.offset&&n.offset.vertical?n.offset.vertical:0,horizontal:n.offset&&n.offset.horizontal?n.offset.horizontal:0},s.zoomPosition=n.zoomPosition||"right",s.zoomContainer=n.zoomContainer?n.zoomContainer:t;var l={handleEvent:function(t){switch(t.type){case"mousemove":return this.handleMouseMove(t);case"mouseenter":return this.handleMouseEnter(t);case"mouseleave":return this.handleMouseLeave(t);case"scroll":return this.handleScroll(t)}},handleMouseMove:function(t){var e,n,a;o&&(e=f(t.clientX-o.left),n=d(t.clientY-o.top),a="-"+e*i+"px -"+n*r+"px",s.zoomedImg.element.style.backgroundPosition=a,s.zoomLens.element.style.cssText+="top:"+n+"px;left:"+e+"px;display: block;")},handleMouseEnter:function(){s.zoomedImg.element.style.display="block",s.zoomLens.element.style.display="block"},handleMouseLeave:function(){s.zoomedImg.element.style.display="none",s.zoomLens.element.style.display="none"},handleScroll:function(){o=u(s.sourceImg.element)}};return g(),s.sourceImg.element.complete?p():s.sourceImg.element.onload=p,{setup:function(){g()},kill:function(){m()},_getInstanceInfo:function(){return{events:l,setup:g,kill:m,onSourceImgLoad:p,data:s,options:n}}}}function u(t){if(t){var e=t.getBoundingClientRect();return{left:e.left,top:e.top}}return{left:0,top:0}}function h(t,e,n){return function(t,e,n){return t<e?e:t>n?n:t}(t,e,n)-e}function f(t){var e,i=s.zoomLens.width/2;return h(t,i,(e=i,n.width-e))}function d(t){var e,i=s.zoomLens.height/2;return h(t,i,(e=i,n.height-e))}function p(){n.height=n.height||s.sourceImg.element.height,s.sourceImg.element.style.height=n.height+"px",n.width=n.width||s.sourceImg.element.width,s.sourceImg.element.style.width=n.width+"px",function(t,e){t.scale?(e.zoomedImg.element.style.width=t.width*t.scale+"px",e.zoomedImg.element.style.height=t.height*t.scale+"px"):t.zoomWidth?(e.zoomedImg.element.style.width=t.zoomWidth+"px",e.zoomedImg.element.style.height=e.sourceImg.element.style.height):(e.zoomedImg.element.style.width="100%",e.zoomedImg.element.style.height="100%")}(n,s),s.sourceImg.naturalWidth=s.sourceImg.element.naturalWidth,s.sourceImg.naturalHeight=s.sourceImg.element.naturalHeight,s.zoomedImg.element.style.backgroundSize=s.sourceImg.naturalWidth+"px "+s.sourceImg.naturalHeight+"px",n.zoomStyle&&(s.zoomedImg.element.style.cssText+=n.zoomStyle),n.zoomLensStyle?s.zoomLens.element.style.cssText+=n.zoomLensStyle:(s.zoomLens.element.style.background="white",s.zoomLens.element.style.opacity="0.4"),i=s.sourceImg.naturalWidth/n.width,r=s.sourceImg.naturalHeight/n.height,o=u(s.sourceImg.element),n.scale?(s.zoomLens.width=n.width/(s.sourceImg.naturalWidth/(n.width*n.scale)),s.zoomLens.height=n.height/(s.sourceImg.naturalHeight/(n.height*n.scale))):n.zoomWidth?(s.zoomLens.width=n.zoomWidth/i,s.zoomLens.height=n.height/r):(s.zoomedImg.element.style.display="block",s.zoomLens.width=s.zoomedImg.element.clientWidth/i,s.zoomLens.height=s.zoomedImg.element.clientHeight/r,s.zoomedImg.element.style.display="none"),s.zoomLens.element.style.position="absolute",s.zoomLens.element.style.width=s.zoomLens.width+"px",s.zoomLens.element.style.height=s.zoomLens.height+"px",s.zoomLens.element.pointerEvents="none",n.sourceImgLoadedCallback&&n.sourceImgLoadedCallback()}function g(){if(n.img){var e=document.createElement("img");e.src=n.img,s.sourceImg.element=t.appendChild(e)}else s.sourceImg.element=t.children[0],"IMG"!==s.sourceImg.element.nodeName&&(s.sourceImg.element=s.sourceImg.element.querySelector("img"));n=n||{},s.sourceImg.element.style.width=n.width?n.width+"px":"auto",s.sourceImg.element.style.height=n.height?n.height+"px":"auto",s.zoomLens.element=t.appendChild(c),s.zoomLens.element.style.display="none",s.zoomLens.element.classList.add("customily-image-zoom__zoomed-area"),s.zoomedImg.element=s.zoomContainer.appendChild(a),s.zoomedImg.element.classList.add("customily-image-zoom__zoomed-image"),s.zoomedImg.element.style.backgroundImage="url('"+s.sourceImg.element.src+"')",s.zoomedImg.element.style.backgroundRepeat="no-repeat",s.zoomedImg.element.style.display="none";var i=s.sourceImg.element.getBoundingClientRect();switch(s.zoomPosition){case"left":s.zoomedImg.element.style.position="absolute",s.zoomedImg.element.style.top=i.top+s.zoomedImgOffset.vertical+"px",s.zoomedImg.element.style.left=i.left-i.width-s.zoomedImgOffset.horizontal+"px";break;case"top":s.zoomedImg.element.style.position="absolute",s.zoomedImg.element.style.top=s.zoomedImgOffset.vertical-2*s.zoomedImgOffset.vertical+"px",s.zoomedImg.element.style.left="calc(50% + "+s.zoomedImgOffset.horizontal+"px)",s.zoomedImg.element.style.transform="translate3d(-50%, -100%, 0)";break;case"bottom":s.zoomedImg.element.style.position="absolute",s.zoomedImg.element.style.bottom=s.zoomedImgOffset.vertical-2*s.zoomedImgOffset.vertical+"px",s.zoomedImg.element.style.left="calc(50% + "+s.zoomedImgOffset.horizontal+"px)",s.zoomedImg.element.style.transform="translate3d(-50%, 100%, 0)";break;case"original":s.zoomedImg.element.style.position="absolute",s.zoomedImg.element.style.top="0px",s.zoomedImg.element.style.left="0px";break;default:s.zoomedImg.element.style.position="absolute",s.zoomedImg.element.style.top=i.top+s.zoomedImgOffset.vertical+"px",s.zoomedImg.element.style.left=i.left+i.width+s.zoomedImgOffset.horizontal+"px"}return t.addEventListener("mousemove",l,!1),t.addEventListener("mouseenter",l,!1),t.addEventListener("mouseleave",l,!1),s.zoomLens.element.addEventListener("mouseenter",l,!1),s.zoomLens.element.addEventListener("mouseleave",l,!1),window.addEventListener("scroll",l,!1),s}function m(){return t.removeEventListener("mousemove",l,!1),t.removeEventListener("mouseenter",l,!1),t.removeEventListener("mouseleave",l,!1),s.zoomLens.element.removeEventListener("mouseenter",l,!1),s.zoomLens.element.removeEventListener("mouseleave",l,!1),window.removeEventListener("scroll",l,!1),s.zoomLens&&s.zoomedImg&&(t.removeChild(s.zoomLens.element),s.zoomContainer.removeChild(s.zoomedImg.element)),n.img?t.removeChild(s.sourceImg.element):(s.sourceImg.element.style.width="",s.sourceImg.element.style.height=""),s}}},t.exports?t.exports=r():i.ImageZoom=r()},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,i){"string"===typeof t&&(t=[[null,t,""]]);var r={};if(i)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(r[s]=!0)}for(var a=0;a<t.length;a++){var c=[].concat(t[a]);i&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},function(t,e,n){n(74),n(79),n(105),t.exports=n(167)},function(t,e,n){n(75)("iterator")},function(t,e,n){var i=n(41),r=n(5),o=n(76),s=n(14).f;t.exports=function(t){var e=i.Symbol||(i.Symbol={});r(e,t)||s(e,t,{value:o.f(t)})}},function(t,e,n){e.f=n(4)},function(t,e,n){var i=n(2),r=n(29),o=i["__core-js_shared__"]||r("__core-js_shared__",{});t.exports=o},function(t,e,n){var i=n(11);t.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())}))},function(t,e,n){"use strict";var i,r,o,s,a=n(45),c=n(22),l=n(2),u=n(16),h=n(89),f=n(24),d=n(90),p=n(37),g=n(91),m=n(12),v=n(25),y=n(92),b=n(15),x=n(93),C=n(98),S=n(99),w=n(53).set,_=n(100),D=n(101),T=n(102),E=n(55),k=n(103),O=n(33),A=n(51),P=n(4),I=n(104),F=P("species"),M="Promise",L=O.get,R=O.set,j=O.getterFor(M),B=h,U=l.TypeError,z=l.document,N=l.process,W=u("fetch"),H=E.f,X=H,G="process"==b(N),Y=!!(z&&z.createEvent&&l.dispatchEvent),q=A(M,(function(){if(66===I)return!0;if(!G&&"function"!=typeof PromiseRejectionEvent)return!0;if(c&&!B.prototype.finally)return!0;if(I>=51&&/native code/.test(B))return!1;var t=B.resolve(1),e=function(t){t((function(){}),(function(){}))};return(t.constructor={})[F]=e,!(t.then((function(){}))instanceof e)})),V=q||!C((function(t){B.all(t).catch((function(){}))})),Z=function(t){var e;return!(!m(t)||"function"!=typeof(e=t.then))&&e},Q=function(t,e,n){if(!e.notified){e.notified=!0;var i=e.reactions;_((function(){for(var r=e.value,o=1==e.state,s=0;i.length>s;){var a,c,l,u=i[s++],h=o?u.ok:u.fail,f=u.resolve,d=u.reject,p=u.domain;try{h?(o||(2===e.rejection&&tt(t,e),e.rejection=1),!0===h?a=r:(p&&p.enter(),a=h(r),p&&(p.exit(),l=!0)),a===u.promise?d(U("Promise-chain cycle")):(c=Z(a))?c.call(a,f,d):f(a)):d(r)}catch(g){p&&!l&&p.exit(),d(g)}}e.reactions=[],e.notified=!1,n&&!e.rejection&&$(t,e)}))}},K=function(t,e,n){var i,r;Y?((i=z.createEvent("Event")).promise=e,i.reason=n,i.initEvent(t,!1,!0),l.dispatchEvent(i)):i={promise:e,reason:n},(r=l["on"+t])?r(i):"unhandledrejection"===t&&T("Unhandled promise rejection",n)},$=function(t,e){w.call(l,(function(){var n,i=e.value;if(J(e)&&(n=k((function(){G?N.emit("unhandledRejection",i,t):K("unhandledrejection",t,i)})),e.rejection=G||J(e)?2:1,n.error))throw n.value}))},J=function(t){return 1!==t.rejection&&!t.parent},tt=function(t,e){w.call(l,(function(){G?N.emit("rejectionHandled",t):K("rejectionhandled",t,e.value)}))},et=function(t,e,n,i){return function(r){t(e,n,r,i)}},nt=function(t,e,n,i){e.done||(e.done=!0,i&&(e=i),e.value=n,e.state=2,Q(t,e,!0))},it=function(t,e,n,i){if(!e.done){e.done=!0,i&&(e=i);try{if(t===n)throw U("Promise can't be resolved itself");var r=Z(n);r?_((function(){var i={done:!1};try{r.call(n,et(it,t,i,e),et(nt,t,i,e))}catch(o){nt(t,i,o,e)}})):(e.value=n,e.state=1,Q(t,e,!1))}catch(o){nt(t,{done:!1},o,e)}}};q&&(B=function(t){y(this,B,M),v(t),i.call(this);var e=L(this);try{t(et(it,this,e),et(nt,this,e))}catch(n){nt(this,e,n)}},(i=function(t){R(this,{type:M,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=d(B.prototype,{then:function(t,e){var n=j(this),i=H(S(this,B));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=G?N.domain:void 0,n.parent=!0,n.reactions.push(i),0!=n.state&&Q(this,n,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new i,e=L(t);this.promise=t,this.resolve=et(it,t,e),this.reject=et(nt,t,e)},E.f=H=function(t){return t===B||t===o?new r(t):X(t)},c||"function"!=typeof h||(s=h.prototype.then,f(h.prototype,"then",(function(t,e){var n=this;return new B((function(t,e){s.call(n,t,e)})).then(t,e)}),{unsafe:!0}),"function"==typeof W&&a({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return D(B,W.apply(l,arguments))}}))),a({global:!0,wrap:!0,forced:q},{Promise:B}),p(B,M,!1,!0),g(M),o=u(M),a({target:M,stat:!0,forced:q},{reject:function(t){var e=H(this);return e.reject.call(void 0,t),e.promise}}),a({target:M,stat:!0,forced:c||q},{resolve:function(t){return D(c&&this===o?B:this,t)}}),a({target:M,stat:!0,forced:V},{all:function(t){var e=this,n=H(e),i=n.resolve,r=n.reject,o=k((function(){var n=v(e.resolve),o=[],s=0,a=1;x(t,(function(t){var c=s++,l=!1;o.push(void 0),a++,n.call(e,t).then((function(t){l||(l=!0,o[c]=t,--a||i(o))}),r)})),--a||i(o)}));return o.error&&r(o.value),n.promise},race:function(t){var e=this,n=H(e),i=n.reject,r=k((function(){var r=v(e.resolve);x(t,(function(t){r.call(e,t).then(n.resolve,i)}))}));return r.error&&i(r.value),n.promise}})},function(t,e,n){"use strict";var i={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!i.call({1:2},1);e.f=o?function(t){var e=r(this,t);return!!e&&e.enumerable}:i},function(t,e,n){var i=n(11),r=n(15),o="".split;t.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==r(t)?o.call(t,""):Object(t)}:Object},function(t,e,n){var i=n(2),r=n(47),o=i.WeakMap;t.exports="function"===typeof o&&/native code/.test(r.call(o))},function(t,e,n){var i=n(5),r=n(84),o=n(32),s=n(14);t.exports=function(t,e){for(var n=r(e),a=s.f,c=o.f,l=0;l<n.length;l++){var u=n[l];i(t,u)||a(t,u,c(e,u))}}},function(t,e,n){var i=n(16),r=n(85),o=n(88),s=n(6);t.exports=i("Reflect","ownKeys")||function(t){var e=r.f(s(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var i=n(48),r=n(36).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(23),r=n(49),o=n(87),s=function(t){return function(e,n,s){var a,c=i(e),l=r(c.length),u=o(s,l);if(t&&n!=n){for(;l>u;)if((a=c[u++])!=a)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},function(t,e,n){var i=n(50),r=Math.max,o=Math.min;t.exports=function(t,e){var n=i(t);return n<0?r(n+e,0):o(n,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(2);t.exports=i.Promise},function(t,e,n){var i=n(24);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},function(t,e,n){"use strict";var i=n(16),r=n(14),o=n(4),s=n(13),a=o("species");t.exports=function(t){var e=i(t),n=r.f;s&&e&&!e[a]&&n(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e,n){var i=n(6),r=n(94),o=n(49),s=n(52),a=n(95),c=n(97),l=function(t,e){this.stopped=t,this.result=e};(t.exports=function(t,e,n,u,h){var f,d,p,g,m,v,y,b=s(e,n,u?2:1);if(h)f=t;else{if("function"!=typeof(d=a(t)))throw TypeError("Target is not iterable");if(r(d)){for(p=0,g=o(t.length);g>p;p++)if((m=u?b(i(y=t[p])[0],y[1]):b(t[p]))&&m instanceof l)return m;return new l(!1)}f=d.call(t)}for(v=f.next;!(y=v.call(f)).done;)if("object"==typeof(m=c(f,b,y.value,u))&&m&&m instanceof l)return m;return new l(!1)}).stop=function(t){return new l(!0,t)}},function(t,e,n){var i=n(4),r=n(17),o=i("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||s[o]===t)}},function(t,e,n){var i=n(96),r=n(17),o=n(4)("iterator");t.exports=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||r[i(t)]}},function(t,e,n){var i=n(15),r=n(4)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=Object(t),r))?n:o?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){var i=n(6);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(s){var o=t.return;throw void 0!==o&&i(o.call(t)),s}}},function(t,e,n){var i=n(4)("iterator"),r=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){r=!0}};s[i]=function(){return this},Array.from(s,(function(){throw 2}))}catch(a){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o={};o[i]=function(){return{next:function(){return{done:n=!0}}}},t(o)}catch(a){}return n}},function(t,e,n){var i=n(6),r=n(25),o=n(4)("species");t.exports=function(t,e){var n,s=i(t).constructor;return void 0===s||void 0==(n=i(s)[o])?e:r(n)}},function(t,e,n){var i,r,o,s,a,c,l,u,h=n(2),f=n(32).f,d=n(15),p=n(53).set,g=n(38),m=h.MutationObserver||h.WebKitMutationObserver,v=h.process,y=h.Promise,b="process"==d(v),x=f(h,"queueMicrotask"),C=x&&x.value;C||(i=function(){var t,e;for(b&&(t=v.domain)&&t.exit();r;){e=r.fn,r=r.next;try{e()}catch(n){throw r?s():o=void 0,n}}o=void 0,t&&t.enter()},b?s=function(){v.nextTick(i)}:m&&!/(iphone|ipod|ipad).*applewebkit/i.test(g)?(a=!0,c=document.createTextNode(""),new m(i).observe(c,{characterData:!0}),s=function(){c.data=a=!a}):y&&y.resolve?(l=y.resolve(void 0),u=l.then,s=function(){u.call(l,i)}):s=function(){p.call(h,i)}),t.exports=C||function(t){var e={fn:t,next:void 0};o&&(o.next=e),r||(r=e,s()),o=e}},function(t,e,n){var i=n(6),r=n(12),o=n(55);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var i=n(2);t.exports=function(t,e){var n=i.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}},function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}},function(t,e,n){var i,r,o=n(2),s=n(38),a=o.process,c=a&&a.versions,l=c&&c.v8;l?r=(i=l.split("."))[0]+i[1]:s&&(!(i=s.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=s.match(/Chrome\/(\d+)/))&&(r=i[1]),t.exports=r&&+r},function(t,e,n){"use strict";var i=n(23),r=n(106),o=n(17),s=n(33),a=n(109),c=s.set,l=s.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,e){c(this,{type:"Array Iterator",target:i(t),index:0,kind:e})}),(function(){var t=l(this),e=t.target,n=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){var i=n(4),r=n(56),o=n(10),s=i("unscopables"),a=Array.prototype;void 0==a[s]&&o(a,s,r(null)),t.exports=function(t){a[s][t]=!0}},function(t,e,n){var i=n(13),r=n(14),o=n(6),s=n(108);t.exports=i?Object.defineProperties:function(t,e){o(t);for(var n,i=s(e),a=i.length,c=0;a>c;)r.f(t,n=i[c++],e[n]);return t}},function(t,e,n){var i=n(48),r=n(36);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e,n){"use strict";var i=n(45),r=n(110),o=n(58),s=n(113),a=n(37),c=n(10),l=n(24),u=n(4),h=n(22),f=n(17),d=n(57),p=d.IteratorPrototype,g=d.BUGGY_SAFARI_ITERATORS,m=u("iterator"),v=function(){return this};t.exports=function(t,e,n,u,d,y,b){r(n,e,u);var x,C,S,w=function(t){if(t===d&&k)return k;if(!g&&t in T)return T[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},_=e+" Iterator",D=!1,T=t.prototype,E=T[m]||T["@@iterator"]||d&&T[d],k=!g&&E||w(d),O="Array"==e&&T.entries||E;if(O&&(x=o(O.call(new t)),p!==Object.prototype&&x.next&&(h||o(x)===p||(s?s(x,p):"function"!=typeof x[m]&&c(x,m,v)),a(x,_,!0,!0),h&&(f[_]=v))),"values"==d&&E&&"values"!==E.name&&(D=!0,k=function(){return E.call(this)}),h&&!b||T[m]===k||c(T,m,k),f[e]=k,d)if(C={values:w("values"),keys:y?k:w("keys"),entries:w("entries")},b)for(S in C)!g&&!D&&S in T||l(T,S,C[S]);else i({target:e,proto:!0,forced:g||D},C);return C}},function(t,e,n){"use strict";var i=n(57).IteratorPrototype,r=n(56),o=n(31),s=n(37),a=n(17),c=function(){return this};t.exports=function(t,e,n){var l=e+" Iterator";return t.prototype=r(i,{next:o(1,n)}),s(t,l,!1,!0),a[l]=c,t}},function(t,e,n){var i=n(46);t.exports=function(t){return Object(i(t))}},function(t,e,n){var i=n(11);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){var i=n(6),r=n(114);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(o){}return function(n,o){return i(n),r(o),e?t.call(n,o):n.__proto__=o,n}}():void 0)},function(t,e,n){var i=n(12);t.exports=function(t){if(!i(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){var i=function(t){"use strict";var e,n=Object.prototype,i=n.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(t,e,n,i){var r=e&&e.prototype instanceof g?e:g,o=Object.create(r.prototype),s=new E(i||[]);return o._invoke=function(t,e,n){var i=u;return function(r,o){if(i===f)throw new Error("Generator is already running");if(i===d){if("throw"===r)throw o;return O()}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=_(s,n);if(a){if(a===p)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===u)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var c=l(t,e,n);if("normal"===c.type){if(i=n.done?d:h,c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=d,n.method="throw",n.arg=c.arg)}}}(t,n,s),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(i){return{type:"throw",arg:i}}}t.wrap=c;var u="suspendedStart",h="suspendedYield",f="executing",d="completed",p={};function g(){}function m(){}function v(){}var y={};y[o]=function(){return this};var b=Object.getPrototypeOf,x=b&&b(b(k([])));x&&x!==n&&i.call(x,o)&&(y=x);var C=v.prototype=g.prototype=Object.create(y);function S(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function w(t){var e;this._invoke=function(n,r){function o(){return new Promise((function(e,o){!function e(n,r,o,s){var a=l(t[n],t,r);if("throw"!==a.type){var c=a.arg,u=c.value;return u&&"object"===typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then((function(t){e("next",t,o,s)}),(function(t){e("throw",t,o,s)})):Promise.resolve(u).then((function(t){c.value=t,o(c)}),(function(t){return e("throw",t,o,s)}))}s(a.arg)}(n,r,e,o)}))}return e=e?e.then(o,o):o()}}function _(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,_(t,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=l(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,p;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function k(t){if(t){var n=t[o];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}return{next:O}}function O(){return{value:e,done:!0}}return m.prototype=C.constructor=v,v.constructor=m,v[a]=m.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(C),t},t.awrap=function(t){return{__await:t}},S(w.prototype),w.prototype[s]=function(){return this},t.AsyncIterator=w,t.async=function(e,n,i,r){var o=new w(c(e,n,i,r));return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(C),C[a]="Generator",C[o]=function(){return this},C.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=k,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return a.type="throw",a.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:k(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),p}},t}(t.exports);try{regeneratorRuntime=i}catch(r){Function("r","regeneratorRuntime = r")(i)}},function(t,e,n){"use strict";n.r(e),n.d(e,"cancelAllPendingUploads",(function(){return y})),n.d(e,"uploadProductImage",(function(){return b})),n.d(e,"uploadProductSvg",(function(){return x})),n.d(e,"uploadProductVector",(function(){return C}));var i=n(0),r=n.n(i),o=n(67),s=n.n(o),a=n(1),c=n.n(a),l=n(28);function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(n,!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f=n(7),d=n(8),p=d.baseUrl+"/api",g=[],m=function(t,e){var n=g.filter((function(n){return n.type===t&&n.id===e})),i=!0,r=!1,o=void 0;try{for(var s,a=n[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value;try{c.request.abort()}catch(l){}}}catch(u){r=!0,o=u}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}},v=function(t){return new Promise((function(e,n){f.ajax({type:"head",url:t,success:function(t,n,i){var r=i.getResponseHeader("Content-Length");e(parseInt(r)||0)},error:function(t,e){n(e)}})}))},y=function(){var t=!0,e=!1,n=void 0;try{for(var i,r=g[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;try{o.request.abort()}catch(s){}}}catch(a){e=!0,n=a}finally{try{t||null==r.return||r.return()}finally{if(e)throw n}}g=[]},b=function(t,e,n,i,o,s){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return new Promise(function(){var y=c()(r.a.mark((function c(y,b){var x,C,S,w,_,D,T,E,k,O,A,P,I;return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0,x=0,C=!1,S=!1,w=null;case 5:return r.prev=5,m("image",o),_={sessionId:s,imageId:o,format:(i||"png").toLowerCase(),clientVersion:d.clientVersion},D="image/"+_.format,T=f.ajax({type:"GET",url:p+"/JSLib/Image?"+f.param(_),crossDomain:!0,dataType:"json",error:function(t,e){"abort"===e&&(S=!0)}}),g.push({type:"image",id:o,request:T}),r.next=13,T;case 13:return E=r.sent,k=f.ajax({url:E.SignedUrl,type:"PUT",contentType:D,processData:!1,data:t,error:function(t,e){"abort"===e&&(S=!0)}}),g.push({type:"image",id:o,request:k}),r.next=18,k;case 18:return r.next=20,v(E.SignedUrl.substring(0,E.SignedUrl.indexOf("?")));case 20:if(0!==(O=r.sent)&&O===t.size){r.next=28;break}return++x,console.log("Retrying upload for image ".concat(o)),r.next=26,Object(l.delay)(1e3+1e3*x);case 26:r.next=44;break;case 28:if(C=!0,!(a&&u&&e>1&&n>1)){r.next=43;break}return A={sessionId:s,user:u,name:E.Name},P=f.ajax({type:"POST",url:p+"/JSLib/Image/RemoveBackground?"+f.param(A),crossDomain:!0,dataType:"json",error:function(t,e){"abort"===e&&(S=!0)}}),g.push({type:"image",id:o,request:P}),r.prev=33,r.next=36,P;case 36:I=r.sent,y(h({},I,{NoBgName:E.Name})),r.next=43;break;case 40:r.prev=40,r.t0=r.catch(33),console.error("Remove.bg error. Avoiding background remove.");case 43:y(E);case 44:r.next=59;break;case 46:if(r.prev=46,r.t1=r.catch(5),!S){r.next=53;break}C=!0,y(""),r.next=59;break;case 53:return w=r.t1,++x,console.log("Retrying upload for image ".concat(o)),r.next=58,Object(l.delay)(1e3+1e3*x);case 58:console.error("Upload error: ",r.t1);case 59:if(!C&&x<=2){r.next=5;break}case 60:x>2&&b(w),r.next=67;break;case 63:r.prev=63,r.t2=r.catch(0),console.error("Error: ",r.t2),b(r.t2);case 67:case"end":return r.stop()}}),c,null,[[0,63],[5,46],[33,40]])})));return function(t,e){return y.apply(this,arguments)}}())},x=function(t,e,n){return new Promise(function(){var i=c()(r.a.mark((function i(o,s){var a,c,l,u,h;return r.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=!1,i.prev=1,m("vector",e),c={vectorId:e,sessionId:n},l=f.ajax({type:"GET",url:p+"/JSLib/SVG?"+f.param(c),crossDomain:!0,dataType:"json",error:function(t,e){"abort"===e&&(a=!0)}}),g.push({type:"vector",id:e,request:l}),i.next=8,l;case 8:return u=i.sent,h=f.ajax({url:u.SignedUrl,type:"PUT",contentType:"image/svg+xml",processData:!1,data:t,error:function(t,e){"abort"===e&&(a=!0)}}),g.push({type:"vector",id:e,request:h}),i.next=13,h;case 13:o(u.Name),i.next=19;break;case 16:i.prev=16,i.t0=i.catch(1),a?o(""):(console.error("Upload error: ",i.t0),s(i.t0));case 19:case"end":return i.stop()}}),i,null,[[1,16]])})));return function(t,e){return i.apply(this,arguments)}}())},C=function(t,e,n,i){return new Promise(function(){var o=c()(r.a.mark((function o(s,a){var c,l,u,h,d,v,y,b,x;return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(c=!1,r.prev=1,"pdf"!==(l=(t.name||i).split(".").pop().toLowerCase())){r.next=18;break}return m("vector",e),u={sessionId:n,vectorId:e},h=f.ajax({type:"GET",url:p+"/JSLib/Vector?"+f.param(u),crossDomain:!0,dataType:"json"}),g.push({type:"vector",id:e,request:h,error:function(t,e){"abort"===e&&(c=!0)}}),r.next=10,h;case 10:return d=r.sent,v=f.ajax({url:d.SignedUrl,type:"PUT",contentType:"binary/octet-stream",processData:!1,data:t,error:function(t,e){"abort"===e&&(c=!0)}}),g.push({type:"vector",id:e,request:v}),r.next=15,v;case 15:s({Name:d.Name}),r.next=33;break;case 18:if("eps"!==l){r.next=32;break}return m("vector",e),(y=new FormData).append("file",t,t.name||i),y.append("vectorId",e),y.append("sessionId",n),b=f.ajax({url:p+"/JSLib/EPSUpload",data:y,cache:!1,contentType:!1,processData:!1,method:"POST",type:"POST",error:function(t,e){"abort"===e&&(c=!0)}}),g.push({type:"vector",id:e,request:b}),r.next=28,b;case 28:x=r.sent,s(x),r.next=33;break;case 32:a();case 33:r.next=38;break;case 35:r.prev=35,r.t0=r.catch(1),c?s():(console.error("Upload error: ",r.t0),a(r.t0));case 38:case"end":return r.stop()}}),o,null,[[1,35]])})));return function(t,e){return o.apply(this,arguments)}}())}},function(t,e,n){var i=n(7),r=n(8);t.exports=function(){var t=r.baseUrl+"/api";return{getProduct:function(e){var n={productId:e,clientVersion:r.clientVersion};return i.ajax({type:"GET",url:t+"/Product/GetProduct",crossDomain:!0,data:n,dataType:"json"})}}}()},function(t,e,n){var i=n(7),r=n(8);t.exports=function(){var t=r.baseUrl+"/api";return{productPreviewExported:function(e){var n={productId:e,clientVersion:r.clientVersion};return i.ajax({type:"POST",url:t+"/Reports/PreviewExported?"+i.param(n),crossDomain:!0,dataType:"json"})}}}()},function(t,e,n){var i=n(7),r=n(8);t.exports=function(){var t=r.baseUrl+"/api";return{shareCustomization:function(e,n,o,s,a,c,l,u){var h={id:c,clientVersion:r.clientVersion,sessionId:l,texts:e,circularTexts:n,vectorPlaceholders:a,imagesParameters:o,vectorsParameters:s,options:u};return i.ajax({type:"POST",url:t+"/SharedCustomization/Save",crossDomain:!0,data:h,dataType:"json"})},getShareCustomization:function(e){var n={customizationId:e};return i.ajax({type:"GET",url:t+"/SharedCustomization/Get",crossDomain:!0,data:n,dataType:"json"})}}}()},function(t,e){t.exports={isOutsideCanvas:function(t,e){var n=t.centerX-(t.width||t.horizontalDiameter)/2,i=t.centerX+(t.width||t.horizontalDiameter)/2,r=t.centerY-(t.height||t.verticalDiameter)/2,o=t.centerY+(t.height||t.verticalDiameter)/2,s=n<e.preview.width&&i>0,a=r<e.preview.height&&o>0;return!(s&&a)},getMultiplierForTargetSize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return t.getWidth()>t.getHeight()?e/t.getWidth():e/t.getHeight()}}},function(t,e,n){var i,r,o;!function(s){"use strict";r=[n(9)],void 0===(o="function"===typeof(i=function(t){var e=t.global;e.fetch&&e.Request&&e.Response&&e.Response.prototype.blob?t.fetchBlob=function(t,n,i){function r(t){return t.blob()}if(e.Promise&&"function"!==typeof n)return fetch(new Request(t,n)).then(r);fetch(new Request(t,i)).then(r).then(n).catch((function(t){n(null,t)}))}:e.XMLHttpRequest&&""===(new XMLHttpRequest).responseType&&(t.fetchBlob=function(t,n,i){function r(e,n){i=i||{};var r=new XMLHttpRequest;r.open(i.method||"GET",t),i.headers&&Object.keys(i.headers).forEach((function(t){r.setRequestHeader(t,i.headers[t])})),r.withCredentials="include"===i.credentials,r.responseType="blob",r.onload=function(){e(r.response)},r.onerror=r.onabort=r.ontimeout=function(t){e===n?n(null,t):n(t)},r.send(i.body)}return e.Promise&&"function"!==typeof n?(i=n,new Promise(r)):r(n,n)})})?i.apply(e,r):i)||(t.exports=o)}()},function(t,e,n){var i,r,o;!function(s){"use strict";r=[n(9),n(62)],void 0===(o="function"===typeof(i=function(t){var e=t.ExifMap.prototype;e.tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",34665:{36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",36880:"OffsetTime",36881:"OffsetTimeOriginal",36882:"OffsetTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber"},34853:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},40965:{1:"InteroperabilityIndex"}},e.tags.ifd1=e.tags,e.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"Original",2:"Horizontal flip",3:"Rotate 180° CCW",4:"Vertical flip",5:"Vertical flip + Rotate 90° CW",6:"Rotate 90° CW",7:"Horizontal flip + Rotate 90° CW",8:"Rotate 90° CCW"}},e.getText=function(t){var e=this.get(t);switch(t){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[t][e];case"ExifVersion":case"FlashpixVersion":if(!e)return;return String.fromCharCode(e[0],e[1],e[2],e[3]);case"ComponentsConfiguration":if(!e)return;return this.stringValues[t][e[0]]+this.stringValues[t][e[1]]+this.stringValues[t][e[2]]+this.stringValues[t][e[3]];case"GPSVersionID":if(!e)return;return e[0]+"."+e[1]+"."+e[2]+"."+e[3]}return String(e)},e.getAll=function(){var t,e,n,i={};for(t in this)Object.prototype.hasOwnProperty.call(this,t)&&((e=this[t])&&e.getAll?i[this.ifds[t].name]=e.getAll():(n=this.tags[t])&&(i[n]=this.getText(n)));return i},e.getName=function(t){var e=this.tags[t];return"object"===typeof e?this.ifds[t].name:e},function(){var t,n,i,r=e.tags;for(t in r)if(Object.prototype.hasOwnProperty.call(r,t))if(n=e.ifds[t])for(t in i=r[t])Object.prototype.hasOwnProperty.call(i,t)&&(n.map[i[t]]=Number(t));else e.map[r[t]]=Number(t)}()})?i.apply(e,r):i)||(t.exports=o)}()},function(t,e,n){var i,r,o;!function(s){"use strict";r=[n(9),n(63)],void 0===(o="function"===typeof(i=function(t){var e=t.IptcMap.prototype;e.tags={0:"ApplicationRecordVersion",3:"ObjectTypeReference",4:"ObjectAttributeReference",5:"ObjectName",7:"EditStatus",8:"EditorialUpdate",10:"Urgency",12:"SubjectReference",15:"Category",20:"SupplementalCategories",22:"FixtureIdentifier",25:"Keywords",26:"ContentLocationCode",27:"ContentLocationName",30:"ReleaseDate",35:"ReleaseTime",37:"ExpirationDate",38:"ExpirationTime",40:"SpecialInstructions",42:"ActionAdvised",45:"ReferenceService",47:"ReferenceDate",50:"ReferenceNumber",55:"DateCreated",60:"TimeCreated",62:"DigitalCreationDate",63:"DigitalCreationTime",65:"OriginatingProgram",70:"ProgramVersion",75:"ObjectCycle",80:"Byline",85:"BylineTitle",90:"City",92:"Sublocation",95:"State",100:"CountryCode",101:"Country",103:"OriginalTransmissionReference",105:"Headline",110:"Credit",115:"Source",116:"CopyrightNotice",118:"Contact",120:"Caption",121:"LocalCaption",122:"Writer",125:"RasterizedCaption",130:"ImageType",131:"ImageOrientation",135:"LanguageIdentifier",150:"AudioType",151:"AudioSamplingRate",152:"AudioSamplingResolution",153:"AudioDuration",154:"AudioOutcue",184:"JobID",185:"MasterDocumentID",186:"ShortDocumentID",187:"UniqueDocumentID",188:"OwnerID",200:"ObjectPreviewFileFormat",201:"ObjectPreviewFileVersion",202:"ObjectPreviewData",221:"Prefs",225:"ClassifyState",228:"SimilarityIndex",230:"DocumentNotes",231:"DocumentHistory",232:"ExifCameraInfo",255:"CatalogSets"},e.stringValues={10:{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"},75:{a:"Morning",b:"Both Morning and Evening",p:"Evening"},131:{L:"Landscape",P:"Portrait",S:"Square"}},e.getText=function(t){var e=this.get(t),n=this.map[t],i=this.stringValues[n];return i?i[e]:String(e)},e.getAll=function(){var t,e,n={};for(t in this)Object.prototype.hasOwnProperty.call(this,t)&&(e=this.tags[t])&&(n[e]=this.getText(e));return n},e.getName=function(t){return this.tags[t]},function(){var t,n=e.tags,i=e.map||{};for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(i[n[t]]=Number(t))}()})?i.apply(e,r):i)||(t.exports=o)}()},function(t,e,n){var i,r,o;!function(s){"use strict";r=[n(9),n(61),n(26)],void 0===(o="function"===typeof(i=function(t){var e=t.transform,n=t.requiresCanvas,i=t.requiresMetaData,r=t.transformCoordinates,o=t.getTransformedOptions;function s(e,n){var i=e&&e.orientation;return(!0===i&&!t.orientation||1===i&&t.orientation||(!n||t.orientation)&&i>1&&i<9)}function a(t,e){return t!==e&&(1===t&&e>1&&e<9||t>1&&t<9)}function c(t,e){if(e>1&&e<9)switch(t){case 2:case 4:return e>4;case 5:case 7:return e%2===0;case 6:case 8:return 2===e||4===e||5===e||7===e}return!1}(function(t){if(t.global.document){var e=document.createElement("img");e.onload=function(){if(t.orientation=2===e.width&&3===e.height,t.orientation){var n=t.createCanvas(1,1,!0).getContext("2d");n.drawImage(e,1,1,1,1,0,0,1,1),t.orientationCropBug="255,255,255,255"!==n.getImageData(0,0,1,1).data.toString()}},e.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/xABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAAAAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQvoP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXwH/9k="}})(t),t.requiresCanvas=function(e){return s(e)||n.call(t,e)},t.requiresMetaData=function(e){return s(e,!0)||i.call(t,e)},t.transform=function(n,i,r,o,s){e.call(t,n,i,(function(e,n){if(n){var i=t.orientation&&n.exif&&n.exif.get("Orientation");if(i>4&&i<9){var o=n.originalWidth,s=n.originalHeight;n.originalWidth=s,n.originalHeight=o}}r(e,n)}),o,s)},t.getTransformedOptions=function(e,n,i){var r=o.call(t,e,n),s=i.exif&&i.exif.get("Orientation"),l=r.orientation,u=t.orientation&&s;if(!0===l&&(l=s),!a(l,u))return r;var h=r.top,f=r.right,d=r.bottom,p=r.left,g={};for(var m in r)Object.prototype.hasOwnProperty.call(r,m)&&(g[m]=r[m]);if(g.orientation=l,(l>4&&!(u>4)||l<5&&u>4)&&(g.maxWidth=r.maxHeight,g.maxHeight=r.maxWidth,g.minWidth=r.minHeight,g.minHeight=r.minWidth,g.sourceWidth=r.sourceHeight,g.sourceHeight=r.sourceWidth),u>1){switch(u){case 2:f=r.left,p=r.right;break;case 3:h=r.bottom,f=r.left,d=r.top,p=r.right;break;case 4:h=r.bottom,d=r.top;break;case 5:h=r.left,f=r.bottom,d=r.right,p=r.top;break;case 6:h=r.left,f=r.top,d=r.right,p=r.bottom;break;case 7:h=r.right,f=r.top,d=r.left,p=r.bottom;break;case 8:h=r.right,f=r.bottom,d=r.left,p=r.top}if(c(l,u)){var v=h,y=f;h=d,f=p,d=v,p=y}}switch(g.top=h,g.right=f,g.bottom=d,g.left=p,l){case 2:g.right=p,g.left=f;break;case 3:g.top=d,g.right=p,g.bottom=h,g.left=f;break;case 4:g.top=d,g.bottom=h;break;case 5:g.top=p,g.right=d,g.bottom=f,g.left=h;break;case 6:g.top=f,g.right=d,g.bottom=p,g.left=h;break;case 7:g.top=f,g.right=h,g.bottom=p,g.left=d;break;case 8:g.top=p,g.right=h,g.bottom=f,g.left=d}return g},t.transformCoordinates=function(e,n,i){r.call(t,e,n,i);var o=n.orientation,s=t.orientation&&i.exif&&i.exif.get("Orientation");if(a(o,s)){var l=e.getContext("2d"),u=e.width,h=e.height,f=u,d=h;switch((o>4&&!(s>4)||o<5&&s>4)&&(e.width=h,e.height=u),o>4&&(f=h,d=u),s){case 2:l.translate(f,0),l.scale(-1,1);break;case 3:l.translate(f,d),l.rotate(Math.PI);break;case 4:l.translate(0,d),l.scale(1,-1);break;case 5:l.rotate(-.5*Math.PI),l.scale(-1,1);break;case 6:l.rotate(-.5*Math.PI),l.translate(-f,0);break;case 7:l.rotate(-.5*Math.PI),l.translate(-f,d),l.scale(1,-1);break;case 8:l.rotate(.5*Math.PI),l.translate(0,-d)}switch(c(o,s)&&(l.translate(f,d),l.rotate(Math.PI)),o){case 2:l.translate(u,0),l.scale(-1,1);break;case 3:l.translate(u,h),l.rotate(Math.PI);break;case 4:l.translate(0,h),l.scale(1,-1);break;case 5:l.rotate(.5*Math.PI),l.scale(1,-1);break;case 6:l.rotate(.5*Math.PI),l.translate(0,-h);break;case 7:l.rotate(.5*Math.PI),l.translate(u,-h),l.scale(-1,1);break;case 8:l.rotate(-.5*Math.PI),l.translate(-u,0)}}}})?i.apply(e,r):i)||(t.exports=o)}()},function(t,e,n){var i=n(18).fabric;n(126);var r=n(127);i.Object.prototype.customizeCornerIcons({settings:{borderColor:"black",cornerSize:25,cornerShape:"circle",cornerBackgroundColor:"black",cornerPadding:10},mtr:{icon:n(64),settings:{cornerBackgroundColor:"transparent",cornerPadding:0}}}),t.exports=function(){"use strict";return i.CanvasEx=i.util.createClass(i.Canvas,{hammertime:!1,allowMobileTouchEvents:!1,_mcActiveElement:null,_mcBackupMovX:null,_mcBackupMovY:null,_mcDeselectionTimeout:null,_backupMcElementMovement:function(){this._mcActiveElement&&null===this._mcBackupMovX&&(this._mcBackupMovX=this._mcActiveElement.lockMovementX,this._mcBackupMovY=this._mcActiveElement.lockMovementY,this._mcActiveElement.lockMovementX=!0,this._mcActiveElement.lockMovementY=!0)},_restoreMcElementMovement:function(){this._mcActiveElement&&(this._mcActiveElement.lockMovementX=this._mcBackupMovX,this._mcActiveElement.lockMovementY=this._mcBackupMovY,this._mcBackupMovX=this._mcBackupMovY=null)},_touchStartHandler:function(t){t&&t.touches&&t.touches.length>=2&&clearTimeout(this._mcDeselectionTimeout)},initialize:function(t,e){var n=this;if(this.callSuper("initialize",t,e),this.allowMobileTouchEvents){this._touchStartHandler=this._touchStartHandler.bind(this),this._backupMcElementMovement=this._backupMcElementMovement.bind(this),this._restoreMcElementMovement=this._restoreMcElementMovement.bind(this);var i=new r.Manager(this.upperCanvasEl);this.hammertime=i,i.add(new r.Rotate({threshold:10,pointers:2})),i.add(new r.Pinch({threshold:0,pointers:2})).recognizeWith([i.get("rotate")]),i.on("rotatestart rotatemove",(function(t){if("rotatestart"==t.type){var e=n.getActiveObject()||n.findTarget(t.pointers[0],!0);n._mcActiveElement=e}if(n._mcActiveElement)if("rotatestart"==t.type)n._mcActiveElement.__mcLastAngle=t.rotation,n._mcActiveElement.__mcAngle=n._mcActiveElement.angle,n._backupMcElementMovement();else{var i=(n._mcActiveElement.__mcLastAngle||0)-t.rotation;n._mcActiveElement.__mcAngle=n._mcActiveElement.__mcAngle-i,n._mcActiveElement.set("angle",n._mcActiveElement.__mcAngle),n.fire("object:rotating",{target:n._mcActiveElement,e:t.pointers[0]}),n._mcActiveElement.fire("rotating",{target:n._mcActiveElement,e:t.pointers[0]}),n._mcActiveElement.__mcLastAngle=t.rotation,n.requestRenderAll()}})),i.on("pinchstart pinchmove",(function(t){if("pinchstart"==t.type){var e=n.getActiveObject()||n.findTarget(t.pointers[0],!0);n._mcActiveElement=e}n._mcActiveElement&&("pinchstart"==t.type?(n._mcActiveElement.__mcLastScaleX=t.scale,n._mcActiveElement.__mcLastScaleY=t.scale,n._backupMcElementMovement()):(n._mcActiveElement.set("scaleX",1+t.scale-(n._mcActiveElement.__mcLastScaleX||1)),n._mcActiveElement.set("scaleY",1+t.scale-(n._mcActiveElement.__mcLastScaleY||1)),n.fire("object:scaling",{target:n._mcActiveElement,e:t.pointers[0]}),n._mcActiveElement.fire("scaling",{target:n._mcActiveElement,e:t.pointers[0]}),n._mcActiveElement.__mcLastScaleX=n._mcActiveElement.__mcLastScaleY=t.scale,n.requestRenderAll()))})),i.on("hammer.input",(function(t){t.isFinal&&(n._restoreMcElementMovement(),n._mcActiveElement=null)})),this.upperCanvasEl.addEventListener("touchstart",this._touchStartHandler),this.on({"selection:cleared":function(t){var e=this;t.e&&t.e.touches&&1===t.e.touches.length&&t.deselected[0]&&(this.setActiveObject(t.deselected[0]),clearTimeout(this._mcDeselectionTimeout),this._mcDeselectionTimeout=setTimeout((function(){e.discardActiveObject(),e.requestRenderAll()}),100))}})}},dispose:function(){this.callSuper("dispose"),this.upperCanvasEl.removeEventListener("touchstart",this._touchStartHandler)}}),i}()},function(t,e,n){"use strict";!function(e){var n=e.fabric||(e.fabric={}),i=n.util.degreesToRadians,r={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7};"1.6.0".localeCompare(e.fabric.version)>-1&&console.warn("this extension might not be fully compatible with your version of fabric.js ("+e.fabric.version+").Consider using the latest compatible build of fabric.js (> 1.6.0)"),n.util.object.extend(n.Object.prototype,{useCustomIcons:!1,cornerBackgroundColor:"transparent",cornerShape:"",cornerPadding:0,customiseCornerIcons:function(t,e){var n,i;for(n in t)t.hasOwnProperty(n)&&(i={},void 0!==t[n].cornerShape&&(this.cornerShape=t[n].cornerShape),void 0!==t[n].cornerBackgroundColor&&(this.cornerBackgroundColor=t[n].cornerBackgroundColor),void 0!==t[n].borderColor&&(this.borderColor=t[n].borderColor),void 0!==t[n].cornerSize&&(this.cornerSize=t[n].cornerSize),void 0!==t[n].cornerPadding&&(this.cornerPadding=t[n].cornerPadding),void 0===t[n].icon&&"settings"!==Object.keys(t)[0]||(this.useCustomIcons=!0,void 0!==t[n].settings&&(i.settings=t[n].settings),void 0!==t[n].icon&&(i.icon=t[n].icon,this.loadIcon(n,i,(function(){e&&"function"===typeof e&&e()})))))},loadIcon:function(t,e,i){var r=this,o=new Image;o.onload=function(){r[t+"Icon"]=this,e.settings&&(r[t+"Settings"]=e.settings),i&&"function"===typeof i&&i()},o.onerror=function(){n.warn(this.src+" icon is not an image")},(e.icon.match(/^http[s]?:\/\//)||"//"===e.icon.substring(0,2))&&(o.crossOrigin="Anonymous"),o.src=e.icon},customizeCornerIcons:function(t){this.customiseCornerIcons(t)},drawControls:function(t){if(!this.hasControls)return this;var e,n=this._calculateCurrentDimensions(),i=n.x,r=n.y,o=this.cornerSize,s=-(i+o)/2,a=-(r+o)/2;return this.useCustomIcons?e="drawImage":(t.lineWidth=1,t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=t.fillStyle=this.cornerColor,this.transparentCorners||(t.strokeStyle=this.cornerStrokeColor),e=this.transparentCorners?"stroke":"fill"),t.save(),this._setLineDash(t,this.cornerDashArray,null),this._drawControl("tl",t,e,s,a,this.tlIcon,this.tlSettings),this._drawControl("tr",t,e,s+i,a,this.trIcon,this.trSettings),this._drawControl("bl",t,e,s,a+r,this.blIcon,this.blSettings),this._drawControl("br",t,e,s+i,a+r,this.brIcon,this.brSettings),this.get("lockUniScaling")||(this._drawControl("mt",t,e,s+i/2,a,this.mtIcon,this.mtSettings),this._drawControl("mb",t,e,s+i/2,a+r,this.mbIcon,this.mbSettings),this._drawControl("mr",t,e,s+i,a+r/2,this.mrIcon,this.mrSettings),this._drawControl("ml",t,e,s,a+r/2,this.mlIcon,this.mlSettings)),this.hasRotatingPoint&&this._drawControl("mtr",t,e,s+i/2,a-this.rotatingPointOffset,this.mtrIcon,this.mtrSettings),t.restore(),this},_drawControl:function(t,e,n,i,r,o,s){if(this.isControlVisible(t)){var a=this.cornerSize,c=this.cornerStrokeColor||"transparent",l=this.cornerBackgroundColor||"black",u=this.cornerShape||"rect",h="number"===typeof this.cornerPadding?this.cornerPadding:10;if(s&&(s.cornerSize&&(i=i+a/2-s.cornerSize/2,r=r+a/2-s.cornerSize/2,a=s.cornerSize),u=s.cornerShape||u,l=s.cornerBackgroundColor||l,h="number"===typeof s.cornerPadding?s.cornerPadding:h,c=s.cornerStrokeColor||c),this.useCustomIcons)if(u){switch(e.globalAlpha=1,e.fillStyle=l,e.lineWidth=1,e.strokeStyle=c,u){case"rect":e.fillRect(i,r,a,a),c&&e.strokeRect(i,r,a,a);break;case"circle":e.beginPath(),e.arc(i+a/2,r+a/2,a/2,0,2*Math.PI),e.fill(),c&&e.stroke(),e.closePath()}void 0!==o&&e[n](o,i+h/2,r+h/2,a-h,a-h)}else void 0!==o&&e[n](o,i,r,a,a);else"undefined"!==typeof G_vmlCanvasManager||this.transparentCorners||e.clearRect(i,r,a,a),e[n+"Rect"](i,r,a,a),!this.transparentCorners&&c&&e.strokeRect(i,r,a,a)}},_setCornerCoords:function(){var t=this.oCoords,e=i(45-this.angle);for(var r in t){var o,s,a=.707106*(this[r+"Settings"]&&this[r+"Settings"].cornerSize||this.cornerSize),c=a*n.util.cos(e),l=a*n.util.sin(e);o=t[r].x,s=t[r].y,t[r].corner={tl:{x:o-l,y:s-c},tr:{x:o+c,y:s-l},bl:{x:o-c,y:s+l},br:{x:o+l,y:s+c}}}}}),n.util.object.extend(n.Canvas.prototype,{overwriteActions:!1,fixedCursors:!1,customiseControls:function(t){var e;for(e in t)t.hasOwnProperty(e)&&(void 0!==t[e].action&&(this.overwriteActions=!0,this.setCustomAction(e,t[e].action)),void 0!==t[e].cursor&&(this.fixedCursors=!0,this.setCustomCursor(e,t[e].cursor)))},setCustomAction:function(t,e){this[t+"Action"]=e},setCustomCursor:function(t,e){this[t+"cursorIcon"]=e},customizeControls:function(t){this.customiseControls(t)},_getActionFromCorner:function(t,e,n){if(!e)return"drag";if(e)if(this[e+"Action"]&&this.overwriteActions)switch(e){case"mtr":return this[e+"Action"]||"rotate";case"ml":case"mr":return n[this.altActionKey]?n[this.altActionKey]?"skewY":"scaleX":this[e+"Action"];case"mt":case"mb":return n[this.altActionKey]?n[this.altActionKey]?"skewY":"scaleY":this[e+"Action"];default:return this[e+"Action"]||"scale"}else switch(e){case"mtr":return"rotate";case"ml":case"mr":return n[this.altActionKey]?"skewY":"scaleX";case"mt":case"mb":return n[this.altActionKey]?"skewX":"scaleY";default:return"scale"}return!1},_setupCurrentTransform:function(t,e,n){if(e){var r=this.getPointer(t),o=e._findTargetCorner(this.getPointer(t,!0)),s=this._getActionFromCorner(e,o,t),a=this._getOriginFromCorner(e,o);if("function"===typeof s){if(!n)return;s.call(this,t,e),s="void"}if(this._currentTransform={target:e,action:s,corner:o,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,offsetX:r.x-e.left,offsetY:r.y-e.top,originX:a.x,originY:a.y,ex:r.x,ey:r.y,lastX:r.x,lastY:r.y,left:e.left,top:e.top,theta:i(e.angle),width:e.width*e.scaleX,mouseXSign:1,mouseYSign:1,shiftKey:t.shiftKey,altKey:t[this.centeredKey]},this._currentTransform.original={left:e.left,top:e.top,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,originX:a.x,originY:a.y},"remove"===s){if(!n)return;this._removeAction(t,e)}if("moveUp"===s){if(!n)return;this._moveLayerUpAction(t,e)}if("moveDown"===s){if(!n)return;this._moveLayerDownAction(t,e)}if("object"===typeof s&&"rotateByDegrees"===Object.keys(s)[0]){if(!n)return;this._rotateByDegrees(t,e,s.rotateByDegrees)}this._resetCurrentTransform()}},_removeAction:function(t,e){var n=this;this.getActiveObjects()&&"undefined"!==this.getActiveObjects()?this.getActiveObjects().forEach((function(t){t.off(),n.discardActiveObject(),n.remove(t)})):(e.off(),this.discardActiveObject(),this.remove(e))},_moveLayerUpAction:function(t,e){this.getActiveObjects()&&"undefined"!==this.getActiveObjects()?this.getActiveObjects().forEach((function(t){t.bringForward()})):e.bringForward()},_moveLayerDownAction:function(t,e){this.getActiveObjects()&&"undefined"!==this.getActiveObjects()?this.getActiveObjects().forEach((function(t){t.sendBackwards()})):e.sendBackwards()},_rotateByDegrees:function(t,e,n){var i=parseInt(e.get("angle"))+n,r=!1;"center"===e.originX&&"center"===e.originY||!e.centeredRotation||(this._setOriginToCenter(e),r=!0),i=i>360?i-360:i,this.getActiveObjects()&&"undefined"!==this.getActiveObjects()?this.getActiveObjects().forEach((function(t){t.set("angle",i).setCoords()})):e.set("angle",i).setCoords(),r&&this._setCenterToOrigin(e),this.renderAll()},getCornerCursor:function(t,e,n){if(this.actionIsDisabled(t,e,n))return this.notAllowedCursor;if(this.fixedCursors&&this[t+"cursorIcon"])this[t+"cursorIcon"].match(/\.(?:jpe?g|png|gif|jpg|jpeg|svg)$/)?this.setCursor("url("+this[t+"cursorIcon"]+"), auto"):"resize"===this[t+"cursorIcon"]?this.setCursor(this._getRotatedCornerCursor(t,e,n)):this.setCursor(this[t+"cursorIcon"]);else if(t in r)this.setCursor(this._getRotatedCornerCursor(t,e,n));else{if("mtr"!==t||!e.hasRotatingPoint)return this.setCursor(this.defaultCursor),!1;this.setCursor(this.rotationCursor)}return!1}}),t.exports=this}(window)},function(t,e,n){var i;!function(r,o,s,a){"use strict";var c,l=["","webkit","Moz","MS","ms","o"],u=o.createElement("div"),h="function",f=Math.round,d=Math.abs,p=Date.now;function g(t,e,n){return setTimeout(S(t,n),e)}function m(t,e,n){return!!Array.isArray(t)&&(v(t,n[e],n),!0)}function v(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function y(t,e,n){var i="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),t.apply(this,arguments)}}c="function"!==typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==a&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var b=y((function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===a)&&(t[i[r]]=e[i[r]]),r++;return t}),"extend","Use `assign`."),x=y((function(t,e){return b(t,e,!0)}),"merge","Use `assign`.");function C(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&c(i,n)}function S(t,e){return function(){return t.apply(e,arguments)}}function w(t,e){return typeof t==h?t.apply(e&&e[0]||a,e):t}function _(t,e){return t===a?e:t}function D(t,e,n){v(O(e),(function(e){t.addEventListener(e,n,!1)}))}function T(t,e,n){v(O(e),(function(e){t.removeEventListener(e,n,!1)}))}function E(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function k(t,e){return t.indexOf(e)>-1}function O(t){return t.trim().split(/\s+/g)}function A(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function P(t){return Array.prototype.slice.call(t,0)}function I(t,e,n){for(var i=[],r=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];A(r,s)<0&&i.push(t[o]),r[o]=s,o++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function F(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),o=0;o<l.length;){if((i=(n=l[o])?n+r:e)in t)return i;o++}return a}var M=1;function L(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||r}var R="ontouchstart"in r,j=F(r,"PointerEvent")!==a,B=R&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),U=25,z=1,N=2,W=4,H=8,X=1,G=2,Y=4,q=8,V=16,Z=G|Y,Q=q|V,K=Z|Q,$=["x","y"],J=["clientX","clientY"];function tt(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){w(t.options.enable,[t])&&n.handler(e)},this.init()}function et(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,o=e&z&&i-r===0,s=e&(W|H)&&i-r===0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=nt(e));r>1&&!n.firstMultiple?n.firstMultiple=nt(e):1===r&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,c=s?s.center:o.center,l=e.center=it(i);e.timeStamp=p(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=at(c,l),e.distance=st(c,l),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};e.eventType!==z&&o.eventType!==W||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y});e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=ot(e.deltaX,e.deltaY);var u=rt(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=d(u.x)>d(u.y)?u.x:u.y,e.scale=s?(h=s.pointers,f=i,st(f[0],f[1],J)/st(h[0],h[1],J)):1,e.rotation=s?function(t,e){return at(e[1],e[0],J)+at(t[1],t[0],J)}(s.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,r,o,s=t.lastInterval||e,c=e.timeStamp-s.timeStamp;if(e.eventType!=H&&(c>U||s.velocity===a)){var l=e.deltaX-s.deltaX,u=e.deltaY-s.deltaY,h=rt(c,l,u);i=h.x,r=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=ot(l,u),t.lastInterval=e}else n=s.velocity,i=s.velocityX,r=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=o}(n,e);var h,f;var g=t.element;E(e.srcEvent.target,g)&&(g=e.srcEvent.target);e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function nt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:f(t.pointers[n].clientX),clientY:f(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:it(e),deltaX:t.deltaX,deltaY:t.deltaY}}function it(t){var e=t.length;if(1===e)return{x:f(t[0].clientX),y:f(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:f(n/e),y:f(i/e)}}function rt(t,e,n){return{x:e/t||0,y:n/t||0}}function ot(t,e){return t===e?X:d(t)>=d(e)?t<0?G:Y:e<0?q:V}function st(t,e,n){n||(n=$);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function at(t,e,n){n||(n=$);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}tt.prototype={handler:function(){},init:function(){this.evEl&&D(this.element,this.evEl,this.domHandler),this.evTarget&&D(this.target,this.evTarget,this.domHandler),this.evWin&&D(L(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(L(this.element),this.evWin,this.domHandler)}};var ct={mousedown:z,mousemove:N,mouseup:W},lt="mousedown",ut="mousemove mouseup";function ht(){this.evEl=lt,this.evWin=ut,this.pressed=!1,tt.apply(this,arguments)}C(ht,tt,{handler:function(t){var e=ct[t.type];e&z&&0===t.button&&(this.pressed=!0),e&N&&1!==t.which&&(e=W),this.pressed&&(e&W&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var ft={pointerdown:z,pointermove:N,pointerup:W,pointercancel:H,pointerout:H},dt={2:"touch",3:"pen",4:"mouse",5:"kinect"},pt="pointerdown",gt="pointermove pointerup pointercancel";function mt(){this.evEl=pt,this.evWin=gt,tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(pt="MSPointerDown",gt="MSPointerMove MSPointerUp MSPointerCancel"),C(mt,tt,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=ft[i],o=dt[t.pointerType]||t.pointerType,s="touch"==o,a=A(e,t.pointerId,"pointerId");r&z&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):r&(W|H)&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var vt={touchstart:z,touchmove:N,touchend:W,touchcancel:H},yt="touchstart",bt="touchstart touchmove touchend touchcancel";function xt(){this.evTarget=yt,this.evWin=bt,this.started=!1,tt.apply(this,arguments)}function Ct(t,e){var n=P(t.touches),i=P(t.changedTouches);return e&(W|H)&&(n=I(n.concat(i),"identifier",!0)),[n,i]}C(xt,tt,{handler:function(t){var e=vt[t.type];if(e===z&&(this.started=!0),this.started){var n=Ct.call(this,t,e);e&(W|H)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var St={touchstart:z,touchmove:N,touchend:W,touchcancel:H},wt="touchstart touchmove touchend touchcancel";function _t(){this.evTarget=wt,this.targetIds={},tt.apply(this,arguments)}function Dt(t,e){var n=P(t.touches),i=this.targetIds;if(e&(z|N)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,s=P(t.changedTouches),a=[],c=this.target;if(o=n.filter((function(t){return E(t.target,c)})),e===z)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<s.length;)i[s[r].identifier]&&a.push(s[r]),e&(W|H)&&delete i[s[r].identifier],r++;return a.length?[I(o.concat(a),"identifier",!0),a]:void 0}C(_t,tt,{handler:function(t){var e=St[t.type],n=Dt.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});var Tt=2500,Et=25;function kt(){tt.apply(this,arguments);var t=S(this.handler,this);this.touch=new _t(this.manager,t),this.mouse=new ht(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Ot(t,e){t&z?(this.primaryTouch=e.changedPointers[0].identifier,At.call(this,e)):t&(W|H)&&At.call(this,e)}function At(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)}),Tt)}}function Pt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(e-r.x),s=Math.abs(n-r.y);if(o<=Et&&s<=Et)return!0}return!1}C(kt,tt,{handler:function(t,e,n){var i="touch"==n.pointerType,r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)Ot.call(this,e,n);else if(r&&Pt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var It=F(u.style,"touchAction"),Ft=It!==a,Mt="auto",Lt="manipulation",Rt="none",jt="pan-x",Bt="pan-y",Ut=function(){if(!Ft)return!1;var t={},e=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||r.CSS.supports("touch-action",n)})),t}();function zt(t,e){this.manager=t,this.set(e)}zt.prototype={set:function(t){"compute"==t&&(t=this.compute()),Ft&&this.manager.element.style&&Ut[t]&&(this.manager.element.style[It]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return v(this.manager.recognizers,(function(e){w(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(k(t,Rt))return Rt;var e=k(t,jt),n=k(t,Bt);if(e&&n)return Rt;if(e||n)return e?jt:Bt;if(k(t,Lt))return Lt;return Mt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,r=k(i,Rt)&&!Ut[Rt],o=k(i,Bt)&&!Ut[Bt],s=k(i,jt)&&!Ut[jt];if(r){var a=1===t.pointers.length,c=t.distance<2,l=t.deltaTime<250;if(a&&c&&l)return}if(!s||!o)return r||o&&n&Z||s&&n&Q?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Nt=1,Wt=2,Ht=4,Xt=8,Gt=Xt,Yt=16;function qt(t){this.options=c({},this.defaults,t||{}),this.id=M++,this.manager=null,this.options.enable=_(this.options.enable,!0),this.state=Nt,this.simultaneous={},this.requireFail=[]}function Vt(t){return t&Yt?"cancel":t&Xt?"end":t&Ht?"move":t&Wt?"start":""}function Zt(t){return t==V?"down":t==q?"up":t==G?"left":t==Y?"right":""}function Qt(t,e){var n=e.manager;return n?n.get(t):t}function Kt(){qt.apply(this,arguments)}function $t(){Kt.apply(this,arguments),this.pX=null,this.pY=null}function Jt(){Kt.apply(this,arguments)}function te(){qt.apply(this,arguments),this._timer=null,this._input=null}function ee(){Kt.apply(this,arguments)}function ne(){Kt.apply(this,arguments)}function ie(){qt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function re(t,e){return(e=e||{}).recognizers=_(e.recognizers,re.defaults.preset),new oe(t,e)}qt.prototype={defaults:{},set:function(t){return c(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(m(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Qt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return m(t,"dropRecognizeWith",this)?this:(t=Qt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(m(t,"requireFailure",this))return this;var e=this.requireFail;return-1===A(e,t=Qt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(m(t,"dropRequireFailure",this))return this;t=Qt(t,this);var e=A(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<Xt&&i(e.options.event+Vt(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),n>=Xt&&i(e.options.event+Vt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Nt)))return!1;t++}return!0},recognize:function(t){var e=c({},t);if(!w(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(Gt|Yt|32)&&(this.state=Nt),this.state=this.process(e),this.state&(Wt|Ht|Xt|Yt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},C(Kt,qt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=e&(Wt|Ht),r=this.attrTest(t);return i&&(n&H||!r)?e|Yt:i||r?n&W?e|Xt:e&Wt?e|Ht:Wt:32}}),C($t,Kt,{defaults:{event:"pan",threshold:10,pointers:1,direction:K},getTouchAction:function(){var t=this.options.direction,e=[];return t&Z&&e.push(Bt),t&Q&&e.push(jt),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,o=t.deltaX,s=t.deltaY;return r&e.direction||(e.direction&Z?(r=0===o?X:o<0?G:Y,n=o!=this.pX,i=Math.abs(t.deltaX)):(r=0===s?X:s<0?q:V,n=s!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return Kt.prototype.attrTest.call(this,t)&&(this.state&Wt||!(this.state&Wt)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Zt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),C(Jt,Kt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Rt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Wt)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),C(te,qt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Mt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(W|H)&&!r)this.reset();else if(t.eventType&z)this.reset(),this._timer=g((function(){this.state=Gt,this.tryEmit()}),e.time,this);else if(t.eventType&W)return Gt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Gt&&(t&&t.eventType&W?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),C(ee,Kt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Rt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Wt)}}),C(ne,Kt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Z|Q,pointers:1},getTouchAction:function(){return $t.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Z|Q)?e=t.overallVelocity:n&Z?e=t.overallVelocityX:n&Q&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&d(e)>this.options.velocity&&t.eventType&W},emit:function(t){var e=Zt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),C(ie,qt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Lt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&z&&0===this.count)return this.failTimeout();if(i&&r&&n){if(t.eventType!=W)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||st(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=g((function(){this.state=Gt,this.tryEmit()}),e.interval,this),Wt):Gt}return 32},failTimeout:function(){return this._timer=g((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Gt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),re.VERSION="2.0.7",re.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[ee,{enable:!1}],[Jt,{enable:!1},["rotate"]],[ne,{direction:Z}],[$t,{direction:Z},["swipe"]],[ie],[ie,{event:"doubletap",taps:2},["tap"]],[te]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function oe(t,e){this.options=c({},re.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=function(t){var e=t.options.inputClass;return new(e||(j?mt:B?_t:R?kt:ht))(t,et)}(this),this.touchAction=new zt(this,this.options.touchAction),se(this,!0),v(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function se(t,e){var n,i=t.element;i.style&&(v(t.options.cssProps,(function(r,o){n=F(i.style,o),e?(t.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}oe.prototype={set:function(t){return c(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&Gt)&&(r=e.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&n.state&(Wt|Ht|Xt)&&(r=e.curRecognizer=n),o++}},get:function(t){if(t instanceof qt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(m(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(m(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=A(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return v(O(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return v(O(t),(function(t){e?n[t]&&n[t].splice(A(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&se(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},c(re,{INPUT_START:z,INPUT_MOVE:N,INPUT_END:W,INPUT_CANCEL:H,STATE_POSSIBLE:Nt,STATE_BEGAN:Wt,STATE_CHANGED:Ht,STATE_ENDED:Xt,STATE_RECOGNIZED:Gt,STATE_CANCELLED:Yt,STATE_FAILED:32,DIRECTION_NONE:X,DIRECTION_LEFT:G,DIRECTION_RIGHT:Y,DIRECTION_UP:q,DIRECTION_DOWN:V,DIRECTION_HORIZONTAL:Z,DIRECTION_VERTICAL:Q,DIRECTION_ALL:K,Manager:oe,Input:tt,TouchAction:zt,TouchInput:_t,MouseInput:ht,PointerEventInput:mt,TouchMouseInput:kt,SingleTouchInput:xt,Recognizer:qt,AttrRecognizer:Kt,Tap:ie,Pan:$t,Swipe:ne,Pinch:Jt,Rotate:ee,Press:te,on:D,off:T,each:v,merge:x,extend:b,assign:c,inherit:C,bindFn:S,prefixed:F}),("undefined"!==typeof r?r:"undefined"!==typeof self?self:{}).Hammer=re,(i=function(){return re}.call(e,n,e,t))===a||(t.exports=i)}(window,document)},function(t,e,n){var i=n(18).fabric;n(169);var r=n(130),o=r.isSpaceChar,s=r.splitWords,a=r.computeStroke,c=r.drawPaths;window._fillTextOpentype=function(t,e,n,i,r){var o;o=this.lineMetrics?this.lineMetrics:this.measureText(t);var s=_getFontFamilyOpentype.call(this),a=!!Font.hasFont(s)&&Font.resolve(s);if(!a)return this._fillText?this._fillText.call(this,t,e,n,i):this.fillText.call(this,t,e,n);var l={kerning:!0,tracking:r,features:{liga:this.ligatures,rlig:this.ligatures}},u=a.getPaths(t,e,n,_getFontSizeOpentype.call(this),l),h=!1,f=0,d=0,p=!1,g=!1,m=!1;if(i&&o.totalWidthNoJustify<i){g=!0;var v=i-o.totalWidthNoJustify,y=t.match(/\s/g);y?d=v/y.length:(m=!0,d=v/(t.length-1))}for(var b=0;b<u.length;++b){var x=u[b],C=t[b];x.character=C,g&&(h||m&&0!==b)&&(p=!0,f+=d,h=!1),g&&i&&/[ \t\r]/.test(C)&&(h=!0),x.offsetY=0,x.offsetX=f}return this.save(),this.strokeStyle=this.opentypeStroke,this.lineWidth=this.opentypeStrokeWidth,this.lineJoin="round",c(u,this,this.opentypeStrokeWidth>0,!1),this.lineWidth=0,c(u,this,!1,!0),this.restore(),p&&(o.width=i+(this.opentypeStrokeWidth||0),o.totalWidth=i+(this.opentypeStrokeWidth||0)),this.lastDrawnData={paths:u,x:e,y:n,strokeWidth:this.opentypeStrokeWidth},o},window._getFontSizeOpentype=function(){return this.trueFontSize||1*this.font.match(/\d+/)[0]},window._getFontFamilyOpentype=function(){var t=this.font.match(/(\s*\d+(\.\d{1,50})?)px (.*)/);return t?t[t.length-1]:""};var l=new RegExp("\\s$","gi");window._measureTextOpentype=function(t,e,n,i){var r=_getFontFamilyOpentype.call(this),o=!!Font.hasFont(r)&&Font.resolve(_getFontFamilyOpentype.call(this)),s=!0;if(!o)return s=!1,this._measureText?this._measureText.call(this,t):this.measureText.call(this,t);"undefined"===typeof e&&(e=!1),this.lineSpacing=this.lineSpacing||1,this.lineSpacing<0&&(lineSpacing=.01);var c=_getFontSizeOpentype.call(this),u=0,h=-99999999,f=-99999999,d=99999999,p=99999999,g=0,m=0,v=0,y=0,b=1/o.unitsPerEm*c,x=o.fontHeight*b*this.lineSpacing,C=o.totalAscender*b,S=o.totalDescender*b,w=0,_=0;if((this.opentypeStrokeWidth||0)>0){var D=t[0],T=t[t.length-1];D&&T&&(w=a(D,o,c,this.strokeRenderingCanvas,this.opentypeStrokeWidth||0,e,i,this.ligatures,"left"),_=a(T,o,c,this.strokeRenderingCanvas,this.opentypeStrokeWidth||0,e,i,this.ligatures,"right"))}o.forEachGlyph(t,0,0,c,{kerning:e,tracking:i,features:{liga:this.ligatures,rlig:this.ligatures}},(function(t,e,n,i){var r=1/(t.path.unitsPerEm||o.unitsPerEm)*i;if(t.path.commands.length>0&&r){var s=t.getMetrics();"space"!==t.name&&32!==t.unicode||0!==s.xMax||0!==s.xMin||0!==s.yMax||0!==s.yMin?(h=Math.max(s.xMax*r+e,h),d=Math.min(s.xMin*r+e,d),f=Math.max(s.yMax*r+n,f),p=Math.min(s.yMin*r+n,p),0==u&&(v=s.leftSideBearing*r),y=s.rightSideBearing*r,g=Math.max(g,t.descent*r),m=Math.max(m,t.ascent*r)):(h=Math.max(t.advanceWidth*r+e,h),d=Math.min(e,d),f=Math.max(n,f),p=Math.min(n,p))}else r?(h=Math.max(t.advanceWidth*r+e,h),d=Math.min(e,d),f=Math.max(n,f),p=Math.min(n,p)):(h=Math.max(e,h),d=Math.min(e,d),f=Math.max(n,f),p=Math.min(n,p));++u})),t||(h=f=d=p=0);var E,k=h-d,O=f-p;0==k&&(k=1),0==O&&(O=1),o.forEachGlyph(t+" ",0,0,c,{kerning:e,tracking:i,features:{liga:this.ligatures,rlig:this.ligatures}},(function(t,e,n){E=e}));var A=k+w+_;return n&&t.length>1&&null==l.exec(t)&&(E=k=n-w-_),k+=w+_,{width:E+=w+_,height:O+(this.opentypeStrokeWidth||0),heightNoStroke:O,totalWidth:k,totalWidthNoJustify:A,minY:p,maxY:f,minX:d,maxX:h,fontHeight:x,fontAscender:C,fontDescender:S,descent:g,ascent:m,leftSideBearing:v,rightSideBearing:y,leftStrokeWidth:w,rightStrokeWidth:_,isOpenTypeMetrics:s}};var u=["maxWidth","maxHeight","text","fontSize","fontFamily","fontWeight","fontStyle","minFontSize","maxFontSize","tracking","ligatures","lineSpacing","textAlign","multiline","opentypeStrokeWidth"],h={},f={};i.OpentypeIText=i.util.createClass(i.Object,{type:"opentype-itext",_dimensionAffectingProps:u,cacheProperties:i.Object.prototype.cacheProperties.concat(u,"opentypeStroke","fillPattern"),width:1,height:1,maxWidth:1,maxHeight:1,minFontSize:1,maxFontSize:1,text:"",fontFamily:"Arial",fontSize:1,multiline:!1,tracking:0,lineSpacing:1,ligatures:!0,_ligaturesNotSupported:!1,flatCharHeightCache:{},lineHeight:1.16,_fontSizeMult:1,_fontSizeFraction:0,_textData:null,_fillPatternNeedsUpdate:!0,__fillPatternImage:null,__fillPattern:null,_lastDrawnData:{},opentypeStrokeWidth:0,opentypeStroke:"#000000",strokeRenderingCanvas:null,CACHE_FONT_SIZE:200,initialize:function(t,e){this.callSuper("initialize",e),this.text=t,e.version=e.version||i.BoundedText.prototype.version,this.strokeRenderingCanvas=i.util.createCanvasElement(),this._setWidthHeight()},_measureTextOpenType:function(t,e,n,i,r){try{return{metric:window._measureTextOpentype.call(t,e,n,i,r),disableLigatures:!1}}catch(o){if(!this._ligaturesNotSupported&&o&&o.message.indexOf("is not yet supported")>-1)return this._ligaturesNotSupported=!0,console.warn("Disabling ligatures for font "+this.fontFamily),t.ligatures=!1,{metric:window._measureTextOpentype.call(t,e,n,i,r),disableLigatures:!0};throw o}},_splitTextIntoLines:function(t,e,n,i){for(var r=t.split(" "),o=[],s=r[0],a=1;a<r.length;a++){var c=r[a],l=this._getTextMetrics(s+" "+c,e),u=i/this.CACHE_FONT_SIZE;l.textWidth*u<n?s+=" "+c:(o.push(s),s=c)}return o.push(s),o.join("\n")},_getCtxCacheKey:function(t,e,n){return"".concat(t.font,":").concat(t.lineSpacing,":").concat(t.opentypeStrokeWidth,":").concat(e,":").concat(!!n)},_joinWordsMetrics:function(t,e,n,r,s){for(var a={width:0,totalWidth:0,height:i.util.array.max(e,"height")+s,heightNoStroke:i.util.array.max(e,"heightNoStroke"),minY:i.util.array.min(e,"minY"),maxY:i.util.array.max(e,"maxY"),totalWidthNoJustify:0,fontHeight:e[0].fontHeight,fontAscender:e[0].fontAscender,fontDescender:e[0].fontDescender,descent:i.util.array.max(e,"descent"),ascent:i.util.array.max(e,"ascent"),leftSideBearing:e[0].leftSideBearing,rightSideBearing:e[e.length-1].rightSideBearing,leftStrokeWidth:o(t[0])?0:s/2,rightStrokeWidth:o(t[t.length-1])?0:s/2},c=0;c<t.length;c++){var l=t[c],u=e[c];if(a.width+=u.width,a.totalWidth+=u.totalWidth,o(l)){var h=e[c-1],f=e[c+1],d=t[c-1],p=(h?h.rightSideBearing:0)+(f?f.leftSideBearing:0);p+=(0===c||o(d)?1:2)*(n/1e3)*r,a.totalWidth+=p,a.width+=p}}return a.totalWidthNoJustify=a.totalWidth,a},_getTextMetrics:function(t,e){var n=t.replace(/\r\n/g,"\n").split("\n"),r=this.getMeasuringContext();r.opentypeStrokeWidth=0;var o=this._getCtxCacheKey(r,e,r.ligatures);h[o]||(h[o]={}),f[o]&&(r.ligatures=!1,this._ligaturesNotSupported=!0);var a=[],c=!0,l=!1,u=void 0;try{for(var d,p=n[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var g=d.value,m=s(g),v=[],y=!0,b=!1,x=void 0;try{for(var C,S=m[Symbol.iterator]();!(y=(C=S.next()).done);y=!0){var w=C.value;if(h[o][w])v.push(h[o][w]);else{var _=this._measureTextOpenType(r,w,!0,null,e),D=_.metric,T=_.disableLigatures;f[o]=T,T&&(r.ligatures=!1),D&&D.isOpenTypeMetrics&&(h[o][w]=D),v.push(D)}}}catch(M){b=!0,x=M}finally{try{y||null==S.return||S.return()}finally{if(b)throw x}}var E=this._joinWordsMetrics(m,v,e,this.CACHE_FONT_SIZE,this.opentypeStrokeWidth);a.push(E)}}catch(M){l=!0,u=M}finally{try{c||null==p.return||p.return()}finally{if(l)throw u}}for(var k=0,O=0,A=a;O<A.length;O++){k+=A[O].fontHeight}var P=i.util.array.max(a,"totalWidth"),I=a.some((function(t){return t.leftStrokeWidth>0}))?this.opentypeStrokeWidth/2:0,F=a.some((function(t){return t.rightStrokeWidth>0}))?this.opentypeStrokeWidth/2:0;return{lineMetrics:a,textLines:n,textWidth:P,textHeight:k,leftStrokeWidth:I,rightStrokeWidth:F}},_getBoundedTextMetrics:function(t,e,n,i){var r=this._getTextMetrics(t,e),o=r.lineMetrics,s=r.textLines,a=r.textWidth,c=r.textHeight,l=r.leftStrokeWidth,u=r.rightStrokeWidth,h=(n-l-u)/a,f=i/c,d=Math.min(h,f),p=d*this.CACHE_FONT_SIZE;if(p>this.maxFontSize)d*=this.maxFontSize/p,p=this.maxFontSize;else if(p<this.minFontSize){var g=t,m=0,v=0,y=0;do{var b=!0;if(this.multiline&&1===m){var x=this._splitTextIntoLines(t,e,n-this.opentypeStrokeWidth,this.minFontSize),C="",S=1,w=1;do{var _=x.lastIndexOf("\n");if(!(_>-1))break;C=x.slice(_+1),x=x.slice(0,_);var D=this._getTextMetrics(x,e);w=(n-D.leftStrokeWidth-D.rightStrokeWidth)/D.textWidth,S=i/D.textHeight}while(Math.min(S,w)*this.CACHE_FONT_SIZE<this.minFontSize&&x);t=x,C?t+="\n"+C:b=!1}m>0&&b&&(t=t.slice(0,t.length-1)),this.multiline?(p=this.minFontSize,g=this._splitTextIntoLines(t,e,n-this.opentypeStrokeWidth,p)):g=t;var T=this._getTextMetrics(g,e);o=T.lineMetrics,s=T.textLines,a=T.textWidth,c=T.textHeight,y=(n-(l=T.leftStrokeWidth)-(u=T.rightStrokeWidth))/a,v=i/c,p=(d=Math.min(v,y))*this.CACHE_FONT_SIZE,++m}while(p<this.minFontSize&&t.length);p>this.maxFontSize&&(p=(d=this.maxFontSize/this.CACHE_FONT_SIZE)*this.CACHE_FONT_SIZE)}var E=!0,k=!1,O=void 0;try{for(var A,P=o[Symbol.iterator]();!(E=(A=P.next()).done);E=!0){var I=A.value;for(var F in I)"leftStrokeWidth"!==F&&"rightStrokeWidth"!==F&&(I[F]=I[F]*d)}}catch(z){k=!0,O=z}finally{try{E||null==P.return||P.return()}finally{if(k)throw O}}var M=!0,L=!1,R=void 0;try{for(var j,B=o[Symbol.iterator]();!(M=(j=B.next()).done);M=!0){var U=j.value;U.totalWidth+=U.leftStrokeWidth+U.rightStrokeWidth,U.totalWidthNoJustify+=U.leftStrokeWidth+U.rightStrokeWidth}}catch(z){L=!0,R=z}finally{try{M||null==B.return||B.return()}finally{if(L)throw R}}return{fontSize:p,textLines:s,metrics:o,textWidth:a*d+l+u,textHeight:c*d+this.opentypeStrokeWidth}},getMeasuringContext:function(){i._measuringContext||(i._measuringContext=this.canvas&&this.canvas.contextCache||i.util.createCanvasElement().getContext("2d"));var t=i._measuringContext;return t.lineSpacing=this.lineSpacing,t.ligatures=!this._ligaturesNotSupported&&this.ligatures,t.font=i.Text.prototype._getFontDeclaration.call(this,{fontFamily:this.fontFamily,fontSize:this.CACHE_FONT_SIZE,fontWeight:this.fontWeight,fontStyle:this.fontStyle},!0),t.trueFontSize=this.CACHE_FONT_SIZE,t.strokeRenderingCanvas=this.strokeRenderingCanvas,t},_setWidthHeight:function(){this._textData=this._getBoundedTextMetrics(this.text,this.tracking,this.maxWidth,this.maxHeight),this.width="justify"===this.textAlign?this.maxWidth:this._textData.textWidth,this.height=this._textData.textHeight,this.fontSize=this._textData.fontSize},_set:function(t,e){return"fontFamily"===t?(this.flatCharHeightCache={},this._ligaturesNotSupported=!1):"fillPattern"===t&&(this._fillPatternNeedsUpdate=!0),this.callSuper("_set",t,e),this._dimensionAffectingProps.indexOf(t)>-1&&this._setWidthHeight(),this},getTextPaths:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=0;i<t.length;++i)for(var r=t[i],o=r.offsetX+e,s=r.offsetY+n,a=0;a<r.commands.length;a+=1){var c=r.commands[a];"M"===c.type||"L"===c.type?(c.x+=o,c.y+=s):"C"===c.type?(c.x+=o,c.y+=s,c.x1+=o,c.y1+=s,c.x2+=o,c.y2+=s):"Q"===c.type&&(c.x+=o,c.y+=s,c.x1+=o,c.y1+=s)}return t},n=this.maxWidth,i=this.maxHeight,r=[];if(this._lastDrawnData&&Object.keys(this._lastDrawnData).length){for(var o=Object.keys(this._lastDrawnData),s=0;s<o.length;s++){var a=o[s],c=this._lastDrawnData[a],l=-c.x+(n-this.width)/2-(-c.x-this.width/2);"left"===this.textAlign?l-=(n-this.width)/2:"right"===this.textAlign&&(l+=(n-this.width)/2);for(var u=c.y+(i-this.height)/2-(c.y-this.height/2),h=e(c.paths,l,u),f=0;f<h.length;f++){var d=h[f];r.push(t?d.toSVG(8):d.toPathData(8))}}return{paths:r,strokeWidth:this._lastDrawnData[0].strokeWidth,width:n,height:i}}return null},_renderBackground:function(t){var e={x:t.canvas.width,y:t.canvas.height};t.clearRect(-e.x/2,-e.y/2,e.x,e.y),this.backgroundColor&&(e=this._getNonTransformedDimensions(),t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t))},_render:function(t){var e=this;if(t.strokeRenderingCanvas=this.strokeRenderingCanvas,this._fillPatternNeedsUpdate&&this.fillPattern){this._fillPatternNeedsUpdate=!1,this._fillPatternImage=this.fillPattern;var n=this.getMeasuringContext();if(this._fillPattern=n.createPattern(this.fillPattern.source,this.fillPattern.repeat||"repeat"),!this._fillPattern){console.warn("Pattern was null, recreating");var i=0,r=setInterval((function(){e._fillPattern=n.createPattern(e.fillPattern.source,e.fillPattern.repeat||"repeat"),e._fillPattern?clearInterval(r):++i>10&&(clearInterval(r),console.error("Failed to create pattern"))}),50)}}this._renderTextCommon(t)},getFlatCharacterHeight:function(){var t=this.getMeasuringContext(),e=this.fontSize/this.CACHE_FONT_SIZE,n=0;if(this.flatCharHeightCache.x&&this.flatCharHeightCache.x.font===t.font&&this.flatCharHeightCache.x.strokeWidth===t.opentypeStrokeWidth&&this.textAlign===this.flatCharHeightCache.x.textAlign)n=this.flatCharHeightCache.x.height;else{var i=this._measureTextOpenType(t,"x",!0,null,this.tracking).metric;this.flatCharHeightCache.x={},this.flatCharHeightCache.x.font=t.font,this.flatCharHeightCache.x.strokeWidth=t.opentypeStrokeWidth,this.flatCharHeightCache.x.textAlign=this.textAlign,this.flatCharHeightCache.x.height=i.heightNoStroke,n=i.heightNoStroke}return n*=e},_renderTextCommon:function(t){var e;this._lastDrawnData={};var n=this._textData,r=n.textLines,o=n.metrics,s=n.textHeight;t.opentypeStroke=this.opentypeStroke,t.opentypeStrokeWidth=this.opentypeStrokeWidth,t.lineSpacing=this.lineSpacing,t.ligatures=!this._ligaturesNotSupported&&this.ligatures,t.font=i.Text.prototype._getFontDeclaration.call(this,{fontFamily:this.fontFamily,fontSize:this.fontSize,fontWeight:this.fontWeight,fontStyle:this.fontStyle},!1),t.trueFontSize=this.fontSize,t._fillPattern=this._fillPattern,t._fillPatternImage=this._fillPatternImage;var a=0,c=0,l=[];1===r.length&&"justify"!==this.textAlign?(e=o[0],c=-this.width/2):c=-this.width/2;for(var u=s/2-(s-(1===o.length?this.getFlatCharacterHeight():o[0].maxY+o[0].fontHeight*(o.length-1)))/2-o[0].fontHeight*(o.length-1),h=0,f=r.length;h<f;h++){var d=0;1===r.length&&"justify"!==this.textAlign||(e=o[h]),"center"===this.textAlign&&(d=(this.width-e.totalWidth)/2),"right"===this.textAlign&&(d=this.width-e.totalWidth),d+=e.leftStrokeWidth;var p=e.fontHeight;l[h]=p,h>0&&(a+=l[h-1]),this._renderTextLine(t,r[h],"justify"===this.textAlign,c+d-e.leftSideBearing,a+u-this.opentypeStrokeWidth/2,h,e)}},_renderTextLine:function(t,e,n,i,r,o,s){return t.save(),t.lineMetrics=s,info=window._fillTextOpentype.call(t,e,i,r,n?this.maxWidth:null,this.tracking),this._lastDrawnData[o]=Object.assign({},t.lastDrawnData,{width:this.width,height:this.height}),t.lineMetrics=null,t.restore(),info}})},function(t,e){String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t})},function(t,e,n){"use strict";n.r(e),n.d(e,"isSpaceChar",(function(){return i})),n.d(e,"splitWords",(function(){return r})),n.d(e,"drawPaths",(function(){return o})),n.d(e,"computeStroke",(function(){return s}));var i=function(t){return["\r","\n","\t","\f","\v"," "].indexOf(t)>-1},r=function(t){var e=[],n="";if(!t)return[""];var r=!0,o=!1,s=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var l=a.value;i(l)?(n&&e.push(n),e.push(l),n=""):n+=l}}catch(u){o=!0,s=u}finally{try{r||null==c.return||c.return()}finally{if(o)throw s}}return n&&e.push(n),e},o=function(t,e,n,i){if(i||n){e.beginPath();for(var r=0;r<t.length;++r)for(var o=t[r],s=o.offsetX,a=o.offsetY,c=0;c<o.commands.length;c+=1){var l=o.commands[c];"M"===l.type?e.moveTo(l.x+s,l.y+a):"L"===l.type?e.lineTo(l.x+s,l.y+a):"C"===l.type?e.bezierCurveTo(l.x1+s,l.y1+a,l.x2+s,l.y2+a,l.x+s,l.y+a):"Q"===l.type?e.quadraticCurveTo(l.x1+s,l.y1+a,l.x+s,l.y+a):"Z"===l.type&&e.closePath()}e.closePath(),e.lineWidth&&n&&e.stroke(),e.fillStyle&&i&&(e.fill(),e._fillPattern&&(e.save(),e.fillStyle=e._fillPattern,e.transform(e._fillPatternImage.scaleX||1,0,0,e._fillPatternImage.scaleY||1,-e._fillPatternImage.source.width/2,-e._fillPatternImage.source.height/2),e.fill(),e.restore()))}},s=function(t,e,n,i,r,s,a,c,l){var u=e.getPath(t,0,0,n,{kerning:s,tracking:a,features:{liga:c,rlig:c}}),h=u.getBoundingBox();i.width=h.x2-h.x1+3*r+2,i.height=h.y2-h.y1+3*r+2;var f=i.getContext("2d");f.lineJoin="round",f.clearRect(0,0,i.width,i.height),f.save(),f.fillStyle="#000000",f.strokeStyle=r>0?"#ff0000":null,f.lineWidth=r,u.offsetX=2*r,"right"===l&&(u.offsetX=0),u.offsetY=i.height-r,o([u],f,!0,!0);var d=f.getImageData(0,0,i.width,i.height).data,p=-1,g=-1,m=fabric.Color.sourceFromHex("#000000"),v=0;if("left"===l)for(var y=0;y<i.width;++y)for(var b=0;b<i.height;++b){var x=d[_=b*(4*i.width)+4*y],C=d[_+1],S=d[_+2],w=d[_+3];if(0===x&&0===C&&0===S&&0===w);else{if(0!==w&&x===m[0]&&C===m[1]&&S===m[2]){g=y,v=-1===p?0:g-p+1,y=i.width;break}-1===p&&(p=y)}}else for(y=i.width-1;y>=0;--y)for(b=0;b<i.height;++b){var _;x=d[_=b*(4*i.width)+4*y],C=d[_+1],S=d[_+2],w=d[_+3];if(0===x&&0===C&&0===S&&0===w);else{if(0!==w&&x===m[0]&&C===m[1]&&S===m[2]){g=y,v=-1===p?0:p-g+1,y=-1;break}-1===p&&(p=y)}}return v}},function(t,e,n){(function(t){var i;!function(r){var o=e,s=(t&&t.exports,"object"==typeof global&&global);s.global!==s&&s.window;var a=/([\0-\u02FF\u0370-\u1AAF\u1B00-\u1DBF\u1E00-\u20CF\u2100-\uD7FF\uE000-\uFE1F\uFE30-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])([\u0300-\u036F\u1AB0-\u1AFF\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]+)/g,c=/([\uD800-\uDBFF])([\uDC00-\uDFFF])/g,l=function(t){for(var e="",n=(t=t.replace(a,(function(t,e,n){return l(n)+e})).replace(c,"$2$1")).length;n--;)e+=t.charAt(n);return e},u={version:"0.2.0",reverse:l};void 0===(i=function(){return u}.call(e,n,e,t))||(t.exports=i)}()}).call(this,n(40)(t))},function(t,e,n){var i=n(18).fabric;n(133);var r=n(134);i.PathIText=i.util.createClass(i.Text,{type:"path-itext",cacheProperties:i.Text.prototype.cacheProperties.concat("prefix","suffix","startAngle","endAngle","convex","pathWidth","lockAngleControls"),width:1,height:1,caps:!1,path:null,pathProperties:null,pathWidth:1,pathColor:"#ff0000",currentLineHeight:1,fontFamily:"Arial",textAlign:"center",convex:!1,prefix:"",suffix:"",lockUniScalingWithSkew:!1,verticalDiameter:1,horizontalDiameter:1,stroke:"#000000",strokeWidth:0,opentypeStrokeWidth:0,opentypeStroke:"#000000",startAngle:315,endAngle:45,lockAngleControls:!1,_startArcOffset:0,_endArcOffset:0,_maxTextArcLength:0,_pathLength:0,CACHE_FONT_SIZE:200,_angleControlsCords:{},_lockMovementXBackup:!1,_lockMovementYBackup:!1,_draggingAngleControl:null,initialize:function(t,e){e.objectCaching=!0,e.noScaleCache=!1,this.setRadius(e.horizontalDiameter/2,e.verticalDiameter/2),this.fontFamily=e.fontFamily||this.fontFamily,this.callSuper("initialize",t,e),this.on({added:function(){this.cornerSize=.025*this.canvas.width},scaling:function(){if(this.lockUniScalingWithSkew){var t=this.scaleX;this._lastScaleX!=this.scaleX?t=this.scaleX:this._lastScaleY!=this.scaleY&&(t=this.scaleY),this._lastScaleX=t,this._lastScaleY=t,this.scaleX=t,this.scaleY=t}this.updateFromGroupScaling()},selected:function(){this.dirty=!0},deselected:function(){this.dirty=!0},mousedown:function(t){if(!this.lockAngleControls){var e=this.getLocalPointer(t);this._draggingAngleControl=this._isPointInMarkerControl(e),this._draggingAngleControl&&(this._lockMovementXBackup=this.lockMovementX,this._lockMovementYBackup=this.lockMovementY,this.lockMovementX=!0,this.lockMovementY=!0)}},mouseup:function(){this.lockAngleControls||(this._draggingAngleControl&&(this.lockMovementX=this._lockMovementXBackup,this.lockMovementY=this._lockMovementYBackup),this._draggingAngleControl=null)},mousemove:function(t){if(!this.lockAngleControls&&this._angleControlsCords&&this._angleControlsCords.start&&this._angleControlsCords.end&&this.canvas._activeObject===this)if(this._draggingAngleControl){var e=this.getLocalPointer(t),n=Math.atan2(e.y-this.height/2,e.x-this.width/2)+Math.PI/2;this._draggingAngleControl.indexOf("start")>-1?this.set("startAngle",i.util.radiansToDegrees(n)):this._draggingAngleControl.indexOf("end")>-1&&this.set("endAngle",i.util.radiansToDegrees(n)),this.fire("modified",this),this.canvas.renderAll()}else{e=this.getLocalPointer(t);this._isPointInMarkerControl(e)?t.target.hoverCursor="crosshair":t.target.hoverCursor=this.canvas.moveCursor}}})},_isPointInControlSquare:function(t,e,n,r,o){return(r=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),s=t.x-e.x,a=t.y-e.y,c=Math.sqrt(s*s+a*a),l=c*r,u=c*o+e.x,h=l+e.y;return new i.Point(u,h)}(r,new i.Point(t,e),o)).x>t-n/2&&r.x<t+n/2&&r.y>e-n/2&&r.y<e+n/2},_isPointInMarkerControl:function(t){return!!(this._angleControlsCords&&this._angleControlsCords.start&&this._angleControlsCords.end&&t)&&(this._isPointInControlSquare(this._angleControlsCords.start.upper.x,this._angleControlsCords.start.upper.y,this._angleControlsCords.start.size,t,this._angleControlsCords.start.angle)?"start_upper":this._isPointInControlSquare(this._angleControlsCords.start.lower.x,this._angleControlsCords.start.lower.y,this._angleControlsCords.start.size,t,this._angleControlsCords.start.angle)?"start_lower":this._isPointInControlSquare(this._angleControlsCords.end.upper.x,this._angleControlsCords.end.upper.y,this._angleControlsCords.end.size,t,this._angleControlsCords.end.angle)?"end_upper":!!this._isPointInControlSquare(this._angleControlsCords.end.lower.x,this._angleControlsCords.end.lower.y,this._angleControlsCords.end.size,t,this._angleControlsCords.end.angle)&&"end_lower")},updateFromGroupScaling:function(){var t=this.horizontalDiameter*this.scaleX,e=this.verticalDiameter*this.scaleY;this.scaleX=1,this.scaleY=1,this.setRadius(t/2,e/2)},getMeasuringContext:function(){return i._measuringContext||(i._measuringContext=this.canvas&&this.canvas.contextCache||i.util.createCanvasElement().getContext("2d")),i._measuringContext.opentypeStrokeWidth=this.opentypeStrokeWidth,i._measuringContext.opentypeStroke=this.opentypeStroke,i._measuringContext.lineSpacing=1,i._measuringContext},getPathWidth:function(){return this.horizontalDiameter},getPathHeight:function(){return this.verticalDiameter},_generateEllipse:function(t,e,n,i){return"M"+(t-n)+","+e+" a"+n+","+i+" 0 1,0 "+2*n+",0 a"+n+","+i+" 0 1,0 "+-2*n+",0"},_atanTan:function(t,e,n){var i=t=(t+Math.PI)%(2*Math.PI)-Math.PI;return t=Math.atan(e/n*Math.tan(t)),i<-Math.PI/2?t-=Math.PI:i>Math.PI/2&&(t+=Math.PI),t},_getEllipseArcLength:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:360;360!=t&&(t=i.util.radiansToDegrees(this._atanTan(i.util.degreesToRadians(t),r,n))),360!=e&&(e=i.util.radiansToDegrees(this._atanTan(i.util.degreesToRadians(e),r,n))),t=this._normalizeAngle(t),e=this._normalizeAngle(e);for(var s=i.util.degreesToRadians(e-t)/o,a=i.util.degreesToRadians(t),c=0,l=0;l<o;++l){var u=1-r*r/(n*n),h=u*Math.pow(Math.sin(a),2),f=Math.sqrt(Math.abs(1-h));c+=f,a+=s}var d=c*s*n;return Number.isNaN(d)&&(d=0),d},_computeArcs:function(){this._startArcOffset=this._getEllipseArcLength(this.startAngle,360,this.horizontalDiameter/2,this.verticalDiameter/2),this._endArcOffset=this._getEllipseArcLength(0,360-this.endAngle,this.horizontalDiameter/2,this.verticalDiameter/2),this._maxTextArcLength=Math.abs(this._getEllipseArcLength(this.startAngle,this.endAngle,this.horizontalDiameter/2,this.verticalDiameter/2)),this.convex&&(this._maxTextArcLength=this._pathLength-this._maxTextArcLength),this.startAngle>this.endAngle&&(this._maxTextArcLength=this._pathLength-this._maxTextArcLength),this.startAngle===this.endAngle&&(this._maxTextArcLength=Math.abs(this._getEllipseArcLength(0,360,this.horizontalDiameter/2,this.verticalDiameter/2)))},setRadius:function(t,e){!t&&e&&(t=e),!e&&t&&(e=t),t=t<0?.1:t,e=e<0?.1:e,this.horizontalDiameter=2*t,this.verticalDiameter=2*e;var n=this._generateEllipse(0,0,t,e);this.set("width",this.getPathWidth()+1.1*this.currentLineHeight),this.set("height",this.getPathHeight()+1.1*this.currentLineHeight),this.pathProperties=r.svgPathProperties(n),this.path=n,this._pathLength=this._getEllipseArcLength(0,360,this.horizontalDiameter/2,this.verticalDiameter/2),this._computeArcs()},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions");return t.width+=this.width*t.zoomX,t.height+=this.height*t.zoomY,t},_normalizeAngle:function(t){return 0!==(t=t||0)&&t%360===0?t=360:t%=360,t<0&&(t=360+t),t},_set:function(t,e){if("caps"===t)e&&this.set("text",this.text.toUpperCase());else if("text"===t)this.caps&&(e=e.toUpperCase());else if("startAngle"===t||"endAngle"===t)e=this._normalizeAngle(e),this.callSuper("_set",t,e),this._computeArcs();else if("textAlign"===t)this.callSuper("_set",t,e),this._computeArcs();else if("horizontalDiameter"===t)this.setRadius(e/2,this.verticalDiameter/2);else if("verticalDiameter"===t)this.setRadius(this.horizontalDiameter/2,e/2);else{if("fontFamily"===t||"fontSize"===t){"fontFamily"===t&&e.indexOf("'")<0&&(e="'"+e+"'"),this.callSuper("_set",t,e);var n=this.getMeasuringContext();this._setTextStyles(n,i,!0);var i=this.getCompleteStyleDeclaration(0,0),r=i.fontSize/this.CACHE_FONT_SIZE;return this.currentLineHeight=_measureTextOpentype.call(n," ").fontHeight*r,void(this.currentLineHeight=this.currentLineHeight/Math.sin(Math.PI/4))}"convex"===t&&(this.callSuper("_set",t,e),this._computeArcs())}this.callSuper("_set",t,e)},initDimensions:function(){this.callSuper("initDimensions"),this.width=this.getPathWidth()+1.1*this.currentLineHeight,this.height=this.getPathHeight()+1.1*this.currentLineHeight},_wrapDistanceAroundPath:function(t,e){return t>e-1e-5?t-=e:t<0&&(t=e+t),t},_renderAngleMarkers:function(t,e){var n=this;if(this.pathProperties&&!(this.pathWidth<=0)){var r=function(t,e){return Math.atan2(t.y-e.y,t.x-e.x)},o=function(t,e,i,r,o,s,a){var c=1/n.canvas.viewportTransform[0];s*=c;var l=2*c,u=(r*=c)/2*Math.cos(Math.PI/2-i),h=r/2*Math.sin(Math.PI/2-i);t.save(),t.strokeStyle=n.pathColor,t.lineWidth=n.pathWidth,t.translate(e.x,e.y),t.beginPath(),t.moveTo(0,0),t.lineTo(-u,h),t.moveTo(0,0),t.lineTo(u,-h),t.stroke(),o&&(t.lineWidth=l,t.strokeStyle=n.cornerStrokeColor||n.cornerColor,t.save(),t.translate(u,-h),t.rotate(i),t.strokeRect(-s/2,-s/2,s,s),t.restore(),t.save(),t.translate(-u,h),t.rotate(i),t.strokeRect(-s/2,-s/2,s,s),t.restore(),n._angleControlsCords[a]={upper:{x:e.x+n.width/2+u-2*l,y:e.y+n.height/2-h},lower:{x:e.x+n.width/2-u-2*l,y:e.y+n.height/2+h},size:s+2*l,angle:i}),t.restore()},s=function(t,e,r,o,s){s=n._normalizeAngle(s);var a=i.util.degreesToRadians(s),c=a<Math.PI/2&&a>-Math.PI/2?1:-1,l=r*o/Math.sqrt(o*o+r*r*Math.pow(Math.tan(a),2));return{x:(t+(l*=c))*(s>=0&&s<=270?1:-1),y:(e+r*o/Math.sqrt(r*r+o*o/Math.pow(Math.tan(a),2)))*(s>=0&&s<=180?1:-1)}},a=s(0,0,this.horizontalDiameter/2,this.verticalDiameter/2,this.startAngle-90),c=s(0,0,this.horizontalDiameter/2,this.verticalDiameter/2,this.endAngle-90),l=r(a,s(0,0,this.horizontalDiameter/2,this.verticalDiameter/2,this.startAngle-90-1e-4)),u=r(c,s(0,0,this.horizontalDiameter/2,this.verticalDiameter/2,this.endAngle-90-1e-4));o(t,a,l,60,e,this.cornerSize,"start"),o(t,c,u,60,e,this.cornerSize,"end")}},_render:function(t){this.callSuper("_render",t),this._renderAngleMarkers(t,this.canvas._activeObject===this&&!this.lockAngleControls)},getHeightOfChar:function(t,e){var n=this.getMeasuringContext();if(this._textLines[t][e]){var i=this.getValueOfPropertyAt(t,e,"fontSize")/this.CACHE_FONT_SIZE;return _measureTextOpentype.call(n,this._textLines[t][e]).height*i}return this.getValueOfPropertyAt(t,e,"fontSize")},_offsetY:0,_renderTextCommon:function(t,e){var n=0,i=-this.width/2,r=[],o=[];t.opentypeStroke=this.opentypeStrokeWidth>0?this.opentypeStroke:null,t.opentypeStrokeWidth=this.opentypeStrokeWidth,t.ligatures=!1;for(var s=0,a=this._textLines.length;s<a;s++){var c,l=0,u=_measureTextOpentype.call(t,this._textLines[s].join(""));l+=this.opentypeStrokeWidth/2,c=u.fontHeight,o[s]=c,s>0&&(n+=o[s-1]);var h=this._renderTextLine(e,t,this._textLines[s],i+l,n-this.opentypeStrokeWidth/2,s);h&&r.push(h)}},_renderTextLine:function(t,e,n,i,r,o){return this._renderChars(t,e,n,i,r,o)},_renderChars:function(t,e,n,i,r,o){var s=this.getHeightOfLine(o);e.save(),this._fontSizeFraction,this.lineHeight,e.textAlign=this.textAlign,e.textJustify="justify"===this.textAlign,e.pathColor=this.pathColor,e.pathWidth=this.pathWidth,e.convex=this.convex,e.a=this.horizontalDiameter/2,e.b=this.verticalDiameter/2,e.startAngle=this.startAngle,e.endAngle=this.endAngle,e.startArcOffset=this._startArcOffset,e.endArcOffset=this._endArcOffset,e.maxTextArcLength=this._maxTextArcLength,e.pathLength=this._pathLength,e.wrapDistanceAroundPath=this._wrapDistanceAroundPath,e.atanTan=this._atanTan,e.textPath((this.prefix||"")+n.join("")+(this.suffix||""),this.pathProperties),e.restore()},_measureChar:function(t,e,n,i){var r,o,s,a,c=this.getFontCache(e),l=n+t,u=this._getFontDeclaration(e)===this._getFontDeclaration(i),h=e.fontSize/this.CACHE_FONT_SIZE,f=e.fontSize;if(n&&c[n]&&(s=c[n]),c[t]&&(a=r=c[t]),u&&c[l]&&(a=(o=c[l])-s),!r||!s||!o){var d=this.getMeasuringContext();this._setTextStyles(d,e,!0)}if(!r){var p=_measureTextOpentype.call(d,t);a=r=p.width,f=p.height,c[t]=r}if(!s&&u&&n&&(s=_measureTextOpentype.call(d,n).width,c[n]=s),u&&!o&&(o=_measureTextOpentype.call(d,l,!0).width,c[l]=o,(a=o-s)>r)){var g=a-r;c[t]=a,c[l]+=g,r=a}return{width:r*h,kernedWidth:a*h,height:f}},clone:function(t){t&&t(new i.PathIText("A",{originX:"center",originY:"center",pathWidth:this.pathWidth,pathColor:this.pathColor,left:this.left,top:this.top,angle:this.angle,startAngle:this.startAngle,endAngle:this.endAngle,centeredScaling:!0,centeredRotation:!0,textAlign:this.textAlign,skewX:this.skewX,skewY:this.skewY,lockSkewingX:!0,lockSkewingY:!0,lockScalingFlip:!0,fontSize:this.fontSize,horizontalDiameter:this.horizontalDiameter,verticalDiameter:this.verticalDiameter,convex:this.convex,caps:this.caps,fontPath:this.fontPath,fontName:this.fontName,fontFamily:this.fontFamily,fill:this.fill,color:this.color,stroke:this.stroke,strokeWidth:this.strokeWidth,id:this.id,fontsMap:this.fontsMap,fontColorsMap:this.fontColorsMap,zIndex:this.zIndex,prefix:this.prefix,suffix:this.suffix}))}})},function(t,e){t.exports=function(){CanvasRenderingContext2D.prototype.textOverflow="",CanvasRenderingContext2D.prototype.textJustify=!1;var t=[],e=CanvasRenderingContext2D.prototype.save;function n(t,e){for(var n=0,i=e.length-1;i>=0;--i){n+=_measureTextOpentype.call(t,e[i]).width}return n}function i(t,e,n,i,r,o,s,a,c){s=t.atanTan(s,i,r),a=t.atanTan(a,i,r),t.ellipse(e,n,i,r,o,s,a,c)}CanvasRenderingContext2D.prototype.save=function(){t.push({textOverflow:this.textOverflow,textJustify:this.textJustify}),e.call(this)};var r=CanvasRenderingContext2D.prototype.restore;CanvasRenderingContext2D.prototype.restore=function(){r.call(this);var e=t.pop();this.textOverflow=e.textOverflow,this.textJustify=e.textJustify},CanvasRenderingContext2D.prototype.textPath=function(t,e){this.pathWidth>0&&(this.save(),this.beginPath(),this.strokeStyle="rgba(0, 0, 0, 0.3)",this.lineWidth=this.pathWidth,i(this,0,0,this.a,this.b,0,fabric.util.degreesToRadians(this.endAngle-90),fabric.util.degreesToRadians(this.startAngle-90),this.convex),this.stroke(),this.beginPath(),this.strokeStyle=this.pathColor,this.lineWidth=this.pathWidth,i(this,0,0,this.a,this.b,0,fabric.util.degreesToRadians(this.startAngle-90),fabric.util.degreesToRadians(this.endAngle-90),this.convex),this.stroke(),this.restore());var r=this.pathLength;if(!(r<0)){if("visible"!=this.textOverflow&&this.maxTextArcLength<n(this,t)){var o="ellipsis"==this.textOverflow?"…":this.textOverflow||"";do{t=t.slice(0,-1)}while(t&&this.maxTextArcLength<n(this,t));t+=o}var s=-r/4,a=0,c=!1,l=!1;if(s+=this.startArcOffset,this.textJustify){var u=this.maxTextArcLength,h=n(this,t);if(u&&h<u){c=!0;var f=u-h,d=t.match(/\s+/g);d?a=f/d.length:(l=!0,a=f/(t.length-1))}}else{h=n(this,t);"right"===this.textAlign?s=this.convex?s+this.maxTextArcLength-h:s-this.maxTextArcLength+h:"center"===this.textAlign&&(this.convex?(s+=this.maxTextArcLength/2,s-=h/2):s-=(this.maxTextArcLength-h)/2)}if(s=this.wrapDistanceAroundPath(s,r),this.convex)for(p=!1,g=0;g<t.length;++g){m=t[g],v=_measureTextOpentype.call(this,m).width;0===g&&(s=this.wrapDistanceAroundPath(s,r)),c&&(p||l&&0!==g)&&(s+=a,p=!1),c&&u&&/[ \t\r]/.test(m)&&(p=!0);y=s;y=this.wrapDistanceAroundPath(y,r-1e-5);b=e.getPointAtLength(y),x=this.wrapDistanceAroundPath(y+v/2,r),C=this.wrapDistanceAroundPath(y+v/2+1e-5,r),S=e.getPointAtLength(x),w=e.getPointAtLength(C),_=Math.atan2(S.y-w.y,S.x-w.x);this.save(),this.textAlign="center",this.translate(b.x,b.y),this.rotate(_),this.rotate(Math.PI),_fillTextOpentype.call(this,m,0,0),this.restore(),s+=v}else for(var p=!1,g=0;g<t.length;++g){var m=t[g],v=_measureTextOpentype.call(this,m).width;c&&(p||l&&0!==g)&&(s-=a,p=!1),c&&u&&/[ \t\r]/.test(m)&&(p=!0);var y=this.wrapDistanceAroundPath(s,r-1e-5),b=e.getPointAtLength(y),x=this.wrapDistanceAroundPath(y-v/2,r),C=this.wrapDistanceAroundPath(y-v/2+1e-5,r),S=e.getPointAtLength(x),w=e.getPointAtLength(C),_=Math.atan2(S.y-w.y,S.x-w.x);this.save(),this.textAlign="center",this.translate(b.x,b.y),this.rotate(_),_fillTextOpentype.call(this,m,0,0),this.restore(),s-=v}}}}()},function(t,e,n){!function(t){"use strict";function e(t,e,r,c,l,u,f,d){this.a={x:t,y:e},this.b={x:r,y:c},this.c={x:l,y:u},this.d={x:f,y:d},null!==f&&void 0!==f&&null!==d&&void 0!==d?(this.getArcLength=h,this.getPoint=s,this.getDerivative=i):(this.getArcLength=a,this.getPoint=o,this.getDerivative=n),this.init()}function n(t,e,n){return{x:2*(1-n)*(t[1]-t[0])+2*n*(t[2]-t[1]),y:2*(1-n)*(e[1]-e[0])+2*n*(e[2]-e[1])}}function i(t,e,n){return o([3*(t[1]-t[0]),3*(t[2]-t[1]),3*(t[3]-t[2])],[3*(e[1]-e[0]),3*(e[2]-e[1]),3*(e[3]-e[2])],n)}function r(t,e,n,i,r){for(var o=1,s=t/e,a=(t-n(i,r,s))/e;o>.001;){var c=n(i,r,s+a),l=n(i,r,s-a),u=Math.abs(t-c)/e,h=Math.abs(t-l)/e;u<o?(o=u,s+=a):h<o?(o=h,s-=a):a/=2}return s}function o(t,e,n){return{x:(1-n)*(1-n)*t[0]+2*(1-n)*n*t[1]+n*n*t[2],y:(1-n)*(1-n)*e[0]+2*(1-n)*n*e[1]+n*n*e[2]}}function s(t,e,n){return{x:(1-n)*(1-n)*(1-n)*t[0]+3*(1-n)*(1-n)*n*t[1]+3*(1-n)*n*n*t[2]+n*n*n*t[3],y:(1-n)*(1-n)*(1-n)*e[0]+3*(1-n)*(1-n)*n*e[1]+3*(1-n)*n*n*e[2]+n*n*n*e[3]}}function a(t,e,n){void 0===n&&(n=1);var i=t[0]-2*t[1]+t[2],r=e[0]-2*e[1]+e[2],o=2*t[1]-2*t[0],s=2*e[1]-2*e[0],a=4*(i*i+r*r),c=4*(i*o+r*s),l=o*o+s*s;if(0===a)return n*Math.sqrt(Math.pow(t[2]-t[0],2)+Math.pow(e[2]-e[0],2));var u=c/(2*a),h=n+u,f=l/a-u*u;return Math.sqrt(a)/2*(h*Math.sqrt(h*h+f)-u*Math.sqrt(u*u+f)+f*Math.log(Math.abs((h+Math.sqrt(h*h+f))/(u+Math.sqrt(u*u+f)))))}function c(t,e){return _[t][e]}function l(t,e,n){var i,r,o,s=n.length-1;if(0===s)return 0;if(0===t){for(r=0,o=0;o<=s;o++)r+=c(s,o)*Math.pow(1-e,s-o)*Math.pow(e,o)*n[o];return r}for(i=new Array(s),o=0;o<s;o++)i[o]=s*(n[o+1]-n[o]);return l(t-1,e,i)}function u(t,e,n){var i=l(1,n,t),r=l(1,n,e),o=i*i+r*r;return Math.sqrt(o)}function h(t,e,n){var i,r,o,s;for(void 0===n&&(n=1),i=n/2,r=0,o=0;o<20;o++)s=i*S[20][o]+i,r+=w[20][o]*u(t,e,s);return i*r}function f(t,e,n,i){var r=t*n+e*i;return r>1&&(r=1),r<-1&&(r=-1),(t*i-e*n<0?-1:1)*Math.acos(r)}function d(t,e,n,i,r,o,s,a,c,l){var u=l*(t-n)/2+c*(e-i)/2,h=-c*(t-n)/2+l*(e-i)/2,d=s*s,p=a*a,g=u*u,m=h*h,v=d*p-d*m-p*g;v<0&&(v=0),v/=d*m+p*g;var y=(v=Math.sqrt(v)*(r===o?-1:1))*s/a*h,b=v*-a/s*u,x=l*y-c*b+(t+n)/2,C=c*y+l*b+(e+i)/2,S=(u-y)/s,w=(h-b)/a,_=(-u-y)/s,T=(-h-b)/a,E=f(1,0,S,w),k=f(S,w,_,T);return 0===o&&k>0&&(k-=D),1===o&&k<0&&(k+=D),[x,C,E,k]}function p(t,e){var n=4/3*Math.tan(e/4),i=Math.cos(t),r=Math.sin(t),o=Math.cos(t+e),s=Math.sin(t+e);return[i,r,i-r*n,r+i*n,o+s*n,s-o*n,o,s]}function g(t,e,n,i,r,o,s,a,c){var l=0,u=[],h=[];T(t,e,n,i,r,o,s,a,c).forEach((function(t){var e=new C(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),n=e.getTotalLength();l+=n,u.push(n),h.push(e)})),this.length=l,this.partialLengths=u,this.curves=h}function m(t,e,n,i){this.x0=t,this.x1=e,this.y0=n,this.y1=i}var v={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},y=/([astvzqmhlc])([^astvzqmhlc]*)/gi,b=function(t){var e=[];return t.replace(y,(function(t,n,i){var r=n.toLowerCase();for(i=function(t){var e=t.match(x);return e?e.map(Number):[]}(i),"m"===r&&i.length>2&&(e.push([n].concat(i.splice(0,2))),r="l",n="m"===n?"l":"L");i.length>=0;){if(i.length===v[r])return i.unshift(n),e.push(i);if(i.length<v[r])throw new Error("malformed path data");e.push([n].concat(i.splice(0,v[r])))}})),e},x=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,C=function(t,n,i,r,o,s,a,c){return new e(t,n,i,r,o,s,a,c)};e.prototype={constructor:e,init:function(){this.length=this.getArcLength([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y])},getTotalLength:function(){return this.length},getPointAtLength:function(t){var e=r(t,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]);return this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],e)},getTangentAtLength:function(t){var e=r(t,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),n=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],e),i=Math.sqrt(n.x*n.x+n.y*n.y);return i>0?{x:n.x/i,y:n.y/i}:{x:0,y:0}},getPropertiesAtLength:function(t){var e,n=r(t,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),i=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],n),o=Math.sqrt(i.x*i.x+i.y*i.y);e=o>0?{x:i.x/o,y:i.y/o}:{x:0,y:0};var s=this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],n);return{x:s.x,y:s.y,tangentX:e.x,tangentY:e.y}}};var S=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],w=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],_=[[1],[1,1],[1,2,1],[1,3,3,1]],D=2*Math.PI,T=function(t,e,n,i,r,o,s,a,c){var l=Math.sin(r*D/360),u=Math.cos(r*D/360),h=u*(t-a)/2+l*(e-c)/2,f=-l*(t-a)/2+u*(e-c)/2;if(0===h&&0===f)return[];if(0===n||0===i)return[];n=Math.abs(n),i=Math.abs(i);var g=h*h/(n*n)+f*f/(i*i);g>1&&(n*=Math.sqrt(g),i*=Math.sqrt(g));var m=d(t,e,a,c,o,s,n,i,l,u),v=[],y=m[2],b=m[3],x=Math.max(Math.ceil(Math.abs(b)/(D/4)),1);b/=x;for(var C=0;C<x;C++)v.push(p(y,b)),y+=b;return v.map((function(t){for(var e=0;e<t.length;e+=2){var r=t[e+0],o=t[e+1],s=u*(r*=n)-l*(o*=i),a=l*r+u*o;t[e+0]=s+m[0],t[e+1]=a+m[1]}return t}))},E=function(t,e,n,i,r,o,s,a,c){return new g(t,e,n,i,r,o,s,a,c)};g.prototype={constructor:g,init:function(){},getTotalLength:function(){return this.length},getPointAtLength:function(t){t<0?t=0:t>this.length&&(t=this.length);for(var e=this.partialLengths.length-1;this.partialLengths[e]>=t&&this.partialLengths[e]>0;)e--;e<this.partialLengths.length-1&&e++;for(var n=0,i=0;i<e;i++)n+=this.partialLengths[i];return this.curves[e].getPointAtLength(t-n)},getTangentAtLength:function(t){t<0?t=0:t>this.length&&(t=this.length);for(var e=this.partialLengths.length-1;this.partialLengths[e]>=t&&this.partialLengths[e]>0;)e--;e<this.partialLengths.length-1&&e++;for(var n=0,i=0;i<e;i++)n+=this.partialLengths[i];return this.curves[e].getTangentAtLength(t-n)},getPropertiesAtLength:function(t){var e=this.getTangentAtLength(t),n=this.getPointAtLength(t);return{x:n.x,y:n.y,tangentX:e.x,tangentY:e.y}}};var k=function(t,e,n,i){return new m(t,e,n,i)};m.prototype.getTotalLength=function(){return Math.sqrt(Math.pow(this.x0-this.x1,2)+Math.pow(this.y0-this.y1,2))},m.prototype.getPointAtLength=function(t){var e=t/Math.sqrt(Math.pow(this.x0-this.x1,2)+Math.pow(this.y0-this.y1,2)),n=(this.x1-this.x0)*e,i=(this.y1-this.y0)*e;return{x:this.x0+n,y:this.y0+i}},m.prototype.getTangentAtLength=function(){var t=Math.sqrt((this.x1-this.x0)*(this.x1-this.x0)+(this.y1-this.y0)*(this.y1-this.y0));return{x:(this.x1-this.x0)/t,y:(this.y1-this.y0)/t}},m.prototype.getPropertiesAtLength=function(t){var e=this.getPointAtLength(t),n=this.getTangentAtLength();return{x:e.x,y:e.y,tangentX:n.x,tangentY:n.y}},t.svgPathProperties=function(t){function e(t){if(!t)return null;for(var o,s,a=b(t),c=[0,0],l=[0,0],u=0;u<a.length;u++)"M"===a[u][0]?(s=[(c=[a[u][1],a[u][2]])[0],c[1]],r.push(null)):"m"===a[u][0]?(s=[(c=[a[u][1]+c[0],a[u][2]+c[1]])[0],c[1]],r.push(null)):"L"===a[u][0]?(n+=Math.sqrt(Math.pow(c[0]-a[u][1],2)+Math.pow(c[1]-a[u][2],2)),r.push(new k(c[0],a[u][1],c[1],a[u][2])),c=[a[u][1],a[u][2]]):"l"===a[u][0]?(n+=Math.sqrt(Math.pow(a[u][1],2)+Math.pow(a[u][2],2)),r.push(new k(c[0],a[u][1]+c[0],c[1],a[u][2]+c[1])),c=[a[u][1]+c[0],a[u][2]+c[1]]):"H"===a[u][0]?(n+=Math.abs(c[0]-a[u][1]),r.push(new k(c[0],a[u][1],c[1],c[1])),c[0]=a[u][1]):"h"===a[u][0]?(n+=Math.abs(a[u][1]),r.push(new k(c[0],c[0]+a[u][1],c[1],c[1])),c[0]=a[u][1]+c[0]):"V"===a[u][0]?(n+=Math.abs(c[1]-a[u][1]),r.push(new k(c[0],c[0],c[1],a[u][1])),c[1]=a[u][1]):"v"===a[u][0]?(n+=Math.abs(a[u][1]),r.push(new k(c[0],c[0],c[1],c[1]+a[u][1])),c[1]=a[u][1]+c[1]):"z"===a[u][0]||"Z"===a[u][0]?(n+=Math.sqrt(Math.pow(s[0]-c[0],2)+Math.pow(s[1]-c[1],2)),r.push(new k(c[0],s[0],c[1],s[1])),c=[s[0],s[1]]):"C"===a[u][0]?(o=new C(c[0],c[1],a[u][1],a[u][2],a[u][3],a[u][4],a[u][5],a[u][6]),n+=o.getTotalLength(),c=[a[u][5],a[u][6]],r.push(o)):"c"===a[u][0]?(o=new C(c[0],c[1],c[0]+a[u][1],c[1]+a[u][2],c[0]+a[u][3],c[1]+a[u][4],c[0]+a[u][5],c[1]+a[u][6]),n+=o.getTotalLength(),c=[a[u][5]+c[0],a[u][6]+c[1]],r.push(o)):"S"===a[u][0]?(o=u>0&&["C","c","S","s"].indexOf(a[u-1][0])>-1?new C(c[0],c[1],2*c[0]-a[u-1][a[u-1].length-4],2*c[1]-a[u-1][a[u-1].length-3],a[u][1],a[u][2],a[u][3],a[u][4]):new C(c[0],c[1],c[0],c[1],a[u][1],a[u][2],a[u][3],a[u][4]),n+=o.getTotalLength(),c=[a[u][3],a[u][4]],r.push(o)):"s"===a[u][0]?(o=u>0&&["C","c","S","s"].indexOf(a[u-1][0])>-1?new C(c[0],c[1],c[0]+o.d.x-o.c.x,c[1]+o.d.y-o.c.y,c[0]+a[u][1],c[1]+a[u][2],c[0]+a[u][3],c[1]+a[u][4]):new C(c[0],c[1],c[0],c[1],c[0]+a[u][1],c[1]+a[u][2],c[0]+a[u][3],c[1]+a[u][4]),n+=o.getTotalLength(),c=[a[u][3]+c[0],a[u][4]+c[1]],r.push(o)):"Q"===a[u][0]?(o=c[0]==a[u][1]&&c[1]==a[u][2]?new k(a[u][1],a[u][3],a[u][2],a[u][4]):new C(c[0],c[1],a[u][1],a[u][2],a[u][3],a[u][4]),n+=o.getTotalLength(),r.push(o),c=[a[u][3],a[u][4]],l=[a[u][1],a[u][2]]):"q"===a[u][0]?(o=0!=a[u][1]||0!=a[u][2]?new C(c[0],c[1],c[0]+a[u][1],c[1]+a[u][2],c[0]+a[u][3],c[1]+a[u][4]):new k(c[0]+a[u][1],c[0]+a[u][3],c[1]+a[u][2],c[1]+a[u][4]),n+=o.getTotalLength(),l=[c[0]+a[u][1],c[1]+a[u][2]],c=[a[u][3]+c[0],a[u][4]+c[1]],r.push(o)):"T"===a[u][0]?(o=u>0&&["Q","q","T","t"].indexOf(a[u-1][0])>-1?new C(c[0],c[1],2*c[0]-l[0],2*c[1]-l[1],a[u][1],a[u][2]):new k(c[0],a[u][1],c[1],a[u][2]),r.push(o),n+=o.getTotalLength(),l=[2*c[0]-l[0],2*c[1]-l[1]],c=[a[u][1],a[u][2]]):"t"===a[u][0]?(o=u>0&&["Q","q","T","t"].indexOf(a[u-1][0])>-1?new C(c[0],c[1],2*c[0]-l[0],2*c[1]-l[1],c[0]+a[u][1],c[1]+a[u][2]):new k(c[0],c[0]+a[u][1],c[1],c[1]+a[u][2]),n+=o.getTotalLength(),l=[2*c[0]-l[0],2*c[1]-l[1]],c=[a[u][1]+c[0],a[u][2]+c[0]],r.push(o)):"A"===a[u][0]?(o=new E(c[0],c[1],a[u][1],a[u][2],a[u][3],a[u][4],a[u][5],a[u][6],a[u][7]),n+=o.getTotalLength(),c=[a[u][6],a[u][7]],r.push(o)):"a"===a[u][0]&&(o=new E(c[0],c[1],a[u][1],a[u][2],a[u][3],a[u][4],a[u][5],c[0]+a[u][6],c[1]+a[u][7]),n+=o.getTotalLength(),c=[c[0]+a[u][6],c[1]+a[u][7]],r.push(o)),i.push(n);return e}var n=0,i=[],r=[];e.getTotalLength=function(){return n},e.getPointAtLength=function(t){var e=o(t);return r[e.i].getPointAtLength(e.fraction)},e.getTangentAtLength=function(t){var e=o(t);return r[e.i].getTangentAtLength(e.fraction)},e.getPropertiesAtLength=function(t){var e=o(t);return r[e.i].getPropertiesAtLength(e.fraction)},e.getParts=function(){for(var t=[],e=0;e<r.length;e++)if(null!=r[e]){var n={};n.start=r[e].getPointAtLength(0),n.end=r[e].getPointAtLength(i[e]-i[e-1]),n.length=i[e]-i[e-1],function(t){n.getPointAtLength=function(e){return t.getPointAtLength(e)},n.getTangentAtLength=function(e){return t.getTangentAtLength(e)},n.getPropertiesAtLength=function(e){return t.getPropertiesAtLength(e)}}(r[e]),t.push(n)}return t};var o=function(t){t<0?t=0:t>n&&(t=n);for(var e=i.length-1;i[e]>=t&&i[e]>0;)e--;return{fraction:t-i[++e-1],i:e}};return e(t)},t.parse=b,t.Bezier=C,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e){fabric.PDFObject=fabric.util.createClass(fabric.Object,{type:"pdf-object",cacheProperties:fabric.Object.prototype.cacheProperties.concat("pdf","_pdfCanvas"),pdf:null,coverMaskArea:!1,_pdfCanvas:null,_renderPromise:null,initialize:function(t){this.callSuper("initialize",t)},_loadPdf:function(t){var e=this;return new Promise((function(n,i){var r="";r="string"===typeof t?t:URL.createObjectURL(t),pdfjsLib.getDocument(r).promise.then((function(t){console.log("PDF loaded");t.getPage(1).then((function(t){var i=t.getViewport({scale:1}),r=document.createElement("canvas"),o=r.getContext("2d");r.width=i.width,r.height=i.height;var s={canvasContext:o,viewport:i,background:"rgba(0,0,0,0)"};t.render(s).promise.then((function(){e.set("_pdfCanvas",r),e.dirty=!0,e._applyCoverScale(),e.canvas.renderAll(),n()}))}))}),(function(t){this._pdfViewport=null,console.error(t),i(t)}))}))},_set:function(t,e){"pdf"===t&&(this._renderPromise=this._loadPdf(e)),this.callSuper("_set",t,e)},_getPdfScalingToFit:function(){var t=this.width,e=this.height,n=1;return this._pdfCanvas.height>this._pdfCanvas.width?(n=e/this._pdfCanvas.height,this._pdfCanvas.width*n>t&&(n=t/this._pdfCanvas.width)):(n=t/this._pdfCanvas.width,this._pdfCanvas.height*n>e&&(n=e/this._pdfCanvas.height)),n},_applyCoverScale:function(){if(this.coverMaskArea&&this._pdfCanvas&&this._pdfCanvas.width&&this._pdfCanvas.height){var t=this._getPdfScalingToFit(),e=this.width/(this._pdfCanvas.width*t),n=this.height/(this._pdfCanvas.height*t),i=Math.max(e,n);this.set("scaleX",i),this.set("scaleY",i)}},_render:function(t){if(this._pdfCanvas){var e=this._getPdfScalingToFit(),n=-this._pdfCanvas.width*e/2,i=-this._pdfCanvas.height*e/2;t.translate(n,i),t.scale(e,e),t.drawImage(this._pdfCanvas,0,0)}}})},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),o=n(1),s=n.n(o);fabric.SVGObject=fabric.util.createClass(fabric.Object,{type:"svg-object",svgString:"",svgColor:"",svgImage:null,coverMaskArea:!1,cacheProperties:fabric.Object.prototype.cacheProperties.concat("svgString","svgImage","svgColor"),_svgDoc:null,_svgHeight:1,_svgWidth:1,_colorFilter:null,_renderPromise:null,initialize:function(t){this.callSuper("initialize",t),this._colorFilter=new fabric.Image.filters.BlendColor({color:this.svgColor,mode:"tint",alpha:1})},_loadImage:function(t){return new Promise((function(e,n){var i=new Image;i.onerror=function(){n()},i.onload=function(){e(i)},i.src=t}))},_loadSvgString:function(t){var e=this,n=this;return new Promise(function(){var i=s()(r.a.mark((function i(o,s){var a,c,l,u,h,f,d,p;return r.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!t){i.next=44;break}return i.next=4,e._loadImage("data:image/svg+xml,"+encodeURIComponent(t));case 4:if((a=i.sent).style.opacity=0,a.style.position="fixed",document.body.appendChild(a),n._svgHeight=a.naturalHeight,n._svgWidth=a.naturalWidth,document.body.removeChild(a),c=new DOMParser,l=c.parseFromString(t,"image/svg+xml"),u=l.getElementsByTagName("svg")[0],n._svgDoc=l,!l||!u){i.next=34;break}if(h=u.getAttribute("width"),f=u.getAttribute("height"),h&&f){i.next=30;break}if(!(d=u.viewBox.baseVal).width||!d.height){i.next=30;break}return h=d.width,f=d.height,u.setAttribute("width",d.width+"px"),u.setAttribute("height",d.height+"px"),n._svgWidth=h,n._svgHeight=f,i.next=29,e._loadImage("data:image/svg+xml,"+encodeURIComponent((new XMLSerializer).serializeToString(l)));case 29:a=i.sent;case 30:p=/[^\d.px]/,h&&f&&!p.test(h)&&!p.test(f)?0===n._svgHeight&&0===n._svgWidth&&(n._svgWidth=parseFloat(h),n._svgHeight=parseFloat(f)):(n._svgWidth=null,n._svgHeight=null),i.next=37;break;case 34:console.error("Error parsing SVG"),n._svgWidth=null,n._svgHeight=null;case 37:n.svgImage=a,n.set("dirty",!0),n._applyCoverScale(),n.canvas&&n.canvas.renderAll(),o(),i.next=47;break;case 44:e.set("svgImage",null),e.set("_svgDoc",null),o();case 47:i.next=53;break;case 49:i.prev=49,i.t0=i.catch(0),console.error(i.t0),s(i.t0);case 53:case"end":return i.stop()}}),i,null,[[0,49]])})));return function(t,e){return i.apply(this,arguments)}}())},_set:function(t,e){if("svgString"===t)this._renderPromise=this._loadSvgString(e);else if("svgImage"===t)e&&(this._svgWidth=e.width,this._svgHeight=e.height);else if("svgColor"===t){this.callSuper("_set",t,e);var n=new fabric.Color(this.svgColor).getAlpha();this.opacity=n}this.callSuper("_set",t,e)},_getSvgScalingToFit:function(){var t=1,e=this.width,n=this.height;return this._svgHeight>this._svgWidth?(t=n/this._svgHeight,this._svgWidth*t>e&&(t=e/this._svgWidth)):(t=e/this._svgWidth,this._svgHeight*t>n&&(t=n/this._svgHeight)),t},_applyCoverScale:function(){if(this.coverMaskArea&&this._svgWidth&&this._svgHeight){var t=this._getSvgScalingToFit(),e=this.width/(this._svgWidth*t),n=this.height/(this._svgHeight*t),i=Math.max(e,n);this.set("scaleX",i),this.set("scaleY",i)}},_render:function(t){if(this.svgImage){if(this._svgDoc&&null===this._svgHeight&&null===this._svgWidth){var e=this._svgDoc.getElementsByTagName("svg")[0];e.setAttribute("width",t.canvas.width+"px"),e.setAttribute("height",t.canvas.height+"px"),this._svgWidth=t.canvas.width,this._svgHeight=t.canvas.height;var n=(new XMLSerializer).serializeToString(this._svgDoc);return void this.set("svgString",n)}var i=this._getSvgScalingToFit(),r=-this._svgWidth*i/2,o=-this._svgHeight*i/2;if(t.translate(r,o),t.scale(i,i),t.drawImage(this.svgImage,0,0),this.svgColor){this._colorFilter.color=this.svgColor;var s=t.getImageData(0,0,t.canvas.width,t.canvas.height);this._colorFilter.applyTo2d({imageData:s}),t.putImageData(s,0,0)}}}})},function(t,e){fabric.VectorPlaceholder=fabric.util.createClass(fabric.Group,{async:!0,type:"vector-placeholder",originX:"center",originY:"center",selectedPosition:1,svgColor:"",svgString:"",pdf:null,rotationStep:1,coverMaskArea:!1,preventEditMode:!1,_editMode:!1,_enablingEditMode:!1,_editModeDataBackup:{},_boundingBoxOffsetX:0,_boundingBoxOffsetY:0,initialize:function(t){var e=this;t.width=t.width||300,t.height=t.height||300;var n=new fabric.Rect({strokeDashArray:t.strokeDashArray||[10,10],originX:"center",originY:"center",stroke:"#000000",strokeWidth:t.strokeWidth||0,width:t.width,height:t.height,fill:"rgba(0, 0, 0, 0)",id:t.id}),i=!!t.isMobile;this._controlRectangle=new fabric.Rect({originX:"center",originY:"center",strokeWidth:3,width:t.width,height:t.height,fill:"rgba(0, 0, 0, 0)",id:t.id}),this._controlRectangle.setControlsVisibility({tl:!i,tr:!i,br:!i,bl:!i,mtr:!i,ml:!1,mb:!1,mr:!1,mt:!1}),this.callSuper("initialize",[new fabric.SVGObject({width:t.width,height:t.height,visible:!0,originX:"center",originY:"center"}),new fabric.PDFObject({width:t.width,height:t.height,visible:!1,originX:"center",originY:"center"}),n],t),n.set("left",0),n.set("top",0),n.setCoords(),this._resetControlRectangle(),this._controlRectangle.on({mousedown:function(t){e.canvas.fire("object:placeholder:mousedown")},mouseup:function(t){e.canvas.fire("object:placeholder:mouseup")},selected:function(t){e.canvas.fire("object:placeholder:maskSelected")},deselected:function(t){e.fire("deselected",t)},moving:function(){var t=this.left-e.left,n=this.top-e.top;e.setVectorOffset(t,n),e.canvas&&e.canvas.fire("object:placeholder:maskModified",{object:e,parameters:e.getEditModeParameters()})},rotating:function(){this.angle=Math.ceil(this.angle/e.rotationStep)*e.rotationStep,e.setVectorAngle(this.angle-e.angle),e.canvas&&e.canvas.fire("object:placeholder:maskModified",{object:e,parameters:e.getEditModeParameters()})},scaling:function(){e.setVectorScale(this.scaleX,this.scaleY),e.canvas&&e.canvas.fire("object:placeholder:maskModified",{object:e,parameters:e.getEditModeParameters()})}}),this.on({added:function(){this.cornerSize=.025*this.canvas.width},removed:function(){this.canvas.remove(this._controlRectangle)},scaled:function(){var t=this.width*this.scaleX,e=this.height*this.scaleY;this.scaleX=1,this.scaleY=1,this.set("width",t),this.set("height",e)},rotated:function(){this._resetControlRectangle()},"object:dblclick":function(){if(!this.preventEditMode){this._editMode=!0,this._enablingEditMode=!0,this._editModeDataBackup.originalCanvasSelection=this.canvas.selection,this.canvas.selection=!1,this._editModeDataBackup.controlsVisibilityBackup=JSON.parse(JSON.stringify(this._getControlsVisibility())),this.setControlsVisibility({bl:!1,br:!1,mb:!1,ml:!1,mr:!1,mt:!1,mtr:!1,tl:!1,tr:!1}),this._controlRectangle.set("cornerSize",this.cornerSize),this._controlRectangle.set("transparentCorners",this.transparentCorners),this._controlRectangle.set("centeredScaling",this.centeredScaling),this._controlRectangle.set("centeredRotation",this.centeredRotation),this._controlRectangle.set("skewX",this.skewX),this._controlRectangle.set("skewY",this.skewY);var t=this.item(0).visible?this.item(0).scaleX:this.item(1).scaleX,e=this.item(0).visible?this.item(0).scaleY:this.item(1).scaleY;this._controlRectangle.set("scaleX",t),this._controlRectangle.set("scaleY",e),this.canvas.add(this._controlRectangle),this.canvas.setActiveObject(this._controlRectangle),this._editModeDataBackup.originalLockX=this.lockMovementX,this._editModeDataBackup.originalLockY=this.lockMovementY,this.lockMovementX=this.lockMovementY=!0,this.silentEditMode||(this._editModeDataBackup.originalStroke=this.item(2).stroke,this._editModeDataBackup.originalStrokeWidth=this.item(2).strokeWidth,this.item(2).set("stroke","red"),this.item(2).set("strokeWidth",5)),this._enablingEditMode=!1,this.canvas.renderAll()}},deselected:function(){!this._editMode||this._forcedEditMode||this._enablingEditMode||(this._editMode=!1,this.canvas.selection=this._editModeDataBackup.originalCanvasSelection,this.canvas.remove(this._controlRectangle),this.setControlsVisibility(this._editModeDataBackup.controlsVisibilityBackup),this.lockMovementX=this._editModeDataBackup.originalLockX,this.lockMovementY=this._editModeDataBackup.originalLockY,this.silentEditMode||(this.item(2).set("stroke",this._editModeDataBackup.originalStroke),this.item(2).set("strokeWidth",this._editModeDataBackup.originalStrokeWidth),this.set("dirty",!0)),this.canvas.renderAll())}}),this._adjustClippingPath()},_set:function(t,e){if("id"===t)this._controlRectangle&&(this._controlRectangle.id=e),this.callSuper("_set",t,e);else if("coverMaskArea"===t)this.item(0).set("coverMaskArea",e),this.item(1).set("coverMaskArea",e),this.callSuper("_set",t,e);else if("angle"===t)this.callSuper("_set",t,e),this._resetControlRectangle();else if("svgString"===t)this.setSVGString(e),this._resetControlRectangle();else if("svgImage"===t)this.setSvgImage(e),this._resetControlRectangle();else if("pdf"===t){var n=this.item(1),i=this.item(0);n.set("visible",!0),i.set("visible",!1),n.set("pdf",e),this.pdf=e,this.svgString="",this._resetControlRectangle(),this._updateSelectionRectScale(n._renderPromise,n)}else"width"===t?(e=e||0,this._objects.forEach((function(t){t.set("width",e),t.setCoords()})),this.callSuper("_set",t,e),this._adjustClippingPath(),this._resetControlRectangle()):"height"===t?(e=e||0,this._objects.forEach((function(t){t.set("height",e),t.setCoords()})),this.callSuper("_set",t,e),this._adjustClippingPath(),this._resetControlRectangle()):"svgColor"===t?(this.item(0).set("svgColor",e),this.callSuper("_set",t,e)):"evented"===t?(this._controlRectangle.set("evented",e),this._forcedEditMode||this._editMode||this.callSuper("_set",t,e)):"hasControls"===t?(this._controlRectangle.set("hasControls",e),this.callSuper("_set",t,e)):this.callSuper("_set",t,e)},enableEditMode:function(){this._forcedEditMode=!0,this.fire("object:dblclick")},disableEditMode:function(){this.fire("deselected")},updateFromGroupScaling:function(){var t=this.width*this.scaleX,e=this.height*this.scaleY;this.scaleX=1,this.scaleY=1,this.set("width",t),this.set("height",e)},setSvgImage:function(t){this.item(1).set("visible",!1),this.item(0).set("visible",!0),this.item(0).set("svgImage",t),this.pdf=null,this.svgString="",this._updateSelectionRectScale(this.item(0)._renderPromise,this.item(0))},setSVGString:function(t){this.item(1).set("visible",!1),this.item(0).set("visible",!0),this.item(0).set("svgString",t),this.pdf=null,this.svgString=t,this._updateSelectionRectScale(this.item(0)._renderPromise,this.item(0))},setVectorOffset:function(t,e){var n=this._correctOffset(t,e);this.item(0).set("left",n.x),this.item(1).set("left",n.x),this.item(0).set("top",n.y),this.item(1).set("top",n.y),this._controlRectangle.set("left",this.left+t),this._controlRectangle.set("top",this.top+e),this._controlRectangle.setCoords()},setVectorAngle:function(t){this.item(0).set("angle",t),this.item(1).set("angle",t),this._controlRectangle.set("angle",t+this.angle),this._controlRectangle.setCoords()},setVectorScale:function(t,e){this.item(0).set("scaleX",t),this.item(1).set("scaleX",t),this.item(0).set("scaleY",e),this.item(1).set("scaleY",e),this._controlRectangle.set("scaleX",t),this._controlRectangle.set("scaleY",e),this._controlRectangle.setCoords()},getEditModeParameters:function(){return{offsetX:this._controlRectangle.left-this.left||0,offsetY:this._controlRectangle.top-this.top||0,scaleX:this._controlRectangle.scaleX||1,scaleY:this._controlRectangle.scaleY||1,angle:this._controlRectangle.angle||0}},_updateSelectionRectScale:function(t,e){var n=this;t&&t.then((function(){n._controlRectangle.set("scaleX",e.scaleX),n._controlRectangle.set("scaleY",e.scaleY),n._controlRectangle.setCoords()}))},_correctOffset:function(t,e){var n=fabric.util.degreesToRadians(this.angle),i=(e-t*Math.tan(n))*Math.cos(n);return{x:i*Math.tan(n)+t/Math.cos(n),y:i}},_resetControlRectangle:function(){var t=this._controlRectangle;t.set("left",this.left),t.set("top",this.top),t.set("angle",this.angle),t.set("scaleX",1),t.set("scaleY",1),t.set("width",this.width),t.set("height",this.height),this.setVectorOffset(0,0),this.setVectorAngle(0),this.setVectorScale(1,1)},_adjustClippingPath:function(){this.clipPath||this.set("clipPath",new fabric.Rect({originX:"center",originY:"center"})),this.clipPath.set("width",this.width),this.clipPath.set("height",this.height)},_getPdfRenderPromise:function(){return this.item(1)._renderPromise},_getSvgRenderPromise:function(){return this.item(0)._renderPromise}})},function(t,e,n){var i,r,o;r=[n(7)],void 0===(o="function"===typeof(i=function(t,e){var n={color:"rgba(255, 255, 255, 0.8)",custom:"",fade:!0,fontawesome:"",imagePosition:"center center",maxSize:"100px",minSize:"20px",resizeInterval:50,size:"50%",zIndex:2147483647};function i(n,r){var s=i.bind(null,n,r);if(t(n).height()){0==t("#overlay-animation").length&&t('<style id="overlay-animation">').html(" @keyframes loadingOverlayAnimation { from { transform: scale(1); } to { transform: scale(.2); } }").appendTo("body");var a=(n=t(n)).is("body"),c=n.data("LoadingOverlayCount");if(c===e&&(c=0),0===c){var l=t("<div>",{class:"loadingoverlay",css:{"background-color":r.color,position:"relative",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center"}}),u=t("<div>",{class:"loadingoverlaycircle",css:{position:"absolute",width:13,height:13,backgroundColor:"#000",borderRadius:"100%",animation:"loadingOverlayAnimation 0.6s infinite cubic-bezier(.3,0,1,.75)"}}),h=t("<div>",{css:{position:"relative",width:"300px",height:"300px",maxWidth:"100%",maxHeight:"100%"}});if(l.append(h),r.zIndex!==e&&l.css("z-index",r.zIndex),r.fontawesome&&t("<div>",{class:"loadingoverlay_fontawesome "+r.fontawesome}).appendTo(l),r.custom&&t(r.custom).appendTo(l),a?l.css({position:"fixed",top:0,left:0,width:"100%",height:"100%"}):l.css("position","fixed"===n.css("position")?"fixed":"absolute"),o(n,l,r,a),r.resizeInterval>0){var f=setInterval((function(){o(n,l,r,a)}),r.resizeInterval);n.data("LoadingOverlayResizeIntervalId",f)}r.fade?!0===r.fade?r.fade=[400,200]:"string"!==typeof r.fade&&"number"!==typeof r.fade||(r.fade=[r.fade,r.fade]):r.fade=[0,0],n.data({LoadingOverlay:l,LoadingOverlayFadeOutDuration:r.fade[1]}),l.hide().appendTo("body").fadeIn(r.fade[0]);for(var d=Math.PI,p=h.innerWidth(),g=h.innerHeight(),m=0;m<12;m++)h.append(u.clone().css({left:p/2+50*Math.sin(2*d/12*m),top:g/2+50*Math.cos(2*d/12*m),animationDelay:-.6/12*m+"s"}))}c++,n.data("LoadingOverlayCount",c)}else setTimeout(s,100)}function r(n,i){var r=(n=t(n)).data("LoadingOverlayCount");if(r!==e)if(r--,i||r<=0){var o=n.data("LoadingOverlayResizeIntervalId");o&&clearInterval(o),n.data("LoadingOverlay").fadeOut(n.data("LoadingOverlayFadeOutDuration"),(function(){t(this).remove()})),n.removeData(["LoadingOverlay","LoadingOverlayCount","LoadingOverlayFadeOutDuration","LoadingOverlayResizeIntervalId"])}else n.data("LoadingOverlayCount",r)}function o(e,n,i,r){if(!r){var o="fixed"===e.css("position")?e.position():e.offset();n.css({top:o.top-parseInt(t("html").css("padding-top"),10)-parseInt(t("html").css("margin-top"),10)+parseInt(e.css("border-top-width"),10),left:o.left-parseInt(t("html").css("padding-left"),10)-parseInt(t("html").css("margin-left"),10)+parseInt(e.css("border-left-width"),10),width:e.innerWidth(),height:e.innerHeight()})}var s=r?t(window):e,a="auto";i.size&&"auto"!=i.size&&(a=Math.min(s.innerWidth(),s.innerHeight())*parseFloat(i.size)/100,i.maxSize&&a>parseInt(i.maxSize,10)&&(a=parseInt(i.maxSize,10)+"px"),i.minSize&&a<parseInt(i.minSize,10)&&(a=parseInt(i.minSize,10)+"px")),n.children(".loadingoverlay_fontawesome").css("font-size",a)}t.LoadingOverlaySetup=function(e){t.extend(!0,n,e)},t.LoadingOverlay=function(e,o){switch(e.toLowerCase()){case"show":i("body",t.extend(!0,{},n,o));break;case"hide":r("body",o)}},t.fn.LoadingOverlay=function(e,o){switch(e.toLowerCase()){case"show":var s=t.extend(!0,{},n,o);return this.each((function(){i(this,s)}));case"hide":return this.each((function(){r(this,o)}))}}})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i=n(18).fabric;n(140),n(141),n(142),i.IMAGE_MODE_SINGLE_COLOR="single color",i.IMAGE_MODE_FULL_COLOR="full color",i.IMAGE_MODE_GRADING="grading",i.filterBackend=new i.Canvas2dFilterBackend,i.ImagePlaceholder=i.util.createClass(i.Group,{type:"image-placeholder",cacheProperties:i.Group.prototype.cacheProperties.concat("imageColor","threshold","imageMode","stroke"),imageMode:i.IMAGE_MODE_FULL_COLOR,originalElement:null,lockUniScalingWithSkew:!1,lockMouseMovement:!1,originalMaskElement:null,maskingColor:"#000000",coverMaskArea:!1,hasMask:!1,preventEditMode:!1,threshold:150,imageColor:"#000000",silentEditMode:!1,_emptyImage:!1,_editMode:!1,_noMaskScaleX:1,_noMaskScaleY:1,_noMaskOriginalImgScale:1,_originalStroke:null,_originalStrokeWidth:null,_originalCanvasSelection:!0,_originalLockX:!1,_originalLockY:!1,_initialMouseX:0,_initialMouseY:0,_forcedEditMode:!1,rotationStep:1,_maskBoundsRectangle:null,_boundingBoxOffsetX:0,_boundingBoxOffsetY:0,_relationshipMatrix:null,removeWhiteBackground:!1,initialize:function(t,e,n){var r=this,o=!!e.isMobile,s=new i.MaskedImage(t,{originX:"center",originY:"center",width:e.width||300,height:e.height||300},n),a=new i.Rect({strokeDashArray:e.strokeDashArray,originX:"center",originY:"center",stroke:e.stroke||"#000000",strokeWidth:"undefined"!=typeof e.strokeWidth?e.strokeWidth:5,width:e.width||300,height:e.height||300,fill:"rgba(0, 0, 0, 0)",id:e.id});this._maskBoundsRectangle=new i.Rect({originX:"center",originY:"center",strokeWidth:3,stroke:"rgba(0, 0, 0, 0)",width:e.width||300,height:e.height||300,fill:"rgba(0, 0, 0, 0)",lockSkewingX:!0,lockSkewingY:!0}),this._maskBoundsRectangle.setControlsVisibility({tl:!o,tr:!o,br:!o,bl:!o,mtr:!o,ml:!1,mb:!1,mr:!1,mt:!1}),this.callSuper("initialize",[s,a],e),this._adjustClippingPath(),this._resetFakeBoundingBox(),this.setElement(t),this.setMode(this.imageMode),this._maskBoundsRectangle._initialMaskOffsetX=0,this._maskBoundsRectangle._initialMaskOffsetY=0,this._maskBoundsRectangle.on({mousedown:function(t){r.canvas.fire("object:placeholder:mousedown")},mouseup:function(t){r.canvas.fire("object:placeholder:mouseup")},selected:function(t){r.canvas.fire("object:placeholder:maskSelected")},deselected:function(t){r.fire("deselected",t)},rotating:function(){this.angle=Math.ceil(this.angle/r.rotationStep)*r.rotationStep,r._updateMaskAngle(this.angle-r.angle),r._updateRelationshipMatrix(),r.canvas&&r.canvas.fire("object:placeholder:maskModified",{object:r,parameters:r.getEditModeImageParameters()})},scaling:function(){var t=this.width*this.scaleX,e=this.height*this.scaleY;this.set("width",t),this.set("height",e),this.scaleX=1,this.scaleY=1;var n=this.width/(r.item(0).width*r._noMaskOriginalImgScale),i=this.height/(r.item(0).height*r._noMaskOriginalImgScale);r._updateMaskScale(n,i),r._updateRelationshipMatrix(),r.canvas&&r.canvas.fire("object:placeholder:maskModified",{object:r,parameters:r.getEditModeImageParameters()})},moving:function(){r._boundingBoxOffsetX=this.left-r.left,r._boundingBoxOffsetY=this.top-r.top;var t=(this.left-r.left)/r.item(0).scaleX,e=(this.top-r.top)/r.item(0).scaleY;this._lastDistanceX=t,this._lastDistanceY=e,r._updateMaskPosition(t,e),r._updateRelationshipMatrix(),r.canvas&&r.canvas.fire("object:placeholder:maskModified",{object:r,parameters:r.getEditModeImageParameters()})}}),this.on({scaling:function(t){if(this.lockUniScalingWithSkew){var e=1;e="scaleX"===t.transform.action?this.scaleX:this.scaleY,this.scaleX=e,this.scaleY=e}},scaled:function(){var t=this.width*this.scaleX,e=this.height*this.scaleY;this._resetFakeBoundingBox(),this.scaleX=1,this.scaleY=1,this.setWidth(t),this.setHeight(e),this._updateRelationshipMatrix()},added:function(){this.cornerSize=.025*this.canvas.width,this.transparentCorners=!1},removed:function(){this.canvas.remove(this._maskBoundsRectangle)},"object:dblclick":function(){if(!this.preventEditMode&&(this._forcedEditMode||!this._emptyImage)){this._editMode=!0,this._enablingEditMode=!0,this._originalCanvasSelection=this.canvas.selection,this.canvas.selection=!1,this._controlsVisibilityBackup=JSON.parse(JSON.stringify(this._getControlsVisibility())),this.setControlsVisibility({bl:!1,br:!1,mb:!1,ml:!1,mr:!1,mt:!1,mtr:!1,tl:!1,tr:!1}),this._maskBoundsRectangle.set("cornerSize",this.cornerSize),this._maskBoundsRectangle.set("transparentCorners",this.transparentCorners),this._maskBoundsRectangle.set("centeredScaling",!0),this._maskBoundsRectangle.set("centeredRotation",!0),this._maskBoundsRectangle.set("skewX",this.skewX),this._maskBoundsRectangle.set("skewY",this.skewY);var t=this.hasMask?this._maskBoundsRectangle._lastDistanceX*this.item(0).scaleX:this._boundingBoxOffsetX,e=this.hasMask?this._maskBoundsRectangle._lastDistanceY*this.item(0).scaleY:this._boundingBoxOffsetY;this._maskBoundsRectangle.set("left",this.left+t),this._maskBoundsRectangle.set("top",this.top+e),this._maskBoundsRectangle.setCoords(),this.canvas.add(this._maskBoundsRectangle),this.canvas.setActiveObject(this._maskBoundsRectangle),this._updateMaskBoundsPosition(),this._updateRelationshipMatrix(),this._originalLockX=this.lockMovementX,this._originalLockY=this.lockMovementY,this.lockMovementX=this.lockMovementY=!0,this._initialMouseX=null,this._initialMouseY=null,this.silentEditMode||(this._originalStroke=this.item(1).stroke,this._originalStrokeWidth=this.item(1).strokeWidth,this.item(1).set("stroke","red"),this.item(1).set("strokeWidth",5)),this._enablingEditMode=!1,this.canvas.renderAll()}},deselected:function(){!this._editMode||this._forcedEditMode||this._enablingEditMode||(this._editMode=!1,this.canvas.selection=this._originalCanvasSelection,this.canvas.remove(this._maskBoundsRectangle),this.setControlsVisibility(this._controlsVisibilityBackup),this.lockMovementX=this._originalLockX,this.lockMovementY=this._originalLockY,this.silentEditMode||(this.item(1).set("stroke",this._originalStroke),this.item(1).set("strokeWidth",this._originalStrokeWidth),this.set("dirty",!0)),this.canvas.renderAll())},rotating:function(){this._maskBoundsRectangle.set("angle",this.angle)},rotated:function(){this._updateMaskBoundsPosition(),this._updateRelationshipMatrix()}})},_set:function(t,e){if("id"===t)this._maskBoundsRectangle&&(this._maskBoundsRectangle.id=e);else if("lockMouseMovement"===t)e?(this._maskBoundsRectangle.lockMovementX=!0,this._maskBoundsRectangle.lockMovementY=!0):(this._maskBoundsRectangle.lockMovementX=!1,this._maskBoundsRectangle.lockMovementY=!1);else if("imageColor"===t)this.item(0).filters[0]&&"KMeans"===this.item(0).filters[0].type&&(this.item(0).filters[0].setFgColor(e),this.item(0).applyFilters());else if("width"===t||"height"===t)this.callSuper("_set",t,e),this._adjustImage(),this._adjustClippingPath(),this._resetFakeBoundingBox(),this.setMask(this.originalMaskElement);else if("rotationStep"===t)"undefined"===typeof e?e=this.rotationStep:(e<0||0==e)&&(e=1);else if("evented"===t){if(this._maskBoundsRectangle.set("evented",e),this._forcedEditMode||this._editMode)return}else"imageMode"===t?(this.callSuper("_set",t,e),this.originalElement&&this.setMode(this.imageMode)):"stroke"===t?this.item(1).set("stroke",e):"angle"===t?this._updateMaskBoundsPosition():"hasControls"===t&&this._maskBoundsRectangle.set("hasControls",e);this.callSuper("_set",t,e)},updateFromGroupScaling:function(){var t=this.width*this.scaleX,e=this.height*this.scaleY;this.scaleX=1,this.scaleY=1,this.setWidth(t),this.setHeight(e)},enableEditMode:function(){this._forcedEditMode=!0,this.fire("object:dblclick")},disableEditMode:function(){this.fire("deselected")},setEditModeImageScale:function(t){this._editMode&&this._updateMaskScale(t,t)},setEditModeImageRotation:function(t){this._editMode&&this._updateMaskAngle(t)},setEditModeImageOffset:function(t,e){this._editMode&&this._updateMaskPosition(t,e)},getEditModeImageParameters:function(){return this.hasMask?{offsetX:this._maskBoundsRectangle._lastDistanceX||0,offsetY:this._maskBoundsRectangle._lastDistanceY||0,scaleX:this.item(0).maskScaleX||1,scaleY:this.item(0).maskScaleY||1,angle:this.item(0).maskAngle||0,threshold:this.threshold}:{offsetX:this._maskBoundsRectangle._lastDistanceX||0,offsetY:this._maskBoundsRectangle._lastDistanceY||0,scaleX:this._noMaskScaleX||1,scaleY:this._noMaskScaleY||1,angle:this.item(0).angle||0,threshold:this.threshold}},setOpacity:function(t){this.item(0).set("opacity",t)},getOpacity:function(){return this.item(0).opacity},getWidth:function(){return this.width*this.scaleX},setWidth:function(t){t||(t=0),this.item(1).set("width",t),this.set("width",t)},getHeight:function(){return this.height*this.scaleY},setHeight:function(t){t||(t=0),this.item(1).set("height",t),this.set("height",t)},getColor:function(){return this.imageColor},_getInitialBoundsRectangleSize:function(){var t=0,e=0;if(this.originalElement&&this.originalElement.width>0&&this.originalElement.width>0){var n=this._computeImageScaling();t=this.item(0).width*n,e=this.item(0).height*n}return{width:t,height:e}},_resetFakeBoundingBox:function(){this._boundingBoxOffsetX=this._boundingBoxOffsetY=0,this._maskBoundsRectangle._lastDistanceX=this._maskBoundsRectangle._lastDistanceY=0,this._noMaskScaleX=this._noMaskScaleY=1;var t=this._getInitialBoundsRectangleSize();this._maskBoundsRectangle.set("width",t.width),this._maskBoundsRectangle.set("height",t.height),this._maskBoundsRectangle.set("angle",this.angle),this._maskBoundsRectangle.set("left",this.left),this._maskBoundsRectangle.set("top",this.top),this._maskBoundsRectangle.setCoords(),this.item(0).set("left",0),this.item(0).set("top",0),this.item(0).set("angle",0)},setElement:function(t){t?this._emptyImage=!1:((t=new Image).width=t.height=1,this._emptyImage=!0),this.originalElement=t,this.item(0).setElement(t),this.setMask(this.originalMaskElement),this.set("dirty",!0)},setMask:function(t){var e,n,i=this.item(0);(this.originalMaskElement=t,t)?(this.hasMask=!0,this.originalElement&&(this.originalElement.width>this.originalElement.height?(e=this.originalElement.width,(n=this.getHeight()*this.originalElement.width/this.getWidth())<this.originalElement.height&&(n=this.originalElement.height,e=this.getWidth()*this.originalElement.height/this.getHeight())):(n=this.originalElement.height,(e=this.getWidth()*this.originalElement.height/this.getHeight())<this.originalElement.width&&(e=this.originalElement.width,n=this.getHeight()*this.originalElement.width/this.getWidth())),i.set("maskElement",t),i.set("maskScaleX",1),i.set("maskScaleY",1),i.set("maskOffsetX",0),i.set("maskOffsetY",0),i.set("maskAngle",0),i.set("maskHeight",n),i.set("maskWidth",e))):(this.hasMask=!1,i.set("maskElement",null));if(this._adjustImage(!0),this._resetFakeBoundingBox(),this.coverMaskArea){var r=1;if(this.hasMask){var o=this.width/(this.item(0).width*this.item(0).scaleX),s=this.height/(this.item(0).height*this.item(0).scaleY);r=Math.max(o,s)}else{var a=this.width/(this.item(0).width*this.item(0).scaleX),c=this.height/(this.item(0).height*this.item(0).scaleY);r=Math.max(a,c)}this._updateMaskScale(r,r)}},_updateRelationshipMatrix:function(){var t=this._maskBoundsRectangle,e=this.calcTransformMatrix(),n=i.util.invertTransform(e);this._relationshipMatrix=i.util.multiplyTransformMatrices(n,t.calcTransformMatrix())},_updateMaskBoundsPosition:function(){if(this._relationshipMatrix){var t=this._relationshipMatrix,e=i.util.multiplyTransformMatrices(this.calcTransformMatrix(),t),n=i.util.qrDecompose(e);this._maskBoundsRectangle.set({flipX:!1,flipY:!1}),this._maskBoundsRectangle.setPositionByOrigin({x:n.translateX,y:n.translateY},"center","center"),this._maskBoundsRectangle.set(n),this._maskBoundsRectangle.setCoords()}},_correctOffset:function(t,e){var n=this.calcTransformMatrix(!0),r=i.iMatrix,o=i.util.multiplyTransformMatrices(n,r),s=i.util.invertTransform(o);return i.util.transformPoint(new i.Point(this.left+t,this.top+e),s)},_inverseCorrectOffset:function(t,e){var n=this.calcTransformMatrix(!0),r=i.iMatrix,o=i.util.multiplyTransformMatrices(n,r),s=i.util.transformPoint(new i.Point(t,e),o);return{x:s.x-this.left,y:s.y-this.top}},_updateMaskPosition:function(t,e){var n=this.item(0),i=this._correctOffset(t,e);this._maskBoundsRectangle._lastDistanceX=t,this._maskBoundsRectangle._lastDistanceY=e,this.hasMask?(n.set("maskOffsetX",i.x),n.set("maskOffsetY",i.y),this._maskBoundsRectangle.set("left",this.left+t*n.scaleX),this._maskBoundsRectangle.set("top",this.top+e*n.scaleY)):(n.set("left",i.x*n.scaleX),n.set("top",i.y*n.scaleY),this._maskBoundsRectangle.set("left",this.left+t*n.scaleX),this._maskBoundsRectangle.set("top",this.top+e*n.scaleX)),this._maskBoundsRectangle.setCoords()},_updateMaskAngle:function(t){this.hasMask?this.item(0).set("maskAngle",t):this.item(0).set("angle",t),this._maskBoundsRectangle.set("angle",t+this.angle),this._maskBoundsRectangle.setCoords()},_updateMaskScale:function(t,e){this.hasMask?(this.item(0).set("maskScaleX",t),this.item(0).set("maskScaleY",e)):(this._noMaskScaleX=t,this._noMaskScaleY=e,this._adjustImage());var n=this._getInitialBoundsRectangleSize();if(this._maskBoundsRectangle.set("width",n.width*t),this._maskBoundsRectangle.set("height",n.height*e),!this.hasMask){var i=this._inverseCorrectOffset(this.item(0).left/this.item(0).scaleX,this.item(0).top/this.item(0).scaleY);this._updateMaskPosition(i.x,i.y)}this._maskBoundsRectangle.setCoords()},setMode:function(t){var e=this.item(0);if(t===i.IMAGE_MODE_SINGLE_COLOR){this.imageMode=t;var n=new i.Image.filters.KMeans({threshold:this.threshold,fgColor:this.imageColor,bgColor:"rgba(0,0,0,0)"});e.filters[0]=n}else t===i.IMAGE_MODE_FULL_COLOR?(this.imageMode=t,this.removeWhiteBackground?e.filters[0]=new i.Image.filters.FloodFill({replacementColor:"rgba(0, 0, 0, 0)",tolerance:200}):e.filters[0]=null):t===i.IMAGE_MODE_GRADING&&(this.imageMode=t,e.filters[0]=new i.Image.filters.Grayscale);e.set("dirty",!0),this.set("dirty",!0),e.applyFilters()},_computeImageScaling:function(){var t=1;return this.originalElement&&0!=this.originalElement.width&&0!=this.originalElement.height&&(this.originalElement.width>this.originalElement.height?(t=this.getWidth()/this.originalElement.width,this.originalElement.height*t>this.item(1).height&&(t=this.getHeight()/this.originalElement.height)):this.originalElement.height>this.originalElement.width?(t=this.getHeight()/this.originalElement.height,this.originalElement.width*t>this.item(1).width&&(t=this.getWidth()/this.originalElement.width)):t=Math.min(this.getWidth()/this.originalElement.width,this.getHeight()/this.originalElement.height)),t},_adjustImage:function(t){if(this.originalElement&&0!=this.originalElement.width&&0!=this.originalElement.height){var e=this._computeImageScaling();this._noMaskOriginalImgScale=e;var n=e,i=e;t||(n=e*this._noMaskScaleX,i=e*this._noMaskScaleY),this.item(0).set("scaleX",n),this.item(0).set("scaleY",i),this.item(0).setCoords()}},_adjustClippingPath:function(){this.clipPath||this.set("clipPath",new i.Rect({originX:"center",originY:"center"})),this.clipPath.set("width",this.width),this.clipPath.set("height",this.height)},_drawControl:function(t,e,n,i,r,o){this._editMode||this.callSuper("_drawControl",t,e,n,i,r,o)},drawBorders:function(t,e){this._editMode||this.callSuper("drawBorders",t,e)}})},function(t,e,n){!function(t){"use strict";fabric.Image.filters.KMeans=fabric.util.createClass(fabric.Image.filters.BaseFilter,{type:"KMeans",threshold:150,fgColor:"#000000",bgColor:"#ffffff",_rf:0,_gf:0,_bf:0,_af:0,_rb:0,_gb:0,_bb:0,_ab:0,initialize:function(t){t=t||{},this.threshold=t.threshold||150,this.fgColor=t.fgColor||"#000000",this.bgColor=t.bgColor||"#ffffff",this.setFgColor(this.fgColor),this.setBgColor(this.bgColor)},applyTo2d:function(t){for(var e=t.imageData.data,n=0;n<e.length;n+=4){var i=e[n],r=e[n+1],o=e[n+2],s=e[n+3];.2126*i+.7152*r+.0722*o>this.threshold||0===s?(e[n]=this._rb,e[n+1]=this._gb,e[n+2]=this._bb,e[n+3]=this._ab):(e[n]=this._rf,e[n+1]=this._gf,e[n+2]=this._bf,e[n+3]=this._af)}},setFgColor:function(t){var e=new fabric.Color(t).getSource();this._rf=e[0],this._gf=e[1],this._bf=e[2],this._af=255*e[3]},setBgColor:function(t){var e=new fabric.Color(t).getSource();this._rb=e[0],this._gb=e[1],this._bb=e[2],this._ab=255*e[3]}}),fabric.Image.filters.KMeans.fromObject=fabric.Image.filters.BaseFilter.fromObject}()},function(t,e){fabric.MaskedImage=fabric.util.createClass(fabric.Image,{type:"masked-image",cacheProperties:fabric.Group.prototype.cacheProperties.concat("maskElement","maskScaleX","maskScaleY","maskAngle","maskOffsetX","maskOffsetY","maskHeight","maskWidth"),maskElement:null,maskScaleX:1,maskScaleY:1,maskAngle:0,maskOffsetX:0,maskOffsetY:0,maskHeight:0,maskWidth:0,_maskCanvas:null,initialize:function(t,e){this.callSuper("initialize",t,e)},_resizeMaskImage:function(t,e){this._maskCanvas||(this._maskCanvas=document.createElement("canvas"));var n=this._maskCanvas;if(n.width!=t||n.height!=e){var i=this._maskCanvas.getContext("2d"),r=new fabric.Color(this.maskingColor).getSource();n.width=t,n.height=e,i.drawImage(this.maskElement,0,0,n.width,n.height);for(var o=i.getImageData(0,0,n.width,n.height),s=o.data,a=s.length,c=0;c<a;c+=4)(Math.abs(s[c]-r[0])>60||Math.abs(s[c+1]-r[1])>60||Math.abs(s[c+2]-r[2])>60||Math.abs(s[c+3]-255)>60)&&(s[c+3]=0);i.putImageData(o,0,0)}},_set:function(t,e){"maskElement"!==t&&"maskHeight"!==t&&"maskWidth"!==t||(this._maskCanvas=null,"maskHeight"!==t&&"maskWidth"!==t||(!Number.isNaN(e)&&Number.isFinite(e)||(e=1),e=Math.round(e))),this.callSuper("_set",t,e)},_render:function(t){if(this.maskElement){this._resizeMaskImage(this.maskWidth,this.maskHeight),t.save(),t.translate(this.maskOffsetX,this.maskOffsetY),t.rotate(this.maskAngle*Math.PI/180),t.scale(this.maskScaleX,this.maskScaleY),t.drawImage(this._element,-this.width/2,-this.height/2),t.restore(),t.globalCompositeOperation="destination-in";var e=-this._maskCanvas.height/2,n=-this._maskCanvas.width/2;t.drawImage(this._maskCanvas,n,e)}else this.callSuper("_render",t)}})},function(t,e,n){"use strict";n.r(e);var i=n(20),r=n.n(i),o=n(69),s=n.n(o),a=n(70),c=n.n(a),l=function(){function t(e){s()(this,t),this.collectModifiedPixels=!1,this.modifiedPixelsCount=0,this.modifiedPixels=new Set,this._tolerance=0,this._queue=[],this.imageData=e}return c()(t,[{key:"fill",value:function(t,e,n,i){this._newColor=this.colorToRGBA(t),this._replacedColor=this.getColorAtPixel(this.imageData,e,n),this._tolerance=i,this.isSameColor(this._replacedColor,this._newColor,this._tolerance)||(this.addToQueue([e,e,n,-1]),this.fillQueue())}},{key:"hex2RGBA",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255,n=t;if(0===t.indexOf("#")&&(n=t.slice(1)),3===n.length&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),6!==n.length)throw new Error("Invalid HEX color ".concat(n,"."));var i=parseInt(n.slice(0,2),16),r=parseInt(n.slice(2,4),16),o=parseInt(n.slice(4,6),16);return{r:i,g:r,b:o,a:e}}},{key:"colorToRGBA",value:function(t){if(-1!==t.indexOf("rgba")){var e=/rgba\(.*?([0-9]{1,3}).*?([0-9]{1,3}).*?([0-9]{1,3}).*?([0-9\.]{1,})/g.exec(t),n=r()(e,5),i=(n[0],n[1]),o=n[2],s=n[3],a=n[4];return{r:parseInt(i),g:parseInt(o),b:parseInt(s),a:Math.ceil(255*parseFloat(a))}}if(-1!==t.indexOf("rgb")){var c=/rgb\(.*?([0-9]{1,3}).*?([0-9]{1,3}).*?([0-9]{1,3})/g.exec(t),l=r()(c,4),u=(l[0],l[1]),h=l[2],f=l[3];return{r:parseInt(u),g:parseInt(h),b:parseInt(f),a:255}}if(-1!==t.indexOf("#"))return this.hex2RGBA(t);throw new Error("Unsupported color format. Please use CSS rgba, rgb, or HEX!")}},{key:"getColorAtPixel",value:function(t,e,n){var i=t.width,r=t.data,o=4*(n*i+e);if(void 0===r[o+3])throw new Error("Invalid pixel coordinates: x=".concat(e,"; y=").concat(n));return{r:r[o],g:r[o+1],b:r[o+2],a:r[o+3]}}},{key:"setColorAtPixel",value:function(t,e,n,i){var r=t.width,o=t.data,s=4*(i*r+n);if(void 0===o[s+3])throw new Error("Invalid pixel coordinates. Cannot set color at: x=".concat(n,"; y=").concat(i));o[s+0]=255&e.r,o[s+1]=255&e.g,o[s+2]=255&e.b,o[s+3]=255&e.a}},{key:"isSameColor",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return!(Math.abs(t.r-e.r)>n||Math.abs(t.g-e.g)>n||Math.abs(t.b-e.b)>n||Math.abs(t.a-e.a)>n)}},{key:"addToQueue",value:function(t){this._queue.push(t)}},{key:"popFromQueue",value:function(){return this._queue.length?this._queue.pop():null}},{key:"isValidTarget",value:function(t){if(null!==t){var e=this.getColorAtPixel(this.imageData,t.x,t.y);return this.isSameColor(this._replacedColor,e,this._tolerance)}}},{key:"fillLineAt",value:function(t,e){if(!this.isValidTarget({x:t,y:e}))return[-1,-1];this.setPixelColor(this._newColor,{x:t,y:e});for(var n=t,i=t,r=this.getPixelNeighbour("left",n,e);r&&this.isValidTarget(r);)this.setPixelColor(this._newColor,r),n=r.x,r=this.getPixelNeighbour("left",n,e);for(r=this.getPixelNeighbour("right",i,e);r&&this.isValidTarget(r);)this.setPixelColor(this._newColor,r),i=r.x,r=this.getPixelNeighbour("right",i,e);return[n,i]}},{key:"fillQueue",value:function(){for(var t=this.popFromQueue();t;){for(var e=t,n=r()(e,4),i=n[0],o=n[1],s=n[2],a=n[3],c=i;-1!==c&&c<=o;){var l=this.fillLineAt(c,s),u=r()(l,2),h=u[0],f=u[1];-1!==h&&(h>=i&&f<=o&&-1!==a?(a<s&&s+1<this.imageData.height&&this.addToQueue([h,f,s+1,s]),a>s&&s>0&&this.addToQueue([h,f,s-1,s])):(s>0&&this.addToQueue([h,f,s-1,s]),s+1<this.imageData.height&&this.addToQueue([h,f,s+1,s]))),-1===f&&c<=o?c+=1:c=f+1}t=this.popFromQueue()}}},{key:"setPixelColor",value:function(t,e){this.setColorAtPixel(this.imageData,t,e.x,e.y),this.modifiedPixelsCount++,this.collectModifiedPixels&&this.modifiedPixels.add("".concat(e.x,"|").concat(e.y))}},{key:"getPixelNeighbour",value:function(t,e,n){var i;switch(e|=0,n|=0,t){case"right":i={x:e+1|0,y:n};break;case"left":i={x:e-1|0,y:n}}return i.x>=0&&i.x<this.imageData.width?i:null}}]),t}();"undefined"!==typeof exports&&exports,fabric.Image.filters.FloodFill=fabric.util.createClass(fabric.Image.filters.BaseFilter,{type:"FloodFill",replacementColor:"rgba(0, 0, 0, 0)",tolerance:0,initialize:function(t){t=t||{},this.replacementColor=t.replacementColor||"rgba(0, 0, 0, 0)",this.tolerance=t.tolerance||0},applyTo2d:function(t){var e=t.imageData;new l(e).fill(this.replacementColor,0,0,this.tolerance)}}),fabric.Image.filters.FloodFill.fromObject=fabric.Image.filters.BaseFilter.fromObject},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(c){r=!0,o=c}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){n(65);var i=n(59);t.exports=function(){function t(t,e,n,i,r){return new Promise((function(o){e=e.map((function(t){return{id:t.id,uuid:t.uuid,textValue:t.clText||t.getText(),colorOption:t.selectedColorId||1,fontId:t.selectedFont||1}})),n=n.map((function(t){return{id:t.id,uuid:t.uuid,textValue:t.clText||t.text,colorOption:t.selectedColorId||1,fontId:t.selectedFont||1}}));var s=r.filter((function(t){return!t.allowUserUpload})).map((function(t){return{id:t.id,uuid:t.uuid,position:t.selectedVectorIndex,realPosition:t.vectorLibraryId||t.hasLibrary?t.selectedVectorIndex:t.selectedVectorIndex+1,colorPosition:t.lastColorPosition}})),a=i.map((function(t){var e="";return e=t.hasStaticImage||t.dynamicImagesPath?t.id+"-serverStoredImage":t.imageName,{id:t.id,isStaticImage:!!t.hasStaticImage,fileName:e,uuid:t.uuid,position:t.selectedImageIndex,colorPosition:t.lastColorPosition,offsetX:t.getEditModeImageParameters().offsetX,offsetY:t.getEditModeImageParameters().offsetY,previewOriginalElementWidth:t.originalElement.width,previewOriginalElementHeight:t.originalElement.height,angle:t.getEditModeImageParameters().angle,maskScaleX:t.getEditModeImageParameters().scaleX,maskScaleY:t.getEditModeImageParameters().scaleY,threshold:t.threshold}})),c=r.filter((function(t){return t.allowUserUpload})).map((function(t){var e=t.getEditModeParameters();return{id:t.id,fileName:t.vectorName,uuid:t.uuid,offsetX:e.offsetX,offsetY:e.offsetY,scaleX:e.scaleX,scaleY:e.scaleY,angle:e.angle}}));o({productId:t.id,texts:e,circularTexts:n,vectorObjects:s,imagesParameters:a,vectorsParameters:c})}))}return{generateElements:t,generateExportFile:function(e,n,r,o,s,a,c,l){return new Promise((function(u,h){t(n,r,o,s,a).then((function(t){i.generateFile(e,t.texts,t.circularTexts,t.imagesParameters,t.vectorsParameters,t.vectorObjects,t.productId,c,l).then((function(t){u(t)})).catch((function(t){h(t)}))})).catch((function(t){console.error("Error on ".concat(e.toUpperCase()," request")),h(t)}))}))},generateExportFileAuth:function(e,n,r,o,s,a,c,l,u){return new Promise((function(h,f){t(n,r,o,s,a).then((function(t){i.generateFileAuth(e,t.texts,t.circularTexts,t.imagesParameters,t.vectorsParameters,t.vectorObjects,t.productId,c,l,u).then((function(t){h(t)})).catch((function(t){f(t)}))})).catch((function(t){console.error("Error on ".concat(e.toUpperCase()," request")),f(t)}))}))},renameExportedFile:function(t,e,n){return new Promise((function(r,o){i.renameExportedFile(t,e,n).then((function(){r()})).catch((function(t){o(t.responseText)}))}))},requestFutureProductionFile:function(e,n,r,o,s,a,c){return new Promise((function(l,u){t(e,n,r,o,s).then((function(t){i.requestFutureProductionFile(t.texts,t.circularTexts,t.imagesParameters,t.vectorsParameters,t.vectorObjects,t.productId,a,c).then((function(t){l(t)})).catch((function(t){u(t)}))})).catch((function(t){console.error("Error on production file request",t),u(t)}))}))}}}()},function(t,e,n){"use strict";n.r(e),n.d(e,"parseColorFromProperty",(function(){return u})),n.d(e,"hexToRgb",(function(){return h})),n.d(e,"colorToWeb",(function(){return f})),n.d(e,"getImageColor",(function(){return d}));var i=n(0),r=n.n(i),o=n(1),s=n.n(o),a=n(3),c=n(19),l=n.n(c),u=function(t){return"string"===typeof t&&t.indexOf("{")>-1?JSON.parse(t):t},h=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},f=function(t){if("string"===typeof t)return t;if(t.rgb&&t.HEX)return t.alpha<1?"rgba("+255*t.rgb.r+","+255*t.rgb.g+","+255*t.rgb.b+","+t.alpha+")":"#"+t.HEX;if(t.alpha<1){var e=h(t.hex);return"rgba("+e.r+","+e.g+","+e.b+","+t.alpha+")"}return t.hex},d=function(){var t=s()(r.a.mark((function t(e,n){var i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.colorLibraryId){t.next=6;break}return t.next=3,a.a(e.colorLibraryId,n);case 3:i=t.sent,t.next=7;break;case 6:e.colors&&e.colors.length&&(i=l.a.findWhere(e.colors,{position:n}));case 7:return i||(console.warn("No color at position "+n),i=u(e.color)),t.abrupt("return",f(i));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},function(t,e,n){t.exports={ResizeSensor:n(66),ElementQueries:n(149)}},function(t,e,n){"use strict";var i,r,o;"undefined"!==typeof window&&window,r=[n(66)],void 0===(o="function"===typeof(i=function(t){var e=function(){var e,n={},i=[];function r(t){t||(t=document.documentElement);var e=window.getComputedStyle(t,null).fontSize;return parseFloat(e)||16}function o(t,e){var n=e.split(/\d/),i=n[n.length-1];switch(e=parseFloat(e),i){case"px":return e;case"em":return e*r(t);case"rem":return e*r();case"vw":return e*document.documentElement.clientWidth/100;case"vh":return e*document.documentElement.clientHeight/100;case"vmin":case"vmax":var o=document.documentElement.clientWidth/100,s=document.documentElement.clientHeight/100;return e*(0,Math["vmin"===i?"min":"max"])(o,s);default:return e}}function s(t,e){var i,r,s,a,c,l,u,h;this.element=t;var f=["min-width","min-height","max-width","max-height"];this.call=function(){for(i in s=function(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}(this.element),l={},n[e])n[e].hasOwnProperty(i)&&(r=n[e][i],a=o(this.element,r.value),c="width"===r.property?s.width:s.height,h=r.mode+"-"+r.property,u="","min"===r.mode&&c>=a&&(u+=r.value),"max"===r.mode&&c<=a&&(u+=r.value),l[h]||(l[h]=""),u&&-1===(" "+l[h]+" ").indexOf(" "+u+" ")&&(l[h]+=" "+u));for(var t in f)f.hasOwnProperty(t)&&(l[f[t]]?this.element.setAttribute(f[t],l[f[t]].substr(1)):this.element.removeAttribute(f[t]))}}function a(e,n){e.elementQueriesSetupInformation||(e.elementQueriesSetupInformation=new s(e,n)),e.elementQueriesSensor||(e.elementQueriesSensor=new t(e,(function(){e.elementQueriesSetupInformation.call()})))}function c(t,r,o,s){if("undefined"===typeof n[t]){n[t]=[];var a=i.length;e.innerHTML+="\n"+t+" {animation: 0.1s element-queries;}",e.innerHTML+="\n"+t+" > .resize-sensor {min-width: "+a+"px;}",i.push(t)}n[t].push({mode:r,property:o,value:s})}function l(t){var e;if(document.querySelectorAll&&(e=t?t.querySelectorAll.bind(t):document.querySelectorAll.bind(document)),e||"undefined"===typeof $$||(e=$$),e||"undefined"===typeof jQuery||(e=jQuery),!e)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return e}function u(e){var n=[],i=[],r=[],o=0,s=-1,a=[];for(var c in e.children)if(e.children.hasOwnProperty(c)&&e.children[c].tagName&&"img"===e.children[c].tagName.toLowerCase()){n.push(e.children[c]);var l=e.children[c].getAttribute("min-width")||e.children[c].getAttribute("data-min-width"),u=e.children[c].getAttribute("data-src")||e.children[c].getAttribute("url");r.push(u);var h={minWidth:l};i.push(h),l?e.children[c].style.display="none":(o=n.length-1,e.children[c].style.display="block")}function f(){var t,c=!1;for(t in n)n.hasOwnProperty(t)&&i[t].minWidth&&e.offsetWidth>i[t].minWidth&&(c=t);if(c||(c=o),s!==c)if(a[c])n[s].style.display="none",n[c].style.display="block",s=c;else{var l=new Image;l.onload=function(){n[c].src=r[c],n[s].style.display="none",n[c].style.display="block",a[c]=!0,s=c},l.src=r[c]}else n[c].src=r[c]}s=o,e.resizeSensorInstance=new t(e,f),f()}var h=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,f=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function d(t){var e,n,i,r;for(t=t.replace(/'/g,'"');null!==(e=h.exec(t));)for(n=e[1]+e[3],i=e[2];null!==(r=f.exec(i));)c(n,r[1],r[2],r[3])}function p(t){var e="";if(t)if("string"===typeof t)-1===(t=t.toLowerCase()).indexOf("min-width")&&-1===t.indexOf("max-width")||d(t);else for(var n=0,i=t.length;n<i;n++)1===t[n].type?-1!==(e=t[n].selectorText||t[n].cssText).indexOf("min-height")||-1!==e.indexOf("max-height")?d(e):-1===e.indexOf("min-width")&&-1===e.indexOf("max-width")||d(e):4===t[n].type?p(t[n].cssRules||t[n].rules):3===t[n].type&&t[n].styleSheet.hasOwnProperty("cssRules")&&p(t[n].styleSheet.cssRules)}var g=!1;this.init=function(){var n="animationstart";"undefined"!==typeof document.documentElement.style.webkitAnimationName?n="webkitAnimationStart":"undefined"!==typeof document.documentElement.style.MozAnimationName?n="mozanimationstart":"undefined"!==typeof document.documentElement.style.OAnimationName&&(n="oanimationstart"),document.body.addEventListener(n,(function(e){var n=e.target,r=n&&window.getComputedStyle(n,null),o=r&&r.getPropertyValue("animation-name");if(o&&-1!==o.indexOf("element-queries")){n.elementQueriesSensor=new t(n,(function(){n.elementQueriesSetupInformation&&n.elementQueriesSetupInformation.call()}));var s=window.getComputedStyle(n.resizeSensor,null).getPropertyValue("min-width");s=parseInt(s.replace("px","")),a(e.target,i[s])}})),g||((e=document.createElement("style")).type="text/css",e.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",e.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(e),g=!0);for(var r=0,o=document.styleSheets.length;r<o;r++)try{document.styleSheets[r].href&&0===document.styleSheets[r].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[r].href),p(document.styleSheets[r].cssRules||document.styleSheets[r].rules||document.styleSheets[r].cssText)}catch(s){}!function(){for(var t=l()("[data-responsive-image],[responsive-image]"),e=0,n=t.length;e<n;e++)u(t[e])}()},this.findElementQueriesElements=function(t){!function(t){var e=l(t);for(var i in n)if(n.hasOwnProperty(i))for(var r=e(i,t),o=0,s=r.length;o<s;o++)a(r[o],i)}(t)},this.update=function(){this.init()}};return e.update=function(){e.instance.update()},e.detach=function(t){t.elementQueriesSetupInformation?(t.elementQueriesSensor.detach(),delete t.elementQueriesSetupInformation,delete t.elementQueriesSensor):t.resizeSensorInstance&&(t.resizeSensorInstance.detach(),delete t.resizeSensorInstance)},e.init=function(){e.instance||(e.instance=new e),e.instance.init()},e.findElementQueriesElements=function(t){e.instance.findElementQueriesElements(t)},e.listen=function(){!function(t){if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var e=setInterval((function(){/loaded|complete/i.test(document.readyState)&&(t(),clearInterval(e))}),10);else window.onload=t}(e.init)},e})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i=n(151),r=n(152);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[o+a]=s[a];return e||r(s)}},function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var r=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0===(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}},function(t,e){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);t.exports=function(t,e){var i=e||0,r=n;return[r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]]].join("")}},function(t,e,n){var i=n(154)();t.exports=function(t){return t.replace(i,"")}},function(t,e,n){"use strict";t.exports=function(){return/\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74)\uDB40\uDC7F|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|[\u2695\u2696\u2708]\uFE0F|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]\uFE0F|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]))|\uD83D\uDC69\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|\uD83D\uDC69\u200D[\u2695\u2696\u2708])\uFE0F|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D\uDC68(?:\u200D(?:(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D[\uDC66\uDC67])|\uD83C[\uDFFB-\uDFFF])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F/g}},function(t,e,n){!function(){"use strict";t.exports={polyfill:function(){var t=window,e=document;if(!("scrollBehavior"in e.documentElement.style&&!0!==t.__forceSmoothScrollPolyfill__)){var n,i=t.HTMLElement||t.Element,r=468,o={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:i.prototype.scroll||c,scrollIntoView:i.prototype.scrollIntoView},s=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now,a=(n=t.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(n)?1:0);t.scroll=t.scrollTo=function(){void 0!==arguments[0]&&(!0!==l(arguments[0])?g.call(t,e.body,void 0!==arguments[0].left?~~arguments[0].left:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:t.scrollY||t.pageYOffset):o.scroll.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!==typeof arguments[0]?arguments[0]:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:t.scrollY||t.pageYOffset))},t.scrollBy=function(){void 0!==arguments[0]&&(l(arguments[0])?o.scrollBy.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!==typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0):g.call(t,e.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset)))},i.prototype.scroll=i.prototype.scrollTo=function(){if(void 0!==arguments[0])if(!0!==l(arguments[0])){var t=arguments[0].left,e=arguments[0].top;g.call(this,this,"undefined"===typeof t?this.scrollLeft:~~t,"undefined"===typeof e?this.scrollTop:~~e)}else{if("number"===typeof arguments[0]&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");o.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!==typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}},i.prototype.scrollBy=function(){void 0!==arguments[0]&&(!0!==l(arguments[0])?this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}):o.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop))},i.prototype.scrollIntoView=function(){if(!0!==l(arguments[0])){var n=d(this),i=n.getBoundingClientRect(),r=this.getBoundingClientRect();n!==e.body?(g.call(this,n,n.scrollLeft+r.left-i.left,n.scrollTop+r.top-i.top),"fixed"!==t.getComputedStyle(n).position&&t.scrollBy({left:i.left,top:i.top,behavior:"smooth"})):t.scrollBy({left:r.left,top:r.top,behavior:"smooth"})}else o.scrollIntoView.call(this,void 0===arguments[0]||arguments[0])}}function c(t,e){this.scrollLeft=t,this.scrollTop=e}function l(t){if(null===t||"object"!==typeof t||void 0===t.behavior||"auto"===t.behavior||"instant"===t.behavior)return!0;if("object"===typeof t&&"smooth"===t.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+t.behavior+" is not a valid value for enumeration ScrollBehavior.")}function u(t,e){return"Y"===e?t.clientHeight+a<t.scrollHeight:"X"===e?t.clientWidth+a<t.scrollWidth:void 0}function h(e,n){var i=t.getComputedStyle(e,null)["overflow"+n];return"auto"===i||"scroll"===i}function f(t){var e=u(t,"Y")&&h(t,"Y"),n=u(t,"X")&&h(t,"X");return e||n}function d(t){for(;t!==e.body&&!1===f(t);)t=t.parentNode||t.host;return t}function p(e){var n,i,o,a,c=(s()-e.startTime)/r;a=c=c>1?1:c,n=.5*(1-Math.cos(Math.PI*a)),i=e.startX+(e.x-e.startX)*n,o=e.startY+(e.y-e.startY)*n,e.method.call(e.scrollable,i,o),i===e.x&&o===e.y||t.requestAnimationFrame(p.bind(t,e))}function g(n,i,r){var a,l,u,h,f=s();n===e.body?(a=t,l=t.scrollX||t.pageXOffset,u=t.scrollY||t.pageYOffset,h=o.scroll):(a=n,l=n.scrollLeft,u=n.scrollTop,h=c),p({scrollable:a,method:h,startTime:f,startX:l,startY:u,x:i,y:r})}}}}()},function(t,e){try{var n=new window.CustomEvent("test");if(n.preventDefault(),!0!==n.defaultPrevented)throw new Error("Could not prevent default")}catch(r){var i=function(t,e){var n,i;return e=e||{bubbles:!1,cancelable:!1,detail:void 0},(n=document.createEvent("CustomEvent")).initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i=n.preventDefault,n.preventDefault=function(){i.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(r){this.defaultPrevented=!0}},n};i.prototype=window.Event.prototype,window.CustomEvent=i}},function(t,e,n){"use strict";n.r(e);var i=n(72),r=n.n(i)()((function(t){return t[1]}));r.push([t.i,".customily-hover-container {\r\n    position: absolute;\r\n    top: 0;\r\n}\r\n.customily-zoom-btn {\r\n    position: absolute;\r\n    z-index: 1;\r\n    top: 10px;\r\n    left: 10px;\r\n    padding: 2px 8px;\r\n    background: #ccc;\r\n    font-size: 12px;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n}\r\n.customily-zoom-btn:hover {\r\n    background: #eee;\r\n}\r\n.customily-zoom-btn:active {\r\n    background: #aaa;\r\n}\r\n.canvas-container.cl-zoom-active .customily-zoom-btn {\r\n    display: none;\r\n}\r\n.canvas-container.cl-zoom-active {\r\n    cursor: crosshair;\r\n}\r\n.customily-image-zoom__zoomed-area, .customily-image-zoom__zoomed-image {\r\n    box-shadow: 0px 0px 5px 3px rgb(0 0 0 / 30%);\r\n    z-index: 1000001;\r\n}\r\n\r\n/* Touch zoom */\r\n.cl-zoom-img-wrapper {\r\n    position: fixed;\r\n    height: 100vh;\r\n    width: 100vw;\r\n    top: 0;\r\n    left: 0;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    background: #0000006e;\r\n    z-index: 1000001;\r\n}\r\n.cl-zoom-img-wrapper .pinch-zoom-container {\r\n    width: 100%;\r\n}",""]),e.default=r},function(t,e){t.exports="data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='M423.542,163.125l-160-160c-4.167-4.167-10.917-4.167-15.083,0l-160,160c-4.167,4.167-4.167,10.917,0,15.083c4.167,4.167,10.917,4.167,15.083,0L245.333,36.417v464.917c0,5.896,4.771,10.667,10.667,10.667c5.896,0,10.667-4.771,10.667-10.667V36.417l141.792,141.792c2.083,2.083,4.813,3.125,7.542,3.125c2.729,0,5.458-1.042,7.542-3.125C427.708,174.042,427.708,167.292,423.542,163.125z'/%3E %3C/svg%3E"},function(t,e){t.exports="data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='M423.542,333.792c-4.167-4.167-10.917-4.167-15.083,0L266.667,475.583V10.667C266.667,4.771,261.896,0,256,0s-10.667,4.771-10.667,10.667v464.917L103.542,333.792c-4.167-4.167-10.917-4.167-15.083,0c-4.167,4.167-4.167,10.917,0,15.083l160,160c2.083,2.083,4.813,3.125,7.542,3.125s5.458-1.042,7.542-3.125l160-160C427.708,344.708,427.708,337.958,423.542,333.792z'/%3E %3C/svg%3E"},function(t,e){t.exports="data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='M501.333,245.333H36.417l141.792-141.792c4.167-4.167,4.167-10.917,0-15.083c-4.167-4.167-10.917-4.167-15.083,0l-160,160c-4.167,4.167-4.167,10.917,0,15.083l160,160c2.083,2.083,4.813,3.125,7.542,3.125c2.729,0,5.458-1.042,7.542-3.125c4.167-4.167,4.167-10.917,0-15.083L36.417,266.667h464.917c5.896,0,10.667-4.771,10.667-10.667S507.229,245.333,501.333,245.333z'/%3E %3C/svg%3E"},function(t,e){t.exports="data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='M508.875,248.458l-160-160c-4.167-4.167-10.917-4.167-15.083,0c-4.167,4.167-4.167,10.917,0,15.083l141.792,141.792 H10.667C4.771,245.333,0,250.104,0,256s4.771,10.667,10.667,10.667h464.917L333.792,408.458c-4.167,4.167-4.167,10.917,0,15.083c2.083,2.083,4.813,3.125,7.542,3.125c2.729,0,5.458-1.042,7.542-3.125l160-160C513.042,259.375,513.042,252.625,508.875,248.458z'/%3E %3C/svg%3E"},function(t,e){t.exports="data:image/svg+xml,%3Csvg viewBox='-45 -17 533 533.33327' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='m202.1875 22.515625c-42.113281 0-84.203125 11.898437-121.726562 34.414063-20.507813 12.351562-39.230469 27.453124-55.636719 44.894531l1.890625-89.0625c.152344-6.898438-5.320313-12.617188-12.226563-12.761719h-.273437c-6.796875.00390625-12.34375 5.4375-12.488282 12.234375l-2.609374 122.621094c-1.820313 4.628906-.722657 9.894531 2.789062 13.414062 3.511719 3.515625 8.773438 4.621094 13.402344 2.804688l122.652344-2.609375c6.902343-.074219 12.441406-5.726563 12.367187-12.632813-.074219-6.898437-5.726563-12.441406-12.632813-12.367187h-.269531l-100.40625 2.132812c16.183594-18.585937 35.183594-34.527344 56.300781-47.238281 33.636719-20.1875 71.285157-30.851563 108.867188-30.851563 60.097656 0 115.511719 24.800782 156.039062 69.824219 36.132813 40.148438 57.699219 93.945313 57.699219 143.914063 0 49.972656-21.566406 103.769531-57.699219 143.917968-40.527343 45.03125-95.941406 69.832032-156.039062 69.832032-35.234375.242187-69.941406-8.578125-100.78125-25.625-28.304688-15.914063-52.71875-37.925782-71.472656-64.433594-3.945313-5.664062-11.738282-7.058594-17.402344-3.113281-5.664062 3.945312-7.0625 11.738281-3.117188 17.402343.054688.070313.105469.140626.152344.214844 20.929688 29.539063 48.15625 54.066406 79.722656 71.789063 34.542969 19.117187 73.421876 29.019531 112.898438 28.765625 67.28125 0 129.296875-27.734375 174.621094-78.101563 40.152344-44.613281 64.125-104.660156 64.125-160.636719 0-55.980468-23.96875-116.03125-64.125-160.644531-45.324219-50.363281-107.339844-78.097656-174.621094-78.097656zm0 0'/%3E %3C/svg%3E"},function(t,e){t.exports="data:image/svg+xml,%3Csvg viewBox='-17 -17 532 532.00082' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='m391.539062 374.117188c78.863282-88.046876 76.015626-223.878907-8.570312-308.460938-86.515625-86.433594-226.3125-87.6875-314.363281-2.8125-88.054688 84.871094-91.941407 224.621094-8.742188 314.253906 83.199219 89.636719 222.851563 96.15625 314.035157 14.660156l103.378906 103.378907c4.878906 4.835937 12.746094 4.816406 17.601562-.039063 4.855469-4.855468 4.875-12.722656.039063-17.601562zm-308.460937-8.570313c-78.300781-77.578125-78.890625-203.941406-1.316406-282.25 77.578125-78.300781 203.945312-78.890625 282.25-1.316406l1.316406 1.316406c77.816406 77.816406 77.816406 204.429687 0 282.25-77.820313 77.820313-204.4375 77.816406-282.25 0zm0 0'/%3E %3Cpath d='m299.035156 211.921875h-62.386718v-62.332031c0-6.886719-5.582032-12.472656-12.472657-12.472656-6.882812 0-12.472656 5.585937-12.472656 12.472656v62.332031h-62.335937c-6.882813 0-12.472657 5.589844-12.472657 12.472656 0 6.890625 5.589844 12.472657 12.472657 12.472657h62.335937v62.390624c0 6.886719 5.589844 12.472657 12.472656 12.472657 6.890625 0 12.472657-5.585938 12.472657-12.472657v-62.390624h62.386718c6.890625 0 12.472656-5.582032 12.472656-12.472657 0-6.882812-5.582031-12.472656-12.472656-12.472656zm0 0'/%3E %3C/svg%3E"},function(t,e){t.exports="data:image/svg+xml,%3Csvg viewBox='-17 -17 532 532.00082' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='m391.539062 374.117188c78.863282-88.046876 76.015626-223.878907-8.570312-308.460938-86.515625-86.433594-226.3125-87.6875-314.363281-2.8125-88.054688 84.871094-91.941407 224.621094-8.742188 314.253906 83.199219 89.636719 222.851563 96.15625 314.035157 14.660156l103.378906 103.378907c4.878906 4.835937 12.746094 4.816406 17.601562-.039063 4.855469-4.855468 4.875-12.722656.039063-17.601562zm-308.460937-8.570313c-78.300781-77.578125-78.890625-203.941406-1.316406-282.25 77.578125-78.300781 203.945312-78.890625 282.25-1.316406l1.316406 1.316406c77.816406 77.816406 77.816406 204.429687 0 282.25-77.820313 77.820313-204.4375 77.816406-282.25 0zm0 0'/%3E %3Cpath d='m299.035156 211.921875h-149.667968c-6.882813 0-12.472657 5.589844-12.472657 12.472656 0 6.890625 5.589844 12.472657 12.472657 12.472657h149.667968c6.890625 0 12.472656-5.582032 12.472656-12.472657 0-6.882812-5.582031-12.472656-12.472656-12.472656zm0 0'/%3E %3C/svg%3E"},function(t,e){t.exports="data:image/svg+xml,%3C?xml version='1.0' encoding='iso-8859-1'?%3E %3C!-- Generator: Adobe Illustrator 19.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0) --%3E %3Csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 452.025 452.025' style='enable-background:new 0 0 452.025 452.025;' xml:space='preserve'%3E %3Cg%3E %3Cg%3E %3Cpath d='M362.612,34.125h-55.2l13.6-13.6c4.7-4.7,4.7-12.3,0-17s-12.3-4.7-17,0l-34,34.1c-2.3,2.3-3.5,5.3-3.5,8.5 s1.3,6.2,3.5,8.5l34.1,34.1c2.3,2.3,5.4,3.5,8.5,3.5s6.1-1.2,8.5-3.5c4.7-4.7,4.7-12.3,0-17l-13.6-13.6h55.2c35.9,0,65,29.2,65,65 v40.3c0,6.6,5.4,12,12,12s12-5.4,12-12v-40.3C451.712,74.025,411.712,34.125,362.612,34.125z'/%3E %3Cpath d='M438.812,230.925h-197.1c-6.6,0-12,5.4-12,12v197.1c0,6.6,5.4,12,12,12h197.1c6.6,0,12-5.4,12-12v-197.1 C450.812,236.225,445.412,230.925,438.812,230.925z M426.812,428.025h-173.1v-173.1h173.1L426.812,428.025L426.812,428.025z'/%3E %3Cpath d='M147.912,363.325c-4.7-4.7-12.3-4.7-17,0c-4.7,4.7-4.7,12.3,0,17l13.6,13.6h-55.2c-35.9,0-65-29.2-65-65v-40.3 c0-6.6-5.4-12-12-12s-12,5.4-12,12v40.3c0,49.1,39.9,89,89,89h55.2l-13.6,13.6c-4.7,4.7-4.7,12.3,0,17c2.3,2.3,5.4,3.5,8.5,3.5 s6.1-1.2,8.5-3.5l34.1-34.1c4.7-4.7,4.7-12.3,0-17L147.912,363.325z'/%3E %3Cpath d='M13.212,24.025c3.2,0,6.3-1.3,8.5-3.5s3.5-5.3,3.5-8.5c0-3.1-1.3-6.3-3.5-8.5s-5.3-3.5-8.5-3.5s-6.3,1.3-8.5,3.5 s-3.5,5.3-3.5,8.5s1.3,6.3,3.5,8.5C7.012,22.725,10.012,24.025,13.212,24.025z'/%3E %3Cpath d='M111.812,24.025c6.6,0,12-5.4,12-12s-5.4-12-12-12s-12,5.4-12,12S105.112,24.025,111.812,24.025z'/%3E %3Cpath d='M62.512,24.025c6.6,0,12-5.4,12-12s-5.4-12-12-12s-12,5.4-12,12S55.912,24.025,62.512,24.025z'/%3E %3Cpath d='M161.012,24.025c6.6,0,12-5.4,12-12s-5.4-12-12-12s-12,5.4-12,12S154.412,24.025,161.012,24.025z'/%3E %3Cpath d='M210.312,0.025c-3.1,0-6.3,1.3-8.5,3.5s-3.5,5.3-3.5,8.5s1.3,6.3,3.5,8.5s5.3,3.5,8.5,3.5s6.3-1.3,8.5-3.5 s3.5-5.3,3.5-8.5s-1.3-6.3-3.5-8.5S213.512,0.025,210.312,0.025z'/%3E %3Cpath d='M210.312,147.925c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12C222.312,153.225,217.012,147.925,210.312,147.925z'/%3E %3Cpath d='M210.312,98.625c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12C222.312,103.925,217.012,98.625,210.312,98.625z'/%3E %3Cpath d='M210.312,49.325c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12C222.312,54.725,217.012,49.325,210.312,49.325z'/%3E %3Cpath d='M210.312,197.125c-3.2,0-6.3,1.3-8.5,3.5s-3.5,5.3-3.5,8.5c0,3.1,1.3,6.3,3.5,8.5s5.3,3.5,8.5,3.5s6.3-1.3,8.5-3.5 s3.5-5.3,3.5-8.5s-1.3-6.3-3.5-8.5C216.613,198.425,213.512,197.125,210.312,197.125z'/%3E %3Cpath d='M161.012,221.125c6.6,0,12-5.4,12-12s-5.4-12-12-12s-12,5.4-12,12C149.012,215.825,154.412,221.125,161.012,221.125z'/%3E %3Cpath d='M111.812,221.125c6.6,0,12-5.4,12-12s-5.4-12-12-12s-12,5.4-12,12C99.812,215.825,105.112,221.125,111.812,221.125z'/%3E %3Cpath d='M62.512,221.125c6.6,0,12-5.4,12-12s-5.4-12-12-12s-12,5.4-12,12C50.512,215.825,55.912,221.125,62.512,221.125z'/%3E %3Cpath d='M13.212,221.125c3.2,0,6.3-1.3,8.5-3.5s3.5-5.3,3.5-8.5s-1.3-6.3-3.5-8.5s-5.3-3.5-8.5-3.5s-6.3,1.3-8.5,3.5 s-3.5,5.3-3.5,8.5c0,3.1,1.3,6.3,3.5,8.5C7.012,219.825,10.012,221.125,13.212,221.125z'/%3E %3Cpath d='M13.212,171.925c6.6,0,12-5.4,12-12s-5.4-12-12-12s-12,5.4-12,12S6.612,171.925,13.212,171.925z'/%3E %3Cpath d='M13.212,122.625c6.6,0,12-5.4,12-12s-5.4-12-12-12s-12,5.4-12,12C1.212,117.225,6.612,122.625,13.212,122.625z'/%3E %3Cpath d='M13.212,73.325c6.6,0,12-5.4,12-12s-5.4-12-12-12s-12,5.4-12,12S6.612,73.325,13.212,73.325z'/%3E %3C/g%3E %3C/g%3E %3C/svg%3E"},function(t,e,n){var i,r,o;this||window,r=[],void 0===(o="function"===typeof(i=function(){var t=/^(interactive|loaded|complete)$/,e=window.location?window.location.href:null,n=e&&e.replace(/#.*$/,"").replace(/\?.*$/,"")||null,i=document.getElementsByTagName("script"),r="readyState"in(i[0]||document.createElement("script")),o=!window.opera||"[object Opera]"!==window.opera.toString(),s="currentScript"in document;"stackTraceLimit"in Error&&Error.stackTraceLimit!==1/0&&(Error.stackTraceLimit,Error.stackTraceLimit=1/0);var a=!1,c=!1;function l(){if(0===i.length)return null;var e,u,h,f,d,p=[],g=l.skipStackDepth||1;for(e=0;e<i.length;e++)o&&r?t.test(i[e].readyState)&&p.push(i[e]):p.push(i[e]);if(u=new Error,a&&(h=u.stack),!h&&c)try{throw u}catch(m){h=m.stack}if(h&&!(d=function(t,e){var n,r=null;if(e=e||i,"string"===typeof t&&t)for(n=e.length;n--;)if(e[n].src===t){r=e[n];break}return r}(f=function t(e,n){var i,r=null,o="number"===typeof n;return n=o?Math.round(n):0,"string"===typeof e&&e&&(o?i=e.match(/(data:text\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/):(i=e.match(/^(?:|[^:@]*@|.+\)@(?=data:text\/javascript|blob|http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)(data:text\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&i[1]||(i=e.match(/\)@(data:text\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/)),i&&i[1]&&(r=n>0?t(e.slice(e.indexOf(i[0])+i[0].length),n-1):i[1])),r}(h,g),p))&&n&&f===n&&(d=function(t){var e,n,r=null;for(e=0,n=(t=t||i).length;e<n;e++)if(!t[e].hasAttribute("src")){if(r){r=null;break}r=t[e]}return r}(p)),d||1===p.length&&(d=p[0]),d||s&&(d=document.currentScript),!d&&o&&r)for(e=p.length;e--;)if("interactive"===p[e].readyState){d=p[e];break}return d||(d=p[p.length-1]||null),d}(function(){try{var t=new Error;throw a="string"===typeof t.stack&&!!t.stack,t}catch(e){c="string"===typeof e.stack&&!!e.stack}})(),l.skipStackDepth=1;var u=l;return u.near=l,u.far=function(){return null},u.origin=function(){return null},u})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){"use strict";n.r(e);var i=n(27),r=n.n(i),o=n(0),s=n.n(o),a=n(1),c=n.n(a),l=n(3),u=n(8),h=function(t){(t=t.replace("/Content","")).startsWith("Content")&&(t=t.replace("Content",""));var e=u.cdnUrl.replace(/^\/+|\/+$/g,"");return t=t.replace(/^\/+|\/+$/g,""),"".concat(e,"/").concat(t)},f=n(19),d=n.n(f),p=[],g=function(){var t=c()(s.a.mark((function t(e,n){var i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.length>0||n.length>0)){t.next=4;break}return i=(e.length?e:n)[0],t.next=4,v(i,1);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),m=function(){var t=c()(s.a.mark((function t(e){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],console.debug("Loading fonts"),p.push.apply(p,e),e.forEach((function(t){n.push(Font.loadAsync(t.Name.replace(/^.*[\\\/]/,"").split(".")[0],t.Path).then((function(){t.loaded=!0})))})),t.next=6,Promise.all(n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a,c,u,f,d;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.fontLibraryId){t.next=7;break}return t.next=3,l.a(e.fontLibraryId,n);case 3:(o=t.sent)&&(i=o.Path),t.next=10;break;case 7:a=new Map,JSON.parse(e.fontsMap).map((function(t){a.set(t[0],t[1])})),i=a.get(n);case 10:if(!i){t.next=18;break}if(r=i.replace(/^.*[\\\/]/,"").split(".")[0],y(r)){t.next=16;break}return c=h(i),t.next=16,m([{Path:c,Name:r}]);case 16:t.next=35;break;case 18:if(console.warn("No font at position ".concat(n,", will fallback to first available one")),!e.fontLibraryId){t.next=26;break}return t.next=22,l.b(e.fontLibraryId);case 22:(u=t.sent)&&(i=u.Path),t.next=29;break;case 26:f=new Map,JSON.parse(e.fontsMap).map((function(t){f.set(t[0],t[1])})),i=f.entries().next().value[1];case 29:if(!i){t.next=35;break}if(r=i.replace(/^.*[\\\/]/,"").split(".")[0],y(r)){t.next=35;break}return d=h(i),t.next=35,m([{Path:d,Name:r}]);case 35:return t.abrupt("return",r);case 36:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),y=function(t){var e=d.a.find(p,(function(e){return e.Name===t}));return!!e&&e.loaded},b=function(){return p},x={searchParams:"URLSearchParams"in window,iterable:"Symbol"in window&&"iterator"in Symbol,blob:"FileReader"in window&&"Blob"in window&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in window,arrayBuffer:"ArrayBuffer"in window};if(x.arrayBuffer)var C=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],S=ArrayBuffer.isView||function(t){return t&&C.indexOf(Object.prototype.toString.call(t))>-1};function w(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function _(t){return"string"!==typeof t&&(t=String(t)),t}function D(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return x.iterable&&(e[Symbol.iterator]=function(){return e}),e}function T(t){this.map={},t instanceof T?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function E(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function k(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function O(t){var e=new FileReader,n=k(e);return e.readAsArrayBuffer(t),n}function A(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function P(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"===typeof t?this._bodyText=t:x.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:x.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:x.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():x.arrayBuffer&&x.blob&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=A(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):x.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||S(t))?this._bodyArrayBuffer=A(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):x.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},x.blob&&(this.blob=function(){var t=E(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?E(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(O)}),this.text=function(){var t=E(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader,n=k(e);return e.readAsText(t),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),i=0;i<e.length;i++)n[i]=String.fromCharCode(e[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},x.formData&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}T.prototype.append=function(t,e){t=w(t),e=_(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},T.prototype.delete=function(t){delete this.map[w(t)]},T.prototype.get=function(t){return t=w(t),this.has(t)?this.map[t]:null},T.prototype.has=function(t){return this.map.hasOwnProperty(w(t))},T.prototype.set=function(t,e){this.map[w(t)]=_(e)},T.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},T.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),D(t)},T.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),D(t)},T.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),D(t)},x.iterable&&(T.prototype[Symbol.iterator]=T.prototype.entries);var I=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function F(t,e){var n=(e=e||{}).body;if(t instanceof F){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new T(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new T(e.headers)),this.method=function(t){var e=t.toUpperCase();return I.indexOf(e)>-1?e:t}(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function M(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}})),e}function L(t){var e=new T;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n=t.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();e.append(i,r)}})),e}function R(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new T(e.headers),this.url=e.url||"",this._initBody(t)}F.prototype.clone=function(){return new F(this,{body:this._bodyInit})},P.call(F.prototype),P.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new T(this.headers),url:this.url})},R.error=function(){var t=new R(null,{status:0,statusText:""});return t.type="error",t};var j=[301,302,303,307,308];R.redirect=function(t,e){if(-1===j.indexOf(e))throw new RangeError("Invalid status code");return new R(null,{status:e,headers:{location:t}})};var B=window.DOMException;try{new B}catch(Et){(B=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),B.prototype.constructor=B}function U(t,e){return new Promise((function(n,i){var r=new F(t,e);if(r.signal&&r.signal.aborted)return i(new B("Aborted","AbortError"));var o=new XMLHttpRequest;function s(){o.abort()}o.onload=function(){var t={status:o.status,statusText:o.statusText,headers:L(o.getAllResponseHeaders()||"")};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var e="response"in o?o.response:o.responseText;n(new R(e,t))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.onabort=function(){i(new B("Aborted","AbortError"))},o.open(r.method,r.url,!0),"include"===r.credentials?o.withCredentials=!0:"omit"===r.credentials&&(o.withCredentials=!1),o.responseType="blob",r.headers.forEach((function(t,e){o.setRequestHeader(e,t)})),r.signal&&(r.signal.addEventListener("abort",s),o.onreadystatechange=function(){4===o.readyState&&r.signal.removeEventListener("abort",s)}),o.send("undefined"===typeof r._bodyInit?null:r._bodyInit)}))}U.polyfill=!0,self.fetch||(self.fetch=U,self.Headers=T,self.Request=F,self.Response=R);n(60);var z=n(68),N=n.n(z),W=function(){var t=c()(s.a.mark((function t(e){var n,i=arguments;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:6,(e=e||[]).length||e.push((function(){return Promise.resolve()})),t.next=5,N()(n,e,function(){var t=c()(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),H=function(t){return t.match(/[a-z]/i)},X=function(t){return t>="a"&&t<="z"},G=function(t){return t>="0"&&t<="9"},Y=function(t){return X(t)?t.charCodeAt(0)-95:t.charCodeAt(0)-37},q=function(){var t=c()(s.a.mark((function t(e,n,i){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=8;break}return t.next=3,Object(l.c)(n);case 3:if(!((r=t.sent)&&r.indexOf(e)>-1)){t.next=6;break}return t.abrupt("return",!0);case 6:t.next=10;break;case 8:if(!(i&&i.indexOf(e-1)>-1)){t.next=10;break}return t.abrupt("return",!0);case 10:return t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}(),V=function(){var t=c()(s.a.mark((function t(e,n,i){var r,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=1,e=e[0],!H(e)){t.next=10;break}return r=Y(e),t.next=6,q(r,n,i);case 6:if(t.sent){t.next=8;break}r=Y(X(e)?e.toUpperCase():e.toLowerCase());case 8:t.next=25;break;case 10:if(!G(e)){t.next=18;break}return r=e.charCodeAt(0)+6,t.next=14,q(r,n,i);case 14:if(t.sent){t.next=16;break}r=1;case 16:t.next=25;break;case 18:if((o=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_","`","{","|","}","~"]).indexOf(e)>-1&&(r=o.indexOf(e)+64),1===r){t.next=25;break}return t.next=23,q(r,n,i);case 23:if(t.sent){t.next=25;break}r=1;case 25:return t.abrupt("return",r);case 26:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}(),Z=n(7),Q=n(8);function K(t){return new Promise((function(e,n){var i=new Image;i.onload=function(){e(this)},i.onerror=function(){n()},i.crossOrigin="Anonymous",i.src=t}))}var $={resizeImage:function(t,e,n,i){return i="jpg"===(i=i||"png")||"jpeg"===i?"image/jpeg":"image/png",new Promise((function(r,o){var s=document.createElement("canvas");s.width=e,s.height=n,s.getContext("2d").drawImage(t,0,0,s.width,s.height);var a=new Image;a.onload=function(){r(this)},a.crossOrigin=null,a.src=s.toDataURL(i,.9)}))},limitImageResolution:function(t,e,n,i){var r=e,o=n;return i=i||"png",new Promise((function(e,n){i="jpg"===i||"jpeg"===i?"image/jpeg":"image/png";var s=t.width,a=t.height,c=document.createElement("canvas"),l=c.getContext("2d");c.width=s,c.height=a,l.drawImage(t,0,0);var u=1;(a>o||s>r)&&(a/=u=a>s?a/o:s/r,s/=u),c.width=s,c.height=a,c.getContext("2d").drawImage(t,0,0,s,a);var h=c.toDataURL(i,.9);K(h).then((function(t){e({url:h,ratio:u,image:t})})).catch(n)}))},urlToImg:K,imgToBase64:function(t,e){e="jpg"===(e=e||"png")||"jpeg"===e?"image/jpeg":"image/png";var n=document.createElement("canvas"),i=n.getContext("2d");return n.height=t.height,n.width=t.width,i.drawImage(t,0,0),n.toDataURL(e,.9)},getBase64FromServerPath:function(t){var e=Q.baseUrl+"/api",n={imagePath:t};return Z.ajax({type:"GET",url:e+"/Images/Base64?"+Z.param(n),crossDomain:!0})},imageCanvasToBlob:function(t,e,n){return new Promise(function(){var i=c()(s.a.mark((function i(r,o){var a,c;return s.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!(t instanceof Image||t instanceof HTMLImageElement)){i.next=16;break}return i.next=4,U(t.src);case 4:if(!((a=i.sent)._bodyInit instanceof Blob)){i.next=9;break}i.t0=a._bodyInit,i.next=12;break;case 9:return i.next=11,a.blob();case 11:i.t0=i.sent;case 12:c=i.t0,r(c),i.next=17;break;case 16:t.toBlob((function(t){r(t)}),e,n);case 17:i.next=22;break;case 19:i.prev=19,i.t1=i.catch(0),o(i.t1);case 22:case"end":return i.stop()}}),i,null,[[0,19]])})));return function(t,e){return i.apply(this,arguments)}}())},isFabricImageBlank:function(t){var e=t.item(0);return""===e.getSrc()||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="===e.getSrc()||"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="===e.getSrc()||1===e.width||1===e.height},isFabricVectorBlank:function(t){return!t.pdf&&!t.svgString}},J=n(71),tt=n.n(J);"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0}),"function"!=typeof Array.from&&(Array.from=function(t){return[].slice.call(t)});var et=function(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!1),t.dispatchEvent(n)},nt=function(){var t=function(t,e){this.el=t,this.zoomFactor=1,this.lastScale=1,this.offset={x:0,y:0},this.initialOffset={x:0,y:0},this.options=Object.assign({},this.defaults,e),this.setupMarkup(),this.bindEvents(),this.update(),this.isImageLoaded(this.el)&&(this.updateAspectRatio(),this.setupOffsets()),this.enable()},e=function(t,e){return t+e};t.prototype={defaults:{tapZoomFactor:2,zoomOutFactor:1.3,animationDuration:300,maxZoom:4,minZoom:.5,draggableUnzoomed:!0,lockDragAxis:!1,setOffsetsOnce:!1,use2d:!0,zoomStartEventName:"pz_zoomstart",zoomUpdateEventName:"pz_zoomupdate",zoomEndEventName:"pz_zoomend",dragStartEventName:"pz_dragstart",dragUpdateEventName:"pz_dragupdate",dragEndEventName:"pz_dragend",doubleTapEventName:"pz_doubletap",verticalPadding:0,horizontalPadding:0,onZoomStart:null,onZoomEnd:null,onZoomUpdate:null,onDragStart:null,onDragEnd:null,onDragUpdate:null,onDoubleTap:null},handleDragStart:function(t){et(this.el,this.options.dragStartEventName),"function"==typeof this.options.onDragStart&&this.options.onDragStart(this,t),this.stopAnimation(),this.lastDragPosition=!1,this.hasInteraction=!0,this.handleDrag(t)},handleDrag:function(t){var e=this.getTouches(t)[0];this.drag(e,this.lastDragPosition),this.offset=this.sanitizeOffset(this.offset),this.lastDragPosition=e},handleDragEnd:function(){et(this.el,this.options.dragEndEventName),"function"==typeof this.options.onDragEnd&&this.options.onDragEnd(this,event),this.end()},handleZoomStart:function(t){et(this.el,this.options.zoomStartEventName),"function"==typeof this.options.onZoomStart&&this.options.onZoomStart(this,t),this.stopAnimation(),this.lastScale=1,this.nthZoom=0,this.lastZoomCenter=!1,this.hasInteraction=!0},handleZoom:function(t,e){var n=this.getTouchCenter(this.getTouches(t)),i=e/this.lastScale;this.lastScale=e,this.nthZoom+=1,this.nthZoom>3&&(this.scale(i,n),this.drag(n,this.lastZoomCenter)),this.lastZoomCenter=n},handleZoomEnd:function(){et(this.el,this.options.zoomEndEventName),"function"==typeof this.options.onZoomEnd&&this.options.onZoomEnd(this,event),this.end()},handleDoubleTap:function(t){var e=this.getTouches(t)[0],n=this.zoomFactor>1?1:this.options.tapZoomFactor,i=this.zoomFactor,r=function(t){this.scaleTo(i+t*(n-i),e)}.bind(this);this.hasInteraction||(this.isDoubleTap=!0,i>n&&(e=this.getCurrentZoomCenter()),this.animate(this.options.animationDuration,r,this.swing),et(this.el,this.options.doubleTapEventName),"function"==typeof this.options.onDoubleTap&&this.options.onDoubleTap(this,t))},computeInitialOffset:function(){this.initialOffset={x:-Math.abs(this.el.offsetWidth*this.getInitialZoomFactor()-this.container.offsetWidth)/2,y:-Math.abs(this.el.offsetHeight*this.getInitialZoomFactor()-this.container.offsetHeight)/2}},resetOffset:function(){this.offset.x=this.initialOffset.x,this.offset.y=this.initialOffset.y},isImageLoaded:function(t){return"IMG"===t.nodeName?t.complete&&0!==t.naturalHeight:Array.from(t.querySelectorAll("img")).every(this.isImageLoaded)},setupOffsets:function(){this.options.setOffsetsOnce&&this._isOffsetsSet||(this._isOffsetsSet=!0,this.computeInitialOffset(),this.resetOffset())},sanitizeOffset:function(t){var e=this.el.offsetWidth*this.getInitialZoomFactor()*this.zoomFactor,n=this.el.offsetHeight*this.getInitialZoomFactor()*this.zoomFactor,i=e-this.getContainerX()+this.options.horizontalPadding,r=n-this.getContainerY()+this.options.verticalPadding,o=Math.max(i,0),s=Math.max(r,0),a=Math.min(i,0)-this.options.horizontalPadding,c=Math.min(r,0)-this.options.verticalPadding;return{x:Math.min(Math.max(t.x,a),o),y:Math.min(Math.max(t.y,c),s)}},scaleTo:function(t,e){this.scale(t/this.zoomFactor,e)},scale:function(t,e){t=this.scaleZoomFactor(t),this.addOffset({x:(t-1)*(e.x+this.offset.x),y:(t-1)*(e.y+this.offset.y)}),et(this.el,this.options.zoomUpdateEventName),"function"==typeof this.options.onZoomUpdate&&this.options.onZoomUpdate(this,event)},scaleZoomFactor:function(t){var e=this.zoomFactor;return this.zoomFactor*=t,this.zoomFactor=Math.min(this.options.maxZoom,Math.max(this.zoomFactor,this.options.minZoom)),this.zoomFactor/e},canDrag:function(){return this.options.draggableUnzoomed||!((t=this.zoomFactor)>(e=1)-.01&&t<e+.01);var t,e},drag:function(t,e){e&&(this.options.lockDragAxis?Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?this.addOffset({x:-(t.x-e.x),y:0}):this.addOffset({y:-(t.y-e.y),x:0}):this.addOffset({y:-(t.y-e.y),x:-(t.x-e.x)}),et(this.el,this.options.dragUpdateEventName),"function"==typeof this.options.onDragUpdate&&this.options.onDragUpdate(this,event))},getTouchCenter:function(t){return this.getVectorAvg(t)},getVectorAvg:function(t){return{x:t.map((function(t){return t.x})).reduce(e)/t.length,y:t.map((function(t){return t.y})).reduce(e)/t.length}},addOffset:function(t){this.offset={x:this.offset.x+t.x,y:this.offset.y+t.y}},sanitize:function(){this.zoomFactor<this.options.zoomOutFactor?this.zoomOutAnimation():this.isInsaneOffset(this.offset)&&this.sanitizeOffsetAnimation()},isInsaneOffset:function(t){var e=this.sanitizeOffset(t);return e.x!==t.x||e.y!==t.y},sanitizeOffsetAnimation:function(){var t=this.sanitizeOffset(this.offset),e=this.offset.x,n=this.offset.y,i=function(i){this.offset.x=e+i*(t.x-e),this.offset.y=n+i*(t.y-n),this.update()}.bind(this);this.animate(this.options.animationDuration,i,this.swing)},zoomOutAnimation:function(){if(1!==this.zoomFactor){var t=this.zoomFactor,e=this.getCurrentZoomCenter(),n=function(n){this.scaleTo(t+n*(1-t),e)}.bind(this);this.animate(this.options.animationDuration,n,this.swing)}},updateAspectRatio:function(){this.unsetContainerY(),this.setContainerY(this.container.parentElement.offsetHeight)},getInitialZoomFactor:function(){var t=this.container.offsetWidth/this.el.offsetWidth,e=this.container.offsetHeight/this.el.offsetHeight;return Math.min(t,e)},getAspectRatio:function(){return this.el.offsetWidth/this.el.offsetHeight},getCurrentZoomCenter:function(){var t=this.offset.x-this.initialOffset.x,e=-1*this.offset.x-t/(1/this.zoomFactor-1),n=this.offset.y-this.initialOffset.y;return{x:e,y:-1*this.offset.y-n/(1/this.zoomFactor-1)}},getTouches:function(t){var e=this.container.getBoundingClientRect(),n=document.documentElement.scrollTop||document.body.scrollTop,i=document.documentElement.scrollLeft||document.body.scrollLeft,r=e.top+n,o=e.left+i;return Array.prototype.slice.call(t.touches).map((function(t){return{x:t.pageX-o,y:t.pageY-r}}))},animate:function(t,e,n,i){var r=(new Date).getTime(),o=function(){if(this.inAnimation){var s=(new Date).getTime()-r,a=s/t;s>=t?(e(1),i&&i(),this.update(),this.stopAnimation(),this.update()):(n&&(a=n(a)),e(a),this.update(),requestAnimationFrame(o))}}.bind(this);this.inAnimation=!0,requestAnimationFrame(o)},stopAnimation:function(){this.inAnimation=!1},swing:function(t){return-Math.cos(t*Math.PI)/2+.5},getContainerX:function(){return this.container.offsetWidth},getContainerY:function(){return this.container.offsetHeight},setContainerY:function(t){return this.container.style.height=t+"px"},unsetContainerY:function(){this.container.style.height=null},setupMarkup:function(){this.container=function(t){var e=document.implementation.createHTMLDocument("");return e.body.innerHTML=t,Array.from(e.body.children)[0]}('<div class="pinch-zoom-container"></div>'),this.el.parentNode.insertBefore(this.container,this.el),this.container.appendChild(this.el),this.container.style.overflow="hidden",this.container.style.position="relative",this.el.style.webkitTransformOrigin="0% 0%",this.el.style.mozTransformOrigin="0% 0%",this.el.style.msTransformOrigin="0% 0%",this.el.style.oTransformOrigin="0% 0%",this.el.style.transformOrigin="0% 0%",this.el.style.position="absolute"},end:function(){this.hasInteraction=!1,this.sanitize(),this.update()},bindEvents:function(){var t=this;n(this.container,this),window.addEventListener("resize",this.update.bind(this)),Array.from(this.el.querySelectorAll("img")).forEach((function(e){e.addEventListener("load",t.update.bind(t))})),"IMG"===this.el.nodeName&&this.el.addEventListener("load",this.update.bind(this))},update:function(t){this.updatePlaned||(this.updatePlaned=!0,window.setTimeout(function(){this.updatePlaned=!1,t&&"resize"===t.type&&(this.updateAspectRatio(),this.setupOffsets()),t&&"load"===t.type&&(this.updateAspectRatio(),this.setupOffsets());var e=this.getInitialZoomFactor()*this.zoomFactor,n=-this.offset.x/e,i=-this.offset.y/e,r="scale3d("+e+", "+e+",1) translate3d("+n+"px,"+i+"px,0px)",o="scale("+e+", "+e+") translate("+n+"px,"+i+"px)",s=function(){this.clone&&(this.clone.parentNode.removeChild(this.clone),delete this.clone)}.bind(this);!this.options.use2d||this.hasInteraction||this.inAnimation?(this.is3d=!0,s(),this.el.style.webkitTransform=r,this.el.style.mozTransform=o,this.el.style.msTransform=o,this.el.style.oTransform=o,this.el.style.transform=r):(this.is3d&&(this.clone=this.el.cloneNode(!0),this.clone.style.pointerEvents="none",this.container.appendChild(this.clone),window.setTimeout(s,200)),this.el.style.webkitTransform=o,this.el.style.mozTransform=o,this.el.style.msTransform=o,this.el.style.oTransform=o,this.el.style.transform=o,this.is3d=!1)}.bind(this),0))},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1}};var n=function(t,e){var n=null,i=0,r=null,o=null,s=function(t,i){if(n!==t){if(n&&!t)switch(n){case"zoom":e.handleZoomEnd(i);break;case"drag":e.handleDragEnd(i)}switch(t){case"zoom":e.handleZoomStart(i);break;case"drag":e.handleDragStart(i)}}n=t},a=function(t){2===i?s("zoom"):1===i&&e.canDrag()?s("drag",t):s(null,t)},c=function(t){return Array.from(t).map((function(t){return{x:t.pageX,y:t.pageY}}))},l=function(t,e){var n,i;return n=t.x-e.x,i=t.y-e.y,Math.sqrt(n*n+i*i)},u=function(t){t.stopPropagation(),t.preventDefault()},h=!0;t.addEventListener("touchstart",(function(t){e.enabled&&(h=!0,i=t.touches.length,function(t){var o=(new Date).getTime();if(i>1&&(r=null),o-r<300)switch(u(t),e.handleDoubleTap(t),n){case"zoom":e.handleZoomEnd(t);break;case"drag":e.handleDragEnd(t)}else e.isDoubleTap=!1;1===i&&(r=o)}(t))})),t.addEventListener("touchmove",(function(t){if(e.enabled&&!e.isDoubleTap){if(h)a(t),n&&u(t),o=c(t.touches);else{switch(n){case"zoom":2==o.length&&2==t.touches.length&&e.handleZoom(t,function(t,e){var n=l(t[0],t[1]);return l(e[0],e[1])/n}(o,c(t.touches)));break;case"drag":e.handleDrag(t)}n&&(u(t),e.update())}h=!1}})),t.addEventListener("touchend",(function(t){e.enabled&&(i=t.touches.length,a(t))}))};return t}(),it=n(59),rt=n(116),ot=n(117),st=n(118),at=n(119),ct=n(28),lt=n(120);n(125),n(65),n(132),n(135),n(136),n(137);var ut=n(7);n(138),n(139);var ht=n(146),ft=n(8),dt=n(19),pt=n(147),gt=n(148),mt=n(150),vt=n(60),yt=n(153);n(155).polyfill(),n(156),vt.fetchBlob=function(t,e,n){function i(t){return t.blob()}if(window.Promise&&"function"!==typeof e)return U(t,e).then(i);U(t,n).then(i).then(e).catch((function(t){e(null,t)}))};var bt=window.devicePixelRatio||1,xt=300*bt,Ct=null,St="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";function wt(){this.canvas,this.canvasWrapper,this.currentProduct,this.textObjects=[],this.circularTextObjects=[],this.imageHolderObjects=[],this.vectorEPSObjects=[],this.version=ft.clientVersion,this.isMobile=null,this.isIE=!1,this.preventMobile=!1,this.initReady=!1,this.loadingProduct=!1,this.productLoadCancelRequested=!1,this.measureParentWidth=!1,this.mobileControls={},this.zoomActionObj={},this.currentSessionId=null,this.pendingProcessingPromises=[],this.imageZoom=null,this.pinchZoom=null,this.hoverZoomElements={},this.productLoadedEvent=new CustomEvent("productLoaded",{detail:{engraver:this}}),this.resizeEvent=new CustomEvent("resize",{detail:{engraver:this}}),this.MOBILE_CONTROL_TRANSLATE_AMOUNT=5,this.PLACEHOLDERS_SCALE_AMOUNT=.02,this.MAX_CANVAS_SIZE=1200,this.timeOutSelection=null,this.init=this._init.bind(this),this.destroy=this._destroy.bind(this),this.setProduct=this._setProduct.bind(this),this.getTextQuantity=this._getTextQuantity.bind(this),this.getAvailableTextIds=this._getAvailableTextIds.bind(this),this.getImagesQuantity=this._getImagesQuantity.bind(this),this.getAvailableImageIds=this._getAvailableImageIds.bind(this),this.setText=this._setText.bind(this),this.mapTextToImages=this._mapTextToImages.bind(this),this.mapTextToVectors=this._mapTextToVectors.bind(this),this.setFont=this._setFont.bind(this),this.setFontColor=this._setFontColor.bind(this),this.setImage=this._setImage.bind(this),this.setPresetImage=this._setPresetImage.bind(this),this.setImageColor=this._setImageColor.bind(this),this.setPresetVector=this._setPresetVector.bind(this),this.setVector=this._setVector.bind(this),this.setPresetVectorColor=this._setPresetVectorColor.bind(this),this.getImageParameters=this._getImageParameters.bind(this),this.setImageScale=this._setImageScale.bind(this),this.setImageRotation=this._setImageRotation.bind(this),this.setImageOffset=this._setImageOffset.bind(this),this.setImageThreshold=this._setImageThreshold.bind(this),this.setImagePotraceEnabled=this._setImagePotraceEnabled.bind(this),this.setImageZoomStep=this._setImageZoomStep.bind(this),this.setImagePlaceHolderScale=this._setImagePlaceHolderScale.bind(this),this.setImagePlaceHolderRotation=this._setImagePlaceHolderRotation.bind(this),this.rotateActiveImagePlaceholder=this._rotateActiveImagePlaceholder.bind(this),this.moveImagePlaceholder=this._moveImagePlaceholder.bind(this),this.selectNextImagePlaceholder=this._selectNextImagePlaceholder.bind(this),this.getActionableElements=this._getActionableElements.bind(this),this.anyFilledPlaceholder=this._anyFilledPlaceholder.bind(this),this.initializeVectorPlaceholder=this._initializeVectorPlaceholder.bind(this),this.loadSVGFromServer=this._loadSVGFromServer.bind(this),this.exportFile=this._exportFile.bind(this),this.exportFileDelayed=this._exportFileDelayed.bind(this),this.exportFileAuth=this._exportFileAuth.bind(this),this.generateEPS=this._generateEPS.bind(this),this.generatePDF=this._generatePDF.bind(this),this.waitFilesUpload=this._waitFilesUpload.bind(this),this.renameExportedFile=this._renameExportedFile.bind(this),this.generateProductionFile=this._generateProductionFile.bind(this),this.clearSelection=this._clearSelection.bind(this),this.getProductImage=this._getProductImage.bind(this),this.getSessionId=this._getSessionId.bind(this),this._updateZoomerImage=this.__updateZoomerImage.bind(this),this._setParentSize=this.__setParentSize.bind(this),this._clearSelectionOnBlur=this.__clearSelectionOnBlur.bind(this),this._getElementsUrls=this.__getElementsUrls.bind(this),this.showMobileControls=this._showMobileControls.bind(this),this.hideMobileControls=this._hideMobileControls.bind(this),this.refreshControlsVisibility=this._refreshControlsVisibility.bind(this),this.setWidth=this._setWidth.bind(this),this.onresize=this._onresize.bind(this),this.shareCustomization=this._shareCustomization.bind(this),this.loadCustomization=this._loadCustomization.bind(this),this.getSharedCustomization=this._getSharedCustomization.bind(this),this.processTimeoutPlaceholder=this._proccesTimeoutPlaceholder.bind(this)}wt.prototype._init=function(t,e){var i=this;if(i.options=e||{},i.options.hoverZoom=i.options.hoverZoom||!1,i.options.sideZoom=i.options.sideZoom||!1,i.options.touchZoom=i.options.touchZoom||!1,i.options.hoverZoomLevel=i.options.hoverZoomLevel||1.5,i.options.hoverZoomSide=i.options.hoverZoomSide||"right",i.options.hoverZoomQuality=i.options.hoverZoomQuality||1,i.options.imagesCover=i.options.imagesCover||!1,i.options.skipOffscreenAlltogether=i.options.skipOffscreenAlltogether||!1,i.options.resolutionMultiplier=i.options.resolutionMultiplier||1,i.options.keepControlsSize=i.options.keepControlsSize||!1,i.options.allowMobileTouchEvents=i.options.allowMobileTouchEvents||!1,i.measureParentWidth="undefined"===typeof i.options.measureParentWidth?i.measureParentWidth:i.options.measureParentWidth,i.isMobile=/iPhone|iPod|Android/i.test(navigator.userAgent),i.preventMobile=i.options.preventMobileDetection||!1,i.isIE=!!window.MSInputMethodContext&&!!document.documentMode,this.isMobile&&!this.preventMobile&&(this.options.hoverZoom=!1,this.options.sideZoom=!1),this.isMobile||(this.options.touchZoom=!1),this.options.sideZoom&&(this.options.hoverZoom=!1),i.mouseDownOnPlaceholder=!1,console.log("%cPersonalization powered by Customily https://customily.com","font-size: 14px; color: white; background: #7258e0; padding: 2px; border-radius:2px;"),console.log("Mobile: "+!!i.isMobile),"string"==typeof t&&ut("#"+t).length>0||t.constructor==HTMLCanvasElement){i.canvas=new fabric.CanvasEx(t,{backgroundColor:"rgb(255,255,255)",uniScaleKey:null,allowMobileTouchEvents:this.isMobile&&this.options.allowMobileTouchEvents}),i.canvasWrapper=i.canvas.wrapperEl,i.canvasWrapper.style.maxWidth="100%",i.canvas.on({"object:placeholder:maskModified":function(t){var e=i.canvas.getObjects().filter((function(e){return e.id==t.object.id&&("image-placeholder"===e.type&&!e.dynamicImagesPath||"vector-placeholder"===e.type&&e.allowUserUpload)})),n=!0,r=!1,o=void 0;try{for(var s,a=e.filter((function(e){return e.type===t.object.type}))[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var c=s.value;"image-placeholder"===c.type?(i.processTimeoutPlaceholder(),c.setEditModeImageOffset(t.parameters.offsetX,t.parameters.offsetY),c.setEditModeImageScale(t.parameters.scaleX),c.setEditModeImageRotation(t.parameters.angle)):"vector-placeholder"===c.type&&(i.processTimeoutPlaceholder(),c.setVectorOffset(t.parameters.offsetX,t.parameters.offsetY),c.setVectorScale(t.parameters.scaleX,t.parameters.scaleY),c.setVectorAngle(t.parameters.angle))}}catch(Et){r=!0,o=Et}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}i.canvas.requestRenderAll()},"object:placeholder:maskSelected":function(){i.processTimeoutPlaceholder()},"object:placeholder:mousedown":function(){i.mouseDownOnPlaceholder=!0},"object:placeholder:mouseup":function(){i.mouseDownOnPlaceholder=!1}}),i.options.loadingOverlayOptions=i.options.loadingOverlayOptions||{color:"#fff",zIndex:10,container:i.canvasWrapper,force:!0},i.canvas.skipOffscreen=!1,i.canvas.preserveObjectStacking=!0,i.canvas.selection=!1,new gt.ResizeSensor(i.canvasWrapper.parentNode,(function(){i.canvasWrapper.parentNode.dispatchEvent(i.resizeEvent)}));var r=0,o=function(){(i.canvasWrapper.parentNode.clientWidth>r+10||i.canvasWrapper.parentNode.clientWidth<r-10)&&(r=i.setWidth(i.canvasWrapper.parentNode.clientWidth))}.bind(this),s=dt.debounce(o,300);if(i.canvasWrapper.parentNode.addEventListener("resize",s),ut(i.canvasWrapper).addClass("op-zero"),i.canvasWrapper.addEventListener("productLoaded",(function(){ut(i.canvasWrapper).is(":visible")&&i.initReady?(i.canvasWrapper.parentNode.dispatchEvent(i.resizeEvent),r=i.setWidth(i.canvasWrapper.parentNode.clientWidth,!0)):setTimeout((function(){i.canvasWrapper.dispatchEvent(i.productLoadedEvent)}),300)})),!i.options.allowMobileTouchEvents&&i.isMobile){var a=0,c=0;ut(".upper-canvas").on({mousedown:function(t){},touchmove:function(t){var e=c-t.touches[0].pageY,n=a-t.touches[0].pageX;scrollBy(n,e),a=t.touches[0].pageX+n,c=t.touches[0].pageY+e,t.preventDefault()},touchend:function(){},touchstart:function(t){a=t.touches[0].pageX,c=t.touches[0].pageY,t.preventDefault()}})}ut(document).ready((function(){i._setParentSize()})),ut(window).resize((function(){i._setParentSize()})),document.onload=function(){gt.ElementQueries.listen(),gt.ElementQueries.init()};var l=i.options.hoverZoom&&!i.options.sideZoom?".upper-canvas{ cursor: crosshair!important; }":"";this.initZoomAction();ut("<style>".concat(l," .canvas-container, .canvas-container *").concat(":not(.customily-hover-container):not(.customily-zoom-base-image):not(.customily-image-zoom__zoomed-area):not(.customily-zoom-base-image):not(.customily-mobile-controls):not(.cl-mobile-control-wrapper):not(.customily-mobile-controls-item):not(.cl-mobile-control-img)",' { max-width: 100%; height: auto!important;} .lower-canvas{ position: static!important; } .op-zero{opacity: 0} .canvas-container{overflow: hidden;} .canvas-container, .customily-mobile-controls { transition: .5s opacity ease-out; } .customily-mobile-controls { -moz-user-select: -moz-none; -khtml-user-select: none; -ms-user-select: none; user-select: none; -webkit-user-select: none; pointer-events: all; position: relative; max-height: 100%; z-index: 45; justify-content: center; display: flex; flex-wrap: nowrap; direction: rtl; } .customily-mobile-controls>div:hover{ background: #eee; } .customily-mobile-controls>div:active{ background: #aaa; } .customily-mobile-controls>div{ width: 12%; max-width: 40px; margin: 1%; text-align: center; overflow: hidden; background: #ccc; opacity: .7; position: relative; display: flex; justify-content: center; align-items: center; cursor: pointer; } .customily-mobile-controls>div:after { content: ""; display: block; padding-bottom: 100%; } .customily-mobile-controls-item { height:70% !important; width:70%; text-align: center; } #fabric-container { height: auto !important; }</style>')).appendTo("body");var u=n(157).default;return ut("<style>".concat(u.toString(),"</style>")).appendTo("body"),0}return console.error("Couldn't find canvas tag with id "+t),-1},wt.prototype._showMobileControls=function(){this.mobileControls&&this.mobileControls.$container&&(this.options.keepControlsSize?ut(this.mobileControls.$container).css("visibility",""):ut(this.mobileControls.$container).css("display",""))},wt.prototype._hideMobileControls=function(){this.mobileControls&&this.mobileControls.$container&&(this.options.keepControlsSize?ut(this.mobileControls.$container).css("visibility","hidden"):ut(this.mobileControls.$container).css("display","none"))},wt.prototype._onresize=function(t){if(t.constructor!==Function)return console.warn("engraver.onresize: argument is not a method");this.canvasWrapper.parentNode.addEventListener("resize",t)},wt.prototype._destroy=function(){if(this.canvas){for(var t=this.canvas.getObjects(),e=0;e<t.length;++e)this.canvas.remove(t[e]);this.canvas.clear(),this.canvas.dispose()}},wt.prototype.__clearSelectionOnBlur=function(){var t,e=this,n=ut("#"+e.canvas.lowerCanvasEl.id).parent();n.attr("tabindex",-1),n.on("blur",(function(){t=e.canvas._activeObject,e.canvas._activeObject=null,e.canvas.renderAll()})),n.on("focus",(function(){e.canvas._activeObject=t||null,e.canvas.renderAll()}))},wt.prototype.__getElementsUrls=function(t,e){var n=this;return"image"===t?dt.where(this.canvas.getObjects(),{type:"image-placeholder",id:e}).filter((function(t){return t.imageName})).map((function(t){return h("js-lib-temp-images/".concat(n.getSessionId(),"/").concat(t.noBgFileName||t.imageName))})):"vector"===t?dt.where(this.canvas.getObjects(),{type:"vector-placeholder",id:e}).filter((function(t){return t.vectorName})).map((function(t){return h("js-lib-temp-images/".concat(n.getSessionId(),"/").concat(t.vectorName))})):void 0},wt.prototype.__setParentSize=function(){var t=this;setTimeout((function(){if(t.canvas){var e=ut("#"+t.canvas.lowerCanvasEl.id).outerHeight(!0),n=ut("#"+t.canvas.lowerCanvasEl.id).parent();if(n.css("height",e+"px"),t.measureParentWidth){var i=ut("#"+t.canvas.lowerCanvasEl.id).outerWidth(!0);n.css("width",i+"px")}}}),0)},wt.prototype._setWidth=function(t,e){var i=this;if(i.currentProduct){var r=i.currentProduct.preview.width/i.currentProduct.preview.height;t=i.options.hoverZoom?t*i.options.hoverZoomLevel*i.options.hoverZoomQuality:t;var o=(t*=i.options.resolutionMultiplier)/r;t>this.MAX_CANVAS_SIZE&&(o=(t=this.MAX_CANVAS_SIZE)/r),o>this.MAX_CANVAS_SIZE&&(t=(o=this.MAX_CANVAS_SIZE)*r),fabric.devicePixelRatio>2&&(fabric.devicePixelRatio=2),i.canvas.setWidth(t),i.canvas.setHeight(o);var s=t/i.currentProduct.preview.width;return i.canvas.setViewportTransform([s,0,0,s,0,0]),this.refreshZoomBtnVisibility(),i.canvas._objects.filter((function(t){return"image-placeholder"==t.type})).forEach((function(t){t.customizeCornerIcons({settings:{borderColor:"black",cornerSize:.025*i.canvas.width,cornerShape:"circle",cornerBackgroundColor:"black",cornerPadding:10},mtr:{icon:n(64),settings:{cornerBackgroundColor:"transparent",cornerSize:.025*i.canvas.width}}}),t._maskBoundsRectangle.set("cornerSize",t.cornerSize)})),i.canvas.renderAll(),e&&setTimeout((function(){ut(i.canvasWrapper).LoadingOverlay("hide",i.options.loadingOverlayOptions),ut(i.canvasWrapper).removeClass("op-zero"),i.mobileControls.$container&&i.mobileControls.$container.removeClass("op-zero")}),300),i.canvasWrapper.parentNode.clientWidth}},wt.prototype._initializeVectorPlaceholder=function(t){var e=new fabric.VectorPlaceholder({strokeWidth:0,id:t.id,uuid:t.uuid,isMobile:this.isMobile,width:t.width,height:t.height,originX:"center",originY:"center",left:t.centerX,top:t.centerY,outsideCanvas:t.outsideCanvas,allowUserUpload:t.allowUserUpload,selectable:!1,evented:!1,vectors:t.vectors,colors:t.colors||[],lastColorPosition:1,vectorLibraryId:t.vectorLibraryId,colorLibraryId:t.colorLibraryId,applyColoring:t.applyColoring,skewX:t.skewX,skewY:t.skewY,coverMaskArea:t.coverMaskArea,rotationStep:t.rotationStep,visible:"undefined"===typeof t.visible||t.visible,hasControls:!this.options.hoverZoom});return e.set("name","svg-group"),e.set("zIndex",t.zIndex),e.set("centeredRotation",!0),e.set("centeredScaling",!0),e.set("cornerSize",.015*this.canvas.width),e.set("transparentCorners",!1),e.set("angle",t.rotation),this.vectorEPSObjects.push(e),e},wt.prototype._setProduct=function(t){var e=this;return new Promise(function(){var i=c()(s.a.mark((function i(r,o){var a,u,f;return s.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!e.loadingProduct){i.next=4;break}return e.productLoadCancelRequested=!0,i.next=4,ct.waitConditionAsync((function(){return!e.loadingProduct}),200);case 4:for(e.loadingProduct=!0,e.productLoadCancelRequested=!1,console.debug("Loading product '".concat(t,"'")),e.initReady=!1,a=0,ut(e.canvasWrapper).LoadingOverlay("show",e.options.loadingOverlayOptions),rt.cancelAllPendingUploads(),e.currentSessionId=mt(),e.pendingProcessingPromises=[],u=0;u<e.imageHolderObjects.length;++u)e.imageHolderObjects[u].imageName=null,e.imageHolderObjects[u].imageTimestamp=null;Ct||(Ct=CanvasRenderingContext2D.prototype.drawImage),CanvasRenderingContext2D.prototype.drawImage=function(n){return function(){var i=arguments[0];i===e.canvas.lowerCanvasEl&&e.pendingProcessingPromises.push(new Promise((function(e){st.productPreviewExported(t).then((function(){e()})).catch((function(){e()}))}))),n.apply(this,arguments)}}(Ct),f=function(){return!!e.productLoadCancelRequested&&(e.productLoadCancelRequested=!1,e.loadingProduct=!1,console.debug("Product '".concat(t,"' load cancelled")),r(),!0)},ot.getProduct(t).then(function(){var i=c()(s.a.mark((function i(u){var d,p,m,y,x,C,S,w,_,D,T,E;return s.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!f()){i.next=2;break}return i.abrupt("return");case 2:if(!u){i.next=35;break}return T=function(){return(T=c()(s.a.mark((function n(){var i,u,d,p,g,m,y,x,C,S,w,D,T,E,k,O,A,P,I,F,M,L,R,j,B;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,C=function(t){if(t&&t.length){t.filter((function(t){return t.vectors||t.allowUserUpload})).forEach((function(t){i.push(c()(s.a.mark((function n(){var i;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.initializeVectorPlaceholder(t),n.abrupt("return",i);case 2:case"end":return n.stop()}}),n)}))))}));var n=!0,r=!1,o=void 0;try{for(var a,l=function(){var t=a.value;t.allowUserUpload||i.push(c()(s.a.mark((function n(){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.setPresetVector(t.id,1);case 2:if(!t.applyColoring){n.next=5;break}return n.next=5,e.setPresetVectorColor(t.id,1);case 5:case"end":return n.stop()}}),n)}))))},u=t[Symbol.iterator]();!(n=(a=u.next()).done);n=!0)l()}catch(Et){r=!0,o=Et}finally{try{n||null==u.return||u.return()}finally{if(r)throw o}}}},x=function(t){function n(t){return new Promise(function(){var n=c()(s.a.mark((function n(i,r){var o,a,c,u,f,d;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(d=function(n){function o(){var o=new fabric.ImagePlaceholder(n,{isMobile:e.isMobile,angle:t.rotation,originX:"center",originY:"center",left:t.centerX,top:t.centerY,centeredScaling:!0,centeredRotation:!0,skewX:t.skewX||0,skewY:t.skewY||0,strokeWidth:0,width:t.width,height:t.height,lockMovementX:!0,lockMovementY:!0,lockMouseMovement:e.isMobile&&!e.options.allowMobileTouchEvents,selectable:!1,evented:!1,id:t.id,uuid:t.uuid,fixedWidth:t.width,fixedHeight:t.height,fullColor:t.fullColor,grading:t.grading,zIndex:"undefined"===typeof t.zIndex?0:t.zIndex,hasStaticImage:t.hasStaticImage,imageUrl:t.imageUrl,maskPath:t.maskPath,dynamicImagesPath:t.dynamicImagesPath,imageLibraryId:t.imageLibraryId,outsideCanvas:t.outsideCanvas,colorLibraryId:t.colorLibraryId,colors:t.colors||[],color:t.color,lastColorPosition:1,coverMaskArea:!t.dynamicImagesPath&&(e.options.imagesCover||t.coverMaskArea),rotationStep:t.rotationStep,removeWhiteBackground:t.removeWhiteBackground,removeBackground:t.RemoveBackground,visible:"undefined"===typeof t.visible||t.visible,hasControls:!e.options.hoverZoom});if(t.dynamicImagesPath&&(o.selectedImageIndex=1),o.setOpacity(t.opacity),o.setControlsVisibility({tl:!e.isMobile,tr:!e.isMobile,br:!e.isMobile,bl:!e.isMobile,ml:!1,mb:!1,mr:!1,mt:!1,mtr:!1}),o.fullColor||o.grading?!o.fullColor&&o.grading?o.setMode(fabric.IMAGE_MODE_GRADING):o.setMode(fabric.IMAGE_MODE_FULL_COLOR):o.setMode(fabric.IMAGE_MODE_SINGLE_COLOR),o.maskPath){var s=new Image;s.onload=function(){o.setMask(this),a()},s.crossOrigin="Anonymous",s.src=h(o.maskPath)}else a();function a(){e.imageHolderObjects.push(o),o.dynamicImagesPath?i(o):pt.getImageColor(o,1).then((function(t){o.set("imageColor",t),i(o)})).catch(r)}}n?o():((n=new Image).onload=function(){o()},n.src=St)},n.prev=1,!t.hasStaticImage||!t.imageUrl){n.next=8;break}(o=new Image).onload=function(){d(this)},o.src=t.imageUrl,n.next=29;break;case 8:if(!t.dynamicImagesPath&&!t.imageLibraryId){n.next=28;break}if(o=new Image,(a=dt.find(e.currentProduct.eps.vectorEPSEps,(function(e){return e.uuid&&t.uuid?e.uuid==t.uuid:e.id==t.id})))&&e.vectorEPSObjects.push({isHybrid:!0,uuid:a.uuid,id:a.id,selectedVectorIndex:a.vectorLibraryId?1:0,hasLibrary:!!a.vectorLibraryId}),o.onload=function(){d(this)},c=t.dynamicImagesPath.length,u=new Map,c&&(JSON.parse(t.dynamicImagesPath).map((function(t){u.set(t[0],t[1])})),t.dynamicImagesPath=u),o.crossOrigin="anonymous",!t.imageLibraryId){n.next=25;break}if(!t.imageLibraryId){n.next=23;break}return n.next=21,l.a(t.imageLibraryId,1);case 21:(f=n.sent)?o.src=h(f.Path):d(null);case 23:n.next=26;break;case 25:u&&u.get(1)?o.src=h(u.get(1)):(console.warn("Spotted a dynamic image placeholder without an image"),d(null));case 26:n.next=29;break;case 28:d(null);case 29:n.next=35;break;case 31:n.prev=31,n.t0=n.catch(1),console.error(n.t0),r(n.t0);case 35:case"end":return n.stop()}}),n,null,[[1,31]])})));return function(t,e){return n.apply(this,arguments)}}())}if(t&&t.length)for(var r=function(e){var r=t[e];i.push(c()(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))))},o=0;o<t.length;++o)r(o)},i=[],u=e.currentProduct.preview.textsPreview,e.options.skipOffscreenAlltogether&&(u=u.filter((function(t){var n=t.centerX-t.width/2,i=t.centerX+t.width/2,r=t.centerY-t.height/2,o=t.centerY+t.height/2,s=n<e.currentProduct.preview.width&&i>0,a=r<e.currentProduct.preview.height&&o>0;return s&&a}))),u.forEach((function(t){t.outsideCanvas=lt.isOutsideCanvas(t,e.currentProduct),t.outsideCanvas&&++a})),u)for(d=function(t){i.push(c()(s.a.mark((function n(){var i,r,o,a;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((i=new fabric.BoundedText({version:u[t].Version,width:u[t].width,height:u[t].height,originX:"center",originY:"center",left:u[t].centerX,top:u[t].centerY,strokeDashArray:[0,0],textAlign:u[t].textAlign||"center",skewX:u[t].skewX||0,skewY:u[t].skewY||0,fontFamily:b()[0].Name,fontPath:u[t].fontPath,fontsMap:u[t].fontsMap,fontColorsMap:u[t].fontColorsMap,selectable:!1,evented:!1,prefix:u[t].prefix,suffix:u[t].suffix,minSizePx:u[t].minSizePx,maxSizePx:u[t].maxSizePx,id:u[t].id,uuid:u[t].uuid,zIndex:"undefined"===typeof u[t].zIndex?0:u[t].zIndex,Itext:u[t].Itext,tracking:u[t].tracking,lineSpacing:u[t].lineSpacing,selectedFont:1,fontLibraryId:u[t].fontLibraryId,colorLibraryId:u[t].colorLibraryId,outsideCanvas:u[t].outsideCanvas,visible:"undefined"===typeof u[t].visible||u[t].visible,ligatures:u[t].ligatures})).setColor(pt.colorToWeb(pt.parseColorFromProperty(u[t].color))),!i.colorLibraryId||i.outsideCanvas){n.next=7;break}return n.next=5,l.a(i.colorLibraryId,1);case 5:(r=n.sent)&&(o=pt.colorToWeb(r),i.setColor(o));case 7:if(i.outsideCanvas){n.next=12;break}return n.next=10,v(i,1);case 10:(a=n.sent)&&i.setFontFamily(a);case 12:if(i.angle=u[t].rotation,i.setMultiline(u[t].multiline),i.setCaps(u[t].caps),i.setOutlineColor(pt.colorToWeb(pt.parseColorFromProperty(u[t].outlineColor))),i.setOutlineWidth(u[t].outlineWidth),i.textures=u[t].textures||[],i.setStrokeWidth(0),i.setText(""),i.setCursorColor("rgba(0,0,0,0)"),e.textObjects.push(i),u[t].outsideCanvas){n.next=24;break}return n.abrupt("return",i);case 24:case"end":return n.stop()}}),n)}))))},p=0;p<u.length;++p)d(p);if(g=e.currentProduct.preview.circularTextsPreview,e.options.skipOffscreenAlltogether&&(g=g.filter((function(t){var n=t.centerX-t.width/2,i=t.centerX+t.width/2,r=t.centerY-t.height/2,o=t.centerY+t.height/2,s=n<e.currentProduct.preview.width&&i>0,a=r<e.currentProduct.preview.height&&o>0;return s&&a}))),g.forEach((function(t){t.outsideCanvas=lt.isOutsideCanvas(t,e.currentProduct),t.outsideCanvas&&++a})),g)for(m=function(t){i.push(c()(s.a.mark((function n(){var i,r,o,a;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(i=new fabric.PathIText("",{originX:"center",originY:"center",left:g[t].centerX,top:g[t].centerY,angle:g[t].rotation,centeredScaling:!0,centeredRotation:!0,textAlign:g[t].textAlign,skewX:g[t].skewX||0,skewY:g[t].skewY||0,lockScalingFlip:!0,selectable:!1,evented:!1,prefix:g[t].prefix,suffix:g[t].suffix,startAngle:g[t].startAngle,endAngle:g[t].endAngle,pathWidth:0,fontSize:g[t].fontSize,horizontalDiameter:g[t].horizontalDiameter,verticalDiameter:g[t].verticalDiameter,convex:g[t].convex,caps:g[t].caps,fontFamily:b()[0].Name,fill:g[t].color,stroke:g[t].outlineColor,strokeWidth:g[t].outlineWidth,id:g[t].id,uuid:g[t].uuid,zIndex:"undefined"===typeof g[t].zIndex?0:g[t].zIndex,fontPath:g[t].fontPath,fontsMap:g[t].fontsMap,fontColorsMap:g[t].fontColorsMap,fontLibraryId:g[t].fontLibraryId,colorLibraryId:g[t].colorLibraryId,selectedFont:1,outsideCanvas:g[t].outsideCanvas,visible:"undefined"===typeof g[t].visible||g[t].visible})).colorLibraryId||i.outsideCanvas){n.next=6;break}return n.next=4,l.a(i.colorLibraryId,1);case 4:(r=n.sent)&&(o=pt.colorToWeb(r),i.setColor(o));case 6:if(i.outsideCanvas){n.next=11;break}return n.next=9,v(i,1);case 9:(a=n.sent)&&i.set("fontFamily",a);case 11:if(e.circularTextObjects.push(i),g[t].outsideCanvas){n.next=14;break}return n.abrupt("return",i);case 14:case"end":return n.stop()}}),n)}))))},y=0;y<g.length;++y)m(y);if(!f()){n.next=14;break}return n.abrupt("return");case 14:if((S=e.currentProduct.preview.imagePlaceHoldersPreview).forEach((function(t){t.outsideCanvas=lt.isOutsideCanvas(t,e.currentProduct),t.outsideCanvas&&++a})),x(S),!f()){n.next=19;break}return n.abrupt("return");case 19:if((w=e.currentProduct.preview.vectorEPSPreview).forEach((function(t){t.outsideCanvas=lt.isOutsideCanvas(t,e.currentProduct),t.outsideCanvas&&++a})),C(w),!f()){n.next=24;break}return n.abrupt("return");case 24:return n.next=26,W(i);case 26:for(D=n.sent,T=[],E=!0,k=!1,O=void 0,n.prev=31,A=D[Symbol.iterator]();!(E=(P=A.next()).done);E=!0)(I=P.value)&&(e.canvas.add(I),"bounded-text"===I.type&&I.textures&&I.textures.length&&T.push(_(I,I.textures[0].texturePath)));n.next=39;break;case 35:n.prev=35,n.t0=n.catch(31),k=!0,O=n.t0;case 39:n.prev=39,n.prev=40,E||null==A.return||A.return();case 42:if(n.prev=42,!k){n.next=45;break}throw O;case 45:return n.finish(42);case 46:return n.finish(39);case 47:return n.next=49,Promise.all(T);case 49:for(e._updateWithZIndex(),F=!0,M=!1,L=void 0,n.prev=53,R=D[Symbol.iterator]();!(F=(j=R.next()).done);F=!0)(B=j.value)&&("image-placeholder"===B.type?B.hasStaticImage||B.dynamicImagesPath||(B.silentEditMode=!0,B.enableEditMode()):"vector-placeholder"===B.type&&B.allowUserUpload&&(B.silentEditMode=!0,B.enableEditMode()));n.next=61;break;case 57:n.prev=57,n.t1=n.catch(53),M=!0,L=n.t1;case 61:n.prev=61,n.prev=62,F||null==R.return||R.return();case 64:if(n.prev=64,!M){n.next=67;break}throw L;case 67:return n.finish(64);case 68:return n.finish(61);case 69:e.canvas.discardActiveObject(),e.textObjects.sort((function(t,e){return t.id-e.id})),e.circularTextObjects.sort((function(t,e){return t.id-e.id})),e.imageHolderObjects.sort((function(t,e){return t.id-e.id})),e.vectorEPSObjects.sort((function(t,e){return t.id-e.id})),e.canvas.renderAll(),e._setParentSize(),e.initReady=!0,e.canvasWrapper.dispatchEvent(e.productLoadedEvent),window.dispatchEvent(new CustomEvent("customily-product-loaded",{detail:{productId:t}})),console.log("Loaded '".concat(t,"'")),a>0&&console.log(a+" elements ignored because they are outside the preview"),e.loadingProduct=!1,r(),n.next=91;break;case 85:n.prev=85,n.t2=n.catch(0),e.loadingProduct=!1,console.error("Error loading elements: ",n.t2),e.canvasWrapper.dispatchEvent(e.productLoadedEvent),o(n.t2);case 91:case"end":return n.stop()}}),n,null,[[0,85],[31,35,39,47],[40,,42,46],[53,57,61,69],[62,,64,68]])})))).apply(this,arguments)},D=function(){return T.apply(this,arguments)},_=function(t,n){return new Promise((function(i){if(n&&t)try{if(n){var r=new Image;r.onload=function(){t.set("fill",new fabric.Pattern({source:this,crossOrigin:"anonymous"})),e.canvas.renderAll(),i()},r.onerror=function(){i()},r.crossOrigin="anonymous",e.isIE?$.getBase64FromServerPath(n).then((function(t){r.src=t})):r.src=h(n)+"?x-request=jslib"}}catch(E){console.error(E),i()}else i()}))},e.canvas.clear(),e.canvas.renderOnAddRemove=!1,e.textObjects=[],e.circularTextObjects=[],e.imageHolderObjects=[],e.vectorEPSObjects=[],e.currentProduct=u,e.preventMobile||(e.currentProduct.preview.imagePlaceHoldersPreview||e.options.keepControlsSize)&&(0===(d=e.currentProduct.preview.imagePlaceHoldersPreview.filter((function(t){return!t.dynamicImagesPath})).length+e.currentProduct.preview.vectorEPSPreview.filter((function(t){return t.allowUserUpload})).length)&&(e.options.keepControlsSize||(ut("div.customily-mobile-controls").remove(),e.mobileControls.$container&&e.mobileControls.$container.remove(),e.mobileControls.$container=void 0)),p={class:"cl-mobile-control-wrapper"},d>0&&0===ut("div.customily-mobile-controls").length&&(e.mobileControls.$container=ut('<div class="op-zero">').show().addClass("customily-mobile-controls").appendTo(e.canvas.wrapperEl),e.mobileControls.$up=ut("<div>",p).append(ut("<div>",{class:"customily-mobile-controls-item",html:'<img class="cl-mobile-control-img" src="'.concat(n(158),'">')})).appendTo(e.mobileControls.$container),e.mobileControls.$down=ut("<div>",p).append(ut("<div>",{class:"customily-mobile-controls-item",html:'<img class="cl-mobile-control-img" src="'.concat(n(159),'">')})).appendTo(e.mobileControls.$container),e.mobileControls.$left=ut("<div>",p).append(ut("<div>",{class:"customily-mobile-controls-item",html:'<img class="cl-mobile-control-img" src="'.concat(n(160),'">')})).appendTo(e.mobileControls.$container),e.mobileControls.$right=ut("<div>",p).append(ut("<div>",{class:"customily-mobile-controls-item",html:'<img class="cl-mobile-control-img" src="'.concat(n(161),'">')})).appendTo(e.mobileControls.$container),e.mobileControls.$rotate=ut("<div>",p).append(ut("<div>",{class:"customily-mobile-controls-item",html:'<img class="cl-mobile-control-img" src="'.concat(n(162),'">')})).appendTo(e.mobileControls.$container),e.mobileControls.$zoomIn=ut("<div>",p).append(ut("<div>",{class:"customily-mobile-controls-item",html:'<img class="cl-mobile-control-img" src="'.concat(n(163),'">')})).appendTo(e.mobileControls.$container),e.mobileControls.$zoomOut=ut("<div>",p).append(ut("<div>",{class:"customily-mobile-controls-item",html:'<img class="cl-mobile-control-img" src="'.concat(n(164),'">')})).appendTo(e.mobileControls.$container),ct.acceleratedBtnPress(e.mobileControls.$rotate[0],(function(t){t&&(t.preventDefault(),t.stopImmediatePropagation()),e.rotateActiveImagePlaceholder()}),300,200,24),ct.acceleratedBtnPress(e.mobileControls.$zoomIn[0],(function(t){t&&(t.preventDefault(),t.stopImmediatePropagation()),e.setImagePlaceHolderScale(1+e.PLACEHOLDERS_SCALE_AMOUNT)}),300,200,24),ct.acceleratedBtnPress(e.mobileControls.$zoomOut[0],(function(t){t&&(t.preventDefault(),t.stopImmediatePropagation()),e.setImagePlaceHolderScale(1-e.PLACEHOLDERS_SCALE_AMOUNT)}),300,200,24),ct.acceleratedBtnPress(e.mobileControls.$right[0],(function(t){t&&(t.preventDefault(),t.stopImmediatePropagation()),e.moveImagePlaceholder(e.MOBILE_CONTROL_TRANSLATE_AMOUNT,0)}),300,200,24),ct.acceleratedBtnPress(e.mobileControls.$left[0],(function(t){t&&(t.preventDefault(),t.stopImmediatePropagation()),e.moveImagePlaceholder(-e.MOBILE_CONTROL_TRANSLATE_AMOUNT,0)}),300,200,24),ct.acceleratedBtnPress(e.mobileControls.$up[0],(function(t){t&&(t.preventDefault(),t.stopImmediatePropagation()),e.moveImagePlaceholder(0,-e.MOBILE_CONTROL_TRANSLATE_AMOUNT)}),300,200,24),ct.acceleratedBtnPress(e.mobileControls.$down[0],(function(t){t&&(t.preventDefault(),t.stopImmediatePropagation()),e.moveImagePlaceholder(0,e.MOBILE_CONTROL_TRANSLATE_AMOUNT)}),300,200,24)),d>1&&!e.mobileControls.$changeImage?(e.mobileControls.$changeImage=ut("<div>",p).append(ut("<div>",{class:"customily-mobile-controls-item",html:'<img class="cl-mobile-control-img" src="'.concat(n(165),'">')})).appendTo(e.mobileControls.$container),e.mobileControls.$changeImage.on("click touchend",(function(t){t.preventDefault(),e.selectNextImagePlaceholder()}))):d<=1&&e.mobileControls.$changeImage&&(e.mobileControls.$changeImage.remove(),e.mobileControls.$changeImage=void 0),e.mobileControls.$container&&e.hideMobileControls()),m=ut("#"+e.canvas.lowerCanvasEl.id).parent(),y=e.currentProduct.preview.imagePlaceHoldersPreview.some((function(t){return!t.dynamicImagesPath})),x=e.currentProduct.preview.vectorEPSPreview.some((function(t){return t.allowUserUpload})),e.options.hoverZoom||e.options.touchZoom||e.options.sideZoom||y||x?m.css("pointer-events","auto"):m.css("pointer-events","none"),C=e.isMobile?512:1e3,e.setWidth(e.currentProduct.preview.width>C?C:e.currentProduct.preview.width),e.currentProduct.preview.circularTextsPreview=e.currentProduct.preview.circularTextsPreview||[],e.currentProduct.preview.textsPreview=e.currentProduct.preview.textsPreview||[],i.next=24,g(e.currentProduct.preview.textsPreview,e.currentProduct.preview.circularTextsPreview);case 24:if(e.currentProduct.preview.vectorEPSPreview=e.currentProduct.preview.vectorEPSPreview||[],!dt.any(e.currentProduct.preview.vectorEPSPreview,(function(t){return t.allowUserUpload}))){i.next=32;break}return i.next=29,n.e(1).then(n.t.bind(null,181,7));case 29:S=i.sent,window.pdfjsLib=S.default,pdfjsLib.GlobalWorkerOptions.workerSrc=n.p+"customily.pdf.worker.js";case 32:e.currentProduct.preview.imagePath?(w=h(e.currentProduct.preview.imagePath),e.canvas.setBackgroundImage(w,(function(){f()||(e.canvas.renderAll(),D())}),{originX:"left",originY:"top",crossOrigin:"anonymous"})):e.canvas.setBackgroundColor(e.currentProduct.preview.bgColor,(function(){f()||(e.canvas.renderAll(),D())})),i.next=40;break;case 35:E=new Error("No product found with id "+t),e.loadingProduct=!1,console.error(E),e.canvasWrapper.dispatchEvent(e.productLoadedEvent),o(E);case 40:case"end":return i.stop()}}),i)})));return function(t){return i.apply(this,arguments)}}()).catch((function(n){e.loadingProduct=!1,console.error("Something wrong happened while getting product with id "+t),e.canvasWrapper.dispatchEvent(e.productLoadedEvent),o(n)}));case 18:case"end":return i.stop()}}),i)})));return function(t,e){return i.apply(this,arguments)}}())},wt.prototype._getTextQuantity=function(){return this.textObjects.length+this.circularTextObjects.length},wt.prototype._getAvailableTextIds=function(){return this.textObjects.concat(this.circularTextObjects).map((function(t){return t.id}))},wt.prototype._getImagesQuantity=function(){return this.imageHolderObjects.length},wt.prototype._getAvailableImageIds=function(){return this.imageHolderObjects.map((function(t){var e=[];return t.dynamicImagesPath&&(e=Array.from(t.dynamicImagesPath.keys()).map((function(t){return parseInt(t)}))),{ImageId:t.id,Positions:e}}))},wt.prototype._setText=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a,c,l,u,h,f,d,p,g,m;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=dt.where(this.textObjects.concat(this.circularTextObjects),{id:e}),n=yt(n),this.initReady){t.next=5;break}return console.warn("Call init() and wait for it before using setText()"),t.abrupt("return",-1);case 5:if(0!=i.length){t.next=8;break}return console.warn("Can't find text with id "+e),t.abrupt("return",-1);case 8:if(this.canvas){t.next=11;break}return console.warn("Couldn't find a canvas to draw on. Did you call init()?"),t.abrupt("return",-1);case 11:for(r=!0,o=!1,a=void 0,t.prev=14,c=i[Symbol.iterator]();!(r=(l=c.next()).done);r=!0)(u=l.value).type,u.clText=n;t.next=22;break;case 18:t.prev=18,t.t0=t.catch(14),o=!0,a=t.t0;case 22:t.prev=22,t.prev=23,r||null==c.return||c.return();case 25:if(t.prev=25,!o){t.next=28;break}throw a;case 28:return t.finish(25);case 29:return t.finish(22);case 30:for(h=!0,f=!1,d=void 0,t.prev=33,p=i[Symbol.iterator]();!(h=(g=p.next()).done);h=!0)(m=g.value).outsideCanvas||m.set("text",n);t.next=41;break;case 37:t.prev=37,t.t1=t.catch(33),f=!0,d=t.t1;case 41:t.prev=41,t.prev=42,h||null==p.return||p.return();case 44:if(t.prev=44,!f){t.next=47;break}throw d;case 47:return t.finish(44);case 48:return t.finish(41);case 49:return this.canvas.renderAll(),t.abrupt("return",0);case 51:case"end":return t.stop()}}),t,this,[[14,18,22,30],[23,,25,29],[33,37,41,49],[42,,44,48]])})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._mapTextToImages=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:for(i=[],r=function(t){var r=n[t],o=e+t,l=dt.find(a.imageHolderObjects,{id:o});l&&i.push(c()(s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V(r,l.imageLibraryId,Array.from(l.dynamicImagesPath.keys()));case 2:return e=t.sent,t.next=5,a.setPresetImage(o,e);case 5:case"end":return t.stop()}}),t)}))))},o=0;o<n.length;o++)r(o);return t.next=7,W(i);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._mapTextToVectors=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:for(i=[],r=function(t){var r=n[t],o=e+t,l=dt.find(a.vectorEPSObjects,{id:o});l&&i.push(c()(s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V(r,l.vectorLibraryId,(l.vectors||[]).map((function(t){return t.position})));case 2:return e=t.sent,t.next=5,a.setPresetVector(o,e);case 5:case"end":return t.stop()}}),t)}))))},o=0;o<n.length;o++)r(o);return t.next=7,W(i);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._setFont=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a,c,l,u,h,f,d,p,g,m;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=dt.where(this.textObjects.concat(this.circularTextObjects),{id:e}))&&i.length){t.next=4;break}return console.warn("Can't find text with id "+e),t.abrupt("return",-1);case 4:for(r=!0,o=!1,a=void 0,t.prev=7,c=i[Symbol.iterator]();!(r=(l=c.next()).done);r=!0)l.value.selectedFont=n;t.next=15;break;case 11:t.prev=11,t.t0=t.catch(7),o=!0,a=t.t0;case 15:t.prev=15,t.prev=16,r||null==c.return||c.return();case 18:if(t.prev=18,!o){t.next=21;break}throw a;case 21:return t.finish(18);case 22:return t.finish(15);case 23:u=!0,h=!1,f=void 0,t.prev=26,d=i[Symbol.iterator]();case 28:if(u=(p=d.next()).done){t.next=38;break}if((g=p.value).outsideCanvas){t.next=35;break}return t.next=33,v(g,g.selectedFont);case 33:(m=t.sent)?("bounded-text"===g.type?g.setFontFamily(m):g.fontFamily=m,this.canvas.renderAll()):console.warn("No font at position "+n);case 35:u=!0,t.next=28;break;case 38:t.next=44;break;case 40:t.prev=40,t.t1=t.catch(26),h=!0,f=t.t1;case 44:t.prev=44,t.prev=45,u||null==d.return||d.return();case 47:if(t.prev=47,!h){t.next=50;break}throw f;case 50:return t.finish(47);case 51:return t.finish(44);case 52:return t.abrupt("return",0);case 53:case"end":return t.stop()}}),t,this,[[7,11,15,23],[16,,18,22],[26,40,44,52],[45,,47,51]])})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._setFontColor=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a,c,u,h,f,d,p,g,m,v,y;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=dt.where(this.textObjects.concat(this.circularTextObjects),{id:e}))&&i.length){t.next=4;break}return console.warn("Can't find text with id "+e),t.abrupt("return",-1);case 4:for(r=!0,o=!1,a=void 0,t.prev=7,c=i[Symbol.iterator]();!(r=(u=c.next()).done);r=!0)u.value.selectedColorId=n;t.next=15;break;case 11:t.prev=11,t.t0=t.catch(7),o=!0,a=t.t0;case 15:t.prev=15,t.prev=16,r||null==c.return||c.return();case 18:if(t.prev=18,!o){t.next=21;break}throw a;case 21:return t.finish(18);case 22:return t.finish(15);case 23:h=!0,f=!1,d=void 0,t.prev=26,p=i[Symbol.iterator]();case 28:if(h=(g=p.next()).done){t.next=44;break}if((m=g.value).outsideCanvas){t.next=41;break}if(v=void 0,!m.colorLibraryId){t.next=39;break}return t.next=35,l.a(m.colorLibraryId,n);case 35:(v=t.sent)||console.warn("There is no font color stored in that option"),t.next=40;break;case 39:!function(){var t=new Map;JSON.parse(m.fontColorsMap).map((function(e){t.set(e[0],e[1])})),(v=t.get(n))||console.warn("There is no font stored in that option")}();case 40:v&&(y=pt.colorToWeb(v),m.setColor(y));case 41:h=!0,t.next=28;break;case 44:t.next=50;break;case 46:t.prev=46,t.t1=t.catch(26),f=!0,d=t.t1;case 50:t.prev=50,t.prev=51,h||null==p.return||p.return();case 53:if(t.prev=53,!f){t.next=56;break}throw d;case 56:return t.finish(53);case 57:return t.finish(50);case 58:return this.canvas.renderAll(),t.abrupt("return",0);case 60:case"end":return t.stop()}}),t,this,[[7,11,15,23],[16,,18,22],[26,46,50,58],[51,,53,57]])})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._clearSelection=function(){return this.canvas.discardActiveObject(),this.canvas.renderAll(),0},wt.prototype.__updateZoomerImage=function(){console.warn("_updateZoomerImage() is not implemented anymore")},wt.prototype._updateWithZIndex=function(){this.canvas._objects=dt.sortBy(this.canvas._objects,(function(t){return parseInt(t.zIndex)||0}))},wt.prototype._setImageThreshold=function(){var t=c()(s.a.mark((function t(e,n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:dt.where(this.imageHolderObjects,{id:e}).forEach((function(t){"image-placeholder"===t.type&&t.set("threshold",n)})),this.canvas.renderAll();case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._setImageScale=function(t,e){var n=this;return new Promise((function(i,r){var o=dt.where(n.imageHolderObjects,{id:t}),s=[];o.forEach((function(t){"image-placeholder"===t.type&&s.push(t.setEditModeImageScale(e))})),Promise.all(s).then((function(){i()})).catch((function(t){r(t)}))}))},wt.prototype._setImageRotation=function(t,e){var n=this;return new Promise((function(i,r){var o=dt.where(n.imageHolderObjects,{id:t}),s=[];o.forEach((function(t){"image-placeholder"===t.type&&s.push(t.setEditModeImageRotation(e))})),Promise.all(s).then((function(){i()})).catch((function(t){r(t)}))}))},wt.prototype._setImageOffset=function(t,e,n){var i=this;return new Promise((function(r,o){var s=dt.where(i.imageHolderObjects,{id:t}),a=[];s.forEach((function(t){"image-placeholder"===t.type&&a.push(t.setEditModeImageOffset(e,n))})),Promise.all(a).then((function(){r()})).catch((function(t){o(t)}))}))},wt.prototype._setImagePotraceEnabled=function(t,e){dt.where(this.imageHolderObjects,{id:t}).forEach((function(t){"image-placeholder"===t.type&&(t.usePotrace=e)}))},wt.prototype._setImageZoomStep=function(t,e){dt.where(this.imageHolderObjects,{id:t}).forEach((function(t){"image-placeholder"===t.type&&(t.wheelZoomStep=e)}))},wt.prototype._getImageParameters=function(t){var e=dt.where(this.imageHolderObjects,{id:t}),n=[];return e.forEach((function(t){"image-placeholder"===t.type&&n.push(t.getEditModeImageParameters())})),n},wt.prototype._setImage=function(t,e,n,i,r){var o,a,l=this,u=new Promise((function(t,e){o=t,a=e})),h=new Promise((function(u,h){setTimeout((function(){try{if(l.initReady){var f,d=Date.now();if(!l.currentSessionId)return console.error("Invalid session!"),h(new Error("Invalid session!")),void a();var p="";e&&"undefined"!==typeof t||h(new Error("Invalid image or id")),"undefined"===typeof n&&(n=150),l.imageHolderObjects&&l.imageHolderObjects.length||u(),p="string"===typeof e||e instanceof String?e:e.src;var g={orientation:!0};p.indexOf("data:")<0&&(g.crossOrigin="Anonymous"),vt(p,(function(t){try{f=t,m()}catch(e){h(e)}}),g);var m=function(){var p=c()(s.a.mark((function p(){var g,m,v,y,b,x,C,S,w,_,D,T,E,k,O,A;return s.a.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:if(!((g=l.imageHolderObjects.filter((function(e){return e.id==t&&!e.dynamicImagesPath&&!e.imageLibraryId}))).length>0)){p.next=38;break}return m=[],v=[],y="png",(e.indexOf("image/jpeg")>0||e.indexOf(".jpeg")>0||e.indexOf("image/jpg")>0||e.indexOf(".jpg")>0)&&(y="jpeg"),b=l.isMobile?xt:1024,p.next=9,$.limitImageResolution(f,b,b,y);case 9:for(x=p.sent.image,C=g.some((function(t){return t.removeBackground})),S=null,C&&v.push(new Promise((function(t){S=t}))),w=function(t,e){t.hasStaticImage?console.warn("Ignored setting image to static image"):(t.threshold=n,t.setElement(e),$.isFabricImageBlank(t)?(l.clearSelection(),t.set("evented",!1)):t.set("evented",!0),i||l.refreshControlsVisibility())},r||(_=new Promise(function(){var e=c()(s.a.mark((function e(n,i){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$.imageCanvasToBlob(f,"image/"+y,100);case 3:r=e.sent,rt.uploadProductImage(r,f.width,f.height,y,t,l.currentSessionId,C,l.currentProduct.user.Username).then(function(){var e=c()(s.a.mark((function e(i){var r,o,a,c,u,h,p,m,v,y,_;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.Name,o=i.NoBgName,a=i.Url,r){for(c=0;c<l.imageHolderObjects.length;++c)l.imageHolderObjects[c].id===t&&(!l.imageHolderObjects[c].imageTimestamp||d>l.imageHolderObjects[c].imageTimestamp?(!l.imageHolderObjects[c].removeBackground&&o?(l.imageHolderObjects[c].imageName=o,l.imageHolderObjects[c].noBgFileName=null):l.imageHolderObjects[c].removeBackground&&o?(l.imageHolderObjects[c].imageName=r,l.imageHolderObjects[c].noBgFileName=o):(l.imageHolderObjects[c].imageName=r,l.imageHolderObjects[c].noBgFileName=null),l.imageHolderObjects[c].imageTimestamp=d):console.warn("Image ignored because it was older"));console.info("Image uploaded!",r)}if(!(C&&f.width>1&&f.height>1)){e.next=35;break}if(u=x,!a){e.next=16;break}return e.t0=$,e.next=10,$.urlToImg(a);case 10:return e.t1=e.sent,e.t2=b,e.t3=b,e.next=15,e.t0.limitImageResolution.call(e.t0,e.t1,e.t2,e.t3,"png");case 15:u=e.sent.image;case 16:for(h=!0,p=!1,m=void 0,e.prev=19,v=g[Symbol.iterator]();!(h=(y=v.next()).done);h=!0)(_=y.value).removeBackground&&w(_,u);e.next=27;break;case 23:e.prev=23,e.t4=e.catch(19),p=!0,m=e.t4;case 27:e.prev=27,e.prev=28,h||null==v.return||v.return();case 30:if(e.prev=30,!p){e.next=33;break}throw m;case 33:return e.finish(30);case 34:return e.finish(27);case 35:S&&S(),n();case 37:case"end":return e.stop()}}),e,null,[[19,23,27,35],[28,,30,34]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(t){console.error("Error uploading image to the server!"),i(t)})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),i(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()),m.push(_),console.log("Uploading image")),D=!0,T=!1,E=void 0,p.prev=18,k=g[Symbol.iterator]();!(D=(O=k.next()).done);D=!0)(!(A=O.value).removeBackground||1==f.width&&1==f.height)&&w(A,x);p.next=26;break;case 22:p.prev=22,p.t0=p.catch(18),T=!0,E=p.t0;case 26:p.prev=26,p.prev=27,D||null==k.return||k.return();case 29:if(p.prev=29,!T){p.next=32;break}throw E;case 32:return p.finish(29);case 33:return p.finish(26);case 34:Promise.all(v).then((function(){l.canvas.renderAll(),u()})).catch((function(t){h(t)})),Promise.all(m).then((function(){o()})).catch((function(t){a(t)})),p.next=41;break;case 38:console.log("No image was found with id: "+t),u(),o();case 41:case"end":return p.stop()}}),p,null,[[18,22,26,34],[27,,29,33]])})));return function(){return p.apply(this,arguments)}}()}else console.warn("Call init() and wait for it before using setImage()"),u(),o()}catch(v){h(v)}}),0)}));return this.pendingProcessingPromises.push(u,h),h},wt.prototype._setPresetImage=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a,c,u,f,d,p,g,m,v,y,b,x,C;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i=this.imageHolderObjects.filter((function(t){return t.id===e&&t.dynamicImagesPath})),r=!0,o=!1,a=void 0,t.prev=4,c=i[Symbol.iterator]();!(r=(u=c.next()).done);r=!0)u.value.selectedImageIndex=n;t.next=12;break;case 8:t.prev=8,t.t0=t.catch(4),o=!0,a=t.t0;case 12:t.prev=12,t.prev=13,r||null==c.return||c.return();case 15:if(t.prev=15,!o){t.next=18;break}throw a;case 18:return t.finish(15);case 19:return t.finish(12);case 20:f=!0,d=!1,p=void 0,t.prev=23,g=i[Symbol.iterator]();case 25:if(f=(m=g.next()).done){t.next=45;break}if(v=m.value,y=void 0,!v.imageLibraryId){t.next=35;break}return t.next=31,l.a(v.imageLibraryId,n);case 31:(b=t.sent)&&(y=b.Path),t.next=36;break;case 35:y=v.dynamicImagesPath.get(n);case 36:return x=St,y&&(x=h(y)),t.next=40,$.urlToImg(x);case 40:C=t.sent,v.setElement(C);case 42:f=!0,t.next=25;break;case 45:t.next=51;break;case 47:t.prev=47,t.t1=t.catch(23),d=!0,p=t.t1;case 51:t.prev=51,t.prev=52,f||null==g.return||g.return();case 54:if(t.prev=54,!d){t.next=57;break}throw p;case 57:return t.finish(54);case 58:return t.finish(51);case 59:this.canvas&&this.canvas.renderAll();case 60:case"end":return t.stop()}}),t,this,[[4,8,12,20],[13,,15,19],[23,47,51,59],[52,,54,58]])})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._setImageColor=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a,c,l,u,h;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=dt.where(this.imageHolderObjects,{id:e}),r=!0,o=!1,a=void 0,t.prev=4,c=i[Symbol.iterator]();case 6:if(r=(l=c.next()).done){t.next=21;break}if(!(u=l.value).dynamicImagesPath){t.next=11;break}return console.warn("Can't set color to dynamic image ".concat(e)),t.abrupt("continue",18);case 11:return"undefined"===typeof n&&(n=u.lastColorPosition),n=n<1?1:n,u.lastColorPosition=n,t.next=16,pt.getImageColor(u,n);case 16:h=t.sent,u.set("imageColor",h);case 18:r=!0,t.next=6;break;case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(4),o=!0,a=t.t0;case 27:t.prev=27,t.prev=28,r||null==c.return||c.return();case 30:if(t.prev=30,!o){t.next=33;break}throw a;case 33:return t.finish(30);case 34:return t.finish(27);case 35:this.canvas&&this.canvas.renderAll();case 36:case"end":return t.stop()}}),t,this,[[4,23,27,35],[28,,30,34]])})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._loadSVGFromServer=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n<1&&(n=1),e){t.next=3;break}return t.abrupt("return");case 3:if(!e.vectorLibraryId){t.next=10;break}return t.next=6,l.a(e.vectorLibraryId,n);case 6:(r=t.sent)&&(i=r.svgPath),t.next=13;break;case 10:o=n-1,(a=dt.find(e.vectors,(function(t){return t.position===o})))&&(i=a.svgPath);case 13:if(!i){t.next=29;break}if(!this.isIE){t.next=19;break}return t.next=17,new Promise((function(t,n){var r=new Image;r.onload=function(){console.log("Image loaded"),e.set("svgImage",r),t()},r.onerror=function(){var t=new Error("Error loading image from SVG from "+r.src);console.error(t),n(t)},r.crossOrigin="Anonymous",r.src=h(i.replace("Content/eps-svg","Content/svg-images").replace(".svg",".png"))}));case 17:t.next=26;break;case 19:return i=h(i),t.next=22,U(i);case 22:return t.next=24,t.sent.text();case 24:c=t.sent,e.set("svgString",c);case 26:this.canvas&&this.canvas.renderAll(),t.next=31;break;case 29:e.set("svgString",null),this.canvas&&this.canvas.renderAll();case 31:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._setVector=function(t,e){var n,i,o=this,a=new Promise((function(t,e){n=t,i=e})),l=new Promise(function(){var a=c()(s.a.mark((function a(c,l){var u,h,f,d,p,g,m,v,y;return s.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(u=Date.now(),h=dt.where(o.vectorEPSObjects,{id:t,allowUserUpload:!0}),f=null,d=!0,h.length){s.next=9;break}return console.warn("No user uploadable vector with id "+t),c(),n(),s.abrupt("return");case 9:if(p=function(e){h.forEach((function(t){t.set("svgString",e),t.set("evented",!0)})),o.refreshControlsVisibility(),c(),rt.uploadProductSvg(e,t,o.currentSessionId).then((function(t){t&&(h.forEach((function(e){!e.vectorTimestamp||u>e.vectorTimestamp?(e.vectorName=t,e.vectorTimestamp=u):console.warn("Vector ignored because it was older")})),console.info("SVG uploaded!")),n()})).catch((function(t){console.error("Failed uploading SVG",t),i()}))},"string"!==typeof e){s.next=37;break}if(g=e){s.next=20;break}h.forEach((function(t){t.set("svgString",null),t.vectorName=null,t.vectorTimestamp=u,t.set("evented",!1),o.clearSelection()})),d=!1,o.canvas.renderAll(),c(),n(),s.next=37;break;case 20:if(!(g.indexOf("<?xml")>-1||g.indexOf("<svg")>-1)){s.next=25;break}d=!1,p(g),s.next=37;break;case 25:if(!g.length){s.next=37;break}return s.prev=26,f=e.replace(/^.*[\\\/]/,""),s.next=30,U(e).then((function(t){return t.blob()}));case 30:e=s.sent,s.next=37;break;case 33:s.prev=33,s.t0=s.catch(26),l(s.t0),i(s.t0);case 37:if(!d){s.next=65;break}if("object"!==r()(e)||!(e instanceof File||e instanceof Blob)){s.next=62;break}if("eps"!==(m=(e.name||f).split(".").pop().toLowerCase())){s.next=59;break}return s.prev=41,s.next=44,rt.uploadProductVector(e,t,o.currentSessionId,f);case 44:v=s.sent,console.log("EPS uploaded!"),v&&v.SVGString&&h.forEach((function(t){t.set("svgString",v.SVGString),t.set("evented",!0),!t.vectorTimestamp||u>t.vectorTimestamp?(t.vectorName=v.Name,t.vectorTimestamp=u):console.warn("Vector ignored because it was older")})),o.refreshControlsVisibility(),c(),n(),s.next=57;break;case 52:s.prev=52,s.t1=s.catch(41),console.error(s.t1),l(s.t1),i(s.t1);case 57:s.next=60;break;case 59:"pdf"===m?(h.forEach((function(t){t.set("pdf",e),t.set("evented",!0)})),o.refreshControlsVisibility(),c(),rt.uploadProductVector(e,t,o.currentSessionId,f).then((function(t){t&&(h.forEach((function(e){!e.vectorTimestamp||u>e.vectorTimestamp?(e.vectorName=t.Name,e.vectorTimestamp=u):console.warn("Vector ignored because it was older")})),console.info("PDF uploaded!")),n()})).catch((function(t){console.error("Failed uploading PDF",t),i(t)}))):"svg"===m?((y=new FileReader).onload=function(t){var e=t.target.result;p(e)},y.onerror=function(t){console.error("Failed loading SVG",t),c(),n()},y.readAsText(e)):(console.warn("Invalid file format: "+m),c(),n());case 60:s.next=65;break;case 62:console.warn("Invalid vector argument"),c(),n();case 65:case"end":return s.stop()}}),a,null,[[26,33],[41,52]])})));return function(t,e){return a.apply(this,arguments)}}());return this.pendingProcessingPromises.push(a,l),l},wt.prototype._setPresetVector=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a,c,l,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=dt.where(this.vectorEPSObjects,{id:e}),r=!0,o=!1,a=void 0,t.prev=4,c=i[Symbol.iterator]();case 6:if(r=(l=c.next()).done){t.next=20;break}if(!(u=l.value)){t.next=17;break}if(u.vectorLibraryId||u.hasLibrary?u.selectedVectorIndex=n:u.selectedVectorIndex=n-1,!u.vectors&&!u.vectorLibraryId){t.next=15;break}return t.next=13,this.loadSVGFromServer(u,n);case 13:t.next=17;break;case 15:return t.next=17,this.setPresetImage(e,n,150,!0);case 17:r=!0,t.next=6;break;case 20:t.next=26;break;case 22:t.prev=22,t.t0=t.catch(4),o=!0,a=t.t0;case 26:t.prev=26,t.prev=27,r||null==c.return||c.return();case 29:if(t.prev=29,!o){t.next=32;break}throw a;case 32:return t.finish(29);case 33:return t.finish(26);case 34:this.canvas&&this.canvas.renderAll();case 35:case"end":return t.stop()}}),t,this,[[4,22,26,34],[27,,29,33]])})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._setPresetVectorColor=function(){var t=c()(s.a.mark((function t(e,n){var i,r,o,a,c,u,h,f;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=dt.where(this.vectorEPSObjects,{id:e}),r=!0,o=!1,a=void 0,t.prev=4,c=i[Symbol.iterator]();case 6:if(r=(u=c.next()).done){t.next=33;break}if(!(h=u.value).isHybrid){t.next=11;break}return console.warn("Can't set color to hybrid vector with id ".concat(e)),t.abrupt("continue",30);case 11:if("undefined"===typeof n&&(n=h.lastColorPosition),n=n<1?1:n,f=void 0,h.lastColorPosition=n,!h.applyColoring){t.next=25;break}if(!h.colorLibraryId){t.next=22;break}return t.next=19,l.a(h.colorLibraryId,n);case 19:f=t.sent,t.next=23;break;case 22:h.colors&&(f=dt.findWhere(h.colors,{position:n}));case 23:t.next=29;break;case 25:return h.set("svgColor",null),console.warn("No coloring for vector "+e),this.canvas&&this.canvas.renderAll(),t.abrupt("continue",30);case 29:f?h.set("svgColor",pt.colorToWeb(f)):(console.warn("No color at position "+n),h.set("svgColor","rgba(0,0,0,1)"));case 30:r=!0,t.next=6;break;case 33:t.next=39;break;case 35:t.prev=35,t.t0=t.catch(4),o=!0,a=t.t0;case 39:t.prev=39,t.prev=40,r||null==c.return||c.return();case 42:if(t.prev=42,!o){t.next=45;break}throw a;case 45:return t.finish(42);case 46:return t.finish(39);case 47:this.canvas&&this.canvas.renderAll();case 48:case"end":return t.stop()}}),t,this,[[4,35,39,47],[40,,42,46]])})));return function(e,n){return t.apply(this,arguments)}}(),wt.prototype._generateEPS=function(t){return this.exportFile(t,"eps")},wt.prototype._generatePDF=function(t){return this.exportFile(t,"pdf")},wt.prototype._exportFile=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;return new Promise((function(i,r){Promise.all(n.pendingProcessingPromises).then((function(){e=e||n.currentProduct.format,console.log("Starting export..."),ht.generateExportFile(e,n.currentProduct,n.textObjects,n.circularTextObjects,n.imageHolderObjects,n.vectorEPSObjects,t,n.currentSessionId).then((function(t){console.log("".concat(e.toUpperCase()," generated")),i(t)})).catch((function(t){console.error("Error generating ".concat(e.toUpperCase())),r(t)}))})).catch((function(t){console.error("Can't export because of failing to upload one or more images"),r(t)}))}))},wt.prototype._exportFileAuth=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this;return new Promise((function(r,o){Promise.all(i.pendingProcessingPromises).then((function(){n=n||i.currentProduct.format,console.log("Starting export..."),ht.generateExportFileAuth(n,i.currentProduct,i.textObjects,i.circularTextObjects,i.imageHolderObjects,i.vectorEPSObjects,e,i.currentSessionId,t).then((function(t){console.log("".concat(n.toUpperCase()," generated")),r(t)})).catch((function(t){console.error("Error generating ".concat(n.toUpperCase())),o(t)}))})).catch((function(t){console.error("Can't export because of failing to upload one or more images"),o(t)}))}))},wt.prototype._exportFileDelayed=function(t){var e=this;return new Promise((function(n,i){Promise.all(e.pendingProcessingPromises).then((function(){console.log("Starting export..."),ht.requestFutureProductionFile(e.currentProduct,e.textObjects,e.circularTextObjects,e.imageHolderObjects,e.vectorEPSObjects,t,e.currentSessionId).then((function(t){console.log("".concat(e.currentProduct.format.toUpperCase()," generated")),n(t)})).catch((function(t){console.error("Error generating ".concat(e.currentProduct.toUpperCase())),i(t)}))})).catch((function(t){console.error("Can't export because of failing to upload one or more images"),i(t)}))}))},wt.prototype._waitFilesUpload=function(){return Promise.all(this.pendingProcessingPromises)},wt.prototype._renameExportedFile=function(t,e,n){return new Promise((function(i,r){ht.renameExportedFile(t,e,n).then((function(){console.log("Successfully renamed file"),i()})).catch((function(t){r(t),console.error(t)}))}))},wt.prototype._generateProductionFile=function(t,e,n){return new Promise(function(){var i=c()(s.a.mark((function i(r,o){var a,c,l,u,h,f;return s.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,t){i.next=4;break}return o(new Error("Missing product ID")),i.abrupt("return");case 4:if(n){i.next=7;break}return o(new Error("Missing filename")),i.abrupt("return");case 7:return i.next=9,ot.getProduct(t);case 9:a=i.sent,c=[],l=0;case 12:if(!(l<e.length)){i.next=24;break}if("undefined"!==typeof(u=e[l]).textID){i.next=19;break}return o(new Error("Missing id on text at position "+index)),i.abrupt("return");case 19:h=a.preview.textsPreview.find((function(t){return t.id===u.textID})),c.push({id:u.textID,uuid:u.uuid||(h?h.uuid:null),textValue:u.text||"",colorOption:u.fontcolor||1,fontId:u.font||1});case 21:++l,i.next=12;break;case 24:f=mt(),it.generateProductionFile(c,[],[],[],[],t,n,f,!0).then((function(){r(n)})).catch((function(t){o(t)})),i.next=33;break;case 28:return i.prev=28,i.t0=i.catch(0),console.error(i.t0),o(i.t0),i.abrupt("return");case 33:case"end":return i.stop()}}),i,null,[[0,28]])})));return function(t,e){return i.apply(this,arguments)}}())},wt.prototype._getProductImage=function(t,e){var n=this;return new Promise((function(i){if(n.currentProduct.preview.imagePath){var r=h(n.currentProduct.preview.imagePath),o=new Image;o.onload=function(){t&&e?$.resizeImage(this,t,e,"jpeg").then((function(t){i(t)})):i(this)},r.indexOf("data:")<0&&(o.crossOrigin="Anonymous"),o.src=r}else i(null)}))},wt.prototype._getSessionId=function(){return this.currentSessionId},wt.prototype.startHoverZoom=function(t){var e=this;if(this.options.sideZoom){var n=this.hoverZoomElements.imgEl,i=this.hoverZoomElements.imgContainer;this.canvas.lowerCanvasEl.parentNode.classList.add("cl-zoom-active"),this.imageZoom&&this.imageZoom.kill(),this.clearSelection(),this.canvas.toCanvasElement(Math.max(lt.getMultiplierForTargetSize(this.canvas),this.options.hoverZoomLevel),{format:"png",quality:1}).toBlob((function(r){n.src=URL.createObjectURL(r),ut(i).show();var o=e.canvas.lowerCanvasEl.getBoundingClientRect(),s=Math.min(o.width,document.body.clientWidth-(o.left+o.width));"left"===e.options.hoverZoomSide?s=Math.min(o.width,o.left):s-=20,e.imageZoom=new tt.a(i,{width:e.canvas.lowerCanvasEl.clientWidth,height:e.canvas.lowerCanvasEl.clientHeight,zoomWidth:s||1,zoomContainer:document.body,zoomPosition:e.options.hoverZoomSide,offset:{vertical:window.scrollY||window.pageYOffset,horizontal:10},sourceImgLoadedCallback:function(){t&&e.imageZoom._getInstanceInfo().events.handleMouseMove(t)}})}))}else if(this.options.touchZoom){this.clearSelection();var r=this.canvas.toDataURL({multiplier:Math.max(lt.getMultiplierForTargetSize(this.canvas),this.options.hoverZoomLevel),format:"png"});ut(this.hoverZoomElements.imgContainer).show(),this.hoverZoomElements.imgEl.src=r}},wt.prototype.endHoverZoom=function(){this.options.sideZoom?(this.canvas.lowerCanvasEl.parentNode.classList.remove("cl-zoom-active"),ut(this.hoverZoomElements.imgContainer).hide(),ut(".customily-image-zoom__zoomed-image").hide()):this.options.touchZoom&&ut(this.hoverZoomElements.imgContainer).hide()},wt.prototype.initZoomAction=function(){var t=this,e=null;(this.options.sideZoom||this.options.touchZoom)&&((e=document.createElement("div")).innerHTML=this.options.zoomBtnText||"Click to zoom",e.classList.add("customily-zoom-btn"),this.canvas.lowerCanvasEl.parentNode.insertBefore(e,this.canvas.lowerCanvasEl),this.hoverZoomElements.zoomBtn=e,e.addEventListener("click",(function(e){t.startHoverZoom(e)})),e.addEventListener("touchstart",(function(e){t.startHoverZoom(e),e.preventDefault()})),"undefined"!==typeof IntersectionObserver&&new IntersectionObserver((function(e){e.forEach((function(e){t.refreshZoomBtnVisibility()}))}),{threshold:.2}).observe(this.canvas.lowerCanvasEl));if(this.options.hoverZoom){var n=this;n.zoomActionObj.mouseIsOnCanvasContainer=!1;var i=!1;n.canvas.upperCanvasEl.onmouseover=function(){i=!!n.mobileControls.$container&&"hidden"!==n.mobileControls.$container.css("visibility"),n.zoomActionObj.mouseIsOnCanvasContainer||(n.zoomActionObj.mouseIsOnCanvasContainer=!0),n.mobileControls.$container&&n.mobileControls.$container.css("visibility","hidden"),n.canvas.discardActiveObject(),n.canvas.renderAll()},n.canvas.upperCanvasEl.onmousemove=function(t){var e=t.offsetX,i=t.offsetY,r=n.canvas.lowerCanvasEl;n.zoomActionObj.mouseIsOnCanvasContainer&&(r.style.transformOrigin="50% 50%",r.style.transform="scale("+n.options.hoverZoomLevel+") translate("+(r.clientWidth/2-e)/n.options.hoverZoomLevel+"px, "+(r.clientHeight/2-i)/n.options.hoverZoomLevel+"px)")},n.canvas.upperCanvasEl.onmouseleave=n.canvas.upperCanvasEl.onmouseout=function(){n.zoomActionObj.mouseIsOnCanvasContainer=!1,n.canvas.lowerCanvasEl.style.transform="",n.mobileControls.$container&&i&&n.mobileControls.$container.css("visibility","")}}else if(this.options.sideZoom){var r=document.createElement("div");r.classList.add("customily-hover-container");var o=document.createElement("img");o.classList.add("customily-zoom-base-image"),r.appendChild(o),this.canvas.lowerCanvasEl.parentNode.appendChild(r),ut(r).hide(),this.hoverZoomElements.imgEl=o,this.hoverZoomElements.imgContainer=r,r.onmouseleave=function(){t.endHoverZoom()}}else if(this.options.touchZoom){var s=document.createElement("div");s.classList.add("cl-zoom-img-wrapper");var a=document.createElement("img");a.classList.add("cl-zoom-image"),s.appendChild(a),ut(s).hide(),document.body.appendChild(s),this.hoverZoomElements.imgEl=a,this.hoverZoomElements.imgContainer=s,this.pinchZoom=new nt(a,{horizontalPadding:10,verticalPadding:10,minZoom:1,draggableUnzoomed:!1}),this.pinchZoom.container.addEventListener("click",(function(e){e.target===t.pinchZoom.container&&t.endHoverZoom()}),!0),this.pinchZoom.container.addEventListener("touchstart",(function(e){e.target===t.pinchZoom.container&&t.endHoverZoom()}),!0)}},wt.prototype._selectNextImagePlaceholder=function(){var t=this.canvas.getObjects().filter((function(t){return"image-placeholder"===t.type&&!t.dynamicImagesPath||"vector-placeholder"===t.type&&t.allowUserUpload}));if(t.length){var e=this.canvas.getActiveObject(),n=dt.findIndex(t,(function(t){return t._maskBoundsRectangle===e||t._controlRectangle===e}));if(n<0&&(n=dt.findIndex(t,(function(t){return"image-placeholder"===t.type?!$.isFabricImageBlank(t):!$.isFabricVectorBlank(t)}))),n>-1){var i=++n,r=dt.find(t.slice(i),(function(t){return"image-placeholder"===t.type?!$.isFabricImageBlank(t):!$.isFabricVectorBlank(t)}));r||(i=0,r=dt.find(t.slice(i),(function(t){return"image-placeholder"===t.type?!$.isFabricImageBlank(t):!$.isFabricVectorBlank(t)}))),r&&(r._maskBoundsRectangle||r._controlRectangle)&&(this.canvas.setActiveObject(r._maskBoundsRectangle||r._controlRectangle),this.canvas.requestRenderAll(),this.currentSelectedImagePlaceholderIndex=t.indexOf(r))}}},wt.prototype._moveImagePlaceholder=function(t,e){this.processTimeoutPlaceholder();var n=this.getActionableElements(),i=!0,r=!1,o=void 0;try{for(var s,a=n.filter((function(t){return"image-placeholder"===t.type}))[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value,l=c.getEditModeImageParameters();c.setEditModeImageOffset(l.offsetX+t,l.offsetY+e)}}catch(Et){r=!0,o=Et}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}var u=!0,h=!1,f=void 0;try{for(var d,p=n.filter((function(t){return"vector-placeholder"===t.type}))[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var g=d.value,m=g.getEditModeParameters();g.setVectorOffset(m.offsetX+t,m.offsetY+e)}}catch(Et){h=!0,f=Et}finally{try{u||null==p.return||p.return()}finally{if(h)throw f}}this.canvas.requestRenderAll()},wt.prototype._setImagePlaceHolderScale=function(t){this.processTimeoutPlaceholder();var e=this.getActionableElements(),n=!0,i=!1,r=void 0;try{for(var o,s=e.filter((function(t){return"image-placeholder"===t.type}))[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value,c=a.getEditModeImageParameters();a.setEditModeImageScale(c.scaleX*t)}}catch(Et){i=!0,r=Et}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}var l=!0,u=!1,h=void 0;try{for(var f,d=e.filter((function(t){return"vector-placeholder"===t.type}))[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var p=f.value,g=p.getEditModeParameters();p.setVectorScale(g.scaleX*t,g.scaleY*t)}}catch(Et){u=!0,h=Et}finally{try{l||null==d.return||d.return()}finally{if(u)throw h}}this.canvas.requestRenderAll()},wt.prototype._setImagePlaceHolderRotation=function(t){var e=this.getActionableElements(),n=!0,i=!1,r=void 0;try{for(var o,s=e.filter((function(t){return"image-placeholder"===t.type}))[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value,c=a.getEditModeImageParameters();a.setEditModeImageRotation(c.angle+t)}}catch(Et){i=!0,r=Et}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}var l=!0,u=!1,h=void 0;try{for(var f,d=e.filter((function(t){return"vector-placeholder"===t.type}))[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var p=f.value,g=p.getEditModeParameters();p.setVectorAngle(g.angle+t-p.angle)}}catch(Et){u=!0,h=Et}finally{try{l||null==d.return||d.return()}finally{if(u)throw h}}this.canvas.requestRenderAll()},wt.prototype._rotateActiveImagePlaceholder=function(){this.processTimeoutPlaceholder();var t=this.getActionableElements(),e=!0,n=!1,i=void 0;try{for(var r,o=t.filter((function(t){return"image-placeholder"===t.type}))[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value,a=s.getEditModeImageParameters();s.setEditModeImageRotation(a.angle-s.rotationStep)}}catch(Et){n=!0,i=Et}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}var c=!0,l=!1,u=void 0;try{for(var h,f=t.filter((function(t){return"vector-placeholder"===t.type}))[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){var d=h.value,p=d.getEditModeParameters();d.setVectorAngle(p.angle-d.rotationStep-d.angle)}}catch(Et){l=!0,u=Et}finally{try{c||null==f.return||f.return()}finally{if(l)throw u}}this.canvas.requestRenderAll()},wt.prototype._refreshControlsVisibility=function(){this.anyFilledPlaceholder()?this.showMobileControls():(this.hideMobileControls(),this.clearSelection())},wt.prototype.refreshZoomBtnVisibility=function(){if(this.hoverZoomElements.zoomBtn){var t=this.hoverZoomElements.zoomBtn.clientWidth/this.canvas.lowerCanvasEl.clientWidth,e=this.hoverZoomElements.zoomBtn.clientHeight/this.canvas.lowerCanvasEl.clientHeight;isNaN(t)||isNaN(e)||(t>.5||e>.25?ut(this.hoverZoomElements.zoomBtn).css("visibility","hidden"):ut(this.hoverZoomElements.zoomBtn).css("visibility",""))}},wt.prototype._anyFilledPlaceholder=function(){return this.getActionableElements().length>0},wt.prototype._getActionableElements=function(){var t=this.canvas.getObjects().filter((function(t){return"image-placeholder"===t.type&&!t.dynamicImagesPath||"vector-placeholder"===t.type&&t.allowUserUpload})),e=this.canvas.getActiveObject(),n=dt.findIndex(t,(function(t){return t._maskBoundsRectangle===e||t._controlRectangle===e}));if(n>-1){var i=t[n];return t.filter((function(t){return t.id===i.id}))}var r=dt.find(t,(function(t){return"image-placeholder"===t.type?!$.isFabricImageBlank(t):!$.isFabricVectorBlank(t)}));return r?(this.canvas.setActiveObject("image-placeholder"===r.type?r._maskBoundsRectangle:r._controlRectangle),this.canvas.requestRenderAll(),t.filter((function(t){return t.id===r.id}))):[]},wt.prototype._shareCustomization=function(t){var e=this;return new Promise((function(i,r){Promise.all(e.pendingProcessingPromises).then((function(){console.log("Starting share customization..."),ht.generateElements(e.currentProduct,e.textObjects,e.circularTextObjects,e.imageHolderObjects,e.vectorEPSObjects).then((function(o){if(o.imagesParameters&&o.imagesParameters.length&&o.imagesParameters.forEach((function(t){if(!t.position&&t.fileName){var i=e.__getElementsUrls("image",t.id);i&&i.length&&(t.fileName=i[0],n(t.id,t.fileName))}})),o.vectorsParameters&&o.vectorsParameters.length&&o.vectorsParameters.forEach((function(t){if(t.fileName){var i=e.__getElementsUrls("vector",t.id);i&&i.length&&(t.fileName=i[0],n(t.id,t.fileName))}})),o.vectorObjects&&o.vectorObjects.length){var s=!0,a=!1,c=void 0;try{for(var l,u=o.vectorObjects[Symbol.iterator]();!(s=(l=u.next()).done);s=!0){var h=l.value;h.position=h.realPosition}}catch(Et){a=!0,c=Et}finally{try{s||null==u.return||u.return()}finally{if(a)throw c}}}at.shareCustomization(o.texts,o.circularTexts,o.imagesParameters,o.vectorsParameters,o.vectorObjects,o.productId,e.currentSessionId,t).then((function(t){console.log("Share customization success"),i(t)})).catch((function(t){console.error("Error sharing customization"),r(t)}))})).catch((function(t){console.error("Error generating elements"),r(t)}))})).catch((function(t){console.error("Can't share customization because of failing to upload one or more images"),r(t)}))}));function n(e,n){if(t&&t.length){var i=t.find((function(t){return t.uploadedIds&&-1!==t.uploadedIds.indexOf(e)}));i&&(i.value=n)}}},wt.prototype._getSharedCustomization=function(t){return new Promise((function(e,n){at.getShareCustomization(t).done((function(t){e(t)})).fail((function(t){console.error("Error loading shared customization: ",t),n(t)}))}))},wt.prototype._loadCustomization=function(t){var e=this;return new Promise((function(r,o){e._getSharedCustomization(t).then((function(t){var a=JSON.parse(t.CustomizationData);e.setProduct(t.TemplateId).then(c()(s.a.mark((function t(){var o,c,l,u,h,f;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.texts&&a.texts.length&&a.texts.forEach((function(t){n(t)})),a.circularTexts&&a.circularTexts.length&&a.circularTexts.forEach((function(t){n(t)})),a.imagesParameters&&a.imagesParameters.length&&a.imagesParameters.forEach((function(t){!t.position&&t.fileName?(e.setImage(t.id,t.fileName).then((function(){i(t,"image-placeholder")})),t.colorPosition&&e.setImageColor(t.id,t.colorPosition)):t.position&&e.setPresetImage(t.id,t.position)})),!a.vectorsParameters||!a.vectorsParameters.length){t.next=24;break}for(o=!0,c=!1,l=void 0,t.prev=7,u=function(){var t=f.value;t.fileName&&e.setVector(t.id,t.fileName).then((function(){i(t,"vector-placeholder")}))},h=a.vectorsParameters[Symbol.iterator]();!(o=(f=h.next()).done);o=!0)u();t.next=16;break;case 12:t.prev=12,t.t0=t.catch(7),c=!0,l=t.t0;case 16:t.prev=16,t.prev=17,o||null==h.return||h.return();case 19:if(t.prev=19,!c){t.next=22;break}throw l;case 22:return t.finish(19);case 23:return t.finish(16);case 24:a.vectorPlaceholders&&a.vectorPlaceholders.length&&a.vectorPlaceholders.forEach((function(t){t.position&&e.setPresetVector(t.id,t.position),t.colorPosition&&e.setPresetVectorColor(t.id,t.colorPosition)})),r(a.options);case 26:case"end":return t.stop()}}),t,null,[[7,12,16,24],[17,,19,23]])})))).catch((function(t){console.error("Error loading product from shared customization: ",t),o(t)}))})).catch((function(t){console.error("Error loading shared customization: ",t),o(t)}))}));function n(t){e.setText(t.id,t.textValue||""),e.setFont(t.id,t.fontId),e.setFontColor(t.id,t.colorOption)}function i(t,n){var i,r=e.canvas.getObjects().find((function(e){return e.id===t.id}));"image-placeholder"===n?(e.canvas.setActiveObject(r._maskBoundsRectangle),e.canvas.requestRenderAll(),i=t.maskScaleX):(e.canvas.setActiveObject(r._controlRectangle),e.canvas.requestRenderAll(),i=t.scaleX),e.setImagePlaceHolderRotation(t.angle),e.setImagePlaceHolderScale(i),e.moveImagePlaceholder(t.offsetX,t.offsetY),e.clearSelection(),console.log(t.id+" - type: "+n+" adjusted")}},wt.prototype._proccesTimeoutPlaceholder=function(){var t=this;t.timeOutSelection&&clearTimeout(t.timeOutSelection),t.timeOutSelection=setTimeout((function(){t.mouseDownOnPlaceholder?t.processTimeoutPlaceholder():t.clearSelection()}),3e3)};var _t=wt;window.Engraver=_t,window.engraver=new _t;var Dt=n(166)().src,Tt=Dt.substring(0,Dt.lastIndexOf("/")+1);n.p=Tt,HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){var i=this;setTimeout((function(){for(var r=atob(i.toDataURL(e,n).split(",")[1]),o=r.length,s=new Uint8Array(o),a=0;a<o;a++)s[a]=r.charCodeAt(a);t(new Blob([s],{type:e||"image/png"}))}))}})},function(t,e,n){"use strict";function i(t){return null===t?"null":null!==(e=t)&&""+e==="[object Object]"&&e.constructor===Object?"plain object":Array.isArray(t)?"array":t instanceof Date?"date":typeof t;var e}function r(t,e,n){var i,r,o;if(t)return!0;throw r=(n=n||{}).errorClass||Error,o=n,(i=new r(e=e.replace(/{{([0-9a-zA-Z-_. ]+)}}/g,(function(t,e){return"number"===typeof o[e]&&isNaN(o[e])?"NaN":JSON.stringify(o[e])})).replace(/{([0-9a-zA-Z-_. ]+)}/g,(function(t,e){return o[e]})))).attributes=n,i}function o(t,e,n,o){var s,a,c=i(t);r((o=o||{}).condition||-1!==n.indexOf(c),o.errorMessage||"Parameter `{parameterName}` must be a {expectedTypesMessage}, not {parameterType} `{{parameterValue}}`",{errorClass:TypeError,expectedTypesMessage:(s=n,a="or",0===s.length?"":1===s.length?s[0]:2===s.length?s.join(" "+a+" "):s.length>2?s.join(", "+a+" "):void 0),parameterName:e,parameterType:c,parameterValue:t})}function s(t,e,n,i){r(function(t,e){return Array.isArray(e)?-1!==e.indexOf(t):t in e}(t,e),n,Object.assign({errorClass:RangeError},i))}n.r(e),n.d(e,"assert",(function(){return r})),n.d(e,"assertType",(function(){return o})),n.d(e,"assertRange",(function(){return s}))},function(t,e,n){"use strict";n.r(e);var i=n(27),r=n.n(i);String.prototype.codePointAt||function(){var t=function(){try{var t={},e=Object.defineProperty,n=e(t,t,t)&&e}catch(i){}return n}(),e=function(t){if(null==this)throw TypeError();var e=String(this),n=e.length,i=t?Number(t):0;if(i!=i&&(i=0),!(i<0||i>=n)){var r,o=e.charCodeAt(i);return o>=55296&&o<=56319&&n>i+1&&(r=e.charCodeAt(i+1))>=56320&&r<=57343?1024*(o-55296)+r-56320+65536:o}};t?t(String.prototype,"codePointAt",{value:e,configurable:!0,writable:!0}):String.prototype.codePointAt=e}();var o=0,s=-3;function a(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function c(t,e){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new a,this.dtree=new a}var l=new a,u=new a,h=new Uint8Array(30),f=new Uint16Array(30),d=new Uint8Array(30),p=new Uint16Array(30),g=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),m=new a,v=new Uint8Array(320);function y(t,e,n,i){var r,o;for(r=0;r<n;++r)t[r]=0;for(r=0;r<30-n;++r)t[r+n]=r/n|0;for(o=i,r=0;r<30;++r)e[r]=o,o+=1<<t[r]}var b=new Uint16Array(16);function x(t,e,n,i){var r,o;for(r=0;r<16;++r)t.table[r]=0;for(r=0;r<i;++r)t.table[e[n+r]]++;for(t.table[0]=0,o=0,r=0;r<16;++r)b[r]=o,o+=t.table[r];for(r=0;r<i;++r)e[n+r]&&(t.trans[b[e[n+r]]++]=r)}function C(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=1&t.tag;return t.tag>>>=1,e}function S(t,e,n){if(!e)return n;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var i=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,i+n}function w(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var n=0,i=0,r=0,o=t.tag;do{i=2*i+(1&o),o>>>=1,++r,n+=e.table[r],i-=e.table[r]}while(i>=0);return t.tag=o,t.bitcount-=r,e.trans[n+i]}function _(t,e,n){var i,r,o,s,a,c;for(i=S(t,5,257),r=S(t,5,1),o=S(t,4,4),s=0;s<19;++s)v[s]=0;for(s=0;s<o;++s){var l=S(t,3,0);v[g[s]]=l}for(x(m,v,0,19),a=0;a<i+r;){var u=w(t,m);switch(u){case 16:var h=v[a-1];for(c=S(t,2,3);c;--c)v[a++]=h;break;case 17:for(c=S(t,3,3);c;--c)v[a++]=0;break;case 18:for(c=S(t,7,11);c;--c)v[a++]=0;break;default:v[a++]=u}}x(e,v,0,i),x(n,v,i,r)}function D(t,e,n){for(;;){var i,r,s,a,c=w(t,e);if(256===c)return o;if(c<256)t.dest[t.destLen++]=c;else for(i=S(t,h[c-=257],f[c]),r=w(t,n),a=s=t.destLen-S(t,d[r],p[r]);a<s+i;++a)t.dest[t.destLen++]=t.dest[a]}}function T(t){for(var e,n;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if((e=256*(e=t.source[t.sourceIndex+1])+t.source[t.sourceIndex])!==(65535&~(256*t.source[t.sourceIndex+3]+t.source[t.sourceIndex+2])))return s;for(t.sourceIndex+=4,n=e;n;--n)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,o}!function(t,e){var n;for(n=0;n<7;++n)t.table[n]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,n=0;n<24;++n)t.trans[n]=256+n;for(n=0;n<144;++n)t.trans[24+n]=n;for(n=0;n<8;++n)t.trans[168+n]=280+n;for(n=0;n<112;++n)t.trans[176+n]=144+n;for(n=0;n<5;++n)e.table[n]=0;for(e.table[5]=32,n=0;n<32;++n)e.trans[n]=n}(l,u),y(h,f,4,3),y(d,p,2,1),h[28]=0,f[28]=258;var E=function(t,e){var n,i,r=new c(t,e);do{switch(n=C(r),S(r,2,0)){case 0:i=T(r);break;case 1:i=D(r,l,u);break;case 2:_(r,r.ltree,r.dtree),i=D(r,r.ltree,r.dtree);break;default:i=s}if(i!==o)throw new Error("Data error")}while(!n);return r.destLen<r.dest.length?"function"===typeof r.dest.slice?r.dest.slice(0,r.destLen):r.dest.subarray(0,r.destLen):r.dest};function k(t,e,n,i,r){return Math.pow(1-r,3)*t+3*Math.pow(1-r,2)*r*e+3*(1-r)*Math.pow(r,2)*n+Math.pow(r,3)*i}function O(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function A(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function P(t){throw new Error(t)}function I(t,e){t||P(e)}O.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},O.prototype.addPoint=function(t,e){"number"===typeof t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),"number"===typeof e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},O.prototype.addX=function(t){this.addPoint(t,null)},O.prototype.addY=function(t){this.addPoint(null,t)},O.prototype.addBezier=function(t,e,n,i,r,o,s,a){var c=[t,e],l=[n,i],u=[r,o],h=[s,a];this.addPoint(t,e),this.addPoint(s,a);for(var f=0;f<=1;f++){var d=6*c[f]-12*l[f]+6*u[f],p=-3*c[f]+9*l[f]-9*u[f]+3*h[f],g=3*l[f]-3*c[f];if(0!==p){var m=Math.pow(d,2)-4*g*p;if(!(m<0)){var v=(-d+Math.sqrt(m))/(2*p);0<v&&v<1&&(0===f&&this.addX(k(c[f],l[f],u[f],h[f],v)),1===f&&this.addY(k(c[f],l[f],u[f],h[f],v)));var y=(-d-Math.sqrt(m))/(2*p);0<y&&y<1&&(0===f&&this.addX(k(c[f],l[f],u[f],h[f],y)),1===f&&this.addY(k(c[f],l[f],u[f],h[f],y)))}}else{if(0===d)continue;var b=-g/d;0<b&&b<1&&(0===f&&this.addX(k(c[f],l[f],u[f],h[f],b)),1===f&&this.addY(k(c[f],l[f],u[f],h[f],b)))}}},O.prototype.addQuad=function(t,e,n,i,r,o){var s=t+2/3*(n-t),a=e+2/3*(i-e),c=s+1/3*(r-t),l=a+1/3*(o-e);this.addBezier(t,e,s,a,c,l,r,o)},A.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},A.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},A.prototype.curveTo=A.prototype.bezierCurveTo=function(t,e,n,i,r,o){this.commands.push({type:"C",x1:t,y1:e,x2:n,y2:i,x:r,y:o})},A.prototype.quadTo=A.prototype.quadraticCurveTo=function(t,e,n,i){this.commands.push({type:"Q",x1:t,y1:e,x:n,y:i})},A.prototype.close=A.prototype.closePath=function(){this.commands.push({type:"Z"})},A.prototype.extend=function(t){if(t.commands)t=t.commands;else if(t instanceof O){var e=t;return this.moveTo(e.x1,e.y1),this.lineTo(e.x2,e.y1),this.lineTo(e.x2,e.y2),this.lineTo(e.x1,e.y2),void this.close()}Array.prototype.push.apply(this.commands,t)},A.prototype.getBoundingBox=function(){for(var t=new O,e=0,n=0,i=0,r=0,o=0;o<this.commands.length;o++){var s=this.commands[o];switch(s.type){case"M":t.addPoint(s.x,s.y),e=i=s.x,n=r=s.y;break;case"L":t.addPoint(s.x,s.y),i=s.x,r=s.y;break;case"Q":t.addQuad(i,r,s.x1,s.y1,s.x,s.y),i=s.x,r=s.y;break;case"C":t.addBezier(i,r,s.x1,s.y1,s.x2,s.y2,s.x,s.y),i=s.x,r=s.y;break;case"Z":i=e,r=n;break;default:throw new Error("Unexpected path command "+s.type)}}return t.isEmpty()&&t.addPoint(0,0),t},A.prototype.draw=function(t){t.beginPath();for(var e=0;e<this.commands.length;e+=1){var n=this.commands[e];"M"===n.type?t.moveTo(n.x,n.y):"L"===n.type?t.lineTo(n.x,n.y):"C"===n.type?t.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):"Q"===n.type?t.quadraticCurveTo(n.x1,n.y1,n.x,n.y):"Z"===n.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},A.prototype.toPathData=function(t){function e(e){return Math.round(e)===e?""+Math.round(e):e.toFixed(t)}function n(){for(var t=arguments,n="",i=0;i<arguments.length;i+=1){var r=t[i];r>=0&&i>0&&(n+=" "),n+=e(r)}return n}t=void 0!==t?t:2;for(var i="",r=0;r<this.commands.length;r+=1){var o=this.commands[r];"M"===o.type?i+="M"+n(o.x,o.y):"L"===o.type?i+="L"+n(o.x,o.y):"C"===o.type?i+="C"+n(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?i+="Q"+n(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(i+="Z")}return i},A.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&&"black"!==this.fill&&(null===this.fill?e+=' fill="none"':e+=' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},A.prototype.toDOMElement=function(t){var e=this.toPathData(t),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n};var F={fail:P,argument:I,assert:I},M={},L={},R={};function j(t){return function(){return t}}L.BYTE=function(t){return F.argument(t>=0&&t<=255,"Byte value should be between 0 and 255."),[t]},R.BYTE=j(1),L.CHAR=function(t){return[t.charCodeAt(0)]},R.CHAR=j(1),L.CHARARRAY=function(t){for(var e=[],n=0;n<t.length;n+=1)e[n]=t.charCodeAt(n);return e},R.CHARARRAY=function(t){return t.length},L.USHORT=function(t){return[t>>8&255,255&t]},R.USHORT=j(2),L.SHORT=function(t){return t>=32768&&(t=-(65536-t)),[t>>8&255,255&t]},R.SHORT=j(2),L.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},R.UINT24=j(3),L.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},R.ULONG=j(4),L.LONG=function(t){return t>=2147483648&&(t=-(4294967296-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},R.LONG=j(4),L.FIXED=L.ULONG,R.FIXED=R.ULONG,L.FWORD=L.SHORT,R.FWORD=R.SHORT,L.UFWORD=L.USHORT,R.UFWORD=R.USHORT,L.LONGDATETIME=function(t){return[0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t]},R.LONGDATETIME=j(8),L.TAG=function(t){return F.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},R.TAG=j(4),L.Card8=L.BYTE,R.Card8=R.BYTE,L.Card16=L.USHORT,R.Card16=R.USHORT,L.OffSize=L.BYTE,R.OffSize=R.BYTE,L.SID=L.USHORT,R.SID=R.USHORT,L.NUMBER=function(t){return t>=-107&&t<=107?[t+139]:t>=108&&t<=1131?[247+((t-=108)>>8),255&t]:t>=-1131&&t<=-108?[251+((t=-t-108)>>8),255&t]:t>=-32768&&t<=32767?L.NUMBER16(t):L.NUMBER32(t)},R.NUMBER=function(t){return L.NUMBER(t).length},L.NUMBER16=function(t){return[28,t>>8&255,255&t]},R.NUMBER16=j(3),L.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},R.NUMBER32=j(5),L.REAL=function(t){var e=t.toString(),n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(n){var i=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));e=(Math.round(t*i)/i).toString()}for(var r="",o=0,s=e.length;o<s;o+=1){var a=e[o];r+="e"===a?"-"===e[++o]?"c":"b":"."===a?"a":"-"===a?"e":a}for(var c=[30],l=0,u=(r+=1&r.length?"f":"ff").length;l<u;l+=2)c.push(parseInt(r.substr(l,2),16));return c},R.REAL=function(t){return L.REAL(t).length},L.NAME=L.CHARARRAY,R.NAME=R.CHARARRAY,L.STRING=L.CHARARRAY,R.STRING=R.CHARARRAY,M.UTF8=function(t,e,n){for(var i=[],r=n,o=0;o<r;o++,e+=1)i[o]=t.getUint8(e);return String.fromCharCode.apply(null,i)},M.UTF16=function(t,e,n){for(var i=[],r=n/2,o=0;o<r;o++,e+=2)i[o]=t.getUint16(e);return String.fromCharCode.apply(null,i)},L.UTF16=function(t){for(var e=[],n=0;n<t.length;n+=1){var i=t.charCodeAt(n);e[e.length]=i>>8&255,e[e.length]=255&i}return e},R.UTF16=function(t){return 2*t.length};var B={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};M.MACSTRING=function(t,e,n,i){var r=B[i];if(void 0!==r){for(var o="",s=0;s<n;s++){var a=t.getUint8(e+s);o+=a<=127?String.fromCharCode(a):r[127&a]}return o}};var U,z="function"===typeof WeakMap&&new WeakMap;function N(t){return t>=-128&&t<=127}function W(t,e,n){for(var i=0,r=t.length;e<r&&i<64&&0===t[e];)++e,++i;return n.push(128|i-1),e}function H(t,e,n){for(var i=0,r=t.length,o=e;o<r&&i<64;){var s=t[o];if(!N(s))break;if(0===s&&o+1<r&&0===t[o+1])break;++o,++i}n.push(i-1);for(var a=e;a<o;++a)n.push(t[a]+256&255);return o}function X(t,e,n){for(var i=0,r=t.length,o=e;o<r&&i<64;){var s=t[o];if(0===s)break;if(N(s)&&o+1<r&&N(t[o+1]))break;++o,++i}n.push(64|i-1);for(var a=e;a<o;++a){var c=t[a];n.push(c+65536>>8&255,c+256&255)}return o}L.MACSTRING=function(t,e){var n=function(t){if(!U)for(var e in U={},B)U[e]=new String(e);var n=U[t];if(void 0!==n){if(z){var i=z.get(n);if(void 0!==i)return i}var r=B[t];if(void 0!==r){for(var o={},s=0;s<r.length;s++)o[r.charCodeAt(s)]=s+128;return z&&z.set(n,o),o}}}(e);if(void 0!==n){for(var i=[],r=0;r<t.length;r++){var o=t.charCodeAt(r);if(o>=128&&void 0===(o=n[o]))return;i[r]=o}return i}},R.MACSTRING=function(t,e){var n=L.MACSTRING(t,e);return void 0!==n?n.length:0},L.VARDELTAS=function(t){for(var e=0,n=[];e<t.length;){var i=t[e];e=0===i?W(t,e,n):i>=-128&&i<=127?H(t,e,n):X(t,e,n)}return n},L.INDEX=function(t){for(var e=1,n=[e],i=[],r=0;r<t.length;r+=1){var o=L.OBJECT(t[r]);Array.prototype.push.apply(i,o),e+=o.length,n.push(e)}if(0===i.length)return[0,0];for(var s=[],a=1+Math.floor(Math.log(e)/Math.log(2))/8|0,c=[void 0,L.BYTE,L.USHORT,L.UINT24,L.ULONG][a],l=0;l<n.length;l+=1){var u=c(n[l]);Array.prototype.push.apply(s,u)}return Array.prototype.concat(L.Card16(t.length),L.OffSize(a),s,i)},R.INDEX=function(t){return L.INDEX(t).length},L.DICT=function(t){for(var e=[],n=Object.keys(t),i=n.length,r=0;r<i;r+=1){var o=parseInt(n[r],0),s=t[o];e=(e=e.concat(L.OPERAND(s.value,s.type))).concat(L.OPERATOR(o))}return e},R.DICT=function(t){return L.DICT(t).length},L.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]},L.OPERAND=function(t,e){var n=[];if(Array.isArray(e))for(var i=0;i<e.length;i+=1)F.argument(t.length===e.length,"Not enough arguments given for type"+e),n=n.concat(L.OPERAND(t[i],e[i]));else if("SID"===e)n=n.concat(L.NUMBER(t));else if("offset"===e)n=n.concat(L.NUMBER32(t));else if("number"===e)n=n.concat(L.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);n=n.concat(L.REAL(t))}return n},L.OP=L.BYTE,R.OP=R.BYTE;var G="function"===typeof WeakMap&&new WeakMap;function Y(t,e,n){for(var i=0;i<e.length;i+=1){var r=e[i];this[r.name]=r.value}if(this.tableName=t,this.fields=e,n)for(var o=Object.keys(n),s=0;s<o.length;s+=1){var a=o[s],c=n[a];void 0!==this[a]&&(this[a]=c)}}function q(t,e,n){void 0===n&&(n=e.length);var i=new Array(e.length+1);i[0]={name:t+"Count",type:"USHORT",value:n};for(var r=0;r<e.length;r++)i[r+1]={name:t+r,type:"USHORT",value:e[r]};return i}function V(t,e,n){var i=e.length,r=new Array(i+1);r[0]={name:t+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r[o+1]={name:t+o,type:"TABLE",value:n(e[o],o)};return r}function Z(t,e,n){var i=e.length,r=[];r[0]={name:t+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r=r.concat(n(e[o],o));return r}function Q(t){1===t.format?Y.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(q("glyph",t.glyphs))):F.assert(!1,"Can't create coverage table format 2 yet.")}function K(t){Y.call(this,"scriptListTable",Z("scriptRecord",t,(function(t,e){var n=t.script,i=n.defaultLangSys;return F.assert(!!i,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+e,type:"TAG",value:t.tag},{name:"script"+e,type:"TABLE",value:new Y("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Y("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:i.reqFeatureIndex}].concat(q("featureIndex",i.featureIndexes)))}].concat(Z("langSys",n.langSysRecords,(function(t,e){var n=t.langSys;return[{name:"langSysTag"+e,type:"TAG",value:t.tag},{name:"langSys"+e,type:"TABLE",value:new Y("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(q("featureIndex",n.featureIndexes)))}]}))))}]})))}function $(t){Y.call(this,"featureListTable",Z("featureRecord",t,(function(t,e){var n=t.feature;return[{name:"featureTag"+e,type:"TAG",value:t.tag},{name:"feature"+e,type:"TABLE",value:new Y("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(q("lookupListIndex",n.lookupListIndexes)))}]})))}function J(t,e){Y.call(this,"lookupListTable",V("lookup",t,(function(t){var n=e[t.lookupType];return F.assert(!!n,"Unable to write GSUB lookup type "+t.lookupType+" tables."),new Y("lookupTable",[{name:"lookupType",type:"USHORT",value:t.lookupType},{name:"lookupFlag",type:"USHORT",value:t.lookupFlag}].concat(V("subtable",t.subtables,n)))})))}L.CHARSTRING=function(t){if(G){var e=G.get(t);if(void 0!==e)return e}for(var n=[],i=t.length,r=0;r<i;r+=1){var o=t[r];n=n.concat(L[o.type](o.value))}return G&&G.set(t,n),n},R.CHARSTRING=function(t){return L.CHARSTRING(t).length},L.OBJECT=function(t){var e=L[t.type];return F.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},R.OBJECT=function(t){var e=R[t.type];return F.argument(void 0!==e,"No sizeOf function for type "+t.type),e(t.value)},L.TABLE=function(t){for(var e=[],n=t.fields.length,i=[],r=[],o=0;o<n;o+=1){var s=t.fields[o],a=L[s.type];F.argument(void 0!==a,"No encoding function for field type "+s.type+" ("+s.name+")");var c=t[s.name];void 0===c&&(c=s.value);var l=a(c);"TABLE"===s.type?(r.push(e.length),e=e.concat([0,0]),i.push(l)):e=e.concat(l)}for(var u=0;u<i.length;u+=1){var h=r[u],f=e.length;F.argument(f<65536,"Table "+t.tableName+" too big."),e[h]=f>>8,e[h+1]=255&f,e=e.concat(i[u])}return e},R.TABLE=function(t){for(var e=0,n=t.fields.length,i=0;i<n;i+=1){var r=t.fields[i],o=R[r.type];F.argument(void 0!==o,"No sizeOf function for field type "+r.type+" ("+r.name+")");var s=t[r.name];void 0===s&&(s=r.value),e+=o(s),"TABLE"===r.type&&(e+=2)}return e},L.RECORD=L.TABLE,R.RECORD=R.TABLE,L.LITERAL=function(t){return t},R.LITERAL=function(t){return t.length},Y.prototype.encode=function(){return L.TABLE(this)},Y.prototype.sizeOf=function(){return R.TABLE(this)},Q.prototype=Object.create(Y.prototype),Q.prototype.constructor=Q,K.prototype=Object.create(Y.prototype),K.prototype.constructor=K,$.prototype=Object.create(Y.prototype),$.prototype.constructor=$,J.prototype=Object.create(Y.prototype),J.prototype.constructor=J;var tt={Table:Y,Record:Y,Coverage:Q,ScriptList:K,FeatureList:$,LookupList:J,ushortList:q,tableList:V,recordList:Z};function et(t,e){return t.getUint8(e)}function nt(t,e){return t.getUint16(e,!1)}function it(t,e){return t.getUint32(e,!1)}function rt(t,e){return t.getInt16(e,!1)+t.getUint16(e+2,!1)/65535}var ot={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function st(t,e){this.data=t,this.offset=e,this.relativeOffset=0}st.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},st.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},st.prototype.parseCard8=st.prototype.parseByte,st.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},st.prototype.parseCard16=st.prototype.parseUShort,st.prototype.parseSID=st.prototype.parseUShort,st.prototype.parseOffset16=st.prototype.parseUShort,st.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},st.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},st.prototype.parseULong=function(){var t=it(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},st.prototype.parseOffset32=st.prototype.parseULong,st.prototype.parseFixed=function(){var t=rt(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},st.prototype.parseString=function(t){var e=this.data,n=this.offset+this.relativeOffset,i="";this.relativeOffset+=t;for(var r=0;r<t;r++)i+=String.fromCharCode(e.getUint8(n+r));return i},st.prototype.parseTag=function(){return this.parseString(4)},st.prototype.parseLongDateTime=function(){var t=it(this.data,this.offset+this.relativeOffset+4);return t-=2082844800,this.relativeOffset+=8,t},st.prototype.parseVersion=function(t){var e=nt(this.data,this.offset+this.relativeOffset),n=nt(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===t&&(t=4096),e+n/t/10},st.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=ot[t]*e},st.prototype.parseULongList=function(t){void 0===t&&(t=this.parseULong());for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getUint32(i),i+=4;return this.relativeOffset+=4*t,e},st.prototype.parseOffset16List=st.prototype.parseUShortList=function(t){void 0===t&&(t=this.parseUShort());for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getUint16(i),i+=2;return this.relativeOffset+=2*t,e},st.prototype.parseShortList=function(t){for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getInt16(i),i+=2;return this.relativeOffset+=2*t,e},st.prototype.parseByteList=function(t){for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getUint8(i++);return this.relativeOffset+=t,e},st.prototype.parseList=function(t,e){e||(e=t,t=this.parseUShort());for(var n=new Array(t),i=0;i<t;i++)n[i]=e.call(this);return n},st.prototype.parseList32=function(t,e){e||(e=t,t=this.parseULong());for(var n=new Array(t),i=0;i<t;i++)n[i]=e.call(this);return n},st.prototype.parseRecordList=function(t,e){e||(e=t,t=this.parseUShort());for(var n=new Array(t),i=Object.keys(e),r=0;r<t;r++){for(var o={},s=0;s<i.length;s++){var a=i[s],c=e[a];o[a]=c.call(this)}n[r]=o}return n},st.prototype.parseRecordList32=function(t,e){e||(e=t,t=this.parseULong());for(var n=new Array(t),i=Object.keys(e),r=0;r<t;r++){for(var o={},s=0;s<i.length;s++){var a=i[s],c=e[a];o[a]=c.call(this)}n[r]=o}return n},st.prototype.parseStruct=function(t){if("function"===typeof t)return t.call(this);for(var e=Object.keys(t),n={},i=0;i<e.length;i++){var r=e[i],o=t[r];n[r]=o.call(this)}return n},st.prototype.parseValueRecord=function(t){if(void 0===t&&(t=this.parseUShort()),0!==t){var e={};return 1&t&&(e.xPlacement=this.parseShort()),2&t&&(e.yPlacement=this.parseShort()),4&t&&(e.xAdvance=this.parseShort()),8&t&&(e.yAdvance=this.parseShort()),16&t&&(e.xPlaDevice=void 0,this.parseShort()),32&t&&(e.yPlaDevice=void 0,this.parseShort()),64&t&&(e.xAdvDevice=void 0,this.parseShort()),128&t&&(e.yAdvDevice=void 0,this.parseShort()),e}},st.prototype.parseValueRecordList=function(){for(var t=this.parseUShort(),e=this.parseUShort(),n=new Array(e),i=0;i<e;i++)n[i]=this.parseValueRecord(t);return n},st.prototype.parsePointer=function(t){var e=this.parseOffset16();if(e>0)return new st(this.data,this.offset+e).parseStruct(t)},st.prototype.parsePointer32=function(t){var e=this.parseOffset32();if(e>0)return new st(this.data,this.offset+e).parseStruct(t)},st.prototype.parseListOfLists=function(t){for(var e=this.parseOffset16List(),n=e.length,i=this.relativeOffset,r=new Array(n),o=0;o<n;o++){var s=e[o];if(0!==s)if(this.relativeOffset=s,t){for(var a=this.parseOffset16List(),c=new Array(a.length),l=0;l<a.length;l++)this.relativeOffset=s+a[l],c[l]=t.call(this);r[o]=c}else r[o]=this.parseUShortList();else r[o]=void 0}return this.relativeOffset=i,r},st.prototype.parseCoverage=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort(),n=this.parseUShort();if(1===e)return{format:1,glyphs:this.parseUShortList(n)};if(2===e){for(var i=new Array(n),r=0;r<n;r++)i[r]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:i}}throw new Error("0x"+t.toString(16)+": Coverage format must be 1 or 2.")},st.prototype.parseClassDef=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===e)return{format:2,ranges:this.parseRecordList({start:st.uShort,end:st.uShort,classId:st.uShort})};throw new Error("0x"+t.toString(16)+": ClassDef format must be 1 or 2.")},st.list=function(t,e){return function(){return this.parseList(t,e)}},st.list32=function(t,e){return function(){return this.parseList32(t,e)}},st.recordList=function(t,e){return function(){return this.parseRecordList(t,e)}},st.recordList32=function(t,e){return function(){return this.parseRecordList32(t,e)}},st.pointer=function(t){return function(){return this.parsePointer(t)}},st.pointer32=function(t){return function(){return this.parsePointer32(t)}},st.tag=st.prototype.parseTag,st.byte=st.prototype.parseByte,st.uShort=st.offset16=st.prototype.parseUShort,st.uShortList=st.prototype.parseUShortList,st.uLong=st.offset32=st.prototype.parseULong,st.uLongList=st.prototype.parseULongList,st.struct=st.prototype.parseStruct,st.coverage=st.prototype.parseCoverage,st.classDef=st.prototype.parseClassDef;var at={reserved:st.uShort,reqFeatureIndex:st.uShort,featureIndexes:st.uShortList};st.prototype.parseScriptList=function(){return this.parsePointer(st.recordList({tag:st.tag,script:st.pointer({defaultLangSys:st.pointer(at),langSysRecords:st.recordList({tag:st.tag,langSys:st.pointer(at)})})}))||[]},st.prototype.parseFeatureList=function(){return this.parsePointer(st.recordList({tag:st.tag,feature:st.pointer({featureParams:st.offset16,lookupListIndexes:st.uShortList})}))||[]},st.prototype.parseLookupList=function(t){return this.parsePointer(st.list(st.pointer((function(){var e=this.parseUShort();F.argument(1<=e&&e<=9,"GPOS/GSUB lookup type "+e+" unknown.");var n=this.parseUShort(),i=16&n;return{lookupType:e,lookupFlag:n,subtables:this.parseList(st.pointer(t[e])),markFilteringSet:i?this.parseUShort():void 0}}))))||[]},st.prototype.parseFeatureVariationsList=function(){return this.parsePointer32((function(){var t=this.parseUShort(),e=this.parseUShort();return F.argument(1===t&&e<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:st.offset32,featureTableSubstitutionOffset:st.offset32})}))||[]};var ct={getByte:et,getCard8:et,getUShort:nt,getCard16:nt,getShort:function(t,e){return t.getInt16(e,!1)},getULong:it,getFixed:rt,getTag:function(t,e){for(var n="",i=e;i<e+4;i+=1)n+=String.fromCharCode(t.getInt8(i));return n},getOffset:function(t,e,n){for(var i=0,r=0;r<n;r+=1)i<<=8,i+=t.getUint8(e+r);return i},getBytes:function(t,e,n){for(var i=[],r=e;r<n;r+=1)i.push(t.getUint8(r));return i},bytesToString:function(t){for(var e="",n=0;n<t.length;n+=1)e+=String.fromCharCode(t[n]);return e},Parser:st};function lt(t,e,n){t.segments.push({end:e,start:e,delta:-(e-n),offset:0,glyphIndex:n})}var ut={parse:function(t,e){var n={};n.version=ct.getUShort(t,e),F.argument(0===n.version,"cmap table version should be 0."),n.numTables=ct.getUShort(t,e+2);for(var i=-1,r=n.numTables-1;r>=0;r-=1){var o=ct.getUShort(t,e+4+8*r),s=ct.getUShort(t,e+4+8*r+2);if(3===o&&(0===s||1===s||10===s)||0===o&&(0===s||1===s||2===s||3===s||4===s)){i=ct.getULong(t,e+4+8*r+4);break}}if(-1===i)throw new Error("No valid cmap sub-tables found.");var a=new ct.Parser(t,e+i);if(n.format=a.parseUShort(),12===n.format)!function(t,e){var n;e.parseUShort(),t.length=e.parseULong(),t.language=e.parseULong(),t.groupCount=n=e.parseULong(),t.glyphIndexMap={};for(var i=0;i<n;i+=1)for(var r=e.parseULong(),o=e.parseULong(),s=e.parseULong(),a=r;a<=o;a+=1)t.glyphIndexMap[a]=s,s++}(n,a);else{if(4!==n.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+n.format+").");!function(t,e,n,i,r){var o;t.length=e.parseUShort(),t.language=e.parseUShort(),t.segCount=o=e.parseUShort()>>1,e.skip("uShort",3),t.glyphIndexMap={};for(var s=new ct.Parser(n,i+r+14),a=new ct.Parser(n,i+r+16+2*o),c=new ct.Parser(n,i+r+16+4*o),l=new ct.Parser(n,i+r+16+6*o),u=i+r+16+8*o,h=0;h<o-1;h+=1)for(var f=void 0,d=s.parseUShort(),p=a.parseUShort(),g=c.parseShort(),m=l.parseUShort(),v=p;v<=d;v+=1)0!==m?(u=l.offset+l.relativeOffset-2,u+=m,u+=2*(v-p),0!==(f=ct.getUShort(n,u))&&(f=f+g&65535)):f=v+g&65535,t.glyphIndexMap[v]=f}(n,a,t,e,i)}return n},make:function(t){var e,n=!0;for(e=t.length-1;e>0;e-=1){if(t.get(e).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),n=!1;break}}var i=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(i=i.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),i=i.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var r=new tt.Table("cmap",i);for(r.segments=[],e=0;e<t.length;e+=1){for(var o=t.get(e),s=0;s<o.unicodes.length;s+=1)lt(r,o.unicodes[s],e);r.segments=r.segments.sort((function(t,e){return t.start-e.start}))}!function(t){t.segments.push({end:65535,start:65535,delta:1,offset:0})}(r);var a=r.segments.length,c=0,l=[],u=[],h=[],f=[],d=[],p=[];for(e=0;e<a;e+=1){var g=r.segments[e];g.end<=65535&&g.start<=65535?(l=l.concat({name:"end_"+e,type:"USHORT",value:g.end}),u=u.concat({name:"start_"+e,type:"USHORT",value:g.start}),h=h.concat({name:"idDelta_"+e,type:"SHORT",value:g.delta}),f=f.concat({name:"idRangeOffset_"+e,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(d=d.concat({name:"glyph_"+e,type:"USHORT",value:g.glyphId}))):c+=1,n||void 0===g.glyphIndex||(p=(p=(p=p.concat({name:"cmap12Start_"+e,type:"ULONG",value:g.start})).concat({name:"cmap12End_"+e,type:"ULONG",value:g.end})).concat({name:"cmap12Glyph_"+e,type:"ULONG",value:g.glyphIndex}))}if(r.segCountX2=2*(a-c),r.searchRange=2*Math.pow(2,Math.floor(Math.log(a-c)/Math.log(2))),r.entrySelector=Math.log(r.searchRange/2)/Math.log(2),r.rangeShift=r.segCountX2-r.searchRange,r.fields=r.fields.concat(l),r.fields.push({name:"reservedPad",type:"USHORT",value:0}),r.fields=r.fields.concat(u),r.fields=r.fields.concat(h),r.fields=r.fields.concat(f),r.fields=r.fields.concat(d),r.cmap4Length=14+2*l.length+2+2*u.length+2*h.length+2*f.length+2*d.length,!n){var m=16+4*p.length;r.cmap12Offset=20+r.cmap4Length,r.fields=r.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:m},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:p.length/3}]),r.fields=r.fields.concat(p)}return r}},ht=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],ft=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],dt=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],pt=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function gt(t){this.font=t}function mt(t){this.cmap=t}function vt(t,e){this.encoding=t,this.charset=e}function yt(t){switch(t.version){case 1:this.names=pt.slice();break;case 2:this.names=new Array(t.numberOfGlyphs);for(var e=0;e<t.numberOfGlyphs;e++)t.glyphNameIndex[e]<pt.length?this.names[e]=pt[t.glyphNameIndex[e]]:this.names[e]=t.names[t.glyphNameIndex[e]-pt.length];break;case 2.5:this.names=new Array(t.numberOfGlyphs);for(var n=0;n<t.numberOfGlyphs;n++)this.names[n]=pt[n+t.glyphNameIndex[n]];break;case 3:default:this.names=[]}}function bt(t,e){e.lowMemory?function(t){t._IndexToUnicodeMap={};for(var e=t.tables.cmap.glyphIndexMap,n=Object.keys(e),i=0;i<n.length;i+=1){var r=n[i],o=e[r];void 0===t._IndexToUnicodeMap[o]?t._IndexToUnicodeMap[o]={unicodes:[parseInt(r)]}:t._IndexToUnicodeMap[o].unicodes.push(parseInt(r))}}(t):function(t){for(var e,n=t.tables.cmap.glyphIndexMap,i=Object.keys(n),r=0;r<i.length;r+=1){var o=i[r],s=n[o];(e=t.glyphs.get(s)).addUnicode(parseInt(o))}for(var a=0;a<t.glyphs.length;a+=1)e=t.glyphs.get(a),t.cffEncoding?t.isCIDFont?e.name="gid"+a:e.name=t.cffEncoding.charset[a]:t.glyphNames.names&&(e.name=t.glyphNames.glyphIndexToName(a))}(t)}gt.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),n=this.font.glyphs;if(n)for(var i=0;i<n.length;i+=1)for(var r=n.get(i),o=0;o<r.unicodes.length;o+=1)if(r.unicodes[o]===e)return i;return null},mt.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.codePointAt(0)]||0},vt.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),n=this.encoding[e];return this.charset.indexOf(n)},yt.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},yt.prototype.glyphIndexToName=function(t){return this.names[t]};var xt={line:function(t,e,n,i,r){t.beginPath(),t.moveTo(e,n),t.lineTo(i,r),t.stroke()}};function Ct(t){this.bindConstructorValues(t)}function St(t,e,n){Object.defineProperty(t,e,{get:function(){return t.path,t[n]},set:function(e){t[n]=e},enumerable:!0,configurable:!0})}function wt(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(var n=0;n<e.length;n++){var i=e[n];i.path.unitsPerEm=t.unitsPerEm,this.glyphs[n]=i}this.length=e&&e.length||0}Ct.prototype.bindConstructorValues=function(t){this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],"xMin"in t&&(this.xMin=t.xMin),"yMin"in t&&(this.yMin=t.yMin),"xMax"in t&&(this.xMax=t.xMax),"yMax"in t&&(this.yMax=t.yMax),"advanceWidth"in t&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",function(t,e){var n=e||new A;return{configurable:!0,get:function(){return"function"===typeof n&&(n=n()),n},set:function(t){n=t}}}(0,t.path))},Ct.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},Ct.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},Ct.prototype.getPath=function(t,e,n,i,r){var o,s;t=void 0!==t?t:0,e=void 0!==e?e:0,n=void 0!==n?n:72,i||(i={});var a=i.xScale,c=i.yScale;if(i.hinting&&r&&r.hinting&&(s=this.path&&r.hinting.exec(this,n)),s)o=r.hinting.getCommands(s),t=Math.round(t),e=Math.round(e),a=c=1;else{o=this.path.commands;var l=1/(this.path.unitsPerEm||1e3)*n;void 0===a&&(a=l),void 0===c&&(c=l)}for(var u=new A,h=0;h<o.length;h+=1){var f=o[h];"M"===f.type?u.moveTo(t+f.x*a,e+-f.y*c):"L"===f.type?u.lineTo(t+f.x*a,e+-f.y*c):"Q"===f.type?u.quadraticCurveTo(t+f.x1*a,e+-f.y1*c,t+f.x*a,e+-f.y*c):"C"===f.type?u.curveTo(t+f.x1*a,e+-f.y1*c,t+f.x2*a,e+-f.y2*c,t+f.x*a,e+-f.y*c):"Z"===f.type&&u.closePath()}return u},Ct.prototype.getContours=function(){if(void 0===this.points)return[];for(var t=[],e=[],n=0;n<this.points.length;n+=1){var i=this.points[n];e.push(i),i.lastPointOfContour&&(t.push(e),e=[])}return F.argument(0===e.length,"There are still points left in the current contour."),t},Ct.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],n=[],i=0;i<t.length;i+=1){var r=t[i];"Z"!==r.type&&(e.push(r.x),n.push(r.y)),"Q"!==r.type&&"C"!==r.type||(e.push(r.x1),n.push(r.y1)),"C"===r.type&&(e.push(r.x2),n.push(r.y2))}var o={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},Ct.prototype.draw=function(t,e,n,i,r){this.getPath(e,n,i,r).draw(t)},Ct.prototype.drawPoints=function(t,e,n,i){function r(e,n,i,r){t.beginPath();for(var o=0;o<e.length;o+=1)t.moveTo(n+e[o].x*r,i+e[o].y*r),t.arc(n+e[o].x*r,i+e[o].y*r,2,0,2*Math.PI,!1);t.closePath(),t.fill()}e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:24;for(var o=1/this.path.unitsPerEm*i,s=[],a=[],c=this.path,l=0;l<c.commands.length;l+=1){var u=c.commands[l];void 0!==u.x&&s.push({x:u.x,y:-u.y}),void 0!==u.x1&&a.push({x:u.x1,y:-u.y1}),void 0!==u.x2&&a.push({x:u.x2,y:-u.y2})}t.fillStyle="blue",r(s,e,n,o),t.fillStyle="red",r(a,e,n,o)},Ct.prototype.drawMetrics=function(t,e,n,i){var r;e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:24,r=1/this.path.unitsPerEm*i,t.lineWidth=1,t.strokeStyle="black",xt.line(t,e,-1e4,e,1e4),xt.line(t,-1e4,n,1e4,n);var o=this.xMin||0,s=this.yMin||0,a=this.xMax||0,c=this.yMax||0,l=this.advanceWidth||0;t.strokeStyle="blue",xt.line(t,e+o*r,-1e4,e+o*r,1e4),xt.line(t,e+a*r,-1e4,e+a*r,1e4),xt.line(t,-1e4,n+-s*r,1e4,n+-s*r),xt.line(t,-1e4,n+-c*r,1e4,n+-c*r),t.strokeStyle="green",xt.line(t,e+l*r,-1e4,e+l*r,1e4)},wt.prototype.get=function(t){if(void 0===this.glyphs[t]){this.font._push(t),"function"===typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]());var e=this.glyphs[t],n=this.font._IndexToUnicodeMap[t];if(n)for(var i=0;i<n.unicodes.length;i++)e.addUnicode(n.unicodes[i]);this.font.cffEncoding?this.font.isCIDFont?e.name="gid"+t:e.name=this.font.cffEncoding.charset[t]:this.font.glyphNames.names&&(e.name=this.font.glyphNames.glyphIndexToName(t)),this.glyphs[t].advanceWidth=this.font._hmtxTableData[t].advanceWidth,this.glyphs[t].leftSideBearing=this.font._hmtxTableData[t].leftSideBearing}else"function"===typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]());return this.glyphs[t]},wt.prototype.push=function(t,e){this.glyphs[t]=e,this.length++};var _t={GlyphSet:wt,glyphLoader:function(t,e){return new Ct({index:e,font:t})},ttfGlyphLoader:function(t,e,n,i,r,o){return function(){var s=new Ct({index:e,font:t});return s.path=function(){n(s,i,r);var e=o(t.glyphs,s);return e.unitsPerEm=t.unitsPerEm,e},St(s,"xMin","_xMin"),St(s,"xMax","_xMax"),St(s,"yMin","_yMin"),St(s,"yMax","_yMax"),s}},cffGlyphLoader:function(t,e,n,i){return function(){var r=new Ct({index:e,font:t});return r.path=function(){var e=n(t,r,i);return e.unitsPerEm=t.unitsPerEm,e},r}}};function Dt(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(!Dt(t[n],e[n]))return!1;return!0}return!1}function Tt(t){return t.length<1240?107:t.length<33900?1131:32768}function Et(t,e,n){var i,r,o=[],s=[],a=ct.getCard16(t,e);if(0!==a){var c=ct.getByte(t,e+2);i=e+(a+1)*c+2;for(var l=e+3,u=0;u<a+1;u+=1)o.push(ct.getOffset(t,l,c)),l+=c;r=i+o[a]}else r=e+2;for(var h=0;h<o.length-1;h+=1){var f=ct.getBytes(t,i+o[h],i+o[h+1]);n&&(f=n(f)),s.push(f)}return{objects:s,startOffset:e,endOffset:r}}function kt(t,e){if(28===e)return t.parseByte()<<8|t.parseByte();if(29===e)return t.parseByte()<<24|t.parseByte()<<16|t.parseByte()<<8|t.parseByte();if(30===e)return function(t){for(var e="",n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var i=t.parseByte(),r=i>>4,o=15&i;if(15===r)break;if(e+=n[r],15===o)break;e+=n[o]}return parseFloat(e)}(t);if(e>=32&&e<=246)return e-139;if(e>=247&&e<=250)return 256*(e-247)+t.parseByte()+108;if(e>=251&&e<=254)return 256*-(e-251)-t.parseByte()-108;throw new Error("Invalid b0 "+e)}function Ot(t,e,n){e=void 0!==e?e:0;var i=new ct.Parser(t,e),r=[],o=[];for(n=void 0!==n?n:t.length;i.relativeOffset<n;){var s=i.parseByte();s<=21?(12===s&&(s=1200+i.parseByte()),r.push([s,o]),o=[]):o.push(kt(i,s))}return function(t){for(var e={},n=0;n<t.length;n+=1){var i=t[n][0],r=t[n][1],o=void 0;if(o=1===r.length?r[0]:r,e.hasOwnProperty(i)&&!isNaN(e[i]))throw new Error("Object "+e+" already has key "+i);e[i]=o}return e}(r)}function At(t,e){return e=e<=390?ht[e]:t[e-391]}function Pt(t,e,n){for(var i,r={},o=0;o<e.length;o+=1){var s=e[o];if(Array.isArray(s.type)){var a=[];a.length=s.type.length;for(var c=0;c<s.type.length;c++)void 0===(i=void 0!==t[s.op]?t[s.op][c]:void 0)&&(i=void 0!==s.value&&void 0!==s.value[c]?s.value[c]:null),"SID"===s.type[c]&&(i=At(n,i)),a[c]=i;r[s.name]=a}else void 0===(i=t[s.op])&&(i=void 0!==s.value?s.value:null),"SID"===s.type&&(i=At(n,i)),r[s.name]=i}return r}var It=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Ft=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function Mt(t,e){return Pt(Ot(t,0,t.byteLength),It,e)}function Lt(t,e,n,i){return Pt(Ot(t,e,n),Ft,i)}function Rt(t,e,n,i){for(var r=[],o=0;o<n.length;o+=1){var s=Mt(new DataView(new Uint8Array(n[o]).buffer),i);s._subrs=[],s._subrsBias=0;var a=s.private[0],c=s.private[1];if(0!==a&&0!==c){var l=Lt(t,c+e,a,i);if(s._defaultWidthX=l.defaultWidthX,s._nominalWidthX=l.nominalWidthX,0!==l.subrs){var u=Et(t,c+l.subrs+e);s._subrs=u.objects,s._subrsBias=Tt(s._subrs)}s._privateDict=l}r.push(s)}return r}function jt(t,e,n){var i,r,o,s,a,c,l,u,h=new A,f=[],d=0,p=!1,g=!1,m=0,v=0;if(t.isCIDFont){var y=t.tables.cff.topDict._fdSelect[e.index],b=t.tables.cff.topDict._fdArray[y];a=b._subrs,c=b._subrsBias,l=b._defaultWidthX,u=b._nominalWidthX}else a=t.tables.cff.topDict._subrs,c=t.tables.cff.topDict._subrsBias,l=t.tables.cff.topDict._defaultWidthX,u=t.tables.cff.topDict._nominalWidthX;var x=l;function C(t,e){g&&h.closePath(),h.moveTo(t,e),g=!0}function S(){f.length%2!==0&&!p&&(x=f.shift()+u),d+=f.length>>1,f.length=0,p=!0}return function n(l){for(var y,b,w,_,D,T,E,k,O,A,P,I,F=0;F<l.length;){var M=l[F];switch(F+=1,M){case 1:case 3:S();break;case 4:f.length>1&&!p&&(x=f.shift()+u,p=!0),v+=f.pop(),C(m,v);break;case 5:for(;f.length>0;)m+=f.shift(),v+=f.shift(),h.lineTo(m,v);break;case 6:for(;f.length>0&&(m+=f.shift(),h.lineTo(m,v),0!==f.length);)v+=f.shift(),h.lineTo(m,v);break;case 7:for(;f.length>0&&(v+=f.shift(),h.lineTo(m,v),0!==f.length);)m+=f.shift(),h.lineTo(m,v);break;case 8:for(;f.length>0;)i=m+f.shift(),r=v+f.shift(),o=i+f.shift(),s=r+f.shift(),m=o+f.shift(),v=s+f.shift(),h.curveTo(i,r,o,s,m,v);break;case 10:D=f.pop()+c,(T=a[D])&&n(T);break;case 11:return;case 12:switch(M=l[F],F+=1,M){case 35:i=m+f.shift(),r=v+f.shift(),o=i+f.shift(),s=r+f.shift(),E=o+f.shift(),k=s+f.shift(),O=E+f.shift(),A=k+f.shift(),P=O+f.shift(),I=A+f.shift(),m=P+f.shift(),v=I+f.shift(),f.shift(),h.curveTo(i,r,o,s,E,k),h.curveTo(O,A,P,I,m,v);break;case 34:i=m+f.shift(),r=v,o=i+f.shift(),s=r+f.shift(),E=o+f.shift(),k=s,O=E+f.shift(),A=s,P=O+f.shift(),I=v,m=P+f.shift(),h.curveTo(i,r,o,s,E,k),h.curveTo(O,A,P,I,m,v);break;case 36:i=m+f.shift(),r=v+f.shift(),o=i+f.shift(),s=r+f.shift(),E=o+f.shift(),k=s,O=E+f.shift(),A=s,P=O+f.shift(),I=A+f.shift(),m=P+f.shift(),h.curveTo(i,r,o,s,E,k),h.curveTo(O,A,P,I,m,v);break;case 37:i=m+f.shift(),r=v+f.shift(),o=i+f.shift(),s=r+f.shift(),E=o+f.shift(),k=s+f.shift(),O=E+f.shift(),A=k+f.shift(),P=O+f.shift(),I=A+f.shift(),Math.abs(P-m)>Math.abs(I-v)?m=P+f.shift():v=I+f.shift(),h.curveTo(i,r,o,s,E,k),h.curveTo(O,A,P,I,m,v);break;default:console.log("Glyph "+e.index+": unknown operator 1200"+M),f.length=0}break;case 14:f.length>0&&!p&&(x=f.shift()+u,p=!0),g&&(h.closePath(),g=!1);break;case 18:S();break;case 19:case 20:S(),F+=d+7>>3;break;case 21:f.length>2&&!p&&(x=f.shift()+u,p=!0),v+=f.pop(),C(m+=f.pop(),v);break;case 22:f.length>1&&!p&&(x=f.shift()+u,p=!0),C(m+=f.pop(),v);break;case 23:S();break;case 24:for(;f.length>2;)i=m+f.shift(),r=v+f.shift(),o=i+f.shift(),s=r+f.shift(),m=o+f.shift(),v=s+f.shift(),h.curveTo(i,r,o,s,m,v);m+=f.shift(),v+=f.shift(),h.lineTo(m,v);break;case 25:for(;f.length>6;)m+=f.shift(),v+=f.shift(),h.lineTo(m,v);i=m+f.shift(),r=v+f.shift(),o=i+f.shift(),s=r+f.shift(),m=o+f.shift(),v=s+f.shift(),h.curveTo(i,r,o,s,m,v);break;case 26:for(f.length%2&&(m+=f.shift());f.length>0;)i=m,r=v+f.shift(),o=i+f.shift(),s=r+f.shift(),m=o,v=s+f.shift(),h.curveTo(i,r,o,s,m,v);break;case 27:for(f.length%2&&(v+=f.shift());f.length>0;)i=m+f.shift(),r=v,o=i+f.shift(),s=r+f.shift(),m=o+f.shift(),v=s,h.curveTo(i,r,o,s,m,v);break;case 28:y=l[F],b=l[F+1],f.push((y<<24|b<<16)>>16),F+=2;break;case 29:D=f.pop()+t.gsubrsBias,(T=t.gsubrs[D])&&n(T);break;case 30:for(;f.length>0&&(i=m,r=v+f.shift(),o=i+f.shift(),s=r+f.shift(),m=o+f.shift(),v=s+(1===f.length?f.shift():0),h.curveTo(i,r,o,s,m,v),0!==f.length);)i=m+f.shift(),r=v,o=i+f.shift(),s=r+f.shift(),v=s+f.shift(),m=o+(1===f.length?f.shift():0),h.curveTo(i,r,o,s,m,v);break;case 31:for(;f.length>0&&(i=m+f.shift(),r=v,o=i+f.shift(),s=r+f.shift(),v=s+f.shift(),m=o+(1===f.length?f.shift():0),h.curveTo(i,r,o,s,m,v),0!==f.length);)i=m,r=v+f.shift(),o=i+f.shift(),s=r+f.shift(),m=o+f.shift(),v=s+(1===f.length?f.shift():0),h.curveTo(i,r,o,s,m,v);break;default:M<32?console.log("Glyph "+e.index+": unknown operator "+M):M<247?f.push(M-139):M<251?(y=l[F],F+=1,f.push(256*(M-247)+y+108)):M<255?(y=l[F],F+=1,f.push(256*-(M-251)-y-108)):(y=l[F],b=l[F+1],w=l[F+2],_=l[F+3],F+=4,f.push((y<<24|b<<16|w<<8|_)/65536))}}}(n),e.advanceWidth=x,h}function Bt(t,e){var n,i=ht.indexOf(t);return i>=0&&(n=i),(i=e.indexOf(t))>=0?n=i+ht.length:(n=ht.length+e.length,e.push(t)),n}function Ut(t,e,n){for(var i={},r=0;r<t.length;r+=1){var o=t[r],s=e[o.name];void 0===s||Dt(s,o.value)||("SID"===o.type&&(s=Bt(s,n)),i[o.op]={name:o.name,type:o.type,value:s})}return i}function zt(t,e){var n=new tt.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Ut(It,t,e),n}function Nt(t){var e=new tt.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function Wt(t){var e=[],n=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var i=0,r=0,o=0;o<n.commands.length;o+=1){var s=void 0,a=void 0,c=n.commands[o];if("Q"===c.type){c={type:"C",x:c.x,y:c.y,x1:1/3*i+2/3*c.x1,y1:1/3*r+2/3*c.y1,x2:1/3*c.x+2/3*c.x1,y2:1/3*c.y+2/3*c.y1}}if("M"===c.type)s=Math.round(c.x-i),a=Math.round(c.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(c.x),r=Math.round(c.y);else if("L"===c.type)s=Math.round(c.x-i),a=Math.round(c.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rlineto",type:"OP",value:5}),i=Math.round(c.x),r=Math.round(c.y);else if("C"===c.type){var l=Math.round(c.x1-i),u=Math.round(c.y1-r),h=Math.round(c.x2-c.x1),f=Math.round(c.y2-c.y1);s=Math.round(c.x-c.x2),a=Math.round(c.y-c.y2),e.push({name:"dx1",type:"NUMBER",value:l}),e.push({name:"dy1",type:"NUMBER",value:u}),e.push({name:"dx2",type:"NUMBER",value:h}),e.push({name:"dy2",type:"NUMBER",value:f}),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(c.x),r=Math.round(c.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}var Ht={parse:function(t,e,n,i){n.tables.cff={};var r=function(t,e){var n={};return n.formatMajor=ct.getCard8(t,e),n.formatMinor=ct.getCard8(t,e+1),n.size=ct.getCard8(t,e+2),n.offsetSize=ct.getCard8(t,e+3),n.startOffset=e,n.endOffset=e+4,n}(t,e),o=Et(t,r.endOffset,ct.bytesToString),s=Et(t,o.endOffset),a=Et(t,s.endOffset,ct.bytesToString),c=Et(t,a.endOffset);n.gsubrs=c.objects,n.gsubrsBias=Tt(n.gsubrs);var l=Rt(t,e,s.objects,a.objects);if(1!==l.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+l.length);var u=l[0];if(n.tables.cff.topDict=u,u._privateDict&&(n.defaultWidthX=u._privateDict.defaultWidthX,n.nominalWidthX=u._privateDict.nominalWidthX),void 0!==u.ros[0]&&void 0!==u.ros[1]&&(n.isCIDFont=!0),n.isCIDFont){var h=u.fdArray,f=u.fdSelect;if(0===h||0===f)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");var d=Et(t,h+=e),p=Rt(t,e,d.objects,a.objects);u._fdArray=p,f+=e,u._fdSelect=function(t,e,n,i){var r,o=[],s=new ct.Parser(t,e),a=s.parseCard8();if(0===a)for(var c=0;c<n;c++){if((r=s.parseCard8())>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+i+")");o.push(r)}else{if(3!==a)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+a);var l,u=s.parseCard16(),h=s.parseCard16();if(0!==h)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+h);for(var f=0;f<u;f++){if(r=s.parseCard8(),l=s.parseCard16(),r>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+i+")");if(l>n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+l);for(;h<l;h++)o.push(r);h=l}if(l!==n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+l)}return o}(t,f,n.numGlyphs,p.length)}var g,m=e+u.private[1],v=Lt(t,m,u.private[0],a.objects);if(n.defaultWidthX=v.defaultWidthX,n.nominalWidthX=v.nominalWidthX,0!==v.subrs){var y=m+v.subrs,b=Et(t,y);n.subrs=b.objects,n.subrsBias=Tt(n.subrs)}else n.subrs=[],n.subrsBias=0;i.lowMemory?(g=function(t,e){var n,i,r=[],o=ct.getCard16(t,e);if(0!==o){var s=ct.getByte(t,e+2);n=e+(o+1)*s+2;for(var a=e+3,c=0;c<o+1;c+=1)r.push(ct.getOffset(t,a,s)),a+=s;i=n+r[o]}else i=e+2;return{offsets:r,startOffset:e,endOffset:i}}(t,e+u.charStrings),n.nGlyphs=g.offsets.length):(g=Et(t,e+u.charStrings),n.nGlyphs=g.objects.length);var x=function(t,e,n,i){var r,o,s=new ct.Parser(t,e);n-=1;var a=[".notdef"],c=s.parseCard8();if(0===c)for(var l=0;l<n;l+=1)r=s.parseSID(),a.push(At(i,r));else if(1===c)for(;a.length<=n;){r=s.parseSID(),o=s.parseCard8();for(var u=0;u<=o;u+=1)a.push(At(i,r)),r+=1}else{if(2!==c)throw new Error("Unknown charset format "+c);for(;a.length<=n;){r=s.parseSID(),o=s.parseCard16();for(var h=0;h<=o;h+=1)a.push(At(i,r)),r+=1}}return a}(t,e+u.charset,n.nGlyphs,a.objects);if(0===u.encoding?n.cffEncoding=new vt(ft,x):1===u.encoding?n.cffEncoding=new vt(dt,x):n.cffEncoding=function(t,e,n){var i,r={},o=new ct.Parser(t,e),s=o.parseCard8();if(0===s)for(var a=o.parseCard8(),c=0;c<a;c+=1)r[i=o.parseCard8()]=c;else{if(1!==s)throw new Error("Unknown encoding format "+s);var l=o.parseCard8();i=1;for(var u=0;u<l;u+=1)for(var h=o.parseCard8(),f=o.parseCard8(),d=h;d<=h+f;d+=1)r[d]=i,i+=1}return new vt(r,n)}(t,e+u.encoding,x),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new _t.GlyphSet(n),i.lowMemory)n._push=function(i){var r=function(t,e,n,i,r){var o=ct.getCard16(n,i),s=0;0!==o&&(s=i+(o+1)*ct.getByte(n,i+2)+2);var a=ct.getBytes(n,s+e[t],s+e[t+1]);return r&&(a=r(a)),a}(i,g.offsets,t,e+u.charStrings);n.glyphs.push(i,_t.cffGlyphLoader(n,i,jt,r))};else for(var C=0;C<n.nGlyphs;C+=1){var S=g.objects[C];n.glyphs.push(C,_t.cffGlyphLoader(n,C,jt,S))}},make:function(t,e){for(var n,i=new tt.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),r=1/e.unitsPerEm,o={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontBBox:e.fontBBox||[0,0,0,0],fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},s=[],a=1;a<t.length;a+=1)n=t.get(a),s.push(n.name);var c=[];i.header=new tt.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),i.nameIndex=function(t){var e=new tt.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var n=0;n<t.length;n+=1)e.names.push({name:"name_"+n,type:"NAME",value:t[n]});return e}([e.postScriptName]);var l=zt(o,c);i.topDictIndex=Nt(l),i.globalSubrIndex=new tt.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),i.charsets=function(t,e){for(var n=new tt.Record("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<t.length;i+=1){var r=Bt(t[i],e);n.fields.push({name:"glyph_"+i,type:"SID",value:r})}return n}(s,c),i.charStringsIndex=function(t){for(var e=new tt.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),n=0;n<t.length;n+=1){var i=t.get(n),r=Wt(i);e.charStrings.push({name:i.name,type:"CHARSTRING",value:r})}return e}(t),i.privateDict=function(t,e){var n=new tt.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Ut(Ft,t,e),n}({},c),i.stringIndex=function(t){var e=new tt.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var n=0;n<t.length;n+=1)e.strings.push({name:"string_"+n,type:"STRING",value:t[n]});return e}(c);var u=i.header.sizeOf()+i.nameIndex.sizeOf()+i.topDictIndex.sizeOf()+i.stringIndex.sizeOf()+i.globalSubrIndex.sizeOf();return o.charset=u,o.encoding=0,o.charStrings=o.charset+i.charsets.sizeOf(),o.private[1]=o.charStrings+i.charStringsIndex.sizeOf(),l=zt(o,c),i.topDictIndex=Nt(l),i}};var Xt={parse:function(t,e){var n={},i=new ct.Parser(t,e);return n.version=i.parseVersion(),n.fontRevision=Math.round(1e3*i.parseFixed())/1e3,n.checkSumAdjustment=i.parseULong(),n.magicNumber=i.parseULong(),F.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=i.parseUShort(),n.unitsPerEm=i.parseUShort(),n.created=i.parseLongDateTime(),n.modified=i.parseLongDateTime(),n.xMin=i.parseShort(),n.yMin=i.parseShort(),n.xMax=i.parseShort(),n.yMax=i.parseShort(),n.macStyle=i.parseUShort(),n.lowestRecPPEM=i.parseUShort(),n.fontDirectionHint=i.parseShort(),n.indexToLocFormat=i.parseShort(),n.glyphDataFormat=i.parseShort(),n},make:function(t){var e=Math.round((new Date).getTime()/1e3)+2082844800,n=e;return t.createdTimestamp&&(n=t.createdTimestamp+2082844800),new tt.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}};var Gt={parse:function(t,e){var n={},i=new ct.Parser(t,e);return n.version=i.parseVersion(),n.ascender=i.parseShort(),n.descender=i.parseShort(),n.lineGap=i.parseShort(),n.advanceWidthMax=i.parseUShort(),n.minLeftSideBearing=i.parseShort(),n.minRightSideBearing=i.parseShort(),n.xMaxExtent=i.parseShort(),n.caretSlopeRise=i.parseShort(),n.caretSlopeRun=i.parseShort(),n.caretOffset=i.parseShort(),i.relativeOffset+=8,n.metricDataFormat=i.parseShort(),n.numberOfHMetrics=i.parseUShort(),n},make:function(t){return new tt.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}};var Yt={parse:function(t,e,n,i,r,o,s){s.lowMemory?function(t,e,n,i,r){var o,s;t._hmtxTableData={};for(var a=new ct.Parser(e,n),c=0;c<r;c+=1)c<i&&(o=a.parseUShort(),s=a.parseShort()),t._hmtxTableData[c]={advanceWidth:o,leftSideBearing:s}}(t,e,n,i,r):function(t,e,n,i,r){for(var o,s,a=new ct.Parser(t,e),c=0;c<i;c+=1){c<n&&(o=a.parseUShort(),s=a.parseShort());var l=r.get(c);l.advanceWidth=o,l.leftSideBearing=s}}(e,n,i,r,o)},make:function(t){for(var e=new tt.Table("hmtx",[]),n=0;n<t.length;n+=1){var i=t.get(n),r=i.advanceWidth||0,o=i.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:r}),e.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:o})}return e}};var qt={make:function(t){for(var e=new tt.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:t.length}]),n="",i=12+4*t.length,r=0;r<t.length;++r){var o=n.indexOf(t[r]);o<0&&(o=n.length,n+=t[r]),e.fields.push({name:"offset "+r,type:"USHORT",value:i+o}),e.fields.push({name:"length "+r,type:"USHORT",value:t[r].length})}return e.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),e},parse:function(t,e){var n=new ct.Parser(t,e),i=n.parseULong();F.argument(1===i,"Unsupported ltag table version."),n.skip("uLong",1);for(var r=n.parseULong(),o=[],s=0;s<r;s++){for(var a="",c=e+n.parseUShort(),l=n.parseUShort(),u=c;u<c+l;++u)a+=String.fromCharCode(t.getInt8(u));o.push(a)}return o}};var Vt={parse:function(t,e){var n={},i=new ct.Parser(t,e);return n.version=i.parseVersion(),n.numGlyphs=i.parseUShort(),1===n.version&&(n.maxPoints=i.parseUShort(),n.maxContours=i.parseUShort(),n.maxCompositePoints=i.parseUShort(),n.maxCompositeContours=i.parseUShort(),n.maxZones=i.parseUShort(),n.maxTwilightPoints=i.parseUShort(),n.maxStorage=i.parseUShort(),n.maxFunctionDefs=i.parseUShort(),n.maxInstructionDefs=i.parseUShort(),n.maxStackElements=i.parseUShort(),n.maxSizeOfInstructions=i.parseUShort(),n.maxComponentElements=i.parseUShort(),n.maxComponentDepth=i.parseUShort()),n},make:function(t){return new tt.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}},Zt=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Qt={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Kt={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},$t={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function Jt(t,e,n){switch(t){case 0:if(65535===e)return"und";if(n)return n[e];break;case 1:return Qt[e];case 3:return $t[e]}}var te="utf-16",ee={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},ne={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function ie(t,e,n){switch(t){case 0:return te;case 1:return ne[n]||ee[e];case 3:if(1===e||10===e)return te}}function re(t){var e={};for(var n in t)e[t[n]]=parseInt(n);return e}function oe(t,e,n,i,r,o){return new tt.Record("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:o}])}function se(t,e){var n=function(t,e){var n=t.length,i=e.length-n+1;t:for(var r=0;r<i;r++)for(;r<i;r++){for(var o=0;o<n;o++)if(e[r+o]!==t[o])continue t;return r}return-1}(t,e);if(n<0){n=e.length;for(var i=0,r=t.length;i<r;++i)e.push(t[i])}return n}var ae={parse:function(t,e,n){for(var i={},r=new ct.Parser(t,e),o=r.parseUShort(),s=r.parseUShort(),a=r.offset+r.parseUShort(),c=0;c<s;c++){var l=r.parseUShort(),u=r.parseUShort(),h=r.parseUShort(),f=r.parseUShort(),d=Zt[f]||f,p=r.parseUShort(),g=r.parseUShort(),m=Jt(l,h,n),v=ie(l,u,h);if(void 0!==v&&void 0!==m){var y=void 0;if(y=v===te?M.UTF16(t,a+g,p):M.MACSTRING(t,a+g,p,v)){var b=i[d];void 0===b&&(b=i[d]={}),b[m]=y}}}return 1===o&&r.parseUShort(),i},make:function(t,e){var n,i=[],r={},o=re(Zt);for(var s in t){var a=o[s];if(void 0===a&&(a=s),n=parseInt(a),isNaN(n))throw new Error('Name table entry "'+s+'" does not exist, see nameTableNames for complete list.');r[n]=t[s],i.push(n)}for(var c=re(Qt),l=re($t),u=[],h=[],f=0;f<i.length;f++){var d=r[n=i[f]];for(var p in d){var g=d[p],m=1,v=c[p],y=Kt[v],b=ie(m,y,v),x=L.MACSTRING(g,b);void 0===x&&(m=0,(v=e.indexOf(p))<0&&(v=e.length,e.push(p)),y=4,x=L.UTF16(g));var C=se(x,h);u.push(oe(m,y,v,n,x.length,C));var S=l[p];if(void 0!==S){var w=L.UTF16(g),_=se(w,h);u.push(oe(3,1,S,n,w.length,_))}}}u.sort((function(t,e){return t.platformID-e.platformID||t.encodingID-e.encodingID||t.languageID-e.languageID||t.nameID-e.nameID}));for(var D=new tt.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:u.length},{name:"stringOffset",type:"USHORT",value:6+12*u.length}]),T=0;T<u.length;T++)D.fields.push({name:"record_"+T,type:"RECORD",value:u[T]});return D.fields.push({name:"strings",type:"LITERAL",value:h}),D}},ce=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];var le={parse:function(t,e){var n={},i=new ct.Parser(t,e);n.version=i.parseUShort(),n.xAvgCharWidth=i.parseShort(),n.usWeightClass=i.parseUShort(),n.usWidthClass=i.parseUShort(),n.fsType=i.parseUShort(),n.ySubscriptXSize=i.parseShort(),n.ySubscriptYSize=i.parseShort(),n.ySubscriptXOffset=i.parseShort(),n.ySubscriptYOffset=i.parseShort(),n.ySuperscriptXSize=i.parseShort(),n.ySuperscriptYSize=i.parseShort(),n.ySuperscriptXOffset=i.parseShort(),n.ySuperscriptYOffset=i.parseShort(),n.yStrikeoutSize=i.parseShort(),n.yStrikeoutPosition=i.parseShort(),n.sFamilyClass=i.parseShort(),n.panose=[];for(var r=0;r<10;r++)n.panose[r]=i.parseByte();return n.ulUnicodeRange1=i.parseULong(),n.ulUnicodeRange2=i.parseULong(),n.ulUnicodeRange3=i.parseULong(),n.ulUnicodeRange4=i.parseULong(),n.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),n.fsSelection=i.parseUShort(),n.usFirstCharIndex=i.parseUShort(),n.usLastCharIndex=i.parseUShort(),n.sTypoAscender=i.parseShort(),n.sTypoDescender=i.parseShort(),n.sTypoLineGap=i.parseShort(),n.usWinAscent=i.parseUShort(),n.usWinDescent=i.parseUShort(),n.version>=1&&(n.ulCodePageRange1=i.parseULong(),n.ulCodePageRange2=i.parseULong()),n.version>=2&&(n.sxHeight=i.parseShort(),n.sCapHeight=i.parseShort(),n.usDefaultChar=i.parseUShort(),n.usBreakChar=i.parseUShort(),n.usMaxContent=i.parseUShort()),n},make:function(t){return new tt.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)},unicodeRanges:ce,getUnicodeRange:function(t){for(var e=0;e<ce.length;e+=1){var n=ce[e];if(t>=n.begin&&t<n.end)return e}return-1}};var ue={parse:function(t,e){var n={},i=new ct.Parser(t,e);switch(n.version=i.parseVersion(),n.italicAngle=i.parseFixed(),n.underlinePosition=i.parseShort(),n.underlineThickness=i.parseShort(),n.isFixedPitch=i.parseULong(),n.minMemType42=i.parseULong(),n.maxMemType42=i.parseULong(),n.minMemType1=i.parseULong(),n.maxMemType1=i.parseULong(),n.version){case 1:n.names=pt.slice();break;case 2:n.numberOfGlyphs=i.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs);for(var r=0;r<n.numberOfGlyphs;r++)n.glyphNameIndex[r]=i.parseUShort();n.names=[];for(var o=0;o<n.numberOfGlyphs;o++)if(n.glyphNameIndex[o]>=pt.length){var s=i.parseChar();n.names.push(i.parseString(s))}break;case 2.5:n.numberOfGlyphs=i.parseUShort(),n.offset=new Array(n.numberOfGlyphs);for(var a=0;a<n.numberOfGlyphs;a++)n.offset[a]=i.parseChar()}return n},make:function(){return new tt.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},he=new Array(9);he[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(st.coverage),deltaGlyphId:this.parseUShort()}:2===e?{substFormat:2,coverage:this.parsePointer(st.coverage),substitute:this.parseOffset16List()}:void F.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")},he[2]=function(){var t=this.parseUShort();return F.argument(1===t,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(st.coverage),sequences:this.parseListOfLists()}},he[3]=function(){var t=this.parseUShort();return F.argument(1===t,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(st.coverage),alternateSets:this.parseListOfLists()}},he[4]=function(){var t=this.parseUShort();return F.argument(1===t,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(st.coverage),ligatureSets:this.parseListOfLists((function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}}))}};var fe={sequenceIndex:st.uShort,lookupListIndex:st.uShort};he[5]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{substFormat:e,coverage:this.parsePointer(st.coverage),ruleSets:this.parseListOfLists((function(){var t=this.parseUShort(),e=this.parseUShort();return{input:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,fe)}}))};if(2===e)return{substFormat:e,coverage:this.parsePointer(st.coverage),classDef:this.parsePointer(st.classDef),classSets:this.parseListOfLists((function(){var t=this.parseUShort(),e=this.parseUShort();return{classes:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,fe)}}))};if(3===e){var n=this.parseUShort(),i=this.parseUShort();return{substFormat:e,coverages:this.parseList(n,st.pointer(st.coverage)),lookupRecords:this.parseRecordList(i,fe)}}F.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},he[6]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(st.coverage),chainRuleSets:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(fe)}}))}:2===e?{substFormat:2,coverage:this.parsePointer(st.coverage),backtrackClassDef:this.parsePointer(st.classDef),inputClassDef:this.parsePointer(st.classDef),lookaheadClassDef:this.parsePointer(st.classDef),chainClassSet:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(fe)}}))}:3===e?{substFormat:3,backtrackCoverage:this.parseList(st.pointer(st.coverage)),inputCoverage:this.parseList(st.pointer(st.coverage)),lookaheadCoverage:this.parseList(st.pointer(st.coverage)),lookupRecords:this.parseRecordList(fe)}:void F.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},he[7]=function(){var t=this.parseUShort();F.argument(1===t,"GSUB Extension Substitution subtable identifier-format must be 1");var e=this.parseUShort(),n=new st(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:e,extension:he[e].call(n)}},he[8]=function(){var t=this.parseUShort();return F.argument(1===t,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(st.coverage),backtrackCoverage:this.parseList(st.pointer(st.coverage)),lookaheadCoverage:this.parseList(st.pointer(st.coverage)),substitutes:this.parseUShortList()}};var de=new Array(9);de[1]=function(t){return 1===t.substFormat?new tt.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new tt.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new tt.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new tt.Coverage(t.coverage)}].concat(tt.ushortList("substitute",t.substitute)))},de[3]=function(t){return F.assert(1===t.substFormat,"Lookup type 3 substFormat must be 1."),new tt.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new tt.Coverage(t.coverage)}].concat(tt.tableList("altSet",t.alternateSets,(function(t){return new tt.Table("alternateSetTable",tt.ushortList("alternate",t))}))))},de[4]=function(t){return F.assert(1===t.substFormat,"Lookup type 4 substFormat must be 1."),new tt.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new tt.Coverage(t.coverage)}].concat(tt.tableList("ligSet",t.ligatureSets,(function(t){return new tt.Table("ligatureSetTable",tt.tableList("ligature",t,(function(t){return new tt.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:t.ligGlyph}].concat(tt.ushortList("component",t.components,t.components.length+1)))})))}))))};var pe={parse:function(t,e){var n=new st(t,e=e||0),i=n.parseVersion(1);return F.argument(1===i||1.1===i,"Unsupported GSUB table version."),1===i?{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(he)}:{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(he),variations:n.parseFeatureVariationsList()}},make:function(t){return new tt.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new tt.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new tt.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new tt.LookupList(t.lookups,de)}])}};var ge={parse:function(t,e){var n=new ct.Parser(t,e),i=n.parseULong();F.argument(1===i,"Unsupported META table version."),n.parseULong(),n.parseULong();for(var r=n.parseULong(),o={},s=0;s<r;s++){var a=n.parseTag(),c=n.parseULong(),l=n.parseULong(),u=M.UTF8(t,e+c,l);o[a]=u}return o},make:function(t){var e=Object.keys(t).length,n="",i=16+12*e,r=new tt.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:e}]);for(var o in t){var s=n.length;n+=t[o],r.fields.push({name:"tag "+o,type:"TAG",value:o}),r.fields.push({name:"offset "+o,type:"ULONG",value:i+s}),r.fields.push({name:"length "+o,type:"ULONG",value:t[o].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),r}};function me(t){return Math.log(t)/Math.log(2)|0}function ve(t){for(;t.length%4!==0;)t.push(0);for(var e=0,n=0;n<t.length;n+=4)e+=(t[n]<<24)+(t[n+1]<<16)+(t[n+2]<<8)+t[n+3];return e%=Math.pow(2,32)}function ye(t,e,n,i){return new tt.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==i?i:0}])}function be(t){var e=new tt.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var n=Math.pow(2,me(e.numTables));e.searchRange=16*n,e.entrySelector=me(n),e.rangeShift=16*e.numTables-e.searchRange;for(var i=[],r=[],o=e.sizeOf()+ye().sizeOf()*e.numTables;o%4!==0;)o+=1,r.push({name:"padding",type:"BYTE",value:0});for(var s=0;s<t.length;s+=1){var a=t[s];F.argument(4===a.tableName.length,"Table name"+a.tableName+" is invalid.");var c=a.sizeOf(),l=ye(a.tableName,ve(a.encode()),o,c);for(i.push({name:l.tag+" Table Record",type:"RECORD",value:l}),r.push({name:a.tableName+" table",type:"RECORD",value:a}),o+=c,F.argument(!isNaN(o),"Something went wrong calculating the offset.");o%4!==0;)o+=1,r.push({name:"padding",type:"BYTE",value:0})}return i.sort((function(t,e){return t.value.tag>e.value.tag?1:-1})),e.fields=e.fields.concat(i),e.fields=e.fields.concat(r),e}function xe(t,e,n){for(var i=0;i<e.length;i+=1){var r=t.charToGlyphIndex(e[i]);if(r>0)return t.glyphs.get(r).getMetrics()}return n}function Ce(t){for(var e=0,n=0;n<t.length;n+=1)e+=t[n];return e/t.length}var Se={make:be,fontToTable:function(t){for(var e,n=[],i=[],r=[],o=[],s=[],a=[],c=[],l=0,u=0,h=0,f=0,d=0,p=0;p<t.glyphs.length;p+=1){var g=t.glyphs.get(p),m=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+p+"): advanceWidth is not a number.");(e>m||void 0===e)&&m>0&&(e=m),l<m&&(l=m);var v=le.getUnicodeRange(m);if(v<32)u|=1<<v;else if(v<64)h|=1<<v-32;else if(v<96)f|=1<<v-64;else{if(!(v<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");d|=1<<v-96}if(".notdef"!==g.name){var y=g.getMetrics();n.push(y.xMin),i.push(y.yMin),r.push(y.xMax),o.push(y.yMax),a.push(y.leftSideBearing),c.push(y.rightSideBearing),s.push(g.advanceWidth)}}var b={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,s),advanceWidthAvg:Ce(s),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,c)};b.ascender=t.ascender,b.descender=t.descender;var x=Xt.make({flags:3,unitsPerEm:t.unitsPerEm,xMin:b.xMin,yMin:b.yMin,xMax:b.xMax,yMax:b.yMax,lowestRecPPEM:3,createdTimestamp:t.createdTimestamp}),C=Gt.make({ascender:b.ascender,descender:b.descender,advanceWidthMax:b.advanceWidthMax,minLeftSideBearing:b.minLeftSideBearing,minRightSideBearing:b.minRightSideBearing,xMaxExtent:b.maxLeftSideBearing+(b.xMax-b.xMin),numberOfHMetrics:t.glyphs.length}),S=Vt.make(t.glyphs.length),w=le.make(Object.assign({xAvgCharWidth:Math.round(b.advanceWidthAvg),usFirstCharIndex:e,usLastCharIndex:l,ulUnicodeRange1:u,ulUnicodeRange2:h,ulUnicodeRange3:f,ulUnicodeRange4:d,sTypoAscender:b.ascender,sTypoDescender:b.descender,sTypoLineGap:0,usWinAscent:b.yMax,usWinDescent:Math.abs(b.yMin),ulCodePageRange1:1,sxHeight:xe(t,"xyvw",{yMax:Math.round(b.ascender/2)}).yMax,sCapHeight:xe(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",b).yMax,usDefaultChar:t.hasChar(" ")?32:0,usBreakChar:t.hasChar(" ")?32:0},t.tables.os2)),_=Yt.make(t.glyphs),D=ut.make(t.glyphs),T=t.getEnglishName("fontFamily"),E=t.getEnglishName("fontSubfamily"),k=T+" "+E,O=t.getEnglishName("postScriptName");O||(O=T.replace(/\s/g,"")+"-"+E);var A={};for(var P in t.names)A[P]=t.names[P];A.uniqueID||(A.uniqueID={en:t.getEnglishName("manufacturer")+":"+k}),A.postScriptName||(A.postScriptName={en:O}),A.preferredFamily||(A.preferredFamily=t.names.fontFamily),A.preferredSubfamily||(A.preferredSubfamily=t.names.fontSubfamily);var I=[],F=ae.make(A,I),M=I.length>0?qt.make(I):void 0,L=ue.make(),R=Ht.make(t.glyphs,{version:t.getEnglishName("version"),fullName:k,familyName:T,weightName:E,postScriptName:O,unitsPerEm:t.unitsPerEm,fontBBox:[0,b.yMin,b.ascender,b.advanceWidthMax]}),j=t.metas&&Object.keys(t.metas).length>0?ge.make(t.metas):void 0,B=[x,C,S,w,F,D,L,R,_];M&&B.push(M),t.tables.gsub&&B.push(pe.make(t.tables.gsub)),j&&B.push(j);for(var U=be(B),z=ve(U.encode()),N=U.fields,W=!1,H=0;H<N.length;H+=1)if("head table"===N[H].name){N[H].value.checkSumAdjustment=2981146554-z,W=!0;break}if(!W)throw new Error("Could not find head table with checkSum to adjust.");return U},computeCheckSum:ve};function we(t,e){for(var n=0,i=t.length-1;n<=i;){var r=n+i>>>1,o=t[r].tag;if(o===e)return r;o<e?n=r+1:i=r-1}return-n-1}function _e(t,e){for(var n=0,i=t.length-1;n<=i;){var r=n+i>>>1,o=t[r];if(o===e)return r;o<e?n=r+1:i=r-1}return-n-1}function De(t,e){for(var n,i=0,r=t.length-1;i<=r;){var o=i+r>>>1,s=(n=t[o]).start;if(s===e)return n;s<e?i=o+1:r=o-1}if(i>0)return e>(n=t[i-1]).end?0:n}function Te(t,e){this.font=t,this.tableName=e}function Ee(t){Te.call(this,t,"gpos")}function ke(t){Te.call(this,t,"gsub")}function Oe(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Ae(t,e,n){for(var i=t.subtables,r=0;r<i.length;r++){var o=i[r];if(o.substFormat===e)return o}if(n)return i.push(n),n}function Pe(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;++i)n[i]=t[i];return e}function Ie(t,e){if(!t)throw e}function Fe(t,e,n,i,r){var o;return(e&i)>0?(o=t.parseByte(),0===(e&r)&&(o=-o),o=n+o):o=(e&r)>0?n:n+t.parseShort(),o}function Me(t,e,n){var i,r,o=new ct.Parser(e,n);if(t.numberOfContours=o.parseShort(),t._xMin=o.parseShort(),t._yMin=o.parseShort(),t._xMax=o.parseShort(),t._yMax=o.parseShort(),t.numberOfContours>0){for(var s=t.endPointIndices=[],a=0;a<t.numberOfContours;a+=1)s.push(o.parseUShort());t.instructionLength=o.parseUShort(),t.instructions=[];for(var c=0;c<t.instructionLength;c+=1)t.instructions.push(o.parseByte());var l=s[s.length-1]+1;i=[];for(var u=0;u<l;u+=1)if(r=o.parseByte(),i.push(r),(8&r)>0)for(var h=o.parseByte(),f=0;f<h;f+=1)i.push(r),u+=1;if(F.argument(i.length===l,"Bad flags."),s.length>0){var d,p=[];if(l>0){for(var g=0;g<l;g+=1)r=i[g],(d={}).onCurve=!!(1&r),d.lastPointOfContour=s.indexOf(g)>=0,p.push(d);for(var m=0,v=0;v<l;v+=1)r=i[v],(d=p[v]).x=Fe(o,r,m,2,16),m=d.x;for(var y=0,b=0;b<l;b+=1)r=i[b],(d=p[b]).y=Fe(o,r,y,4,32),y=d.y}t.points=p}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var x=!0;x;){i=o.parseUShort();var C={glyphIndex:o.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&i)>0?(2&i)>0?(C.dx=o.parseShort(),C.dy=o.parseShort()):C.matchedPoints=[o.parseUShort(),o.parseUShort()]:(2&i)>0?(C.dx=o.parseChar(),C.dy=o.parseChar()):C.matchedPoints=[o.parseByte(),o.parseByte()],(8&i)>0?C.xScale=C.yScale=o.parseF2Dot14():(64&i)>0?(C.xScale=o.parseF2Dot14(),C.yScale=o.parseF2Dot14()):(128&i)>0&&(C.xScale=o.parseF2Dot14(),C.scale01=o.parseF2Dot14(),C.scale10=o.parseF2Dot14(),C.yScale=o.parseF2Dot14()),t.components.push(C),x=!!(32&i)}if(256&i){t.instructionLength=o.parseUShort(),t.instructions=[];for(var S=0;S<t.instructionLength;S+=1)t.instructions.push(o.parseByte())}}}function Le(t,e){for(var n=[],i=0;i<t.length;i+=1){var r=t[i],o={x:e.xScale*r.x+e.scale01*r.y+e.dx,y:e.scale10*r.x+e.yScale*r.y+e.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};n.push(o)}return n}function Re(t){var e=new A;if(!t)return e;for(var n=function(t){for(var e=[],n=[],i=0;i<t.length;i+=1){var r=t[i];n.push(r),r.lastPointOfContour&&(e.push(n),n=[])}return F.argument(0===n.length,"There are still points left in the current contour."),e}(t),i=0;i<n.length;++i){var r=n[i],o=null,s=r[r.length-1],a=r[0];if(s.onCurve)e.moveTo(s.x,s.y);else if(a.onCurve)e.moveTo(a.x,a.y);else{var c={x:.5*(s.x+a.x),y:.5*(s.y+a.y)};e.moveTo(c.x,c.y)}for(var l=0;l<r.length;++l)if(o=s,s=a,a=r[(l+1)%r.length],s.onCurve)e.lineTo(s.x,s.y);else{var u=a;o.onCurve||{x:.5*(s.x+o.x),y:.5*(s.y+o.y)},a.onCurve||(u={x:.5*(s.x+a.x),y:.5*(s.y+a.y)}),e.quadraticCurveTo(s.x,s.y,u.x,u.y)}e.closePath()}return e}function je(t,e){if(e.isComposite)for(var n=0;n<e.components.length;n+=1){var i=e.components[n],r=t.get(i.glyphIndex);if(r.getPath(),r.points){var o=void 0;if(void 0===i.matchedPoints)o=Le(r.points,i);else{if(i.matchedPoints[0]>e.points.length-1||i.matchedPoints[1]>r.points.length-1)throw Error("Matched points out of range in "+e.name);var s=e.points[i.matchedPoints[0]],a=r.points[i.matchedPoints[1]],c={xScale:i.xScale,scale01:i.scale01,scale10:i.scale10,yScale:i.yScale,dx:0,dy:0};a=Le([a],c)[0],c.dx=s.x-a.x,c.dy=s.y-a.y,o=Le(r.points,c)}e.points=e.points.concat(o)}}return Re(e.points)}Te.prototype={searchTag:we,binSearch:_e,getTable:function(t){var e=this.font.tables[this.tableName];return!e&&t&&(e=this.font.tables[this.tableName]=this.createDefaultTable()),e},getScriptNames:function(){var t=this.getTable();return t?t.scripts.map((function(t){return t.tag})):[]},getDefaultScriptName:function(){var t=this.getTable();if(t){for(var e=!1,n=0;n<t.scripts.length;n++){var i=t.scripts[n].tag;if("DFLT"===i)return i;"latn"===i&&(e=!0)}return e?"latn":void 0}},getScriptTable:function(t,e){var n=this.getTable(e);if(n){t=t||"DFLT";var i=n.scripts,r=we(n.scripts,t);if(r>=0)return i[r].script;if(e){var o={tag:t,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-r,0,o),o.script}}},getLangSysTable:function(t,e,n){var i=this.getScriptTable(t,n);if(i){if(!e||"dflt"===e||"DFLT"===e)return i.defaultLangSys;var r=we(i.langSysRecords,e);if(r>=0)return i.langSysRecords[r].langSys;if(n){var o={tag:e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-r,0,o),o.langSys}}},getFeatureTable:function(t,e,n,i){var r=this.getLangSysTable(t,e,i);if(r){for(var o,s=r.featureIndexes,a=this.font.tables[this.tableName].features,c=0;c<s.length;c++)if((o=a[s[c]]).tag===n)return o.feature;if(i){var l=a.length;return F.assert(0===l||n>=a[l-1].tag,"Features must be added in alphabetical order."),o={tag:n,feature:{params:0,lookupListIndexes:[]}},a.push(o),s.push(l),o.feature}}},getLookupTables:function(t,e,n,i,r){var o=this.getFeatureTable(t,e,n,r),s=[];if(o){for(var a,c=o.lookupListIndexes,l=this.font.tables[this.tableName].lookups,u=0;u<c.length;u++)(a=l[c[u]]).lookupType===i&&s.push(a);if(0===s.length&&r){a={lookupType:i,lookupFlag:0,subtables:[],markFilteringSet:void 0};var h=l.length;return l.push(a),c.push(h),[a]}}return s},getGlyphClass:function(t,e){switch(t.format){case 1:return t.startGlyph<=e&&e<t.startGlyph+t.classes.length?t.classes[e-t.startGlyph]:0;case 2:var n=De(t.ranges,e);return n?n.classId:0}},getCoverageIndex:function(t,e){switch(t.format){case 1:var n=_e(t.glyphs,e);return n>=0?n:-1;case 2:var i=De(t.ranges,e);return i?i.index+e-i.start:-1}},expandCoverage:function(t){if(1===t.format)return t.glyphs;for(var e=[],n=t.ranges,i=0;i<n.length;i++)for(var r=n[i],o=r.start,s=r.end,a=o;a<=s;a++)e.push(a);return e}},Ee.prototype=Te.prototype,Ee.prototype.init=function(){var t=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(t)},Ee.prototype.getKerningValue=function(t,e,n){for(var i=0;i<t.length;i++)for(var r=t[i].subtables,o=0;o<r.length;o++){var s=r[o],a=this.getCoverageIndex(s.coverage,e);if(!(a<0))switch(s.posFormat){case 1:for(var c=s.pairSets[a],l=0;l<c.length;l++){var u=c[l];if(u.secondGlyph===n)return u.value1&&u.value1.xAdvance||0}break;case 2:var h=this.getGlyphClass(s.classDef1,e),f=this.getGlyphClass(s.classDef2,n),d=s.classRecords[h][f];return d.value1&&d.value1.xAdvance||0}}return 0},Ee.prototype.getKerningTables=function(t,e){if(this.font.tables.gpos)return this.getLookupTables(t,e,"kern",2)},ke.prototype=Te.prototype,ke.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},ke.prototype.getSingle=function(t,e,n){for(var i=[],r=this.getLookupTables(e,n,t,1),o=0;o<r.length;o++)for(var s=r[o].subtables,a=0;a<s.length;a++){var c=s[a],l=this.expandCoverage(c.coverage),u=void 0;if(1===c.substFormat){var h=c.deltaGlyphId;for(u=0;u<l.length;u++){var f=l[u];i.push({sub:f,by:f+h})}}else{var d=c.substitute;for(u=0;u<l.length;u++)i.push({sub:l[u],by:d[u]})}}return i},ke.prototype.getAlternates=function(t,e,n){for(var i=[],r=this.getLookupTables(e,n,t,3),o=0;o<r.length;o++)for(var s=r[o].subtables,a=0;a<s.length;a++)for(var c=s[a],l=this.expandCoverage(c.coverage),u=c.alternateSets,h=0;h<l.length;h++)i.push({sub:l[h],by:u[h]});return i},ke.prototype.getLigatures=function(t,e,n){for(var i=[],r=this.getLookupTables(e,n,t,4),o=0;o<r.length;o++)for(var s=r[o].subtables,a=0;a<s.length;a++)for(var c=s[a],l=this.expandCoverage(c.coverage),u=c.ligatureSets,h=0;h<l.length;h++)for(var f=l[h],d=u[h],p=0;p<d.length;p++){var g=d[p];i.push({sub:[f].concat(g.components),by:g.ligGlyph})}return i},ke.prototype.addSingle=function(t,e,n,i){var r=Ae(this.getLookupTables(n,i,t,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});F.assert(1===r.coverage.format,"Ligature: unable to modify coverage table format "+r.coverage.format);var o=e.sub,s=this.binSearch(r.coverage.glyphs,o);s<0&&(s=-1-s,r.coverage.glyphs.splice(s,0,o),r.substitute.splice(s,0,0)),r.substitute[s]=e.by},ke.prototype.addAlternate=function(t,e,n,i){var r=Ae(this.getLookupTables(n,i,t,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});F.assert(1===r.coverage.format,"Ligature: unable to modify coverage table format "+r.coverage.format);var o=e.sub,s=this.binSearch(r.coverage.glyphs,o);s<0&&(s=-1-s,r.coverage.glyphs.splice(s,0,o),r.alternateSets.splice(s,0,0)),r.alternateSets[s]=e.by},ke.prototype.addLigature=function(t,e,n,i){var r=this.getLookupTables(n,i,t,4,!0)[0],o=r.subtables[0];o||(o={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},r.subtables[0]=o),F.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub[0],a=e.sub.slice(1),c={ligGlyph:e.by,components:a},l=this.binSearch(o.coverage.glyphs,s);if(l>=0){for(var u=o.ligatureSets[l],h=0;h<u.length;h++)if(Oe(u[h].components,a))return;u.push(c)}else l=-1-l,o.coverage.glyphs.splice(l,0,s),o.ligatureSets.splice(l,0,[c])},ke.prototype.getFeature=function(t,e,n){if(/ss\d\d/.test(t))return this.getSingle(t,e,n);switch(t){case"aalt":case"salt":return this.getSingle(t,e,n).concat(this.getAlternates(t,e,n));case"dlig":case"liga":case"rlig":return this.getLigatures(t,e,n)}},ke.prototype.add=function(t,e,n,i){if(/ss\d\d/.test(t))return this.addSingle(t,e,n,i);switch(t){case"aalt":case"salt":return"number"===typeof e.by?this.addSingle(t,e,n,i):this.addAlternate(t,e,n,i);case"dlig":case"liga":case"rlig":return this.addLigature(t,e,n,i)}};var Be,Ue,ze,Ne,We={getPath:Re,parse:function(t,e,n,i,r){return r.lowMemory?function(t,e,n,i){var r=new _t.GlyphSet(i);return i._push=function(o){var s=n[o];s!==n[o+1]?r.push(o,_t.ttfGlyphLoader(i,o,Me,t,e+s,je)):r.push(o,_t.glyphLoader(i,o))},r}(t,e,n,i):function(t,e,n,i){for(var r=new _t.GlyphSet(i),o=0;o<n.length-1;o+=1){var s=n[o];s!==n[o+1]?r.push(o,_t.ttfGlyphLoader(i,o,Me,t,e+s,je)):r.push(o,_t.glyphLoader(i,o))}return r}(t,e,n,i)}};function He(t){this.font=t,this.getCommands=function(t){return We.getPath(t).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Xe(t){return t}function Ge(t){return Math.sign(t)*Math.round(Math.abs(t))}function Ye(t){return Math.sign(t)*Math.round(Math.abs(2*t))/2}function qe(t){return Math.sign(t)*(Math.round(Math.abs(t)+.5)-.5)}function Ve(t){return Math.sign(t)*Math.ceil(Math.abs(t))}function Ze(t){return Math.sign(t)*Math.floor(Math.abs(t))}var Qe=function(t){var e=this.srPeriod,n=this.srPhase,i=1;return t<0&&(t=-t,i=-1),t+=this.srThreshold-n,t=Math.trunc(t/e)*e,(t+=n)<0?n*i:t*i},Ke={x:1,y:0,axis:"x",distance:function(t,e,n,i){return(n?t.xo:t.x)-(i?e.xo:e.x)},interpolate:function(t,e,n,i){var r,o,s,a,c,l,u;if(!i||i===this)return r=t.xo-e.xo,o=t.xo-n.xo,c=e.x-e.xo,l=n.x-n.xo,0===(u=(s=Math.abs(r))+(a=Math.abs(o)))?void(t.x=t.xo+(c+l)/2):void(t.x=t.xo+(c*a+l*s)/u);r=i.distance(t,e,!0,!0),o=i.distance(t,n,!0,!0),c=i.distance(e,e,!1,!0),l=i.distance(n,n,!1,!0),0!==(u=(s=Math.abs(r))+(a=Math.abs(o)))?Ke.setRelative(t,t,(c*a+l*s)/u,i,!0):Ke.setRelative(t,t,(c+l)/2,i,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(t,e,n,i,r){if(i&&i!==this){var o=r?e.xo:e.x,s=r?e.yo:e.y,a=o+n*i.x,c=s+n*i.y;t.x=a+(t.y-c)/i.normalSlope}else t.x=(r?e.xo:e.x)+n},slope:0,touch:function(t){t.xTouched=!0},touched:function(t){return t.xTouched},untouch:function(t){t.xTouched=!1}},$e={x:0,y:1,axis:"y",distance:function(t,e,n,i){return(n?t.yo:t.y)-(i?e.yo:e.y)},interpolate:function(t,e,n,i){var r,o,s,a,c,l,u;if(!i||i===this)return r=t.yo-e.yo,o=t.yo-n.yo,c=e.y-e.yo,l=n.y-n.yo,0===(u=(s=Math.abs(r))+(a=Math.abs(o)))?void(t.y=t.yo+(c+l)/2):void(t.y=t.yo+(c*a+l*s)/u);r=i.distance(t,e,!0,!0),o=i.distance(t,n,!0,!0),c=i.distance(e,e,!1,!0),l=i.distance(n,n,!1,!0),0!==(u=(s=Math.abs(r))+(a=Math.abs(o)))?$e.setRelative(t,t,(c*a+l*s)/u,i,!0):$e.setRelative(t,t,(c+l)/2,i,!0)},normalSlope:0,setRelative:function(t,e,n,i,r){if(i&&i!==this){var o=r?e.xo:e.x,s=r?e.yo:e.y,a=o+n*i.x,c=s+n*i.y;t.y=c+i.normalSlope*(t.x-a)}else t.y=(r?e.yo:e.y)+n},slope:Number.POSITIVE_INFINITY,touch:function(t){t.yTouched=!0},touched:function(t){return t.yTouched},untouch:function(t){t.yTouched=!1}};function Je(t,e){this.x=t,this.y=e,this.axis=void 0,this.slope=e/t,this.normalSlope=-t/e,Object.freeze(this)}function tn(t,e){var n=Math.sqrt(t*t+e*e);return e/=n,1===(t/=n)&&0===e?Ke:0===t&&1===e?$e:new Je(t,e)}function en(t,e,n,i){this.x=this.xo=Math.round(64*t)/64,this.y=this.yo=Math.round(64*e)/64,this.lastPointOfContour=n,this.onCurve=i,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(Ke),Object.freeze($e),Je.prototype.distance=function(t,e,n,i){return this.x*Ke.distance(t,e,n,i)+this.y*$e.distance(t,e,n,i)},Je.prototype.interpolate=function(t,e,n,i){var r,o,s,a,c,l,u;s=i.distance(t,e,!0,!0),a=i.distance(t,n,!0,!0),r=i.distance(e,e,!1,!0),o=i.distance(n,n,!1,!0),0!==(u=(c=Math.abs(s))+(l=Math.abs(a)))?this.setRelative(t,t,(r*l+o*c)/u,i,!0):this.setRelative(t,t,(r+o)/2,i,!0)},Je.prototype.setRelative=function(t,e,n,i,r){i=i||this;var o=r?e.xo:e.x,s=r?e.yo:e.y,a=o+n*i.x,c=s+n*i.y,l=i.normalSlope,u=this.slope,h=t.x,f=t.y;t.x=(u*h-l*a+c-f)/(u-l),t.y=u*(t.x-h)+f},Je.prototype.touch=function(t){t.xTouched=!0,t.yTouched=!0},en.prototype.nextTouched=function(t){for(var e=this.nextPointOnContour;!t.touched(e)&&e!==this;)e=e.nextPointOnContour;return e},en.prototype.prevTouched=function(t){for(var e=this.prevPointOnContour;!t.touched(e)&&e!==this;)e=e.prevPointOnContour;return e};var nn=Object.freeze(new en(0,0)),rn={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function on(t,e){switch(this.env=t,this.stack=[],this.prog=e,t){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Ke,this.round=Ge}}function sn(t){for(var e=t.tZone=new Array(t.gZone.length),n=0;n<e.length;n++)e[n]=new en(0,0)}function an(t,e){var n,i=t.prog,r=t.ip,o=1;do{if(88===(n=i[++r]))o++;else if(89===n)o--;else if(64===n)r+=i[r+1]+1;else if(65===n)r+=2*i[r+1]+1;else if(n>=176&&n<=183)r+=n-176+1;else if(n>=184&&n<=191)r+=2*(n-184+1);else if(e&&1===o&&27===n)break}while(o>0);t.ip=r}function cn(t,e){exports.DEBUG&&console.log(e.step,"SVTCA["+t.axis+"]"),e.fv=e.pv=e.dpv=t}function ln(t,e){exports.DEBUG&&console.log(e.step,"SPVTCA["+t.axis+"]"),e.pv=e.dpv=t}function un(t,e){exports.DEBUG&&console.log(e.step,"SFVTCA["+t.axis+"]"),e.fv=t}function hn(t,e){var n,i,r=e.stack,o=r.pop(),s=r.pop(),a=e.z2[o],c=e.z1[s];exports.DEBUG&&console.log("SPVTL["+t+"]",o,s),t?(n=a.y-c.y,i=c.x-a.x):(n=c.x-a.x,i=c.y-a.y),e.pv=e.dpv=tn(n,i)}function fn(t,e){var n,i,r=e.stack,o=r.pop(),s=r.pop(),a=e.z2[o],c=e.z1[s];exports.DEBUG&&console.log("SFVTL["+t+"]",o,s),t?(n=a.y-c.y,i=c.x-a.x):(n=c.x-a.x,i=c.y-a.y),e.fv=tn(n,i)}function dn(t){exports.DEBUG&&console.log(t.step,"POP[]"),t.stack.pop()}function pn(t,e){var n=e.stack.pop(),i=e.z0[n],r=e.fv,o=e.pv;exports.DEBUG&&console.log(e.step,"MDAP["+t+"]",n);var s=o.distance(i,nn);t&&(s=e.round(s)),r.setRelative(i,nn,s,o),r.touch(i),e.rp0=e.rp1=n}function gn(t,e){var n,i,r,o=e.z2,s=o.length-2;exports.DEBUG&&console.log(e.step,"IUP["+t.axis+"]");for(var a=0;a<s;a++)n=o[a],t.touched(n)||(i=n.prevTouched(t))!==n&&(i===(r=n.nextTouched(t))&&t.setRelative(n,n,t.distance(i,i,!1,!0),t,!0),t.interpolate(n,i,r,t))}function mn(t,e){for(var n=e.stack,i=t?e.rp1:e.rp2,r=(t?e.z0:e.z1)[i],o=e.fv,s=e.pv,a=e.loop,c=e.z2;a--;){var l=n.pop(),u=c[l],h=s.distance(r,r,!1,!0);o.setRelative(u,u,h,s),o.touch(u),exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-a)+": ":"")+"SHP["+(t?"rp1":"rp2")+"]",l)}e.loop=1}function vn(t,e){var n=e.stack,i=t?e.rp1:e.rp2,r=(t?e.z0:e.z1)[i],o=e.fv,s=e.pv,a=n.pop(),c=e.z2[e.contours[a]],l=c;exports.DEBUG&&console.log(e.step,"SHC["+t+"]",a);var u=s.distance(r,r,!1,!0);do{l!==r&&o.setRelative(l,l,u,s),l=l.nextPointOnContour}while(l!==c)}function yn(t,e){var n,i,r=e.stack,o=t?e.rp1:e.rp2,s=(t?e.z0:e.z1)[o],a=e.fv,c=e.pv,l=r.pop();switch(exports.DEBUG&&console.log(e.step,"SHZ["+t+"]",l),l){case 0:n=e.tZone;break;case 1:n=e.gZone;break;default:throw new Error("Invalid zone")}for(var u=c.distance(s,s,!1,!0),h=n.length-2,f=0;f<h;f++)i=n[f],a.setRelative(i,i,u,c)}function bn(t,e){var n=e.stack,i=n.pop()/64,r=n.pop(),o=e.z1[r],s=e.z0[e.rp0],a=e.fv,c=e.pv;a.setRelative(o,s,i,c),a.touch(o),exports.DEBUG&&console.log(e.step,"MSIRP["+t+"]",i,r),e.rp1=e.rp0,e.rp2=r,t&&(e.rp0=r)}function xn(t,e){var n=e.stack,i=n.pop(),r=n.pop(),o=e.z0[r],s=e.fv,a=e.pv,c=e.cvt[i];exports.DEBUG&&console.log(e.step,"MIAP["+t+"]",i,"(",c,")",r);var l=a.distance(o,nn);t&&(Math.abs(l-c)<e.cvCutIn&&(l=c),l=e.round(l)),s.setRelative(o,nn,l,a),0===e.zp0&&(o.xo=o.x,o.yo=o.y),s.touch(o),e.rp0=e.rp1=r}function Cn(t,e){var n=e.stack,i=n.pop(),r=e.z2[i];exports.DEBUG&&console.log(e.step,"GC["+t+"]",i),n.push(64*e.dpv.distance(r,nn,t,!1))}function Sn(t,e){var n=e.stack,i=n.pop(),r=n.pop(),o=e.z1[i],s=e.z0[r],a=e.dpv.distance(s,o,t,t);exports.DEBUG&&console.log(e.step,"MD["+t+"]",i,r,"->",a),e.stack.push(Math.round(64*a))}function wn(t,e){var n=e.stack,i=n.pop(),r=e.fv,o=e.pv,s=e.ppem,a=e.deltaBase+16*(t-1),c=e.deltaShift,l=e.z0;exports.DEBUG&&console.log(e.step,"DELTAP["+t+"]",i,n);for(var u=0;u<i;u++){var h=n.pop(),f=n.pop();if(a+((240&f)>>4)===s){var d=(15&f)-8;d>=0&&d++,exports.DEBUG&&console.log(e.step,"DELTAPFIX",h,"by",d*c);var p=l[h];r.setRelative(p,p,d*c,o)}}}function _n(t,e){var n=e.stack,i=n.pop();exports.DEBUG&&console.log(e.step,"ROUND[]"),n.push(64*e.round(i/64))}function Dn(t,e){var n=e.stack,i=n.pop(),r=e.ppem,o=e.deltaBase+16*(t-1),s=e.deltaShift;exports.DEBUG&&console.log(e.step,"DELTAC["+t+"]",i,n);for(var a=0;a<i;a++){var c=n.pop(),l=n.pop();if(o+((240&l)>>4)===r){var u=(15&l)-8;u>=0&&u++;var h=u*s;exports.DEBUG&&console.log(e.step,"DELTACFIX",c,"by",h),e.cvt[c]+=h}}}function Tn(t,e){var n,i,r=e.stack,o=r.pop(),s=r.pop(),a=e.z2[o],c=e.z1[s];exports.DEBUG&&console.log(e.step,"SDPVTL["+t+"]",o,s),t?(n=a.y-c.y,i=c.x-a.x):(n=c.x-a.x,i=c.y-a.y),e.dpv=tn(n,i)}function En(t,e){var n=e.stack,i=e.prog,r=e.ip;exports.DEBUG&&console.log(e.step,"PUSHB["+t+"]");for(var o=0;o<t;o++)n.push(i[++r]);e.ip=r}function kn(t,e){var n=e.ip,i=e.prog,r=e.stack;exports.DEBUG&&console.log(e.ip,"PUSHW["+t+"]");for(var o=0;o<t;o++){var s=i[++n]<<8|i[++n];32768&s&&(s=-(1+(65535^s))),r.push(s)}e.ip=n}function On(t,e,n,i,r,o){var s,a,c,l,u=o.stack,h=t&&u.pop(),f=u.pop(),d=o.rp0,p=o.z0[d],g=o.z1[f],m=o.minDis,v=o.fv,y=o.dpv;c=(a=s=y.distance(g,p,!0,!0))>=0?1:-1,a=Math.abs(a),t&&(l=o.cvt[h],i&&Math.abs(a-l)<o.cvCutIn&&(a=l)),n&&a<m&&(a=m),i&&(a=o.round(a)),v.setRelative(g,p,c*a,y),v.touch(g),exports.DEBUG&&console.log(o.step,(t?"MIRP[":"MDRP[")+(e?"M":"m")+(n?">":"_")+(i?"R":"_")+(0===r?"Gr":1===r?"Bl":2===r?"Wh":"")+"]",t?h+"("+o.cvt[h]+","+l+")":"",f,"(d =",s,"->",c*a,")"),o.rp1=o.rp0,o.rp2=f,e&&(o.rp0=f)}function An(t){this.char=t,this.state={},this.activeState=null}function Pn(t,e,n){this.contextName=n,this.startIndex=t,this.endOffset=e}function In(t,e,n){this.contextName=t,this.openRange=null,this.ranges=[],this.checkStart=e,this.checkEnd=n}function Fn(t,e){this.context=t,this.index=e,this.length=t.length,this.current=t[e],this.backtrack=t.slice(0,e),this.lookahead=t.slice(e+1)}function Mn(t){this.eventId=t,this.subscribers=[]}function Ln(t){var e=this,n=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];n.forEach((function(t){Object.defineProperty(e.events,t,{value:new Mn(t)})})),t&&n.forEach((function(n){var i=t[n];"function"===typeof i&&e.events[n].subscribe(i)}));["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"].forEach((function(t){e.events[t].subscribe(e.updateContextsRanges)}))}function Rn(t){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],Ln.call(this,t)}function jn(t){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(t)}function Bn(t){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(t)}function Un(t){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(t)}function zn(t){return/[A-z]/.test(t)}function Nn(t){this.font=t,this.features={}}function Wn(t){this.id=t.id,this.tag=t.tag,this.substitution=t.substitution}function Hn(t,e){if(!t)return-1;switch(e.format){case 1:return e.glyphs.indexOf(t);case 2:for(var n=e.ranges,i=0;i<n.length;i++){var r=n[i];if(t>=r.start&&t<=r.end){var o=t-r.start;return r.index+o}}break;default:return-1}return-1}function Xn(t,e){return-1===Hn(t,e.coverage)?null:t+e.deltaGlyphId}function Gn(t,e){var n=Hn(t,e.coverage);return-1===n?null:e.substitute[n]}function Yn(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i],o=e.current,s=Hn(o=Array.isArray(o)?o[0]:o,r);-1!==s&&n.push(s)}return n.length!==t.length?-1:n}function qn(t,e){var n=e.inputCoverage.length+e.lookaheadCoverage.length+e.backtrackCoverage.length;if(t.context.length<n)return[];var i=Yn(e.inputCoverage,t);if(-1===i)return[];var r=e.inputCoverage.length-1;if(t.lookahead.length<e.lookaheadCoverage.length)return[];for(var o=t.lookahead.slice(r);o.length&&Un(o[0].char);)o.shift();var s=new Fn(o,0),a=Yn(e.lookaheadCoverage,s),c=[].concat(t.backtrack);for(c.reverse();c.length&&Un(c[0].char);)c.shift();if(c.length<e.backtrackCoverage.length)return[];var l=new Fn(c,0),u=Yn(e.backtrackCoverage,l),h=[];if(i.length===e.inputCoverage.length&&a.length===e.lookaheadCoverage.length&&u.length===e.backtrackCoverage.length)for(var f=0;f<e.lookupRecords.length;f++)for(var d=e.lookupRecords[f].lookupListIndex,p=this.getLookupByIndex(d),g=0;g<p.subtables.length;g++){var m=p.subtables[g],v=this.getLookupMethod(p,m);if("12"===this.getSubstitutionType(p,m))for(var y=0;y<i.length;y++){var b=v(t.get(y));b&&h.push(b)}}return h}function Vn(t,e){var n,i=Hn(t.current,e.coverage);if(-1===i)return null;for(var r=e.ligatureSets[i],o=0;o<r.length;o++){n=r[o];for(var s=0;s<n.components.length;s++){if(t.lookahead[s]!==n.components[s])break;if(s===n.components.length-1)return n}}return null}function Zn(t,e){var n=Hn(t,e.coverage);return-1===n?null:e.sequences[n]}He.prototype.exec=function(t,e){if("number"!==typeof e)throw new Error("Point size is not a number!");if(!(this._errorState>2)){var n=this.font,i=this._prepState;if(!i||i.ppem!==e){var r=this._fpgmState;if(!r){on.prototype=rn,(r=this._fpgmState=new on("fpgm",n.tables.fpgm)).funcs=[],r.font=n,exports.DEBUG&&(console.log("---EXEC FPGM---"),r.step=-1);try{Ue(r)}catch(l){return console.log("Hinting error in FPGM:"+l),void(this._errorState=3)}}on.prototype=r,(i=this._prepState=new on("prep",n.tables.prep)).ppem=e;var o=n.tables.cvt;if(o)for(var s=i.cvt=new Array(o.length),a=e/n.unitsPerEm,c=0;c<o.length;c++)s[c]=o[c]*a;else i.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),i.step=-1);try{Ue(i)}catch(l){this._errorState<2&&console.log("Hinting error in PREP:"+l),this._errorState=2}}if(!(this._errorState>1))try{return ze(t,i)}catch(l){return this._errorState<1&&(console.log("Hinting error:"+l),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}}},ze=function(t,e){var n,i,r,o=e.ppem/e.font.unitsPerEm,s=o,a=t.components;if(on.prototype=e,a){var c=e.font;i=[],n=[];for(var l=0;l<a.length;l++){var u=a[l],h=c.glyphs.get(u.glyphIndex);r=new on("glyf",h.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+l+"---"),r.step=-1),Ne(h,r,o,s);for(var f=Math.round(u.dx*o),d=Math.round(u.dy*s),p=r.gZone,g=r.contours,m=0;m<p.length;m++){var v=p[m];v.xTouched=v.yTouched=!1,v.xo=v.x=v.x+f,v.yo=v.y=v.y+d}var y=i.length;i.push.apply(i,p);for(var b=0;b<g.length;b++)n.push(g[b]+y)}t.instructions&&!r.inhibitGridFit&&((r=new on("glyf",t.instructions)).gZone=r.z0=r.z1=r.z2=i,r.contours=n,i.push(new en(0,0),new en(Math.round(t.advanceWidth*o),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),r.step=-1),Ue(r),i.length-=2)}else r=new on("glyf",t.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),r.step=-1),Ne(t,r,o,s),i=r.gZone;return i},Ne=function(t,e,n,i){for(var r,o,s,a=t.points||[],c=a.length,l=e.gZone=e.z0=e.z1=e.z2=[],u=e.contours=[],h=0;h<c;h++)r=a[h],l[h]=new en(r.x*n,r.y*i,r.lastPointOfContour,r.onCurve);for(var f=0;f<c;f++)r=l[f],o||(o=r,u.push(f)),r.lastPointOfContour?(r.nextPointOnContour=o,o.prevPointOnContour=r,o=void 0):(s=l[f+1],r.nextPointOnContour=s,s.prevPointOnContour=r);if(!e.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",e.stack);for(var d=0;d<c;d++)console.log(d,l[d].x,l[d].y)}if(l.push(new en(0,0),new en(Math.round(t.advanceWidth*n),0)),Ue(e),l.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",e.stack);for(var p=0;p<c;p++)console.log(p,l[p].x,l[p].y)}}},Ue=function(t){var e=t.prog;if(e){var n,i=e.length;for(t.ip=0;t.ip<i;t.ip++){if(exports.DEBUG&&t.step++,!(n=Be[e[t.ip]]))throw new Error("unknown instruction: 0x"+Number(e[t.ip]).toString(16));n(t)}}},Be=[cn.bind(void 0,$e),cn.bind(void 0,Ke),ln.bind(void 0,$e),ln.bind(void 0,Ke),un.bind(void 0,$e),un.bind(void 0,Ke),hn.bind(void 0,0),hn.bind(void 0,1),fn.bind(void 0,0),fn.bind(void 0,1),function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"SPVFS[]",n,i),t.pv=t.dpv=tn(i,n)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"SPVFS[]",n,i),t.fv=tn(i,n)},function(t){var e=t.stack,n=t.pv;exports.DEBUG&&console.log(t.step,"GPV[]"),e.push(16384*n.x),e.push(16384*n.y)},function(t){var e=t.stack,n=t.fv;exports.DEBUG&&console.log(t.step,"GFV[]"),e.push(16384*n.x),e.push(16384*n.y)},function(t){t.fv=t.pv,exports.DEBUG&&console.log(t.step,"SFVTPV[]")},function(t){var e=t.stack,n=e.pop(),i=e.pop(),r=e.pop(),o=e.pop(),s=e.pop(),a=t.z0,c=t.z1,l=a[n],u=a[i],h=c[r],f=c[o],d=t.z2[s];exports.DEBUG&&console.log("ISECT[], ",n,i,r,o,s);var p=l.x,g=l.y,m=u.x,v=u.y,y=h.x,b=h.y,x=f.x,C=f.y,S=(p-m)*(b-C)-(g-v)*(y-x),w=p*v-g*m,_=y*C-b*x;d.x=(w*(y-x)-_*(p-m))/S,d.y=(w*(b-C)-_*(g-v))/S},function(t){t.rp0=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SRP0[]",t.rp0)},function(t){t.rp1=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SRP1[]",t.rp1)},function(t){t.rp2=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SRP2[]",t.rp2)},function(t){var e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZP0[]",e),t.zp0=e,e){case 0:t.tZone||sn(t),t.z0=t.tZone;break;case 1:t.z0=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){var e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZP1[]",e),t.zp1=e,e){case 0:t.tZone||sn(t),t.z1=t.tZone;break;case 1:t.z1=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){var e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZP2[]",e),t.zp2=e,e){case 0:t.tZone||sn(t),t.z2=t.tZone;break;case 1:t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){var e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZPS[]",e),t.zp0=t.zp1=t.zp2=e,e){case 0:t.tZone||sn(t),t.z0=t.z1=t.z2=t.tZone;break;case 1:t.z0=t.z1=t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){t.loop=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SLOOP[]",t.loop)},function(t){exports.DEBUG&&console.log(t.step,"RTG[]"),t.round=Ge},function(t){exports.DEBUG&&console.log(t.step,"RTHG[]"),t.round=qe},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SMD[]",e),t.minDis=e/64},function(t){exports.DEBUG&&console.log(t.step,"ELSE[]"),an(t,!1)},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"JMPR[]",e),t.ip+=e-1},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SCVTCI[]",e),t.cvCutIn=e/64},void 0,void 0,function(t){var e=t.stack;exports.DEBUG&&console.log(t.step,"DUP[]"),e.push(e[e.length-1])},dn,function(t){exports.DEBUG&&console.log(t.step,"CLEAR[]"),t.stack.length=0},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"SWAP[]"),e.push(n),e.push(i)},function(t){var e=t.stack;exports.DEBUG&&console.log(t.step,"DEPTH[]"),e.push(e.length)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"CINDEX[]",n),e.push(e[e.length-n])},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"MINDEX[]",n),e.push(e.splice(e.length-n,1)[0])},void 0,void 0,void 0,function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"LOOPCALL[]",n,i);var r=t.ip,o=t.prog;t.prog=t.funcs[n];for(var s=0;s<i;s++)Ue(t),exports.DEBUG&&console.log(++t.step,s+1<i?"next loopcall":"done loopcall",s);t.ip=r,t.prog=o},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"CALL[]",e);var n=t.ip,i=t.prog;t.prog=t.funcs[e],Ue(t),t.ip=n,t.prog=i,exports.DEBUG&&console.log(++t.step,"returning from",e)},function(t){if("fpgm"!==t.env)throw new Error("FDEF not allowed here");var e=t.stack,n=t.prog,i=t.ip,r=e.pop(),o=i;for(exports.DEBUG&&console.log(t.step,"FDEF[]",r);45!==n[++i];);t.ip=i,t.funcs[r]=n.slice(o+1,i)},void 0,pn.bind(void 0,0),pn.bind(void 0,1),gn.bind(void 0,$e),gn.bind(void 0,Ke),mn.bind(void 0,0),mn.bind(void 0,1),vn.bind(void 0,0),vn.bind(void 0,1),yn.bind(void 0,0),yn.bind(void 0,1),function(t){for(var e=t.stack,n=t.loop,i=t.fv,r=e.pop()/64,o=t.z2;n--;){var s=e.pop(),a=o[s];exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-n)+": ":"")+"SHPIX[]",s,r),i.setRelative(a,a,r),i.touch(a)}t.loop=1},function(t){for(var e=t.stack,n=t.rp1,i=t.rp2,r=t.loop,o=t.z0[n],s=t.z1[i],a=t.fv,c=t.dpv,l=t.z2;r--;){var u=e.pop(),h=l[u];exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-r)+": ":"")+"IP[]",u,n,"<->",i),a.interpolate(h,o,s,c),a.touch(h)}t.loop=1},bn.bind(void 0,0),bn.bind(void 0,1),function(t){for(var e=t.stack,n=t.rp0,i=t.z0[n],r=t.loop,o=t.fv,s=t.pv,a=t.z1;r--;){var c=e.pop(),l=a[c];exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-r)+": ":"")+"ALIGNRP[]",c),o.setRelative(l,i,0,s),o.touch(l)}t.loop=1},function(t){exports.DEBUG&&console.log(t.step,"RTDG[]"),t.round=Ye},xn.bind(void 0,0),xn.bind(void 0,1),function(t){var e=t.prog,n=t.ip,i=t.stack,r=e[++n];exports.DEBUG&&console.log(t.step,"NPUSHB[]",r);for(var o=0;o<r;o++)i.push(e[++n]);t.ip=n},function(t){var e=t.ip,n=t.prog,i=t.stack,r=n[++e];exports.DEBUG&&console.log(t.step,"NPUSHW[]",r);for(var o=0;o<r;o++){var s=n[++e]<<8|n[++e];32768&s&&(s=-(1+(65535^s))),i.push(s)}t.ip=e},function(t){var e=t.stack,n=t.store;n||(n=t.store=[]);var i=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"WS",i,r),n[r]=i},function(t){var e=t.stack,n=t.store,i=e.pop();exports.DEBUG&&console.log(t.step,"RS",i);var r=n&&n[i]||0;e.push(r)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"WCVTP",n,i),t.cvt[i]=n/64},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"RCVT",n),e.push(64*t.cvt[n])},Cn.bind(void 0,0),Cn.bind(void 0,1),void 0,Sn.bind(void 0,0),Sn.bind(void 0,1),function(t){exports.DEBUG&&console.log(t.step,"MPPEM[]"),t.stack.push(t.ppem)},void 0,function(t){exports.DEBUG&&console.log(t.step,"FLIPON[]"),t.autoFlip=!0},void 0,void 0,function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"LT[]",n,i),e.push(i<n?1:0)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"LTEQ[]",n,i),e.push(i<=n?1:0)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"GT[]",n,i),e.push(i>n?1:0)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"GTEQ[]",n,i),e.push(i>=n?1:0)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"EQ[]",n,i),e.push(n===i?1:0)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"NEQ[]",n,i),e.push(n!==i?1:0)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"ODD[]",n),e.push(Math.trunc(n)%2?1:0)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"EVEN[]",n),e.push(Math.trunc(n)%2?0:1)},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"IF[]",e),e||(an(t,!0),exports.DEBUG&&console.log(t.step,"EIF[]"))},function(t){exports.DEBUG&&console.log(t.step,"EIF[]")},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"AND[]",n,i),e.push(n&&i?1:0)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"OR[]",n,i),e.push(n||i?1:0)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"NOT[]",n),e.push(n?0:1)},wn.bind(void 0,1),function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SDB[]",e),t.deltaBase=e},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SDS[]",e),t.deltaShift=Math.pow(.5,e)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"ADD[]",n,i),e.push(i+n)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"SUB[]",n,i),e.push(i-n)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"DIV[]",n,i),e.push(64*i/n)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"MUL[]",n,i),e.push(i*n/64)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"ABS[]",n),e.push(Math.abs(n))},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"NEG[]",n),e.push(-n)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"FLOOR[]",n),e.push(64*Math.floor(n/64))},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"CEILING[]",n),e.push(64*Math.ceil(n/64))},_n.bind(void 0,0),_n.bind(void 0,1),_n.bind(void 0,2),_n.bind(void 0,3),void 0,void 0,void 0,void 0,function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"WCVTF[]",n,i),t.cvt[i]=n*t.ppem/t.font.unitsPerEm},wn.bind(void 0,2),wn.bind(void 0,3),Dn.bind(void 0,1),Dn.bind(void 0,2),Dn.bind(void 0,3),function(t){var e,n=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SROUND[]",n),t.round=Qe,192&n){case 0:e=.5;break;case 64:e=1;break;case 128:e=2;break;default:throw new Error("invalid SROUND value")}switch(t.srPeriod=e,48&n){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*e;break;case 32:t.srPhase=.5*e;break;case 48:t.srPhase=.75*e;break;default:throw new Error("invalid SROUND value")}n&=15,t.srThreshold=0===n?0:(n/8-.5)*e},function(t){var e,n=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"S45ROUND[]",n),t.round=Qe,192&n){case 0:e=Math.sqrt(2)/2;break;case 64:e=Math.sqrt(2);break;case 128:e=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(t.srPeriod=e,48&n){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*e;break;case 32:t.srPhase=.5*e;break;case 48:t.srPhase=.75*e;break;default:throw new Error("invalid S45ROUND value")}n&=15,t.srThreshold=0===n?0:(n/8-.5)*e},void 0,void 0,function(t){exports.DEBUG&&console.log(t.step,"ROFF[]"),t.round=Xe},void 0,function(t){exports.DEBUG&&console.log(t.step,"RUTG[]"),t.round=Ve},function(t){exports.DEBUG&&console.log(t.step,"RDTG[]"),t.round=Ze},dn,dn,void 0,void 0,void 0,void 0,void 0,function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SCANCTRL[]",e)},Tn.bind(void 0,0),Tn.bind(void 0,1),function(t){var e=t.stack,n=e.pop(),i=0;exports.DEBUG&&console.log(t.step,"GETINFO[]",n),1&n&&(i=35),32&n&&(i|=4096),e.push(i)},void 0,function(t){var e=t.stack,n=e.pop(),i=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"ROLL[]"),e.push(i),e.push(n),e.push(r)},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"MAX[]",n,i),e.push(Math.max(i,n))},function(t){var e=t.stack,n=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"MIN[]",n,i),e.push(Math.min(i,n))},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SCANTYPE[]",e)},function(t){var e=t.stack.pop(),n=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"INSTCTRL[]",e,n),e){case 1:return void(t.inhibitGridFit=!!n);case 2:return void(t.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,En.bind(void 0,1),En.bind(void 0,2),En.bind(void 0,3),En.bind(void 0,4),En.bind(void 0,5),En.bind(void 0,6),En.bind(void 0,7),En.bind(void 0,8),kn.bind(void 0,1),kn.bind(void 0,2),kn.bind(void 0,3),kn.bind(void 0,4),kn.bind(void 0,5),kn.bind(void 0,6),kn.bind(void 0,7),kn.bind(void 0,8),On.bind(void 0,0,0,0,0,0),On.bind(void 0,0,0,0,0,1),On.bind(void 0,0,0,0,0,2),On.bind(void 0,0,0,0,0,3),On.bind(void 0,0,0,0,1,0),On.bind(void 0,0,0,0,1,1),On.bind(void 0,0,0,0,1,2),On.bind(void 0,0,0,0,1,3),On.bind(void 0,0,0,1,0,0),On.bind(void 0,0,0,1,0,1),On.bind(void 0,0,0,1,0,2),On.bind(void 0,0,0,1,0,3),On.bind(void 0,0,0,1,1,0),On.bind(void 0,0,0,1,1,1),On.bind(void 0,0,0,1,1,2),On.bind(void 0,0,0,1,1,3),On.bind(void 0,0,1,0,0,0),On.bind(void 0,0,1,0,0,1),On.bind(void 0,0,1,0,0,2),On.bind(void 0,0,1,0,0,3),On.bind(void 0,0,1,0,1,0),On.bind(void 0,0,1,0,1,1),On.bind(void 0,0,1,0,1,2),On.bind(void 0,0,1,0,1,3),On.bind(void 0,0,1,1,0,0),On.bind(void 0,0,1,1,0,1),On.bind(void 0,0,1,1,0,2),On.bind(void 0,0,1,1,0,3),On.bind(void 0,0,1,1,1,0),On.bind(void 0,0,1,1,1,1),On.bind(void 0,0,1,1,1,2),On.bind(void 0,0,1,1,1,3),On.bind(void 0,1,0,0,0,0),On.bind(void 0,1,0,0,0,1),On.bind(void 0,1,0,0,0,2),On.bind(void 0,1,0,0,0,3),On.bind(void 0,1,0,0,1,0),On.bind(void 0,1,0,0,1,1),On.bind(void 0,1,0,0,1,2),On.bind(void 0,1,0,0,1,3),On.bind(void 0,1,0,1,0,0),On.bind(void 0,1,0,1,0,1),On.bind(void 0,1,0,1,0,2),On.bind(void 0,1,0,1,0,3),On.bind(void 0,1,0,1,1,0),On.bind(void 0,1,0,1,1,1),On.bind(void 0,1,0,1,1,2),On.bind(void 0,1,0,1,1,3),On.bind(void 0,1,1,0,0,0),On.bind(void 0,1,1,0,0,1),On.bind(void 0,1,1,0,0,2),On.bind(void 0,1,1,0,0,3),On.bind(void 0,1,1,0,1,0),On.bind(void 0,1,1,0,1,1),On.bind(void 0,1,1,0,1,2),On.bind(void 0,1,1,0,1,3),On.bind(void 0,1,1,1,0,0),On.bind(void 0,1,1,1,0,1),On.bind(void 0,1,1,1,0,2),On.bind(void 0,1,1,1,0,3),On.bind(void 0,1,1,1,1,0),On.bind(void 0,1,1,1,1,1),On.bind(void 0,1,1,1,1,2),On.bind(void 0,1,1,1,1,3)],An.prototype.setState=function(t,e){return this.state[t]=e,this.activeState={key:t,value:this.state[t]},this.activeState},An.prototype.getState=function(t){return this.state[t]||null},Rn.prototype.inboundIndex=function(t){return t>=0&&t<this.tokens.length},Rn.prototype.composeRUD=function(t){var e=this,n=t.map((function(t){return e[t[0]].apply(e,t.slice(1).concat(!0))})),i=function(t){return"object"===r()(t)&&t.hasOwnProperty("FAIL")};if(n.every(i))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:n.filter(i)};this.dispatch("composeRUD",[n.filter((function(t){return!i(t)}))])},Rn.prototype.replaceRange=function(t,e,n,i){e=null!==e?e:this.tokens.length;var r=n.every((function(t){return t instanceof An}));if(!isNaN(t)&&this.inboundIndex(t)&&r){var o=this.tokens.splice.apply(this.tokens,[t,e].concat(n));return i||this.dispatch("replaceToken",[t,e,n]),[o,n]}return{FAIL:"replaceRange: invalid tokens or startIndex."}},Rn.prototype.replaceToken=function(t,e,n){if(!isNaN(t)&&this.inboundIndex(t)&&e instanceof An){var i=this.tokens.splice(t,1,e);return n||this.dispatch("replaceToken",[t,e]),[i[0],e]}return{FAIL:"replaceToken: invalid token or index."}},Rn.prototype.removeRange=function(t,e,n){e=isNaN(e)?this.tokens.length:e;var i=this.tokens.splice(t,e);return n||this.dispatch("removeRange",[i,t,e]),i},Rn.prototype.removeToken=function(t,e){if(!isNaN(t)&&this.inboundIndex(t)){var n=this.tokens.splice(t,1);return e||this.dispatch("removeToken",[n,t]),n}return{FAIL:"removeToken: invalid token index."}},Rn.prototype.insertToken=function(t,e,n){return t.every((function(t){return t instanceof An}))?(this.tokens.splice.apply(this.tokens,[e,0].concat(t)),n||this.dispatch("insertToken",[t,e]),t):{FAIL:"insertToken: invalid token(s)."}},Rn.prototype.registerModifier=function(t,e,n){this.events.newToken.subscribe((function(i,r){var o=[i,r],s=[i,r];if(null===e||!0===e.apply(this,o)){var a=n.apply(this,s);i.setState(t,a)}})),this.registeredModifiers.push(t)},Mn.prototype.subscribe=function(t){return"function"===typeof t?this.subscribers.push(t)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},Mn.prototype.unsubscribe=function(t){this.subscribers.splice(t,1)},Fn.prototype.setCurrentIndex=function(t){this.index=t,this.current=this.context[t],this.backtrack=this.context.slice(0,t),this.lookahead=this.context.slice(t+1)},Fn.prototype.get=function(t){switch(!0){case 0===t:return this.current;case t<0&&Math.abs(t)<=this.backtrack.length:return this.backtrack.slice(t)[0];case t>0&&t<=this.lookahead.length:return this.lookahead[t-1];default:return null}},Rn.prototype.rangeToText=function(t){if(t instanceof Pn)return this.getRangeTokens(t).map((function(t){return t.char})).join("")},Rn.prototype.getText=function(){return this.tokens.map((function(t){return t.char})).join("")},Rn.prototype.getContext=function(t){var e=this.registeredContexts[t];return e||null},Rn.prototype.on=function(t,e){var n=this.events[t];return n?n.subscribe(e):null},Rn.prototype.dispatch=function(t,e){var n=this,i=this.events[t];i instanceof Mn&&i.subscribers.forEach((function(t){t.apply(n,e||[])}))},Rn.prototype.registerContextChecker=function(t,e,n){if(this.getContext(t))return{FAIL:"context name '"+t+"' is already registered."};if("function"!==typeof e)return{FAIL:"missing context start check."};if("function"!==typeof n)return{FAIL:"missing context end check."};var i=new In(t,e,n);return this.registeredContexts[t]=i,this.contextCheckers.push(i),i},Rn.prototype.getRangeTokens=function(t){var e=t.startIndex+t.endOffset;return[].concat(this.tokens.slice(t.startIndex,e))},Rn.prototype.getContextRanges=function(t){var e=this.getContext(t);return e?e.ranges:{FAIL:"context checker '"+t+"' is not registered."}},Rn.prototype.resetContextsRanges=function(){var t=this.registeredContexts;for(var e in t){if(t.hasOwnProperty(e))t[e].ranges=[]}},Rn.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var t=this.tokens.map((function(t){return t.char})),e=0;e<t.length;e++){var n=new Fn(t,e);this.runContextCheck(n)}this.dispatch("updateContextsRanges",[this.registeredContexts])},Rn.prototype.setEndOffset=function(t,e){var n=new Pn(this.getContext(e).openRange.startIndex,t,e),i=this.getContext(e).ranges;return n.rangeId=e+"."+i.length,i.push(n),this.getContext(e).openRange=null,n},Rn.prototype.runContextCheck=function(t){var e=this,n=t.index;this.contextCheckers.forEach((function(i){var r=i.contextName,o=e.getContext(r).openRange;if(!o&&i.checkStart(t)&&(o=new Pn(n,null,r),e.getContext(r).openRange=o,e.dispatch("contextStart",[r,n])),o&&i.checkEnd(t)){var s=n-o.startIndex+1,a=e.setEndOffset(s,r);e.dispatch("contextEnd",[r,a])}}))},Rn.prototype.tokenize=function(t){this.tokens=[],this.resetContextsRanges();var e=Array.from(t);this.dispatch("start");for(var n=0;n<e.length;n++){var i=e[n],r=new Fn(e,n);this.dispatch("next",[r]),this.runContextCheck(r);var o=new An(i);this.tokens.push(o),this.dispatch("newToken",[o,r])}return this.dispatch("end",[this.tokens]),this.tokens},Nn.prototype.getDefaultScriptFeaturesIndexes=function(){for(var t=this.font.tables.gsub.scripts,e=0;e<t.length;e++){var n=t[e];if("DFLT"===n.tag)return n.script.defaultLangSys.featureIndexes}return[]},Nn.prototype.getScriptFeaturesIndexes=function(t){if(!this.font.tables.gsub)return[];if(!t)return this.getDefaultScriptFeaturesIndexes();for(var e=this.font.tables.gsub.scripts,n=0;n<e.length;n++){var i=e[n];if(i.tag===t&&i.script.defaultLangSys)return i.script.defaultLangSys.featureIndexes;var r=i.langSysRecords;if(r)for(var o=0;o<r.length;o++){var s=r[o];if(s.tag===t)return s.langSys.featureIndexes}}return this.getDefaultScriptFeaturesIndexes()},Nn.prototype.mapTagsToFeatures=function(t,e){for(var n={},i=0;i<t.length;i++){var r=t[i].tag,o=t[i].feature;n[r]=o}this.features[e].tags=n},Nn.prototype.getScriptFeatures=function(t){var e=this.features[t];if(this.features.hasOwnProperty(t))return e;var n=this.getScriptFeaturesIndexes(t);if(!n)return null;var i=this.font.tables.gsub;return e=n.map((function(t){return i.features[t]})),this.features[t]=e,this.mapTagsToFeatures(e,t),e},Nn.prototype.getSubstitutionType=function(t,e){return t.lookupType.toString()+e.substFormat.toString()},Nn.prototype.getLookupMethod=function(t,e){var n=this;switch(this.getSubstitutionType(t,e)){case"11":return function(t){return Xn.apply(n,[t,e])};case"12":return function(t){return Gn.apply(n,[t,e])};case"63":return function(t){return qn.apply(n,[t,e])};case"41":return function(t){return Vn.apply(n,[t,e])};case"21":return function(t){return Zn.apply(n,[t,e])};default:throw new Error("lookupType: "+t.lookupType+" - substFormat: "+e.substFormat+" is not yet supported")}},Nn.prototype.lookupFeature=function(t){var e=t.contextParams,n=e.index,i=this.getFeature({tag:t.tag,script:t.script});if(!i)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+t.tag+"' for script '"+t.script+"'.");for(var r=this.getFeatureLookups(i),o=[].concat(e.context),s=0;s<r.length;s++)for(var a=r[s],c=this.getLookupSubtables(a),l=0;l<c.length;l++){var u=c[l],h=this.getSubstitutionType(a,u),f=this.getLookupMethod(a,u),d=void 0;switch(h){case"11":(d=f(e.current))&&o.splice(n,1,new Wn({id:11,tag:t.tag,substitution:d}));break;case"12":(d=f(e.current))&&o.splice(n,1,new Wn({id:12,tag:t.tag,substitution:d}));break;case"63":d=f(e),Array.isArray(d)&&d.length&&o.splice(n,1,new Wn({id:63,tag:t.tag,substitution:d}));break;case"41":(d=f(e))&&o.splice(n,1,new Wn({id:41,tag:t.tag,substitution:d}));break;case"21":(d=f(e.current))&&o.splice(n,1,new Wn({id:21,tag:t.tag,substitution:d}))}e=new Fn(o,n),Array.isArray(d)&&!d.length||(d=null)}return o.length?o:null},Nn.prototype.supports=function(t){if(!t.script)return!1;this.getScriptFeatures(t.script);var e=this.features.hasOwnProperty(t.script);if(!t.tag)return e;var n=this.features[t.script].some((function(e){return e.tag===t.tag}));return e&&n},Nn.prototype.getLookupSubtables=function(t){return t.subtables||null},Nn.prototype.getLookupByIndex=function(t){return this.font.tables.gsub.lookups[t]||null},Nn.prototype.getFeatureLookups=function(t){return t.lookupListIndexes.map(this.getLookupByIndex.bind(this))},Nn.prototype.getFeature=function(t){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(t.script)||this.getScriptFeatures(t.script);var e=this.features[t.script];return e?e.tags[t.tag]?this.features[t.script].tags[t.tag]:null:{FAIL:"No feature for script "+t.script}};var Qn={startCheck:function(t){var e=t.current,n=t.get(-1);return null===n&&jn(e)||!jn(n)&&jn(e)},endCheck:function(t){var e=t.get(1);return(null===e||!jn(e))}};var Kn={startCheck:function(t){var e=t.current,n=t.get(-1);return(jn(e)||Un(e))&&!jn(n)},endCheck:function(t){var e=t.get(1);switch(!0){case null===e:return!0;case!jn(e)&&!Un(e):var n=/\s/.test(e);if(!n)return!0;if(n){if(!t.lookahead.some((function(t){return jn(t)||Un(t)})))return!0}break;default:return!1}}};var $n={11:function(t,e,n){e[n].setState(t.tag,t.substitution)},12:function(t,e,n){e[n].setState(t.tag,t.substitution)},63:function(t,e,n){t.substitution.forEach((function(i,r){e[n+r].setState(t.tag,i)}))},41:function(t,e,n){var i=e[n];i.setState(t.tag,t.substitution.ligGlyph);for(var r=t.substitution.components.length,o=0;o<r;o++)(i=e[n+o+1]).setState("deleted",!0)}};function Jn(t,e,n){t instanceof Wn&&$n[t.id]&&$n[t.id](t,e,n)}function ti(t){var e=this,n=this.featuresTags.arab,i=this.tokenizer.getRangeTokens(t);if(1!==i.length){var r=new Fn(i.map((function(t){return t.getState("glyphIndex")})),0),o=new Fn(i.map((function(t){return t.char})),0);i.forEach((function(t,s){if(!Un(t.char)){r.setCurrentIndex(s),o.setCurrentIndex(s);var a,c=0;switch(function(t){for(var e=[].concat(t.backtrack),n=e.length-1;n>=0;n--){var i=e[n],r=Bn(i),o=Un(i);if(!r&&!o)return!0;if(r)return!1}return!1}(o)&&(c|=1),function(t){if(Bn(t.current))return!1;for(var e=0;e<t.lookahead.length;e++){if(!Un(t.lookahead[e]))return!0}return!1}(o)&&(c|=2),c){case 1:a="fina";break;case 2:a="init";break;case 3:a="medi"}if(-1!==n.indexOf(a)){var l=e.query.lookupFeature({tag:a,script:"arab",contextParams:r});if(l instanceof Error)return console.info(l.message);l.forEach((function(t,e){t instanceof Wn&&(Jn(t,i,e),r.context[e]=t.substitution)}))}}}))}}function ei(t,e){return new Fn(t.map((function(t){return t.activeState.value})),e||0)}function ni(t){var e=this,n=this.tokenizer.getRangeTokens(t),i=ei(n);i.context.forEach((function(t,r){i.setCurrentIndex(r);var o=e.query.lookupFeature({tag:"rlig",script:"arab",contextParams:i});o.length&&(o.forEach((function(t){return Jn(t,n,r)})),i=ei(n))}))}var ii={startCheck:function(t){var e=t.current,n=t.get(-1);return null===n&&zn(e)||!zn(n)&&zn(e)},endCheck:function(t){var e=t.get(1);return(null===e||!zn(e))}};function ri(t,e){return new Fn(t.map((function(t){return t.activeState.value})),e||0)}function oi(t){var e=this,n=this.tokenizer.getRangeTokens(t),i=ri(n);i.context.forEach((function(t,r){i.setCurrentIndex(r);var o=e.query.lookupFeature({tag:"liga",script:"latn",contextParams:i});o.length&&(o.forEach((function(t){return Jn(t,n,r)})),i=ri(n))}))}function si(t){this.baseDir=t||"ltr",this.tokenizer=new Rn,this.featuresTags={}}function ai(t){var e=this.contextChecks[t+"Check"];return this.tokenizer.registerContextChecker(t,e.startCheck,e.endCheck)}function ci(){return ai.call(this,"latinWord"),ai.call(this,"arabicWord"),ai.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function li(){var t=this;this.tokenizer.getContextRanges("arabicSentence").forEach((function(e){var n=t.tokenizer.getRangeTokens(e);t.tokenizer.replaceRange(e.startIndex,e.endOffset,n.reverse())}))}function ui(){if(-1===this.tokenizer.registeredModifiers.indexOf("glyphIndex"))throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function hi(){var t=this;this.featuresTags.hasOwnProperty("arab")&&(ui.call(this),this.tokenizer.getContextRanges("arabicWord").forEach((function(e){ti.call(t,e)})))}function fi(){var t=this;this.featuresTags.hasOwnProperty("arab")&&(-1!==this.featuresTags.arab.indexOf("rlig")&&(ui.call(this),this.tokenizer.getContextRanges("arabicWord").forEach((function(e){ni.call(t,e)}))))}function di(){var t=this;this.featuresTags.hasOwnProperty("latn")&&(-1!==this.featuresTags.latn.indexOf("liga")&&(ui.call(this),this.tokenizer.getContextRanges("latinWord").forEach((function(e){oi.call(t,e)}))))}function pi(t){(t=t||{}).tables=t.tables||{},t.empty||(Ie(t.familyName,"When creating a new Font object, familyName is required."),Ie(t.styleName,"When creating a new Font object, styleName is required."),Ie(t.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Ie(t.ascender,"When creating a new Font object, ascender is required."),Ie(t.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:t.familyName||" "},fontSubfamily:{en:t.styleName||" "},fullName:{en:t.fullName||t.familyName+" "+t.styleName},postScriptName:{en:t.postScriptName||(t.familyName+t.styleName).replace(/\s/g,"")},designer:{en:t.designer||" "},designerURL:{en:t.designerURL||" "},manufacturer:{en:t.manufacturer||" "},manufacturerURL:{en:t.manufacturerURL||" "},license:{en:t.license||" "},licenseURL:{en:t.licenseURL||" "},version:{en:t.version||"Version 0.1"},description:{en:t.description||" "},copyright:{en:t.copyright||" "},trademark:{en:t.trademark||" "}},this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.createdTimestamp=t.createdTimestamp,this.tables=Object.assign(t.tables,{os2:Object.assign({usWeightClass:t.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:t.widthClass||this.usWidthClasses.MEDIUM,fsSelection:t.fsSelection||this.fsSelectionValues.REGULAR},t.tables.os2)})),this.supported=!0,this.glyphs=new _t.GlyphSet(this,t.glyphs||[]),this.encoding=new gt(this),this.position=new Ee(this),this.substitution=new ke(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new He(this):void 0}})}function gi(t,e){var n=JSON.stringify(t),i=256;for(var r in e){var o=parseInt(r);if(o&&!(o<256)){if(JSON.stringify(e[r])===n)return o;i<=o&&(i=o+1)}}return e[i]=t,i}function mi(t,e,n){var i=gi(e.name,n);return[{name:"tag_"+t,type:"TAG",value:e.tag},{name:"minValue_"+t,type:"FIXED",value:e.minValue<<16},{name:"defaultValue_"+t,type:"FIXED",value:e.defaultValue<<16},{name:"maxValue_"+t,type:"FIXED",value:e.maxValue<<16},{name:"flags_"+t,type:"USHORT",value:0},{name:"nameID_"+t,type:"USHORT",value:i}]}function vi(t,e,n){var i={},r=new ct.Parser(t,e);return i.tag=r.parseTag(),i.minValue=r.parseFixed(),i.defaultValue=r.parseFixed(),i.maxValue=r.parseFixed(),r.skip("uShort",1),i.name=n[r.parseUShort()]||{},i}function yi(t,e,n,i){for(var r=[{name:"nameID_"+t,type:"USHORT",value:gi(e.name,i)},{name:"flags_"+t,type:"USHORT",value:0}],o=0;o<n.length;++o){var s=n[o].tag;r.push({name:"axis_"+t+" "+s,type:"FIXED",value:e.coordinates[s]<<16})}return r}function bi(t,e,n,i){var r={},o=new ct.Parser(t,e);r.name=i[o.parseUShort()]||{},o.skip("uShort",1),r.coordinates={};for(var s=0;s<n.length;++s)r.coordinates[n[s].tag]=o.parseFixed();return r}si.prototype.setText=function(t){this.text=t},si.prototype.contextChecks={latinWordCheck:ii,arabicWordCheck:Qn,arabicSentenceCheck:Kn},si.prototype.registerFeatures=function(t,e){var n=this,i=e.filter((function(e){return n.query.supports({script:t,tag:e})}));this.featuresTags.hasOwnProperty(t)?this.featuresTags[t]=this.featuresTags[t].concat(i):this.featuresTags[t]=i},si.prototype.applyFeatures=function(t,e){if(!t)throw new Error("No valid font was provided to apply features");this.query||(this.query=new Nn(t));for(var n=0;n<e.length;n++){var i=e[n];this.query.supports({script:i.script})&&this.registerFeatures(i.script,i.tags)}},si.prototype.registerModifier=function(t,e,n){this.tokenizer.registerModifier(t,e,n)},si.prototype.checkContextReady=function(t){return!!this.tokenizer.getContext(t)},si.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(hi.call(this),fi.call(this)),this.checkContextReady("latinWord")&&di.call(this),this.checkContextReady("arabicSentence")&&li.call(this)},si.prototype.processText=function(t){this.text&&this.text===t||(this.setText(t),ci.call(this),this.applyFeaturesToContexts())},si.prototype.getBidiText=function(t){return this.processText(t),this.tokenizer.getText()},si.prototype.getTextGlyphs=function(t){this.processText(t);for(var e=[],n=0;n<this.tokenizer.tokens.length;n++){var i=this.tokenizer.tokens[n];if(!i.state.deleted){var r=i.activeState.value;e.push(Array.isArray(r)?r[0]:r)}}return e},pi.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},pi.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},pi.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},pi.prototype.updateFeatures=function(t){return this.defaultRenderOptions.features.map((function(e){return"latn"===e.script?{script:"latn",tags:e.tags.filter((function(e){return t[e]}))}:e}))},pi.prototype.stringToGlyphs=function(t,e){var n=this,i=new si;i.registerModifier("glyphIndex",null,(function(t){return n.charToGlyphIndex(t.char)}));var r=e?this.updateFeatures(e.features):this.defaultRenderOptions.features;i.applyFeatures(this,r);for(var o=i.getTextGlyphs(t),s=o.length,a=new Array(s),c=this.glyphs.get(0),l=0;l<s;l+=1)a[l]=this.glyphs.get(o[l])||c;return a},pi.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},pi.prototype.nameToGlyph=function(t){var e=this.nameToGlyphIndex(t),n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},pi.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},pi.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var n=this.position.defaultKerningTables;return n?this.position.getKerningValue(n,t,e):this.kerningPairs[t+","+e]||0},pi.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},pi.prototype.forEachGlyph=function(t,e,n,i,r,o){e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:72,r=Object.assign({},this.defaultRenderOptions,r);var s,a=1/this.unitsPerEm*i,c=this.stringToGlyphs(t,r);if(r.kerning){var l=r.script||this.position.getDefaultScriptName();s=this.position.getKerningTables(l,r.language)}for(var u=0;u<c.length;u+=1){var h=c[u];if(o.call(this,h,e,n,i,r),h.advanceWidth&&(e+=h.advanceWidth*a),r.kerning&&u<c.length-1)e+=(s?this.position.getKerningValue(s,h.index,c[u+1].index):this.getKerningValue(h,c[u+1]))*a;r.letterSpacing?e+=r.letterSpacing*i:r.tracking&&(e+=r.tracking/1e3*i)}return e},pi.prototype.getPath=function(t,e,n,i,r){var o=new A;return this.forEachGlyph(t,e,n,i,r,(function(t,e,n,i){var s=t.getPath(e,n,i,r,this);o.extend(s)})),o},pi.prototype.getPaths=function(t,e,n,i,r){var o=[];return this.forEachGlyph(t,e,n,i,r,(function(t,e,n,i){var s=t.getPath(e,n,i,r,this);o.push(s)})),o},pi.prototype.getAdvanceWidth=function(t,e,n){return this.forEachGlyph(t,0,0,e,n,(function(){}))},pi.prototype.draw=function(t,e,n,i,r,o){this.getPath(e,n,i,r,o).draw(t)},pi.prototype.drawPoints=function(t,e,n,i,r,o){this.forEachGlyph(e,n,i,r,o,(function(e,n,i,r){e.drawPoints(t,n,i,r)}))},pi.prototype.drawMetrics=function(t,e,n,i,r,o){this.forEachGlyph(e,n,i,r,o,(function(e,n,i,r){e.drawMetrics(t,n,i,r)}))},pi.prototype.getEnglishName=function(t){var e=this.names[t];if(e)return e.en},pi.prototype.validate=function(){var t=this;function e(e){var n=t.getEnglishName(e);n&&n.trim().length}e("fontFamily"),e("weightName"),e("manufacturer"),e("copyright"),e("version"),this.unitsPerEm},pi.prototype.toTables=function(){return Se.fontToTable(this)},pi.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},pi.prototype.toArrayBuffer=function(){for(var t=this.toTables().encode(),e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;i++)n[i]=t[i];return e},pi.prototype.download=function(t){var e=this.getEnglishName("fontFamily"),i=this.getEnglishName("fontSubfamily");t=t||e.replace(/\s/g,"")+"-"+i+".otf";var r=this.toArrayBuffer();if("undefined"!==typeof window)if(window.URL=window.URL||window.webkitURL,window.URL){var o=new DataView(r),s=new Blob([o],{type:"font/opentype"}),a=document.createElement("a");a.href=window.URL.createObjectURL(s),a.download=t;var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!1),a.dispatchEvent(c)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var l=n(39),u=function(t){for(var e=new Buffer(t.byteLength),n=new Uint8Array(t),i=0;i<e.length;++i)e[i]=n[i];return e}(r);l.writeFileSync(t,u)}},pi.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},pi.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},pi.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var xi={make:function(t,e){var n=new tt.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:t.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:t.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*t.axes.length}]);n.offsetToData=n.sizeOf();for(var i=0;i<t.axes.length;i++)n.fields=n.fields.concat(mi(i,t.axes[i],e));for(var r=0;r<t.instances.length;r++)n.fields=n.fields.concat(yi(r,t.instances[r],t.axes,e));return n},parse:function(t,e,n){var i=new ct.Parser(t,e),r=i.parseULong();F.argument(65536===r,"Unsupported fvar table version.");var o=i.parseOffset16();i.skip("uShort",1);for(var s=i.parseUShort(),a=i.parseUShort(),c=i.parseUShort(),l=i.parseUShort(),u=[],h=0;h<s;h++)u.push(vi(t,e+o+h*a,n));for(var f=[],d=e+o+s*a,p=0;p<c;p++)f.push(bi(t,d+p*l,u,n));return{axes:u,instances:f}}},Ci=new Array(10);Ci[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{posFormat:1,coverage:this.parsePointer(st.coverage),value:this.parseValueRecord()}:2===e?{posFormat:2,coverage:this.parsePointer(st.coverage),values:this.parseValueRecordList()}:void F.assert(!1,"0x"+t.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Ci[2]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();F.assert(1===e||2===e,"0x"+t.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var n=this.parsePointer(st.coverage),i=this.parseUShort(),r=this.parseUShort();if(1===e)return{posFormat:e,coverage:n,valueFormat1:i,valueFormat2:r,pairSets:this.parseList(st.pointer(st.list((function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(i),value2:this.parseValueRecord(r)}}))))};if(2===e){var o=this.parsePointer(st.classDef),s=this.parsePointer(st.classDef),a=this.parseUShort(),c=this.parseUShort();return{posFormat:e,coverage:n,valueFormat1:i,valueFormat2:r,classDef1:o,classDef2:s,class1Count:a,class2Count:c,classRecords:this.parseList(a,st.list(c,(function(){return{value1:this.parseValueRecord(i),value2:this.parseValueRecord(r)}})))}}},Ci[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Ci[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Ci[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Ci[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Ci[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Ci[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Ci[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var Si=new Array(10);var wi={parse:function(t,e){var n=new st(t,e=e||0),i=n.parseVersion(1);return F.argument(1===i||1.1===i,"Unsupported GPOS table version "+i),1===i?{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ci)}:{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ci),variations:n.parseFeatureVariationsList()}},make:function(t){return new tt.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new tt.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new tt.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new tt.LookupList(t.lookups,Si)}])}};var _i={parse:function(t,e){var n=new ct.Parser(t,e),i=n.parseUShort();if(0===i)return function(t){var e={};t.skip("uShort");var n=t.parseUShort();F.argument(0===n,"Unsupported kern sub-table version."),t.skip("uShort",2);var i=t.parseUShort();t.skip("uShort",3);for(var r=0;r<i;r+=1){var o=t.parseUShort(),s=t.parseUShort(),a=t.parseShort();e[o+","+s]=a}return e}(n);if(1===i)return function(t){var e={};t.skip("uShort"),t.parseULong()>1&&console.warn("Only the first kern subtable is supported."),t.skip("uLong");var n=255&t.parseUShort();if(t.skip("uShort"),0===n){var i=t.parseUShort();t.skip("uShort",3);for(var r=0;r<i;r+=1){var o=t.parseUShort(),s=t.parseUShort(),a=t.parseShort();e[o+","+s]=a}}return e}(n);throw new Error("Unsupported kern table version ("+i+").")}};var Di={parse:function(t,e,n,i){for(var r=new ct.Parser(t,e),o=i?r.parseUShort:r.parseULong,s=[],a=0;a<n+1;a+=1){var c=o.call(r);i&&(c*=2),s.push(c)}return s}};function Ti(t,e){n(39).readFile(t,(function(t,n){if(t)return e(t.message);e(null,Pe(n))}))}function Ei(t,e){var n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){return n.response?e(null,n.response):e("Font could not be loaded: "+n.statusText)},n.onerror=function(){e("Font could not be loaded")},n.send()}function ki(t,e){for(var n=[],i=12,r=0;r<e;r+=1){var o=ct.getTag(t,i),s=ct.getULong(t,i+4),a=ct.getULong(t,i+8),c=ct.getULong(t,i+12);n.push({tag:o,checksum:s,offset:a,length:c,compression:!1}),i+=16}return n}function Oi(t,e){if("WOFF"===e.compression){var n=new Uint8Array(t.buffer,e.offset+2,e.compressedLength-2),i=new Uint8Array(e.length);if(E(n,i),i.byteLength!==e.length)throw new Error("Decompression error: "+e.tag+" decompressed length doesn't match recorded length");return{data:new DataView(i.buffer,0),offset:0}}return{data:t,offset:e.offset}}function Ai(t,e){var n,i;e=void 0===e||null===e?{}:e;var r,o,s,a,c,l,u,h,f,d,p,g,m=new pi({empty:!0}),v=new DataView(t,0),y=[],b=ct.getTag(v,0);if(b===String.fromCharCode(0,1,0,0)||"true"===b||"typ1"===b)m.outlinesFormat="truetype",y=ki(v,r=ct.getUShort(v,4));else if("OTTO"===b)m.outlinesFormat="cff",y=ki(v,r=ct.getUShort(v,4));else{if("wOFF"!==b)throw new Error("Unsupported OpenType signature "+b);var x=ct.getTag(v,4);if(x===String.fromCharCode(0,1,0,0))m.outlinesFormat="truetype";else{if("OTTO"!==x)throw new Error("Unsupported OpenType flavor "+b);m.outlinesFormat="cff"}y=function(t,e){for(var n=[],i=44,r=0;r<e;r+=1){var o=ct.getTag(t,i),s=ct.getULong(t,i+4),a=ct.getULong(t,i+8),c=ct.getULong(t,i+12),l=void 0;l=a<c&&"WOFF",n.push({tag:o,offset:s,compression:l,compressedLength:a,length:c}),i+=20}return n}(v,r=ct.getUShort(v,12))}for(var C=0;C<r;C+=1){var S=y[C],w=void 0;switch(S.tag){case"cmap":w=Oi(v,S),m.tables.cmap=ut.parse(w.data,w.offset),m.encoding=new mt(m.tables.cmap);break;case"cvt ":w=Oi(v,S),g=new ct.Parser(w.data,w.offset),m.tables.cvt=g.parseShortList(S.length/2);break;case"fvar":s=S;break;case"fpgm":w=Oi(v,S),g=new ct.Parser(w.data,w.offset),m.tables.fpgm=g.parseByteList(S.length);break;case"head":w=Oi(v,S),m.tables.head=Xt.parse(w.data,w.offset),m.unitsPerEm=m.tables.head.unitsPerEm,n=m.tables.head.indexToLocFormat;break;case"hhea":w=Oi(v,S),m.tables.hhea=Gt.parse(w.data,w.offset),m.ascender=m.tables.hhea.ascender,m.descender=m.tables.hhea.descender,m.numberOfHMetrics=m.tables.hhea.numberOfHMetrics;break;case"hmtx":u=S;break;case"ltag":w=Oi(v,S),i=qt.parse(w.data,w.offset);break;case"maxp":w=Oi(v,S),m.tables.maxp=Vt.parse(w.data,w.offset),m.numGlyphs=m.tables.maxp.numGlyphs;break;case"name":d=S;break;case"OS/2":w=Oi(v,S),m.tables.os2=le.parse(w.data,w.offset);break;case"post":w=Oi(v,S),m.tables.post=ue.parse(w.data,w.offset),m.glyphNames=new yt(m.tables.post);break;case"prep":w=Oi(v,S),g=new ct.Parser(w.data,w.offset),m.tables.prep=g.parseByteList(S.length);break;case"glyf":a=S;break;case"loca":f=S;break;case"CFF ":o=S;break;case"kern":h=S;break;case"GPOS":c=S;break;case"GSUB":l=S;break;case"meta":p=S}}var _=Oi(v,d);if(m.tables.name=ae.parse(_.data,_.offset,i),m.names=m.tables.name,a&&f){var D=0===n,T=Oi(v,f),E=Di.parse(T.data,T.offset,m.numGlyphs,D),k=Oi(v,a);m.glyphs=We.parse(k.data,k.offset,E,m,e)}else{if(!o)throw new Error("Font doesn't contain TrueType or CFF outlines.");var O=Oi(v,o);Ht.parse(O.data,O.offset,m,e)}var A=Oi(v,u);if(Yt.parse(m,A.data,A.offset,m.numberOfHMetrics,m.numGlyphs,m.glyphs,e),bt(m,e),h){var P=Oi(v,h);m.kerningPairs=_i.parse(P.data,P.offset)}else m.kerningPairs={};if(c){var I=Oi(v,c);m.tables.gpos=wi.parse(I.data,I.offset),m.position.init()}if(l){var F=Oi(v,l);m.tables.gsub=pe.parse(F.data,F.offset)}if(s){var M=Oi(v,s);m.tables.fvar=xi.parse(M.data,M.offset,m.names)}if(p){var L=Oi(v,p);m.tables.meta=ge.parse(L.data,L.offset),m.metas=m.tables.meta}return m}function Pi(t,e,n){var i="undefined"===typeof window?Ti:Ei;return new Promise((function(r,o){i(t,(function(t,i){if(t){if(e)return e(t);o(t)}var s;try{s=Ai(i,n)}catch(a){if(e)return e(a,null);o(a)}if(e)return e(null,s);r(s)}))}))}n(129);var Ii={};window.Font={resolve:function(t){if(t=(t=(t=t.replace(/"/g,"")).replace(/'/g,"")).toLowerCase(),Ii[t])return Ii[t];for(var e in Ii)if(Ii.hasOwnProperty(e)&&e.startsWith(t))return Ii[e];console.error('Font "'+t+'" was not cached with loadAsync()')},loadAsync:function(t,e){return new Promise((function(n,i){t=(t=(t=t.replace(/"/g,"")).replace(/'/g,"")).toLowerCase(),Pi(e,(function(e,r){e&&i(e),Ii[t]=r;r.numGlyphs;var o,s,a=-99999999,c=99999999,l="x",u=null;for(o in r.glyphs.glyphs)if(r.glyphs.glyphs.hasOwnProperty(o)&&(s=r.glyphs.glyphs[o]).name==l){u=s;break}if(!u)for(o in l=l.toUpperCase(),r.glyphs.glyphs)if(r.glyphs.glyphs.hasOwnProperty(o)&&(s=r.glyphs.glyphs[o]).name==l){u=s;break}if(u){var h=u.getMetrics();for(o in r.glyphs.glyphs)if(r.glyphs.glyphs.hasOwnProperty(o)){var f=(s=r.glyphs.glyphs[o]).getMetrics();"undefined"!==typeof f.yMin?(s.descent=Math.abs(f.yMin),s.ascent=Math.abs(h.yMax-f.yMax)):(s.ascent=0,s.descent=0)}}else for(o in console.warn("Couldn't find pattern Glyph for font: "+t),r.glyphs.glyphs)r.glyphs.glyphs.hasOwnProperty(o)&&((s=r.glyphs.glyphs[o]).descent=0);for(o in r.glyphs.glyphs)if(r.glyphs.glyphs.hasOwnProperty(o)){var d=(s=r.glyphs.glyphs[o]).getMetrics();"undefined"!==typeof d.yMin&&(a=Math.max(d.yMax,a),c=Math.min(d.yMin,c))}r.totalDescender=c,r.totalAscender=a,r.fontHeight=Math.abs(a-c),n()}))}))},hasFont:function(t){return t=(t=(t=t.replace(/"/g,"")).replace(/'/g,"")).toLowerCase(),!!Ii[t]}}}]);